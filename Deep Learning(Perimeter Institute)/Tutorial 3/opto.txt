Research topics Marquardt group: at the interface of nanophysics and quantum optics
For up-to-date complete info, please also consult the publications page!

In our research, we apply tools from condensed matter theory and from quantum optics to a range of questions at the interface of nanophysics and quantum optics, addressing both quantum and classical dynamics. In our approach, we often try to identify the salient features of experimentally relevant situations and condense them into minimalist models which can then be attacked with all the state-of-the-art theoretical tools. At the same time, we also care about the direct contact with experiments, down to designing the classical electromagnetic and acoustic properties of specific structures.

In the past few years, our main focus has been developing the theoretical underpinnings of a new research area, that of cavity optomechanics. The following overview gives a brief introduction to this field and then describes our main contributions (both in establishing the foundations in the early stages, and our more recent ongoing work).

Cavity Optomechanics: Brief Introduction

The Livingston LIGO site (picture: LIGO collaboration)
Radiation pressure – Four hundred years ago, the astronomer Johannes Kepler wrote a book about comets. He noted that the tail of a comet always points away from the sun. His explanation: The light emanating from the sun pushes away the tail. This is probably the first known speculation about the physical phenomenon of radiation pressure. It was only Maxwell, though, who came up with a quantitative prediction for the radiation pressure force, and it took until 1901 to be detected in the laboratory (by Nichols and Hull in Dartmouth and by Lebedev in Moscow). Since then, radiation forces have been observed and exploited in various settings, for example in controlling the motion of cold atoms or dielectric particles. However, usually the light only provides some fixed forces, while there is no backaction of the mechanical motion onto the light field. This changes when we turn to the field of optomechanics, where there is a true two-way interaction.

Perhaps the most impressive precision measurement of all time is the detection of gravitational waves using kilometer-length Michelson interferometers. Using the two LIGO detectors, gravitational waves from the inspiral of two black holes have been measured in September 2015. These instruments are so sensitive that they can measure displacements of the order of the size of a nucleus. Their noise approaches the ultimate limits set by quantum mechanics. These limits arise due to the unavoidable shot noise of the laser beam. When the light power is rather low, the measured phase shift is uncertain due to the limited number of photons. As the power increases, the relative fluctuations of photon number become smaller, and the measurement gets more precise. However, there is a limit to the precision. At some point, for higher laser powers, another effect kicks in, and this is directly related to radiation pressure. The unavoidable photon shot noise fluctuations of the laser beam exert a random force on the end mirrors of the interferometer, which imprint some extra jitter motion that masks the real signal. Due to this "backaction noise", the precision decreases again. As a consequence, there is an intermediate power at which some optimum is reached, and that is known as the "standard quantum limit" of displacement detection. The importance of radiation pressure noise for the sensitivity of LIGO-type detectors was already discussed in the 70s, and in the 80s it led researchers to consider the use of "squeezed light" (which will become part of some future LIGO version).

LIGO is an example of a cavity-optomechanical system, albeit with rather unusual dimensions. About 10 years ago it was realized that many nano- and microscale systems can also exhibit optomechanical effects, and that these can be very strong. Since then, there has been a growing worlwide community of researchers that tries to harness the radiation pressure force (and similar radiation forces) for applications such as ultrasensitive detection, quantum communication, and studies in the foundations of quantum physics. Incidentally, modern research into cavity optomechanics at the micro- and nanoscale is also feeding back into improved ideas for gravitational wave detection.


Schematic of a typical cavity-optomechanical system

Cavity optomechanics setup – The typical system in cavity optomechanics is some optical cavity whose geometry changes due to any kind of mechanical motion. This might be the motion of an end-mirror, the motion of some polarizable object inside the cavity, or the deformation of a dielectric boundary (in a whispering gallery mode optical resonator or photonic crystal). If this description sounds very generic, then that is because indeed practically any optical cavity system will display optomechanical effects. The only question is how large they are, which depends on the details of the geometry but also on the amplitude of the mechanical motion. Having a cavity strongly enhances the effects, as compared to a simple free-space system with light bouncing off a mirror in the absence of any cavity. First of all, the incoming laser intensity is resonantly enhanced. It is multiplied by the finesse of the cavity, which can be on the order of a million. This increases the radiation force by the same amount. At the same time, tiny changes in the boundary of the cavity will induce a shift of all its optical resonance frequencies. Suppose the laser had initially been in resonance with the cavity, filling it up with light. A small shift of the resonance now will lead to a rapid decrease of light intensity, which will also decrease the force. It is in this way that light does not only exert a force, but any resulting motion will act back on the light field and modify the force in turn. There is a true interaction between light and mechanical motion, and this is at the heart of optomechanics.

One of the remarkable facts about optomechanics is the huge variety of physical devices in which it can be observed. Masses range from picogram nanodevices to kilogram-scale macroscopic mirrors, length scales from micrometer to centimeter (and beyond, if we include the km-length LIGO cavities), and the mechanical frequencies span many orders of magnitude as well, from Hz to several GHz. Crucially, the frequency of the radiation does not need to be resonant with the mechanical frequencies. This adds a lot of flexibility, allowing to employ optical radiation as well as microwave radiation. It also enables one of the potential significant applications of optomechanics in the domain of quantum information processing, namely coherent conversion of quantum signals from microwave to optical frequencies.


Optomechanical Setups (schematic), from top left: Fabry-Perot cavity with a moveable end-mirror, microtoroid, membrane or nanotube inside a cavity, photonic crystal, atoms trapped inside a cavity, vibrating capacitor plates in a microwave LC circuit
A brief history of optomechanics – The present research field of cavity optomechanics in micro- and nanoscale systems really started to take off only in around 2006. Nevertheless, over the preceding decades there had been a number of pioneering contributions. At the end of the 60s and during the 70s, Vladimir Braginsky was studying the measurement of small signals, with part of the motivation being gravitational wave detection. He built the first microwave cavity optomechanical system and showed that the microwave radiation can lead to some extra damping (or antidamping) of the mechanical motion of an end-mirror. In the 80s, the Walther lab at MPQ in Munich were the first to observe radiation pressure effects due to optical radiation, in a setup with a macroscopic mirror whose position showed bistability under the influence of the light. During the 90s, optomechanical experiments were primarily carried forward by the group around Antoine Heidmann at LKB in Paris, and there were some first speculations about quantum effects in such systems (groups of Knight and Tombesi). From about 2004 onward, a variety of different micro- and nanoscale systems were observed to show optomechanical effects, and the number of research groups has been growing quickly ever since that time.

Reviews - A more detailed discussion can be found in either one of our two reviews. A rather early, didactical brief overview in Marquardt and Girvin, "Optomechanics" (Physics '09); and a comprehensive review in Aspelmeyer, Kippenberg, and Marquardt, "Cavity Optomechanics" (Rev Mod Phys '14).


The following sections contain a review of our contributions to the field, organized by topic.

Our work
The past years have seen an explosion of interest in the interaction of light with nanomechanical motion. Typical systems contain a laser-driven optical cavity, being coupled via radiation forces to mechanical motion. The goals of this field range from foundational questions to applications in quantum information processing and in the ultrasensitive detection of mass, force, position and acceleration. Our significant early contributions to the initial developments of this field consisted in predicting the nonlinear dynamics, pointing out the requirements for ground-state laser cooling, and predicting the so-called strong coupling regime, where photons and phonons hybridize to form new excitations.

More recently, we have gone beyond the canonical optomechanical system and studied systems where many optical and mechanical modes couple to each other, forming optomechanical arrays and circuits. There, we are studying the many-body dynamics of photons and phonons interacting with each other, possibilities for mechanical quantum state processing, classical synchronization physics, and questions related to enhancing the coupling strengths.

Classical Nonlinear Dynamics

The generic attractor diagram for the nonlinear dynamics of an optomechanical system. Attractors (stable amplitudes) are shown in black.
The interaction of radiation with the mechanical motion of some object can give rise to intricate nonlinear dynamics. This holds for any standard optomechanical setup, where both the intensity of the radiation and its sensitivity to the mechanical motion are amplified by exploiting an optical cavity. Beyond a certain threshold in input laser power, the mechanical resonator may suddenly start to oscillate by itself, extracting the required energy from the radiation field. This is similar to lasing action, but here the result is a self-amplified mechanical oscillation, pumped by the optical field. The existence of a linear instability threshold itself was known already (particularly as a potential nuisance in interferometric gravitational wave detection), when we started our analysis. This led to our finding a rather surprising attractor diagram, with many possible nonlinear attractors for the long-time dynamics of the system (arXiv Feb 05, PRL 06). Nowadays, it is acknowledged that this describes the generic nonlinear behaviour of optomechanical systems. The attractor diagram has been observed in experiments by now. As pointed out in our 2006 PRL, the nonlinear attractor diagram might also be exploited in ultrasensitive 'latching' measurements, a proposal yet to be implemented.

We later extended this analysis in several ways. We showed how the system behaves in the deep quantum regime, and we also showed that when several such limit cycle oscillators are coupled, this may give rise to optomechanical synchronization.

Laser Cooling and Strong Coupling Regime

Progress of laser-cooling in optomechanical systems.
Starting in 2006, the primary goal in optomechanics, for several years, was to laser-cool the motion of the mechanical resonator. This is necessary to reach the quantum regime, since none of the mechanical resonators being used is already near the ground state at the typical bulk temperatures. In 2007, we published the complete theory of optomechanical laser-cooling, establishing the quantum limits to the phonon occupancy (arXiv Jan 07, PRL 07). This served as a theoretical foundation for all the subsequent experiments that tried to cool down to the quantum ground state of motion. This goal was finally achieved in 2011, using both optical radiation and microwaves.

In the same work, we also predicted what is now known as the strong coupling regime of optomechanics, where the photon and the phonon mode hybridize strongly, to form new excitations. This is possible if the effective (laser-enhanced) coupling rate between light and vibrations surpasses the photon decay rate. The effect is visible in the mechanical (and in the optical) spectrum, where some normal-mode splitting develops. Nowadays, this regime has been reached experimentally and is being exploited for state transfer between optical and mechanical excitations.

Optomechanical Arrays

Possible design of an optomechanical array, based on optical and mechanical modes implemented in a photonic crystal.
One of the most exciting aspects of physics is the emergence of novel complex behaviour when one combines many equivalent simple building blocks in a simple way, for example by stacking atoms to form a crystal lattice. From the theoretical perspective, this leads us into the domain of (classical or quantum) field theories, and to concepts such as phase transitions, universality, and nonequilibrium pattern formation. For this reason, engineering of periodical arrays of simple constituents is now a major goal in a number of research fields. For example, optical lattices allow to control the transport of cold atoms, arrays of superconducting cavities promise to do the same for microwave photons on a chip, and on the more microscopic scale, engineered metamaterials serve to produce novel optical properties.

In 2009, we began investigating the dynamics of periodic arrangements of optical and vibrational modes, which we termed "optomechanical arrays". This line of research was inspired by the newly available platform of photonic crystals (optomechanical crystals), though the concept could also be implemented in many other possible platforms, such as arrays of coupled disk resonators or arrays of microwave optomechanical systems. Our first work in this direction (arXiv Jul 10, PRL 11) introduced for the first time the concept of optomechanical arrays of this kind. Moreover, we predicted their nonlinear behaviour, especially the synchronization between optomechanical oscillators. Several years later, optomechanical arrays are now being implemented. For example, we are working with the group of Oskar Painter at Caltech, who pioneered photonic crystals in optomechanics (optomechanical crystals), to realize optomechanical arrays in this platform.

By now, optomechanical synchronization has been experimentally observed by the Tang group in Yale and by the Lipson group (Cornell/Columbia), in both cases for the simplest possible system (two coupled oscillators). The Lipson group also extended this (in 2015) to a small array of seven disk oscillators. Mathematical work by the Milburn group has extended our theoretical analysis to optical coupling between the oscillators. In general, such synchronization of oscillators could become important for metrological purposes, to suppress the effects of noise on the phase stability of the oscillations. In addition, it is very interesting from a theoretical point of view. Ultimately, such systems are described by stochastic nonlinear classical field theories on a lattice, which are of considerable interest in many areas of physics. In more recent work, we described the intricate spiral patterns that could form in the phase field that describes the oscillation phases in any 2D array of coupled limit-cycle oscillators (PRE 15).


Synchronization of two optomechanical oscillators of unequal frequencies upon increasing the coupling strength.
Going from classical nonlinear dynamics to quantum nonlinear dynamics, one can study aspects of quantum many-body physics of photons and phonons. Interestingly, the full interacting Hamiltonian of an optomechanical array in the quantum regime is formally equivalent to the Holstein-Hubbard Hamiltonian in solid-state physics, except that electrons have been replaced by photons. This replacement, of course, gives rise to significant physical differences, since we are now dealing with bosons, their number is no longer conserved, and we have to face a nonequilibrium situation by necessity (the system has to be driven by a laser). The resulting model does not only show a kind of superfluid-Mott-insulator transition for the photons, but also a quantum synchronization transition. Here, synchronization of the mechanical oscillators can be disrupted by the unavoidable nonequilibrium quantum noise in the system (PRL 13). The precise nature of this phase transition is not yet completely understood, but quantum synchronization is by now becoming an active area of research.

Even in the linear regime, optomechanical arrays turn out to be surprisingly interesting. This is because the resulting bandstructure of photons and phonons can be tuned optically. Upon application of a strong pump laser field, the original nonlinear optomechanical interaction turns into a quadratic coupling whose strength and phase can be set by the laser. In this way, optomechanical arrays can (in some ways) become for photons and phonons what optical lattices are for cold atoms: a tuneable medium in which the transport can be controlled by an external laser field.

To name one example, we have shown how an optomechanical array with a honeycomb lattice could produce several of the surprising effects that have been observed for electrons in graphene, such as ultrarelativistic dynamics near the Dirac point and Klein tunneling (NJP 15). The setting would be significantly different from graphene electronics, in that we are dealing with two physically different species of (bosonic) particles, photons and phonons, which can hybridize and from new photon-phonon polaritons, with optically tuneable properties.

On the theoretical level, in our quest to understand the dynamics of optomechanical arrays we are employing direct numerical simulations of the classical nonlinear stochastic dynamics, quantum mean-field approaches (like dynamical Gutzwiller), truncated Wigner approximation methods, perturbation theory and other quantum many-body techniques. At the same time, we also care about the direct implementation in experiments, and we employ finite-element simulations to design suitable photonic crystal structures with the desired electromagnetic and acoustic properties.

Topological Transport of Light and Sound

Topologically protected transport of sound waves on the nanoscale can be engineered in an optomechanical array. The crucial ingredients are a suitable geometry of the array and illumination by a laser beam with the right phase pattern.
Optomechanical arrays offer a very flexible way to control the transport of photons and phonons, most of all because their behaviour is not fixed by the geometry but can be tuned by a laser. In a series of works, we have shown how to exploit this flexibility to produce topologically protected transport of photons and phonons on a lattice.

One of the beautiful aspects of physics is the universality of certain concepts. For example, waves are ubiquitous in nature and can arise in many different forms. Even though the details of the corresponding wave equations may differ, many features carry over from one example to the next. Linear waves in periodic media will always display a bandstructure. Most aspects of bandstructures have been understood since the early days of quantum mechanics. Therefore, it is quite surprising that the concept of topological properties in bandstructures is relatively recent. It was first discovered in the context of the quantum Hall effect and then more recently became a central piece of modern physics, when a class of new materials was found which realize a slightly different version of the same concept. These are the so-called topological insulators. Physically, in all of these cases the most important aspect is that there are 'chiral' edge channels near the boundary of any sample made of this material. The particles (matter waves) flow along such edge channels only in one way and are robust against disorder scattering, because there is no counterpropagating edge channel. It is obvious that such a behaviour can become very helpful for many possible applications.

The optomechanical interaction between photons and phonons can often be 'linearized' to a very good approximation. Then it looks like a coherent conversion between photons and phonons, with a conversion amplitude that can be tuned by the strong driving laser. For our story here, it is crucial that this conversion amplitude (coupling) can also have a phase. Physically, this phase is set by the optical phase of the driving laser. That can now be exploited to produce "non-reciprocal" behaviour: A phonon or photon hopping around a circle (in a set of coupled mechanical or optical modes) can pick up an overall phase that depends on the direction of motion (clockwise vs. counter-clockwise). This phase can be identified formally with the Aharonov-Bohm phase that a charged particle would pick up when moving around a closed loop in a magnetic field. That reasoning can also be turned around. If there is such a phase, then the particle effectively feels a magnetic field, even when it is not charged. Any physical effect we usually associate with the motion of a charged particle in a magnetic field will then be present. For example, the trajectory of the particle (or the motion of a wave packet) will be curved by a Lorentz force.

During the past several years, various ideas have been put forward to produce artificial magnetic fields for photons. These ideas include particular fixed geometrical arrangements of ring resonators, magneto-optic materials, and time-dependent modulation of the dielectric properties of a photonic crystal via nearby electrodes. We were able to show that the optomechanical interaction can be used to produce the same effects but with much more flexibility. The ingredients are just a suitable photonic crystal and two laser beams with the right spatial pattern of optical phases (Optica 15). The effective photon magnetic field can then be tuned arbitrarily by variation of the driving laser intensity and phase pattern. More recently, we showed that the effective magnetic field could even become a dynamical gauge field, being determined by the mechanical oscillation phases of mechanical resonators (arXiv 15).

After the power of the concept of topological transport had been fully appreciated for electrons, researchers moved to explore its features for other systems like cold atoms, photons, or magnons. Phonons, however, were for a long time absent from this list. It is, indeed, not trivial to engineer the suitable non-reciprocal phases for phonon transport. In 2014, we were the first to come up with a proposal for engineering phonon topological transport (arXiv Sep 14, PRX 15). A short while later, other proposals were put forward and at the same time macroscopic setups using cleverly coupled pendula were produced as proof-of-principle experiments. Nevertheless, our optomechanical approach to this challenge remains the most flexible one. The optical laser phase pattern illuminating the sample determines the topological phase, and spatial variations in this pattern could be used to produce several adjacent topologically different regions (with chiral edge states in-between). Moreover, even quench physics could easily be explored in such a system, by changing the driving laser. Once realized, such optomechanical phonon Chern insulators could be exploited for studying heat transport on the nanoscale in new ways, with unidirectional edge channels connecting different heat reservoirs.

Measurement and Quantum Noise
One of the primary possible applications of optomechanical systems consists in ultrasensitive measurements, of small displacements, forces, masses, and accelerations.

It is straightforward to measure the mechanical displacement in an optomechanical system. After all, the optical cavity represents an interferometer. However, the so-called standard quantum limit for displacement detection prescribes that there is a lower limit to the unavoidable noise in such a setting. Ultimately, this arises due to Heisenberg's uncertainty relation, because a weak continuous position measurement essentially attempts to measure the full trajectory of a quantum particle, which is of course not possible with arbitrary precision (see e.g. our review RevModPhys 10). This challenge can be circumvented, however, if one deliberately measures only a particular "quadrature" of the mechanical oscillation. We analyzed such a scheme in detail (NJP 08), and by now this has been shown in experiments (e.g. by the Schwab group).

Apart from the mechanical displacement, it would be even more interesting to be able to measure the quantized phonon number of a mechanical resonator. In 2008, in a joint work with the Harris group (Nature 08) we pointed out how that would become possible in a novel optomechanical system where the optical frequency couples to the square of the position (instead of just linearly). That would enable a quantum non-demolition measurement of phonon number, which would eventually allow to observe quantum jumps between discrete mechanical Fock states. It has to be pointed out, though, that this goal still remains very challenging, even with the present-day strongly improved systems. The reason is that it effectively requires the single-photon strong coupling regime, where the bare coupling is larger than the photon decay rate.

The Deep Quantum Regime: Strong Single-Photon Coupling

Partially negative Wigner density of a nonclassical mechanical quantum state, produced in an optomechanical oscillator.
The optomechanical interaction between photons and phonons is fundamentally nonlinear, since the force acting on the mechanical resonator is proportional to the intensity of the light field (and not its amplitude). Nevertheless, the coupling constant is usually so small that one has to compensate for this by boosting the effects through a large laser drive. In that case, the interaction becomes linear and the more subtle effects are lost. Recent years have seen strong experimental efforts to increase the bare optomechanical coupling, such that it would become strong even at the level of single photons and single phonons. In our theory work, we have been investigating which effects would become possible if the coupling rate were to reach or exceed other important scales in the problem (such as the photon decay rate or the mechanical frequency).

One of the natural questions to ask in this context is how the classical nonlinear dynamics smoothly transitions into the quantum regime (the classical-quantum transition) when the coupling is so large that nonlinear effects can be seen even for small numbers of photons and phonons. We predicted that one will be able to see non-Gaussian (NJP 08 ) and even non-classical (PRL 12) quantum states of mechanical motion in this "single photon strong coupling" regime (as it came to be known).

Another, very relevant, question is how to increase the effective optomechanical coupling such that true quantum many-body effects could be seen in the experiments. We found out that one can engineer a system with two suitable optical modes so as to boost the quantum nonlinear effects (PRL 12). This would allow effective photon-photon interactions, as well as QND measurements of photon and phonon number. One can also turn the question around and ask how the first subtle effects of quantum nonlinearities would manifest themselves even if the coupling is not yet very strong. We predicted that in a two-tone spectroscopy experiment, the sharp spectral dips that are associated with "optomechanically induced transparency" could provide such a first tell-tale sign of nonlinearities on the quantum level (PRL 13). All of these effects still remain to be seen in experiments. A number of experimental groups are working hard to improve the designs of their physical setups to approach the strong single-photon coupling regime.

Other research topics
Decoherence
The wave-particle duality is at the heart of quantum physics. Matter waves show interference patterns. However, local interactions destroy interference effects, giving rise to classical-like particle dynamics. This is known as decoherence and it has important implications both for the foundations of quantum mechanics and for possible applications. We have studied decoherence especially in settings relevant to the quantum transport of electrons, where many-body effects and the Pauli principle change the usual story of a single particle coupled to some bath. To this end, we exploit techniques from many-body theory like path-integrals, diagrammatic perturbation theory and exactly solvable models such as Luttinger liquids. In addition, decoherence is of crucial importance for current challenges in quantum optics and optomechanics.

Quantum electrodynamics in superconducting circuits
Systems of superconducting qubits coupling to on-chip microwave resonators have seen enormous progress in the past 10 years, with coherence times increasing by at least four orders of magnitude. They are now seen as one of the main candidates for quantum computers and simulators. In the past years, we have e.g. proposed an on-chip detector of single microwave photons or the measurement-based generation of entanglement. At present, multi-qubit circuits are becoming possible. Here we have been the first to propose a design for a two-dimensional “cavity grid”, coupling many qubits and resonators. Recently, we started exploring how multi-qubit systems could be exploited for quantum simulations of interesting many-body models, e.g. with regard to possible phase transitions of matter-radiation systems, or for implementing interacting quantum field theories.

Many-body dynamics in non-equilibrium
Systems of ultracold atoms have become a unique tool to study many-body physics, since they are well isolated and parameters can be tuned quickly on the time-scales of motion. Recently, we have started studying the possibilities afforded by the novel site-resolved detection of individual atoms. In this context, we have predicted a many-body Zeno effect occuring for interacting atoms in an optical lattice being observed repeatedly and a protocol for measuring spatial current patterns and correlations. In another development, we have proposed how to use tunnel-coupled clouds of cold atoms to generate a quantum simulator for testing structure formation in interacting quantum field theories, including the effects of cosmological expansion, which is relevant for the early universe.

This site allows you to watch the videos and download the lecture note pdfs for the course “Machine Learning for Physicists”. That course was taught in the summer term 2017 by Florian Marquardt.

Please see the original course website for instructions of how to install python, theano, and keras, and for example python files! (Note: In the lectures, we only use keras functionality, so you can also install tensorflow instead of theano as the underlying framework – this is probably better, since theano will no longer be updated)

Watch the videos on Apple iTunes or on the Lecture Videos Site of the University Erlangen-Nuremberg, or jump to the direct links below!

These are lectures about neural networks, for physicists. These lectures were delivered in the summer term 2017 by Florian Marquardt at the university of Erlangen-Nuremberg, Germany. Download the PDF here (split into three parts). See the other posts for further information and for the video recordings!

Here is an example from our own group which combines many of the advanced techniques that are explained in the lectures (in particular, reinforcement learning and recurrent networks). Our setting is simple: you are given a set of a few qubits, with one of them initialized in an arbitrary (unknown) initial quantum state. There is decoherence due to the unavoidable noise of the environment. How do you best preserve the quantum state? Using reinforcement learning, the neural network discovers from scratch quantum error correction strategies. These involve gates (e.g. CNOT) that manipulate and entangle the qubits. The strategies also involve measurements, and the subsequent actions will depend on the measurement outcomes. This challenge demonstrates very nicely the power of reinforcement learning: the same program can be applied to many different physical scenarios

This is us. After each name, we indicate the room (02. indicates 2nd floor; at Staudtstr. 7, Erlangen, building B3), and the telephone extension. Dial 09131-85-extension from within Germany or +49-9131-85-extension from abroad. The email adress is always FirstName.LastName@physik.uni-erlangen.de.

Have you ever wondered about the mysterious "collapse of the wave function" or the "wave-particle duality"? Does Schrödinger's cat make you uneasy? Do you have a feeling that there could be a deeper, more 'microscopic' theory underlying Quantum Mechanics? Do you believe that trajectories are ruled out by Quantum Mechanics? Do you want to learn how the early "Gedankenexperiments" are now routinely realized in the labs?
This lecture series addresses questions related to the foundations of Quantum Mechanics. Topics will include: Bell's inequalities and Entanglement, Measurements, Decoherence and the quantum-to-classical crossover, Interpretations of Quantum Mechanics (including Bohm's pilot wave and Nelson's Stochastic Quantization), Extensions of Quantum Mechanics (for example "spontaneous localization"), Geometric phases (Aharonov-Bohm effect and all that), and other topics.
The lectures require knowledge as obtained in a standard first course on Quantum Mechanics (more background will be beneficial but not absolutely needed). Master-level students and PhD students (as well as postdocs) will probably get the most out of this course.

This course will offer an introduction to the interaction of light with nanomechanical and micro-mechanical motion. In the past few years it has turned out that this interaction is ubiquitous in many physical systems, since it only requires some optical cavity whose resonance frequency is modified by mechanical vibrations (e.g. distortion of the cavity’s boundaries). The resulting physics can be used to laser-cool and manipulate the quantum-mechanical vibrations, to perform sensitive detection of displacements, forces, and accelerations, to implement efficient wavelength-conversion from the microwave to the optical domain, to study foundational issues in quantum mechanics, and to address a large variety of further questions at the intersection of nanophysics and quantum optics. After going through the basics, we will have a chance to explore some selected open questions in current research. A first course in quantum mechanics is needed as a prerequisite.

Lecture series by Florian Marquardt, summer term 2013

Have you ever wondered about the mysterious "collapse of the wave function" or the "wave-particle duality"? Does Schrödinger's cat make you uneasy? Do you have a feeling that there could be a deeper, more 'microscopic' theory underlying Quantum Mechanics? Do you believe that trajectories are ruled out by Quantum Mechanics? Are you confused by the concept of spin or by fermions vs. bosons? Do you want to learn how the founding fathers' "Gedankenexperiments" are now routinely realized in the labs?

This lecture series addresses questions related to the foundations of Quantum Mechanics. Find more about the topics, the schedule, and links to the original literature on the lecture website:

Note: Most of these papers are in German. English translations may be found in the book 'B. L. van der Waerden, editor, Sources of Quantum Mechanics (Dover Publications, 1968) ISBN 0-486-61881-1'.

On the Theory of Quanta, PhD thesis of Louis-Victor de Broglie (1924), English translation by A. Kracklauer: Download e-book
Heisenberg's original matrix mechanics - This is the work that created the modern theory of quantum mechanics (Heisenberg 1925). Heisenberg wanted to tackle the question of how to predict correctly the intensities of atomic transition lines, as Bohr had already clarified how to obtain the transition frequencies. Heisenberg began by noticing that, according to Bohr, the correct quantum transition frequencies do not depend just on the current state of motion (as do the frequencies of emitted radiation for a classical orbit), but rather on two states (initial and final). Likewise, in classical theory, the intensities of emitted radiation would be given by the squares of the Fourier amplitudes of the oscillating dipole moment for a given orbit. In an ingenious step, Heisenberg then postulated that instead of a set of Fourier amplitudes for a given orbit (enumerated by one index), one would have to introduce a set of amplitudes depending on two indices, one for the initial, the other for the final state. He assumed that the equations of motion for those amplitudes looked formally the same as in classical theory (Heisenberg equations of motion). The last crucial ingredient is the commutation relation. This he derived by looking at the linear response of an electron to an external perturbation (essentially deriving something like Kubo's formula, containing the commutator) and then demanding that the short-time response would be always that of a free, classical electron. This fixes the commutator between position and momentum. Thus was born matrix mechanics. He applied this immediately to the harmonic oscillator and also dealt with the anharmonic oscillator using perturbation theory. See also Heisenberg's Nobel Lecture from 1933 to learn more about his view on these developments, and the slightly earlier overview (Heisenberg 1928 (Naturwissenschaften)) that also includes much of the developments before matrix mechanics.
The formalism of matrix mechanics - The formalism of matrix mechanics was then developed fully by Born, Jordan and Heisenberg (Born, Jordan and Heisenberg 1926). They discuss: canonical transformations, perturbation theory, angular momentum, eigenvalues and eigenvectors. In addition to the formalism, that work also contains the earliest discussion of a quantum field theory: A linear chain of masses coupled by springs is quantized and solved by going over to normal modes. As a result, they find the Planck spectrum of thermal equilibrium, as a direct consequence of the newly developed quantum mechanics!
The hydrogen atom in matrix mechanics - Wolfgang Pauli (Pauli 1926) managed to apply the new matrix mechanics to the hydrogen atom. He found the correct energy spectrum, as well as the correct Stark effect corrections to the energy in an applied electric field. In this solution, he makes use of the Runge-Lenz vector which is an additional conserved quantity known from classical mechanics for the Kepler problem, denoting the orientation of the elliptical orbit in space.
The Schroedinger equation - Shortly after Heisenberg's work, Schroedinger came up with the equation that now carries his name. The essential idea was to start from the Hamilton-Jacobi equation, claim the action is the logarithm of some wave function psi (think WKB!), and derive a quadratic form of psi that is to be extremized (Schroedinger equation from the variatonal principle). This leads to the stationary Schroedinger equation, which he then solves for the hydrogen atom, as well as for the harmonic oscillator, the rotor and the nuclear motion of the di-atomic molecule (Schroedinger 1926a and Schroedinger 1926b).
The probabilistic interpretation - While for a single electron inside an atom it might still be conceivable to view the wavefunction as some sort of smeared-out charge density, this view clearly becomes untenable when one moves to scattering processes, where the final scattered wave spreads out over a large region of space, whereas physically the particle will be detected at a point-like location. Thus it happened that during the investigation of quantum-mechanical scattering processes Max Born (Born 1926) was lead to the conclusion that the wave function has something to do with the probability of detecting a particle at some location. He at first incorrectly guessed the wave function itself gives the probability, but then inserted a famous footnote (on page 3 of this work) that says one should take the square! See also Max Born's Nobel lecture from 1954 for a discussion of the development of quantum mechanics.
The uncertainty relation - Heisenberg showed that the precision with which position and momentum can be measured cannot be arbitrarily high for both these quantities simultaneously (Heisenberg 1927). This work contains also the discussion of the famous "Heisenberg microscope" gedankenexperiment, where one tries to determine the position of an electron only to find that by doing so one destroys any interference pattern that might have existed without this act of observation.
Spin - The electron spin was introduced by Wolfgang Pauli (Pauli 1927) as an additional discrete degree of freedom that could take two values. (Note: The Pauli spin matrices make their first appearance on page 8 of this work)

Upcoming Workshop “Machine Learning for Quantum Technology” (May 8-10, 2019)

This workshop brings together the international community trying to apply advanced methods of machine learning to quantum devices. The workshop takes place May 8-10 at the MPL in Erlangen, Germany. Read more about the workshop.

Published: Our paper on machine learning applied to quantum error correction

Our paper on neural networks discovering quantum error correction strategies has just been published. It has appeared in Physical Review X. There was a press release by the Max Planck Society: “Artificial Intelligence controls Quantum Computers“.

Workshop: Current trends in open and nonequilibrium quantum optical systems [July 2018]

From July 16th to 18th we hosted a workshop on the broad topic of open and nonequilibrium quantum optical systems. We invited some of the leading scientists in the field, who contributed to a diverse event covering from the most abstract to the most applied aspects. Thank you to all whose contributions made it a varied and dynamical workshop!
Find all the details in the official page.

Jobs available: Machine Learning for Physics [March 2018]

We are offering postdoc and PhD positions to enlarge our new team that develops cutting-edge neural-network-based techniques for scientific discovery. Please see the job description!

Discovering Quantum Error Correction from scratch! [February 2018]

Figure_News_ReinforcementLearning

We have applied for the first time neural-network-based reinforcement learning to quantum physics. Specifically, we have shown how that advanced technique from computer science can help to automatically discover complex quantum feedback strategies from scratch. In our specific example, we applied it to the domain of quantum error correction: how to preserve the quantum information stored in a small ensemble of qubit against noise, by applying suitable gate sequences and measurements. Read more about that in our preprint arxiv.org/abs/1802.05267.

New Max Planck Research Group [January 2018]

Silvia_V-K_As of January 2018, Silvia Viola Kusminskiy has taken up her position as the head of a new Max Planck Research Group (MPRG). Her group “Theory of hybrid systems for quantum technologies” will explore the interaction between light and condensed matter systems at the micro/nanoscale. Her current interest lies in optomagnonics, where light couples coherently to magnetic excitations in solid state systems.

Machine Learning for Physicists [January 2018]

SmallSmileysWe just set up a new domain to collect all the videos and lecture slides for the course on machine learning that we taught in the summer term 2017. This was specifically about neural networks and reinforcement learning, and the goal was to be “hands-on”. See:

machine-learning-for-physicists.org

Christmas Lecture [December 2017]

On 14th December 2017, we presented you the annual Christmas lecture at the FAU Erlangen-Nuremberg. Thank you to the large audience for attending!

Chiral Photonics 2017 – Workshop [September 2017]

Chiral Photonics is an emergent topic in physics. We have brought together renowned experts from all over the world here at MPL, to discuss the present and the future of this new and exciting subject.
The workshop was animated by interesting and lively discussions among the participants. See the workshop website.

Light and Motion in a Helium Drop [August 2017]

DropForWebsiteShadow
What happens when you combine the physics of superfluid helium with optomechanics, in a levitated drop that has optical whispering gallery modes of outstanding quality? In our most recent work, we are analyzing all the basic aspects of such a system, to lay the groundwork for an upcoming experiment. A particular feature in this new optomechanics platform is the coupling between rotations, vibrations, and the light field. Read more in our recent manuscript or look at the slides of a talk given at the SPIE in San Diego.

OMT Summer School [July 2017]

We were pleased to welcome a group of keen young physicists to our OMT Summer School “Quantum Measurements and Theoretical Cavity Optomechanics” from 5th till 7th July here at the Max Planck Institute for the Science of Light. Please refer to our website for more information.

Cavity Optomagnonics Workshop [June 2017]

The first workshop worldwide on this new topic, coupling light to magnons, was a great success. We welcomed many important experts in the field to the new building of the MPL, and exchanged scientific viewpoints across different fields (like quantum optics, magnonics, spintronics, etc.). See the workshop website.

Snowflakes go chiral! [April 2017]

We have discovered a novel way to make sound waves go one way (and one way only). See our new paper on a topological insulator for sound waves at the nanoscale. You can also look at a brief summary of this (and other related papers of ours), in the slides from a talk at San Sebastian (July 2017).Snowflake

Move into the new building! [Sept 2016]

We moved into the new MPL building end of September 2016.

We are currently looking for both PhD students as well as postdoctoral researchers. Join our team at the MPL theory division and explore the world of photons and matter!

[March 2018] See also our special job ad for Machine Learning for Physics (Postdoc positions available)!

YOUR TASKS
If you are curious about new quantum technologies, come and join us in our explorations at the intersection of nanophysics and quantum optics.
Our main focus is currently in optomechanics. This new field studies the interaction of light and nanomechanical motion, down into the quantum regime. This opens the door towards quantum optomechanical circuits, many-body physics, potential applications in ultrasensitive measurements, quantum information, and fundamental tests of quantum mechanics. Further research topics include quantum electrodynamics and quantum computing in superconducting circuits, topological photonics and phononics, decoherence, and quantum transport.

YOUR PROFILE
Our work has both analytical and numerical components, and in most of the topics we have collaborations with experimentalists. Thus, computer skills and the desire to apply theory to realworld problems are strong advantages. We put particular emphasis on physical understanding.

OUR OFFER
We have ongoing collaborations with both experimental and theoretical groups all over the world, including at Yale, Caltech, McGill and other institutions. The payment and benefits are based on the German TVöD guidelines.
The Max Planck Society is committed to increasing the number of individuals with disabilities in its workforce and therefore encourages applications from such qualified individuals. Furthermore, the Max Planck Society seeks to increase the number of women in those areas where they are underrepresented and therefore explicitly encourages women to apply.

YOUR APPLICATION
Applications should be sent electronically to Prof. Florian Marquardt, but always cc to the team assistant, Mrs Gesine Murphy (marquardt-office@mpl.mpg.de).

The set of documents you should send with your application comprises the following:

PhD applicants: a CV and the names of two expert references.

PostDoc applications: a CV, a list of publications, and the names of two expert references.

We will start reviewing applications immediately but will continue to accept applications indefinitely.

This international workshop covers emerging applications of machine learning to quantum devices, including advanced methods like reinforcement learning.

May 8-10, 2019, at the Max Planck Institute for the Science of Light in Erlangen, Germany

Note: The workshop will be preceded by a two-day school for students trying to enter the field, going from a recap of the basics of neural networks to advanced techniques.

Scientific Organization: Florian Marquardt

Local Organization: Gesine Murphy

Confirmed Invited Speakers:

Hans Briegel, Innsbruck
Evert van Nieuwenburg, Caltech
Roger Melko, Waterloo
Alan Aspuru-Guzik, Toronto
Barry Sanders, Calgary
Jens Eisert, Berlin
Paul Baireuther, Leiden
Fabio Sciarrino, Rome
Renato Renner, ETH Zürich
Marin Bukov, UC Berkeley
Mauro Paternostro, Belfast
Natalia Ares, Oxford
Emmanuel Flurin, CEA Saclay
Enrico Prati, Consiglio Nazionale delle Ricerche
Raffaele Santagati, Bristol
Registration starts January 10, 2019. Registration deadline: March 31, 2019. There will be the possibility to submit short contributed talks and poster presentations.

The MPL Theory Division, led by Florian Marquardt, deals with both the quantum and classical dynamics of systems relevant for modern optics research, especially at the interface between nanophysics and quantum optics. Topics include the theory of optomechanics, neural networks and machine learning for physics, quantum optics in superconducting circuits, transport in photonic systems, fundamental questions of quantum many-body theory, nonequilibrium nonlinear dynamics, and decoherence. The group applies a variety of approaches, ranging from analytical studies to numerical simulations.

Research topics Marquardt group: at the interface of nanophysics and quantum optics
In our research, we apply tools from condensed matter theory and from quantum optics to a range of questions at the interface of nanophysics and quantum optics, addressing both quantum and classical dynamics. In our approach, we often try to identify the salient features of experimentally relevant situations and condense them into minimalist models which can then be attacked with all the state-of-the-art theoretical tools. At the same time, we also care about the direct contact with experiments, down to designing the classical electromagnetic and acoustic properties of specific structures. In the past few years, our main focus has been developing the theoretical underpinnings of a new research area, that of cavity optomechanics. Moreover, we develop new theoretical tools, like applications of neural networks (deep learning).


Cavity Optomechanics
This field deals with the fundamental interaction between light and mechanical vibrations. We have developed many of the theoretical underpinnings of this field and are now analyzing future optomechanical devices. Possible applications include novel tools for quantum communication, very sensitive detectors, and experiments on the foundations of quantum physics. 


Topological Transport of Phonons and Photons
Waves can display "topological" phenomena when they propagate in suitably designed media. The most prototypical effect is the creation of chiral edge states, first known from the quantum Hall effect for electrons in a magnetic field. This helps to make transport robust against disorder. We have pioneered the design of phonon topological transport (see our 2015 paper), exploiting the tools of optomechanics.


Machine Learning for Physics
Machine learning with artificial neural networks is revolutionizing many areas of science and engineering. Powerful "deep" networks are extremely successful in tasks such as image recognition. An increasing number of research groups around the world have now begun to explore the application of these ideas to physics. We have pioneered the application of neural-network based "reinforcement learning" to quantum physics, where a computer develops from scratch useful sequences of quantum operations. Read our paper on this topic. We are currently pushing forward into many different applications.


More: Circuit Quantum Electrodynamics, Qubits, Optomagnonics, Nonequilibrium Quantum Many-Body Dynamics, Nonlinear Classical Field Theories
Our group continues to contribute to a variety of topics: circuit quantum electrodynamics in superconducting chips, qubit dynamics and decoherence (including machine learning for quantum error correction), cavity optomagnonics (coupling magnons to the light field; in collaboration with the junior research group of Silvia Viola-Kusminskiy), synchronization in lattices of coupled oscillators and other effects in nonlinear field theories, nonequilibrium quantum many-body dynamics in cold atoms and other systems.

Cavity Optomechanics: Brief introduction

Radiation pressure – Four hundred years ago, the astronomer Johannes Kepler wrote a book about comets. He noted that the tail of a comet always points away from the sun. His explanation: The light emanating from the sun pushes away the tail. This is probably the first known speculation about the physical phenomenon of radiation pressure. It was only Maxwell, though, who came up with a quantitative prediction for the radiation pressure force, and it took until 1901 to be detected in the laboratory (by Nichols and Hull in Dartmouth and by Lebedev in Moscow). Since then, radiation forces have been observed and exploited in various settings, for example in controlling the motion of cold atoms or dielectric particles. However, usually the light only provides some fixed forces, while there is no backaction of the mechanical motion onto the light field. This changes when we turn to the field of optomechanics, where there is a true two-way interaction.

Perhaps the most impressive precision measurement of all time is the detection of gravitational waves using kilometer-length Michelson interferometers. Using the two LIGO detectors, gravitational waves from the inspiral of two black holes have been measured in September 2015. These instruments are so sensitive that they can measure displacements of the order of the size of a nucleus. Their noise approaches the ultimate limits set by quantum mechanics. These limits arise due to the unavoidable shot noise of the laser beam. When the light power is rather low, the measured phase shift is uncertain due to the limited number of photons. As the power increases, the relative fluctuations of photon number become smaller, and the measurement gets more precise. However, there is a limit to the precision. At some point, for higher laser powers, another effect kicks in, and this is directly related to radiation pressure. The unavoidable photon shot noise fluctuations of the laser beam exert a random force on the end mirrors of the interferometer, which imprint some extra jitter motion that masks the real signal. Due to this “backaction noise”, the precision decreases again. As a consequence, there is an intermediate power at which some optimum is reached, and that is known as the “standard quantum limit” of displacement detection. The importance of radiation pressure noise for the sensitivity of LIGO-type detectors was already discussed in the 70s, and in the 80s it led researchers to consider the use of “squeezed light” (which will become part of some future LIGO version).

LIGO is an example of a cavity-optomechanical system, albeit with rather unusual dimensions. About 10 years ago it was realized that many nano- and microscale systems can also exhibit optomechanical effects, and that these can be very strong. Since then, there has been a growing worlwide community of researchers that tries to harness the radiation pressure force (and similar radiation forces) for applications such as ultrasensitive detection, quantum communication, and studies in the foundations of quantum physics. Incidentally, modern research into cavity optomechanics at the micro- and nanoscale is also feeding back into improved ideas for gravitational wave detection.

Cavity optomechanics setup – The typical system in cavity optomechanics is some optical cavity whose geometry changes due to any kind of mechanical motion. This might be the motion of an end-mirror, the motion of some polarizable object inside the cavity, or the deformation of a dielectric boundary (in a whispering gallery mode optical resonator or photonic crystal). If this description sounds very generic, then that is because indeed practically any optical cavity system will display optomechanical effects. The only question is how large they are, which depends on the details of the geometry but also on the amplitude of the mechanical motion. Having a cavity strongly enhances the effects, as compared to a simple free-space system with light bouncing off a mirror in the absence of any cavity. First of all, the incoming laser intensity is resonantly enhanced. It is multiplied by the finesse of the cavity, which can be on the order of a million. This increases the radiation force by the same amount. At the same time, tiny changes in the boundary of the cavity will induce a shift of all its optical resonance frequencies. Suppose the laser had initially been in resonance with the cavity, filling it up with light. A small shift of the resonance now will lead to a rapid decrease of light intensity, which will also decrease the force. It is in this way that light does not only exert a force, but any resulting motion will act back on the light field and modify the force in turn. There is a true interaction between light and mechanical motion, and this is at the heart of optomechanics.

One of the remarkable facts about optomechanics is the huge variety of physical devices in which it can be observed. Masses range from picogram nanodevices to kilogram-scale macroscopic mirrors, length scales from micrometer to centimeter (and beyond, if we include the km-length LIGO cavities), and the mechanical frequencies span many orders of magnitude as well, from Hz to several GHz. Crucially, the frequency of the radiation does not need to be resonant with the mechanical frequencies. This adds a lot of flexibility, allowing to employ optical radiation as well as microwave radiation. It also enables one of the potential significant applications of optomechanics in the domain of quantum information processing, namely coherent conversion of quantum signals from microwave to optical frequencies.


Optomechanical Setups (schematic), from top left: Fabry-Perot cavity with a moveable end-mirror, microtoroid, membrane or nanotube inside a cavity, photonic crystal, atoms trapped inside a cavity, vibrating capacitor plates in a microwave LC circuit
A brief history of optomechanics – The present research field of cavity optomechanics in micro- and nanoscale systems really started to take off only in around 2006. Nevertheless, over the preceding decades there had been a number of pioneering contributions. At the end of the 60s and during the 70s, Vladimir Braginsky was studying the measurement of small signals, with part of the motivation being gravitational wave detection. He built the first microwave cavity optomechanical system and showed that the microwave radiation can lead to some extra damping (or antidamping) of the mechanical motion of an end-mirror. In the 80s, the Walther lab at MPQ in Munich were the first to observe radiation pressure effects due to optical radiation, in a setup with a macroscopic mirror whose position showed bistability under the influence of the light. During the 90s, optomechanical experiments were primarily carried forward by the group around Antoine Heidmann at LKB in Paris, and there were some first speculations about quantum effects in such systems (groups of Knight and Tombesi). From about 2004 onward, a variety of different micro- and nanoscale systems were observed to show optomechanical effects, and the number of research groups has been growing quickly ever since that time.

Reviews – A more detailed discussion can be found in either one of our two reviews. A rather early, didactical brief overview in Marquardt and Girvin, “Optomechanics” (Physics ’09); and a comprehensive review in Aspelmeyer, Kippenberg, and Marquardt, “Cavity Optomechanics” (Rev Mod Phys ’14)

 

The following sections contain a review of our contributions to the field, organized by topic.

Our Work
The past years have seen an explosion of interest in the interaction of light with nanomechanical motion. Typical systems contain a laser-driven optical cavity, being coupled via radiation forces to mechanical motion. The goals of this field range from foundational questions to applications in quantum information processing and in the ultrasensitive detection of mass, force, position and acceleration. Our significant early contributions to the initial developments of this field consisted in predicting the nonlinear dynamics, pointing out the requirements for ground-state laser cooling, and predicting the so-called strong coupling regime, where photons and phonons hybridize to form new excitations.

More recently, we have gone beyond the canonical optomechanical system and studied systems where many optical and mechanical modes couple to each other, forming optomechanical arrays and circuits. There, we are studying the many-body dynamics of photons and phonons interacting with each other, possibilities for mechanical quantum state processing, classical synchronization physics, and questions related to enhancing the coupling strengths.

Classical Nonlinear Dynamics

The generic attractor diagram for the nonlinear dynamics of an optomechanical system. Attractors (stable amplitudes) are shown in black.
The interaction of radiation with the mechanical motion of some object can give rise to intricate nonlinear dynamics. This holds for any standard optomechanical setup, where both the intensity of the radiation and its sensitivity to the mechanical motion are amplified by exploiting an optical cavity. Beyond a certain threshold in input laser power, the mechanical resonator may suddenly start to oscillate by itself, extracting the required energy from the radiation field. This is similar to lasing action, but here the result is a self-amplified mechanical oscillation, pumped by the optical field. The existence of a linear instability threshold itself was known already (particularly as a potential nuisance in interferometric gravitational wave detection), when we started our analysis. This led to our finding a rather surprising attractor diagram, with many possible nonlinear attractors for the long-time dynamics of the system (arXiv Feb 05, PRL 06). Nowadays, it is acknowledged that this describes the generic nonlinear behaviour of optomechanical systems. The attractor diagram has been observed in experiments by now. As pointed out in our 2006 PRL, the nonlinear attractor diagram might also be exploited in ultrasensitive ‘latching’ measurements, a proposal yet to be implemented.

We later extended this analysis in several ways. We showed how the system behaves in the deep quantum regime, and we also showed that when several such limit cycle oscillators are coupled, this may give rise to optomechanical synchronization.

Laser Cooling and Strong Coupling Regime

Progress of laser-cooling in optomechanical systems
Starting in 2006, the primary goal in optomechanics, for several years, was to laser-cool the motion of the mechanical resonator. This is necessary to reach the quantum regime, since none of the mechanical resonators being used is already near the ground state at the typical bulk temperatures. In 2007, we published the complete theory of optomechanical laser-cooling, establishing the quantum limits to the phonon occupancy (arXiv Jan 07, PRL 07). This served as a theoretical foundation for all the subsequent experiments that tried to cool down to the quantum ground state of motion. This goal was finally achieved in 2011, using both optical radiation and microwaves.

In the same work, we also predicted what is now known as the strong coupling regime of optomechanics, where the photon and the phonon mode hybridize strongly, to form new excitations. This is possible if the effective (laser-enhanced) coupling rate between light and vibrations surpasses the photon decay rate. The effect is visible in the mechanical (and in the optical) spectrum, where some normal-mode splitting develops. Nowadays, this regime has been reached experimentally and is being exploited for state transfer between optical and mechanical excitations.


Possible design of an optomechanical array, based on optical and mechanical modes implemented in a photonic crystal
One of the most exciting aspects of physics is the emergence of novel complex behaviour when one combines many equivalent simple building blocks in a simple way, for example by stacking atoms to form a crystal lattice. From the theoretical perspective, this leads us into the domain of (classical or quantum) field theories, and to concepts such as phase transitions, universality, and nonequilibrium pattern formation. For this reason, engineering of periodical arrays of simple constituents is now a major goal in a number of research fields. For example, optical lattices allow to control the transport of cold atoms, arrays of superconducting cavities promise to do the same for microwave photons on a chip, and on the more microscopic scale, engineered metamaterials serve to produce novel optical properties.

In 2009, we began investigating the dynamics of periodic arrangements of optical and vibrational modes, which we termed “optomechanical arrays”. This line of research was inspired by the newly available platform of photonic crystals (optomechanical crystals), though the concept could also be implemented in many other possible platforms, such as arrays of coupled disk resonators or arrays of microwave optomechanical systems. Our first work in this direction (arXiv Jul 10, PRL 11) introduced for the first time the concept of optomechanical arrays of this kind. Moreover, we predicted their nonlinear behaviour, especially the synchronization between optomechanical oscillators. Several years later, optomechanical arrays are now being implemented. For example, we are working with the group of Oskar Painter at Caltech, who pioneered photonic crystals in optomechanics (optomechanical crystals), to realize optomechanical arrays in this platform.

By now, optomechanical synchronization has been experimentally observed by the Tang group in Yale and by the Lipson group (Cornell/Columbia), in both cases for the simplest possible system (two coupled oscillators). The Lipson group also extended this (in 2015) to a small array of seven disk oscillators. Mathematical work by the Milburn group has extended our theoretical analysis to optical coupling between the oscillators. In general, such synchronization of oscillators could become important for metrological purposes, to suppress the effects of noise on the phase stability of the oscillations. In addition, it is very interesting from a theoretical point of view. Ultimately, such systems are described by stochastic nonlinear classical field theories on a lattice, which are of considerable interest in many areas of physics. In more recent work, we described the intricate spiral patterns that could form in the phase field that describes the oscillation phases in any 2D array of coupled limit-cycle oscillators (PRE 15).


Synchronization of two optomechanical oscillators of unequal frequencies upon increasing the coupling strength
Going from classical nonlinear dynamics to quantum nonlinear dynamics, one can study aspects of quantum many-body physics of photons and phonons. Interestingly, the full interacting Hamiltonian of an optomechanical array in the quantum regime is formally equivalent to the Holstein-Hubbard Hamiltonian in solid-state physics, except that electrons have been replaced by photons. This replacement, of course, gives rise to significant physical differences, since we are now dealing with bosons, their number is no longer conserved, and we have to face a nonequilibrium situation by necessity (the system has to be driven by a laser). The resulting model does not only show a kind of superfluid-Mott-insulator transition for the photons, but also a quantum synchronization transition. Here, synchronization of the mechanical oscillators can be disrupted by the unavoidable nonequilibrium quantum noise in the system (PRL 13). The precise nature of this phase transition is not yet completely understood, but quantum synchronization is by now becoming an active area of research.

Even in the linear regime, optomechanical arrays turn out to be surprisingly interesting. This is because the resulting bandstructure of photons and phonons can be tuned optically. Upon application of a strong pump laser field, the original nonlinear optomechanical interaction turns into a quadratic coupling whose strength and phase can be set by the laser. In this way, optomechanical arrays can (in some ways) become for photons and phonons what optical lattices are for cold atoms: a tuneable medium in which the transport can be controlled by an external laser field.

To name one example, we have shown how an optomechanical array with a honeycomb lattice could produce several of the surprising effects that have been observed for electrons in graphene, such as ultrarelativistic dynamics near the Dirac point and Klein tunneling (NJP 15). The setting would be significantly different from graphene electronics, in that we are dealing with two physically different species of (bosonic) particles, photons and phonons, which can hybridize and from new photon-phonon polaritons, with optically tuneable properties.

On the theoretical level, in our quest to understand the dynamics of optomechanical arrays we are employing direct numerical simulations of the classical nonlinear stochastic dynamics, quantum mean-field approaches (like dynamical Gutzwiller), truncated Wigner approximation methods, perturbation theory and other quantum many-body techniques. At the same time, we also care about the direct implementation in experiments, and we employ finite-element simulations to design suitable photonic crystal structures with the desired electromagnetic and acoustic properties.

Topological Transport of Light and Sound

Topologically protected transport of sound waves on the nanoscale can be engineered in an optomechanical array. The crucial ingredients are a suitable geometry of the array and illumination by a laser beam with the right phase pattern
Optomechanical arrays offer a very flexible way to control the transport of photons and phonons, most of all because their behaviour is not fixed by the geometry but can be tuned by a laser. In a series of works, we have shown how to exploit this flexibility to produce topologically protected transport of photons and phonons on a lattice.

One of the beautiful aspects of physics is the universality of certain concepts. For example, waves are ubiquitous in nature and can arise in many different forms. Even though the details of the corresponding wave equations may differ, many features carry over from one example to the next. Linear waves in periodic media will always display a bandstructure. Most aspects of bandstructures have been understood since the early days of quantum mechanics. Therefore, it is quite surprising that the concept of topological properties in bandstructures is relatively recent. It was first discovered in the context of the quantum Hall effect and then more recently became a central piece of modern physics, when a class of new materials was found which realize a slightly different version of the same concept. These are the so-called topological insulators. Physically, in all of these cases the most important aspect is that there are ‘chiral’ edge channels near the boundary of any sample made of this material. The particles (matter waves) flow along such edge channels only in one way and are robust against disorder scattering, because there is no counterpropagating edge channel. It is obvious that such a behaviour can become very helpful for many possible applications.

The optomechanical interaction between photons and phonons can often be ‘linearized’ to a very good approximation. Then it looks like a coherent conversion between photons and phonons, with a conversion amplitude that can be tuned by the strong driving laser. For our story here, it is crucial that this conversion amplitude (coupling) can also have a phase. Physically, this phase is set by the optical phase of the driving laser. That can now be exploited to produce “non-reciprocal” behaviour: A phonon or photon hopping around a circle (in a set of coupled mechanical or optical modes) can pick up an overall phase that depends on the direction of motion (clockwise vs. counter-clockwise). This phase can be identified formally with the Aharonov-Bohm phase that a charged particle would pick up when moving around a closed loop in a magnetic field. That reasoning can also be turned around. If there is such a phase, then the particle effectively feels a magnetic field, even when it is not charged. Any physical effect we usually associate with the motion of a charged particle in a magnetic field will then be present. For example, the trajectory of the particle (or the motion of a wave packet) will be curved by a Lorentz force.

During the past several years, various ideas have been put forward to produce artificial magnetic fields for photons. These ideas include particular fixed geometrical arrangements of ring resonators, magneto-optic materials, and time-dependent modulation of the dielectric properties of a photonic crystal via nearby electrodes. We were able to show that the optomechanical interaction can be used to produce the same effects but with much more flexibility. The ingredients are just a suitable photonic crystal and two laser beams with the right spatial pattern of optical phases (Optica 15). The effective photon magnetic field can then be tuned arbitrarily by variation of the driving laser intensity and phase pattern. More recently, we showed that the effective magnetic field could even become a dynamical gauge field, being determined by the mechanical oscillation phases of mechanical resonators (arXiv 15).

After the power of the concept of topological transport had been fully appreciated for electrons, researchers moved to explore its features for other systems like cold atoms, photons, or magnons. Phonons, however, were for a long time absent from this list. It is, indeed, not trivial to engineer the suitable non-reciprocal phases for phonon transport. In 2014, we were the first to come up with a proposal for engineering phonon topological transport (arXiv Sep 14, PRX 15). A short while later, other proposals were put forward and at the same time macroscopic setups using cleverly coupled pendula were produced as proof-of-principle experiments. Nevertheless, our optomechanical approach to this challenge remains the most flexible one. The optical laser phase pattern illuminating the sample determines the topological phase, and spatial variations in this pattern could be used to produce several adjacent topologically different regions (with chiral edge states in-between). Moreover, even quench physics could easily be explored in such a system, by changing the driving laser. Once realized, such optomechanical phonon Chern insulators could be exploited for studying heat transport on the nanoscale in new ways, with unidirectional edge channels connecting different heat reservoirs.

Measurement and Quantum Noise
One of the primary possible applications of optomechanical systems consists in ultrasensitive measurements, of small displacements, forces, masses, and accelerations.

It is straightforward to measure the mechanical displacement in an optomechanical system. After all, the optical cavity represents an interferometer. However, the so-called standard quantum limit for displacement detection prescribes that there is a lower limit to the unavoidable noise in such a setting. Ultimately, this arises due to Heisenberg’s uncertainty relation, because a weak continuous position measurement essentially attempts to measure the full trajectory of a quantum particle, which is of course not possible with arbitrary precision (see e.g. our review RevModPhys 10). This challenge can be circumvented, however, if one deliberately measures only a particular “quadrature” of the mechanical oscillation. We analyzed such a scheme in detail (NJP 08), and by now this has been shown in experiments (e.g. by the Schwab group).

Apart from the mechanical displacement, it would be even more interesting to be able to measure the quantized phonon number of a mechanical resonator. In 2008, in a joint work with the Harris group (Nature 08) we pointed out how that would become possible in a novel optomechanical system where the optical frequency couples to the square of the position (instead of just linearly). That would enable a quantum non-demolition measurement of phonon number, which would eventually allow to observe quantum jumps between discrete mechanical Fock states. It has to be pointed out, though, that this goal still remains very challenging, even with the present-day strongly improved systems. The reason is that it effectively requires the single-photon strong coupling regime, where the bare coupling is larger than the photon decay rate.


Partially negative Wigner density of a nonclassical mechanical quantum state, produced in an optomechanical oscillator
The optomechanical interaction between photons and phonons is fundamentally nonlinear, since the force acting on the mechanical resonator is proportional to the intensity of the light field (and not its amplitude). Nevertheless, the coupling constant is usually so small that one has to compensate for this by boosting the effects through a large laser drive. In that case, the interaction becomes linear and the more subtle effects are lost. Recent years have seen strong experimental efforts to increase the bare optomechanical coupling, such that it would become strong even at the level of single photons and single phonons. In our theory work, we have been investigating which effects would become possible if the coupling rate were to reach or exceed other important scales in the problem (such as the photon decay rate or the mechanical frequency).

One of the natural questions to ask in this context is how the classical nonlinear dynamics smoothly transitions into the quantum regime (the classical-quantum transition) when the coupling is so large that nonlinear effects can be seen even for small numbers of photons and phonons. We predicted that one will be able to see non-Gaussian (NJP 08 ) and even non-classical (PRL 12) quantum states of mechanical motion in this “single photon strong coupling” regime (as it came to be known).

Another, very relevant, question is how to increase the effective optomechanical coupling such that true quantum many-body effects could be seen in the experiments. We found out that one can engineer a system with two suitable optical modes so as to boost the quantum nonlinear effects (PRL 12). This would allow effective photon-photon interactions, as well as QND measurements of photon and phonon number. One can also turn the question around and ask how the first subtle effects of quantum nonlinearities would manifest themselves even if the coupling is not yet very strong. We predicted that in a two-tone spectroscopy experiment, the sharp spectral dips that are associated with “optomechanically induced transparency” could provide such a first tell-tale sign of nonlinearities on the quantum level (PRL 13). All of these effects still remain to be seen in experiments. A number of experimental groups are working hard to improve the designs of their physical setups to approach the strong single-photon coupling regime.

Please visit the official domain machine-learning-for-physicists.org, where we collected all the videos and slides from the 2017 Machine Learning for Physics Lecture Series for quick download!

 

Basic Information about this lecture series

Contact: florian.marquardt@mpl.mpg.de
2 hours/week, 5 ECTS credit points
UnivIS
Description: This is a course introducing modern techniques of machine learning, especially deep neural networks, to an audience of physicists. Neural networks can be trained to perform many challenging tasks, including image recognition and natural language processing, just by showing them many examples. While neural networks have been introduced already in the 50s, they really have taken off in the past decade, with spectacular successes in many areas. Often, their performance now surpasses humans, as proven by the recent achievements in handwriting recognition and in winning the game of 'Go' against expert human players. They are now also being considered more and more for applications in physics, ranging from predictions of material properties to analyzing phase transitions.

Contents: We will cover the basics of neural networks (backpropagation), convolutional networks, autoencoders, restricted Boltzmann machines, and recurrent neural networks, as well as the recently emerging applications in physics. Time permitting, we will address other topics, like the relation to spin glass models, curriculum learning, reinforcement learning, adversarial learning, active learning, "robot scientists", deducing nonlinear dynamics, and dynamical neural computers.

Prerequisites: As a prerequisite you will only need matrix multiplication and the chain rule, i.e. the course will be understandable to bachelor students, master students and graduate students. However, knowledge of any computer programming language will make it much more fun. We will sometimes present examples using the 'python' programming language, which is a modern interpreted language with powerful linear algebra and plotting functions.

Book: The first parts of the course will rely heavily on the excellent and free online book by Nielsen: "Neural Networks and Deep Learning"

Software: Modern standard computers are powerful enough to run neural networks in a reasonable time. The following list of software packages helps to keep the programming effort low (it is possible to implement advanced structures like a deep convolutional neural network in only a dozen lines of code, which is quite amazing):

Python is a widely used high-level programming language for general-purpose programming; both Theano and Keras are Python moduls. We highly recommend the usage of the 3.x branch (cmp. Python2 vs Python3).
TensorFlow is a package for dataflow and differentiable programming, developed by Google. It is a symbolic math library for a broad range of tasks, including machine learning applications such as neural networks. For that purpose, TensorFlow provides the low-level tools (multi-dimensional arrays, convolutional layers, efficient computation of the gradient, ...).
Keras is a high-level framework for neural networks, running on top of TensorFlow. Designed to enable fast experimentation with deep neural networks, it focuses on being minimal, modular and extensible.
Matplotlib is a plotting library for the Python programming language. We use it to visualize our results.
Jupyter is a browser-based application that allows to create and share documents that contain live (Python) code, equations, visualizations and explanatory text. So, Jupyter serves a similar purpose like Mathematica notebooks.
All the software above is open source and freely available for a large number of platforms. See also the installation instructions.

Cavity Optomechanics   Markus Aspelmeyer  markus.aspelmeyer@univie.ac.at optomechanicsrmp@gmail.com  english  Vienna Center for Quantum Science and Technology (VCQ), Faculty of Physics, University of Vienna, 1090 Vienna, Austria   Tobias J. Kippenberg  tobias.kippenberg@epfl.ch  english  Ecole Polytechnique F�d�rale de Lausanne (EPFL), 1015 Lausanne, Switzerland    Florian Marquardt  Florian.Marquardt@physik.uni-erlangen.de  english  University of Erlangen-N�rnberg, Institute for Theoretical Physics, Staudtstr. 7, 91058 Erlangen, Germany;  and Max Planck Institute for the Science of Light, Erlangen, Germany  We review the field of cavity optomechanics, which explores the interaction between electromagnetic radiation and nano- or micromechanical motion. This review covers the basics of optical cavities and mechanical resonators, their mutual optomechanical interaction mediated by the radiation pressure force, the large variety of experimental systems which exhibit this interaction, optical measurements of mechanical motion, dynamical backaction amplification and cooling, nonlinear dynamics, multimode optomechanics, and proposals for future cavity quantum optomechanics experiments. In addition, we describe the perspectives for fundamental quantum physics and for possible applications of optomechanical devices.      Introduction    Light carries momentum which gives rise to radiation pressure forces. These forces were already postulated in the 17 century by Kepler, who noted that the dust tails of comets point away from the sun during  a comet transit . The first unambiguous experimental demonstrations of the radiation pressure force predicted by Maxwell were performed using a light mill configuration . A careful analysis of these experiments was required to distinguish the phenomenon from thermal effects that had dominated earlier observations. As early as 1909, Einstein derived the statistics of the radiation pressure force fluctuations acting on a moveable mirror , including the frictional effects of the radiation force, and this analysis allowed him to reveal the dual wave-particle nature of blackbody radiation. In pioneering experiments, both the linear and angular momentum transfer of photons to atoms and macroscopic objects were demonstrated by Frisch  and by Beth , respectively.            In the 1970s Arthur Ashkin demonstrated that focused lasers beams can be used to trap and control dielectric particles, which also included feedback cooling . The non-conservative nature of the radiation pressure force and the resulting possibility to use it for cooling atomic motion was first pointed out by H�nsch and Schawlow and by Dehmelt and Wineland . Laser cooling was subsequently realized experimentally in the 1980s and has become since then an extraordinarily important technique . It has, for example, allowed cooling of ions to their motional ground state and it is the underlying resource for ultracold atom experiments. Many applications have been enabled by laser cooling , including optical atomic clocks, precision measurements of the gravitational field, and systematic studies of quantum many-body physics in trapped clouds of atoms .   The role of radiation pressure and its ability to provide cooling for larger objects was already investigated earlier by Braginsky in the context of interferometers. Braginsky considered the dynamical influence of radiation pressure on a harmonically suspended end-mirror of a cavity. His analysis revealed that the retarded nature of the force, due to the finite cavity lifetime, provides either damping or anti-damping of mechanical motion, two effects that he was able to demonstrate in pioneering experiments using a microwave cavity . In later experiments, these phenomena were also observed in microwave-coupled -scale mechanical resonators . Independently, similar physics was explored theoretically for solid-state vibrations . In the optical domain, the first cavity optomechanical experiment  demonstrated bistability of the radiation pressure force acting on a macroscopic end-mirror.  Braginsky also addressed the fundamental consequences of the quantum fluctuations of radiation pressure and demonstrated that they impose a limit on how accurately the position of a free test mass (e.g. a mirror) can be measured . A detailed analysis by Caves clarified the role of this ponderomotive quantum noise in interferometers . These works established the standard quantum limit for continuous position detection, which is essential for gravitational wave detectors such as LIGO or VIRGO.   During the 1990s, several aspects of quantum cavity optomechanical systems started to be explored theoretically. These include squeezing of light  and quantum non-demolition (QND) detection of the light intensity , which exploit the effective Kerr nonlinearity generated by the optomechanical interaction. It was also pointed out that for extremely strong optomechanical coupling the resulting quantum nonlinearities could give rise to nonclassical and entangled states of the light field and the mechanics . Furthermore, feedback cooling by radiation pressure was suggested . Around the same time, in a parallel development, cavity-assisted laser-cooling was proposed as a method to cool the motion of atoms and molecules that lack closed internal transitions .  On the experimental side, optical feedback cooling based on the radiation pressure force was first demonstrated in  for the vibrational modes of a macroscopic end-mirror. This approach was later taken to much lower temperatures . At the same time, there was a trend to miniaturize the mechanical element. For example, the thermal motion of a -scale mirror was monitored in a cryogenic optical cavity . Producing high-quality optical Fabry-Perot cavities below that scale, however, turned out to be very challenging. In spite of this, it was still possible to observe optomechanical effects of retarded radiation forces in microscale setups where the forces were of photothermal origin, effectively replacing the cavity lifetime with a thermal time constant. Examples include demonstration of the optical spring effect , feedback damping , self-induced oscillations , and cavity cooling due to the dynamical backaction of retarded photothermal light forces .   Yet, for future applications in quantum coherent optomechanics it is highly desirable to be able to exploit the non-dissipative radiation pressure force. Both the advent of optical microcavities and of advanced nanofabrication techniques eventually allowed to enter this regime. In 2005 it was discovered that optical microtoroid resonators with their high optical finesse at the same time contain mechanical modes and thus are able to display optomechanical effects, in particular radiation-pressure induced self-oscillations  (i.e. the effect Braginsky termed ``parametric instability''      ). In 2006 three different teams demonstrated radiation-pressure cavity cooling, for suspended micromirrors  and for microtoroids . Since then, cavity optomechanics has advanced rapidly and optomechanical coupling has been reported in numerous novel systems. These include membranes  and nanorods  inside Fabry-Perot resonators, whispering gallery microdisks  and microspheres , photonic crystals , and evanescently coupled nanobeams . In addition, cavity optomechanics has been demonstrated for the mechanical excitations of cold atom clouds . Optomechanical interactions are also present in optical waveguides - as first studied and observed in the context of squeezing, where the confined mechanical modes of fibers lead to Guided Acoustic Wave scattering . Nowadays there are a number of systems where such optomechanical interactions are explored in the absence of a cavity, such as waveguides in photonic circuits or photonic crystal fibres, see e.g. . These setups lie somewhat outside the scope of the concepts presented in this review, but we emphasize that they are very promising for applications due to their large bandwidth.  Optomechanical coupling has also been realized using microfabricated superconducting resonators, by embedding a nanomechanical beam inside a superconducting transmission line microwave cavity  or by incorporating a flexible aluminum membrane into a lumped element superconducting resonator . In these systems the mechanical motion capacitively couples to the microwave cavity. This approach ties cavity optomechanics to an independent development that has been garnering momentum since the late 1990s, which is concerned with measuring and controlling the motion of nano- and micromechanical oscillators using electrical and other non-optical coupling techniques. Examples include coupling of mechanical oscillators to single electron transistors  or a quantum point contact . Besides a wealth of possible applications for such devices in sensitive detection , these methods provide the possiblility of realizing mechanical quantum devices  by direct interaction with two-level quantum systems . For recent comprehensive general reviews of nanomechanical systems (in particular electro-mechanical devices), we refer the reader to .   It should be noted that in atomic systems quantum coherent control of mechanical motion is state of the art since early pioneering experiments with trapped ions  for reviews see . In fact, quantum information processing in these systems relies on using the quantum states of motion to mediate interactions between distant atomic spins . In contrast, the fabricated nano- and micromechanical structures that form the subject of this review will extend this level of control to a different realm, of objects with large masses and of devices with a great flexibility in design and the possibility to integrate them in on-chip architectures.  There are several different motivations that drive the rapidly growing interest into cavity optomechanics. On the one side, there is the highly sensitive optical detection of small forces, displacements, masses, and accelerations. On the other hand, cavity quantum optomechanics promises to manipulate and detect mechanical motion in the quantum regime using light, creating nonclassical states of light and mechanical motion. These tools will form the basis for applications in quantum information processing, where optomechanical devices could serve as coherent light-matter interfaces, for example to interconvert information stored in solid-state qubits into flying photonic qubits. Another example is the ability to build hybrid quantum devices that combine otherwise incompatible degrees of freedoms of different physical systems. At the same time, it offers a route towards fundamental tests of quantum mechanics in an hitherto unaccessible parameter regime of size and mass.   A number of reviews  and brief commentary papers  on cavity optomechanics have been published during the past few years, and the topic has also been discussed as part of a larger reviews on nanomechanical systems . Here we aim for a comprehensive treatment that incorporates the most recent advances and points the way towards future challenges.  This review is organized follows: We first discuss optical cavities, mechanical resonators, the basic optomechanical interaction between them and the large range of experimental setups and parameters that are now available. We then go on to derive the basic consequences of the interaction (such as optomechanical damping and the optical spring effect), describe various measurement schemes, and present the quantum theory of optomechanical cooling. After studying nonlinear effects in the classical regime, we address multimode setups and the wide field of proposed applications in the quantum domain, before concluding with an outlook.                                                                 *    Optical cavities and mechanical resonators    In this section we recall the basic aspects of optical cavities and of mechanical resonators, as needed to describe cavity optomechanical systems. Much more about these topics can be found in standard textbooks on quantum optics, e.g. , and on nanomechanical systems .   Optical resonators  Optical resonators can be realized experimentally in a multitude of forms of which several types will be discussed later in the review. Here we give a unifying description of the optical properties and provide the mathematical description of a cavity that is pumped with a single monochromatic laser source.     Basic properties    We first consider the classical response of a simple Fabry-Perot resonator, which will allow to introduce the relevant parameters to characterize an optical cavity. A Fabry-Perot resonator or etalon consisting of two highly reflective mirrors, separated by a distance , contains a series of resonances which are given by the angular frequency  Here  is the integer mode number. The separation of two longitudinal resonances is denoted as the free spectral range (FSR) of the cavity:    In the following, we will almost always focus on a single optical mode, whose frequency we will denote .  Both the finite mirror transparencies and the internal absorption or scattering out of the cavity lead to a finite photon (intensity) cavity decay rate      .   A further useful quantity is the optical finesse, , which gives the average number of round-trips before a photon leaves the cavity:    The optical finesse is a useful parameter as it gives the enhancement of the circulating power over the power that is coupled into the resonator. Alternatively, we can introduce the quality factor of the optical resonator,    where  is the photon lifetime. Note that the quality factor is also used to characterize the damping rate of mechanical resonators (see below). Generally speaking, the cavity decay rate  can have two contributions, one from losses that are associated with the (useful) input (and output) coupling and a second contribution from the internal losses. It is useful to differentiate these two contributions. For the case of a high-Q cavity, the total cavity loss rate can be written as the sum of the individual contributions:        Here,  refers to the loss rate associated with the input coupling, and  refers to the remaining loss rate. For example, in the case of a waveguide coupled to a microtoroidal or microsphere resonator,  is the loss rate associated with the waveguide-resonator interface and  describes the light absorption inside the resonator. For the case of a Fabry-Perot cavity,  is the loss rate at the input cavity mirror and  summarizes the loss rate inside the cavity, including transmission losses at the second cavity mirror as well as all scattering and absorption losses behind the first mirror. Note that by splitting the total decay rate into these two contributions, we are assuming that the photons going into the  decay channel will not be recorded. More generally, one could distinguish between more decay channels (e.g. input mirror, output mirror, absorption).   Input-output formalism for an optical cavity    A quantum mechanical description of a cavity that is coupled to the outside electromagnetic environment can be given either via master equations (if only the internal dynamics is of interest) or via a framework known as input-output theory, if one also wants to access the light field being emitted by (or reflected from) the cavity. Input-output theory allows us to directly model the quantum fluctuations injected from any coupling port (such as the input mirror) into the cavity. In addition, it takes into account any coherent laser drive that may be present. For more details beyond the brief discussion provided below, see e.g. .                    Input-output theory is formulated on the level of Heisenberg equations of motion, describing the time-evolution of the field amplitude  inside the cavity. One finds that the amplitude  experiences decay at a rate . At the same time, its fluctuations are constantly replenished via the quantum noise entering through the various ports of the cavity. In the present case, we distinguish between the channels associated with the input coupling (decay rate ) and the other loss processes (overall decay rate , including loss through the second mirror). The equation of motion reads:     In the classical case,  would be replaced by a properly normalized complex amplitude of the electric field of the cavity mode under consideration. Indeed, the classical version of this equation (and the following ones) can be obtained by simply taking the average, such that . We have chosen a frame rotating with the laser frequency , i.e.  and have introduced the laser detuning  with respect to the cavity mode (see also Sec. ). Note that a similar equation can also be written down for the mechanical oscillator in order to describe its dissipation and the associated noise force, comprising quantum and thermal contributions (see Sec. ).  The input field  should be thought of as a stochastic quantum field. In the simplest case, it represents the fluctuating vacuum electric field coupling to the cavity at time , plus a coherent laser drive. However, the same formalism can also be used to describe squeezed states and other more complex field states. The field is normalized in such a way that     is the input power launched into the cavity, i. e.  is the rate of photons arriving at the cavity. The same kind of description holds for the ``unwanted'' channel associated with .  According to the input-output theory of open quantum systems, the field that is reflected from the Fabry Perot resonator (or coupled back into the coupling waveguide) is given by:    Note that this input-output relation describes correctly the field reflected from the input mirror of a Fabry-Perot resonator. The above equation describes also the transmitted pump field of an evanescently coupled uni-directional waveguide resonator system, such as a whispering gallery mode resonator coupled to a waveguide . In this case the above expression would yield the transmitted pump field.  We still have to consider the case of a two-sided cavity, e.g. a two-sided Fabry Perot cavity. Other examples in this review include a waveguide coupled to superconducting stripline cavities or fiber-taper coupled photonic crystal defect cavities. In these cases there are both transmitted and reflected fields. In all of these cases there are two options for the description. If the field transmitted through the second mirror is not of interest to the analysis, one may lump the effects of that mirror into the decay rate , which now represents both internal losses and output coupling through the second mirror. If, however, the field is important, it should be represented by an additional term of the type  in Eq. (). Then an equation analogous to Eq. () will hold for the output field  at that second mirror.   In the following, we will not be concerned with noise properties, but focus instead on classical average quantities (for a single-sided cavity), taking the average of Eqs. () and ().  We can solve the equation () first for the steady-state amplitude in the presence of a monochromatic laser drive whose amplitude is given by . Noting that  we obtain:     The expression linking the input field to the intracavity field will be referred to as the optical susceptibility,      Thus, the steady-state cavity population , i.e the average number of photons circulating inside the cavity, is given by:     were  is the input power launched into the cavity. The reflection or transmission amplitude (for the case of a Fabry-Perot cavity or a waveguide-coupled resonator, respectively) can be calculated by inserting Eq. () into Eq. (). Using the symbol  for the reflection amplitude in the sense of figure  case (b), we obtain:     The square  of this amplitude gives the probability of reflection from the cavity (for Fabry-Perot) or transmission in the case of a uni-directional waveguide resonator system. From this expression, several regimes can be differentiated. If the external coupling  dominates the cavity losses (, the cavity is called ``overcoupled''. In that case  and the pump photons emerge from the cavity without having been absorbed or lost via the second mirror (a property that is important as discussed below in the context of quantum limited detection). The case where  refers to the situation of ``critical coupling''. In this case,  on resonance. This implies the input power is either fully dissipated within the resonator or fully transmitted through the second mirror (in the case of a Fabry-Perot cavity with  denoting the decay through the second mirror). The situation   is referred to as ``undercoupling'' and is associated with cavity losses dominated by intrinsic losses. For many experiments this coupling condition is not advantageous, as it leads to an effective loss of information.  The physical meaning of reflection (or transmission) depends sensitively on the experimental realization under consideration. One can distinguish four scenarios, which are outlined in the figure .   Mechanical resonators     Mechanical normal modes  The vibrational modes of any object can be calculated by solving the equations of the linear theory of elasticity under the appropriate boundary conditions that are determined by the geometry     . This eigenvalue problem yields a set of normal modes and corresponding eigenfrequencies . The mechanical displacement patterns associated with mechanical motion are given by the strain field  where  designates the normal mode.   For the purposes of this review, we will mostly focus on a single normal mode of vibration of frequency  (where '' stands for 'mechanical'), assuming that the mode spectrum is sufficiently sparse such that there is no spectral overlap with other mechanical modes. The loss of mechanical energy is described by the (energy) damping rate  which is related to the mechanical quality factor     by  If one is interested in the equation of motion for the global amplitude  of the motion, one can utilize a suitably normalized (see below) dimensionless mode function , such that the displacement field would be . Then the temporal evolution of  can be described by the canonical simple equation of motion of a harmonic oscillator of effective mass :     Here  denotes the sum of all forces that are acting on the mechanical oscillator. In the absence of any external forces, it is given by the thermal Langevin force (see Sec. ). In the above equation the (energy) damping rate  has been assumed to be frequency independent. Deviations of this model are treated for example in .  A brief remark about the effective mass  is necessary at this point . The normalization that has been chosen for the mode function  affects the normalization of . However, it will always be true that the potential energy is given by . This value can then be compared to the expression for the potential energy that arises from a calculation according to the theory of elasticity. Demanding them to be equal yields the correct value for the effective mass  (which therefore is seen to depend on the normalization that was chosen for the mode function). Of course, for the simple case of a center-of-mass oscillation of a solid object, a natural definition of  is the center of mass displacement in which case the effective mass will be on the order of the total mass of the object. A treatment of effective mass in optomechanical experiments is found in .  Eq. () can be solved easily, which is best done in frequency space. We introduce the Fourier transform via . Then  defines the susceptibility , connecting the external force to the response  of the coordinate:     The low frequency response is given by  where  is the spring constant     .   The quantum mechanical treatment of the mechanical harmonic oscillator leads to the Hamiltonian    Here the phonon creation () and annihilation () operators have been introduced, with     where      is the zero-point fluctuation amplitude of the mechanical oscillator, i.e. the spread of the coordinate in the ground-state: , and where  denotes the mechanical vacuum state. The position and momentum satisfy the commutator relation . The quantity  is the phonon number operator, whose average is denoted by . In the following, we will typically not display explicitly the contribution  of the zero-point energy to the energy of the oscillator.  We briefly discuss the effect of dissipation. If the mechanical oscillator is coupled to a high temperature bath, the average phonon number will evolve according to the expression:     For an oscillator which is initially in the ground state,  this implies a simple time dependence of the occupation according to , where  is the average phonon number of the environment. Consequently, the rate at which the mechanical oscillator heats out of the ground state is given by:     The latter is often referred to as the thermal decoherence rate, and given by the inverse time it takes for one quantum to enter from the environment. In the above expression the high temperature limit has been taken, i.e.  This expression shows that to attain low decoherence a high mechanical Q factor and a low temperature bath are important. The change of population of a certain Fock state can be described within the framework of the Master equation approach. This approach allows to calculate the decoherence rate of other quantum states such as a Fock state . The latter is given by (see e.g.):     revealing that higher Fock states exhibit a progressively higher rate of decoherence.       Mechanical dissipation    The loss of mechanical excitations, i.e. phonons, is quantified by the energy dissipation rate . The origins of mechanical dissipation have been intensively studied over the last decades and comprehensive reviews are found for example in . The most relevant loss mechanisms include:   viscous damping, which is caused by interactions with the surrounding gas atoms or by compression of thin fluidic layers ; clamping losses, which are due to the radiation of elastic waves into the substrate through the supports of the oscillator ; fundamental anharmonic effects such as thermoelastic damping (TED) and phonon-phonon interactions ; materials-induced losses, which are caused by the relaxation of intrinsic or extrinsic defect states in the bulk or surface of the resonator . Such losses have been successfully described by a phenomenological model involving two level defect states, which are coupled to the strain via the deformation potential . In the context of nano- and micromechanical oscillators the two level fluctuator damping has been revisited .  The various dissipation processes contribute independently to the overall mechanical losses and hence add up incoherently. The resulting mechanical quality factor  is given by , where  labels the different loss mechanisms.  Another helpful quantity is the so-called ``'' product, which plays an important role in the phase noise performance of oscillators. In the context of optomechanics, it quantifies the decoupling of the mechanical resonator from a thermal environment. Specifically, , denotes the number of coherent oscillations in the presence of thermal decoherence, and evidently scales with .                           Susceptibility, noise spectra and fluctuation dissipation theorem    If one measures the motion of a single harmonic oscillator in thermal equilibrium, one will observe a trajectory  oscillating at the eigenfrequency . However, due to the influence of both mechanical damping and the fluctuating thermal Langevin force, these oscillations will have a randomly time-varying amplitude and phase. Both amplitude and phase change on the time scale given by the damping time . Such real-time measurements have been performed in optomechanical systems  (see Fig. ).  In experiments, the mechanical motion is often not analyzed in real-time but instead as a noise spectrum in frequency space. This allows to easily separate the contributions from different normal modes. We briefly recapitulate the relevant concepts. Given one particular realization of the trajectory  obtained during a measurement time , we define the gated Fourier transform over a finite time interval :     Averaging over independent experimental runs, we obtain the spectral density . In the limit , the Wiener-Khinchin theorem connects this to the Fourier transform  of the autocorrelation function, also called the noise power spectral density:     Here we have defined:     The only assumption which has been made is that  is a stationary random process. From Eqs. (,), we immediately obtain the important result that the area under the experimentally measured mechanical noise spectrum yields the variance of the mechanical displacement, :     Furthermore, in thermal equilibrium, the fluctuation-dissipation theorem (FDT) relates the noise to the dissipative part of the linear response,     where  denotes the mechanical susceptibility introduced above and we have treated the high-temperature (classical) case. For weak damping (), this gives rise to Lorentzian peaks of width  in the noise spectrum, located at  (see Fig. ). Integration of  according to Eq. () yields the variance, which for weak damping is set by the equipartition theorem: .  In the quantum regime, the natural generalization of Eq. () contains the product of Heisenberg time-evolved operators, , which do not commute. As a consequence, the spectrum  is asymmetric in frequency. The quantum FDT      implies that  for  at . Our discussion of dynamical backaction cooling will mention that this means the  bath is not able to supply energy, as there are no thermal excitations. In this review we will also consider the symmetrized noise spectrum, . For more on noise spectra, we refer to .            Principles of optomechanical coupling     The radiation pressure force and optomechanical coupling    In our discussion the fundamental mechanism that couples the properties of the cavity radiation field to the mechanical motion is the momentum transfer of photons, i.e. radiation pressure. The simplest form of radiation pressure coupling is the momentum transfer due to reflection that occurs in a Fabry Perot cavity. A single photon transfers the momentum  (: photon wavelength). As a consequence the radiation pressure force is given by     Here  denotes the cavity round trip time. Therefore,  describes the radiation pressure force caused by one intracavity photon. The parameter  which appears in this expression describes also the change of cavity resonance frequency with position, i.e. the frequency pull parameter. In the next section, which introduces a Hamiltonian description of the interaction between a movable mirror and optical cavity, this relation will be derived in its full generality.  More generally, the optomechanical coupling can arise for example by direct momentum transfer via reflection (Fabry-Perot type cavities with a moveable end-mirror, microtoroids), by coupling via a dispersive shift of the cavity frequency (membrane in the middle, levitated nano-objects trapped inside the cavity) or by optical near-field effects (e.g. nano-objects in the evanescent field of a resonator or a waveguide just above a substrate).   Various radiation pressure forces have been investigated in the pioneering work of Ashkin, who first demonstrated that small dielectric particles can be trapped in laser light . The relevant forces are generally referred to as gradient (or dipole) forces, as the force arises from the gradient of the laser field intensity. The particle is attracted to the center of the Gaussian trapping laser beam. If  denotes the laser electric field distribution, the time-averaged dielectric energy of the particle in the field is given by  (with  the polarizability) which correspondingly yields a force  In addition to the gradient force, scattering forces occur for a traveling wave. These forces scale with , i.e. the wavenumber of the electromagnetic radiation, in contrast to the gradient forces. In addition there is also a contribution from the strain-optical effect, i.e. the strain-dependent polarizability. The strain-optical coupling is the dominant coupling mechanism in guided acoustic wave scattering . Independent of the physical interpretation of the force, however, the optomechanical interaction in an optomechanical system can always be derived by considering the cavity resonance frequency shift as a function of displacement (i.e. the ``dispersive'' shift). This will be the basis for our Hamiltonian description adopted in the next section.  It is important to note at this point that a significant difference between the trapping of particles in free space and micromechanical systems is the fact that the latter are also subject to radiation forces based on thermal effects. Absorption of light can heat a structure and deform it, which corresponds to the action of a force (e.g. in an asymmetric, bimorph structure, including materials of different thermal expansion). These photothermal forces can in many ways lead to effects similar to retarded radiation pressure forces, with the thermal relaxation time of the structure replacing the cavity photon lifetime. However, since such forces are based on absorption of light, they cannot form the basis for future fully coherent quantum optomechanical setups, since at least the coherence of the light field is thereby irretrievably lost.   Hamiltonian formulation    The starting point of all our subsequent discussions will be the Hamiltonian describing the coupled system of a radiation mode interacting with a vibrational mode (Fig. ). For brevity we will refer to the radiation field as ``optical'', even though the important case of microwave setups is included here as well.  We will focus here on the simplest possible model system in cavity optomechanics, which has been used to successfully describe most of the experiments to date. In this model, we restrict our attention to one of the many optical modes, i.e. the one closest to resonance with the driving laser. Moreover, we also describe only one of the many mechanical normal modes. This is mostly arbitrary, as the displacement frequency spectrum will show peaks at any of the mechanical resonances. Still, as long as the dynamics is linear with independently evolving normal modes, the model will provide a valid approximation. In some cases, like sideband-resolved cooling, it may be possible to experimentally select a particular mechanical mode by adjusting the laser detuning, whereas in other cases, like nonlinear dynamics, an extended description involving several mechanical modes may become crucial.   The uncoupled optical () and mechanical () mode are represented by two harmonic oscillators, which is typically an excellent approximation at the displacements generated in the experiments:     In the case of a cavity with a movable end mirror the coupling of optical and mechanical mode is parametric, i.e. the cavity resonance frequency is modulated by the mechanical amplitude       :     For most experimental realizations discussed in this review, it suffices to keep the linear term, where we define the optical frequency shift per displacement as  (but see Sec.  for another example). A more detailed derivation of the optomechanical Hamiltonian can be found in an early paper .   We mention in passing that other coupling mechanisms have been discussed. For example, the transparency of a moving Bragg mirror, and hence , can depend on its velocity . More generally, the displacement may couple to the cavity decay rate, yielding . This case (sometimes termed ``dissipative coupling''), which is of practical relevance in some setups , can lead to novel physical effects, e.g. in cooling .  For a simple cavity of length , we have . The sign reflects the fact that we take  to indicate an increase in cavity length, leading to a decrease in  if . In general, expanding to leading order in the displacement, we have:     Here , as defined before. Thus, the interaction part of the Hamiltonian can be written     where     is the vacuum optomechanical coupling strength, expressed as a frequency. It quantifies the interaction between a single phonon and a single photon. We stress that, generally speaking,  is more fundamental than , since  is affected by the definition of the displacement that is to some extent arbitrary for more complicated mechanical normal modes (see the discussion in Sec. ). Therefore, in the following we will almost always refer to . Further below, we will also mention , which is an often-used measure for the effective optomechanical coupling in the linearized regime. It will be enhanced compared to  by the amplitude of the photon field. The Hamiltonian reveals that the interaction of a movable mirror with the radiation field is fundamentally a nonlinear process, involving three operators (three wave mixing).  The radiation pressure force is simply the derivative of  with respect to displacement:       The full Hamiltonian  will also include terms that describe dissipation (photon decay and mechanical friction), fluctuations (influx of thermal phonons), and driving by an external laser. These effects are formulated most efficiently using the equations of motion and the input-output formalism (see Sec. , and also the next section). Here, we just remark that it is convenient to change the description of the optical mode by switching to a frame rotating at the laser frequency . Applying the unitary transformation  makes the driving terms time-independent   , and generates a new Hamiltonian  of the form     where     is the laser detuning introduced already in Sec. , and where we have omitted () driving, decay, and fluctuation terms, which will be discussed below. Eq. () is the frequently used starting point in cavity optomechanics.  We now introduce the so-called ``linearized'' approximate description of cavity optomechanics. To this end, we split the cavity field into an average coherent amplitude  and a fluctuating term:     Then, the interaction part of the Hamiltonian      may be expanded in powers of . The first term, , indicates the presence of an average radiation pressure force . It may be omitted after implementing an appropriate shift of the displacement's origin by . The second term, of order , is the one we keep:     The third term, , is omitted as being smaller by a factor . Without loss of generality, we will now assume  real-valued. Thus, the Hamiltonian in the rotating frame reads     where the quadratic interaction part           is referred to as ``linearized'', since the resulting coupled equations of motion will be linear in this approximation. Note that the remaining terms in Eq. () no longer contain the laser driving, as that has already been taken care of by the shift implemented in Eq. (). In the literature up to now, the combination     is often referred to as ``the optomechanical coupling strength''. Obviously, it depends on the laser intensity and is thus less fundamental than the single-photon coupling  (obtained for ). In the linearized regime described here, the optomechanical system can be viewed in analogy to a linear amplifier  that receives optical and mechanical input fields.  The linearized description can be good even if the average photon number circulating inside the cavity is not large. This is because the mechanical system may not be able to resolve the individual photons if the decay rate  is sufficiently large. The detailed conditions for the linearized approximation to be valid may depend on the questions that are asked. We will return to this question in the section on nonlinear quantum optomechanics (Sec. ).   We briefly note that  is one neccessary condition for the so-called ``strong coupling'' regime of cavity optomechanics, where the mechanical oscillator and the driven optical mode hybridize (Sec. ). A much more challenging condition is to have , i.e. the single-photon optomechanical coupling rate exceeding the cavity decay rate. In the latter regime, nonlinear quantum effects will become observable (see Sec. ).  Depending on the detuning, three different regimes can be distinguished with respect to the interaction (), especially in the sideband-resolved regime (, which we assume in the remainder of this section). For , we have two harmonic oscillators of (nearly) equal frequency that can interchange quanta: the mechanical oscillator and the driven cavity mode. Within the rotating-wave approximation (RWA) we thus can write the interaction as     This is the case relevant for cooling (transferring all thermal phonons into the cold photon mode; Sec. ) and for quantum state transfer between light and mechanics (Sec. ). In the quantum-optical domain, it is referred to as a ``beam-splitter'' interaction.  For , the dominant terms in RWA     represent a ``two-mode squeezing'' interaction that lies at the heart of parametric amplification . In the absence of dissipation, this would lead to an exponential growth of the energies stored both in the vibrational mode and the driven optical mode, with strong quantum correlations between the two. Thus, it may be used for efficiently entangling both modes (Sec. ). Focussing on the mechanical mode alone, the growth of energy can be interpreted as ``anti-damping'' or amplification (Sec. ). If the intrinsic dissipation is low enough, this behaviour may trigger a dynamical instability that leads to self-induced mechanical oscillations. The resulting features will be discussed in Sec. .  Finally, when , the interaction     means that the mechanical position  leads to a phase shift of the light field, which is the situation encountered in optomechanical displacement detection (Sec. ). In addition, this interaction Hamiltonian can be viewed as implementing QND detection of the optical amplitude quadrature , since that operator commutes with the full Hamiltonian in this case.    Optomechanical equations of motion    The mechanical motion induces a shift of the optical resonance frequency, which in turn results in a change of circulating light intensity and, therefore, of the radiation pressure force acting on the motion. This kind of feedback loop is known as optomechanical ``backaction''. The finite cavity decay rate  introduces some retardation between the motion and the resulting changes of the force, hence the term ``dynamical'' backaction.  A convenient starting point for the analytical treatment of the radiation-pressure dynamical backaction phenomena (Sec.  and Sec. ) is the input-output formalism. This formalism (briefly introduced in Sec. ) provides us with equations of motion for the cavity field amplitude  and, analogously, for the mechanical amplitude . These equations have the form of Quantum Langevin equations    , since both the light amplitude and the mechanical motion are driven by noise terms that comprise the vacuum noise and any thermal noise entering the system:   a & =-2a+i(+Gx)a+_exa_in(t)+_0f_in(t)  b & =(-i_m-_m2)b+ig_0a^a+_mb_in(t)  Please see Sec.  for remarks on the input-output treatment and the optical decay rates . With regard to the damping term  for the mechanical dissipation, we note that this treatment is correct as long as . Otherwise the equations would have to be formulated on the level of the displacement , with a damping force .  The noise correlators associated with the input fluctuations are given by:   a_in(t)a_in^(t^)& =(t-t^)  a_in^(t)a_in(t^)& =0  b_in(t)b_in^(t^)& =(n_th+1)(t-t^)  b_in^(t)b_in(t^)& =n_th(t-t^)  Here we have assumed that the optical field has zero thermal occupation (), which is an approximation that is valid for optical fields at room temperature, although it may fail for the case of microwave fields, unless the setup is cooled to sufficiently low temperatures. In contrast, the mechanical degree of freedom is typically coupled to a hot environment, with an average number of quanta given by . Together with these correlators, the quantum Langevin equations describe the evolution of the optical cavity field and the mechanical oscillator, including all fluctuation effects.   It is equally useful to give the classical, averaged version of these equations that will be valid for sufficiently large photon and phonon numbers, in the semiclassical limit. Then, we can write down the equations for the complex light amplitude  and the oscillator position :    & =-2+i(+Gx)+_ex_in  m_effx & =-m_eff_m^2x-m_eff_mx+G^2  Here we have neglected all fluctuations, although these could be added to describe thermal and even, in a semiclassical approximation, quantum noise forces. The term  represents the laser drive. Note that we have also chosen to write the mechanical equation of motion in terms of the displacement, where . This becomes equivalent to the equation given above only for weak damping, . These fully nonlinear coupled differential equations will be the basis for our discussion of nonlinear phenomena, in particular the optomechanical parametric instability (also called ``self-induced oscillations'' or ``mechanical lasing'', Sec. ).  The equations of motion Eq. (), () (and likewise their classical versions) are inherently nonlinear as they contain the product of the mechanical oscillator amplitude and the cavity field (first line) or the radiation pressure force  that is quadratic in photon operators (second line). While they can still be solved numerically in the classical case, for the quantum regime they are of purely formal use and in practice cannot be solved exactly, neither analytically nor numerically. However, in many situations that we will encounter it is permissible to linearize this set of equations around some steady-state solution: . Using  and keeping only the linear terms, we find the following set of coupled linear equations of motion:   a & =(i2)a+ig(b+b^)+   & _exa_in(t)+_0f_in(t)  b & =(-i_m-_m2)b+ig(a+a^)+_mb_in(t).  These correspond to what one would have obtained alternatively by employing the ``linearized'' coupling Hamiltonian of Eq. () and then applying input-output theory. Here we have (as is common practice) redefined the origin of the mechanical oscillations to take into account the constant displacement  that is induced by the average radiation pressure force. It is evident that now the mutual coupling terms between the optical and mechanical degrees of freedom are linear in the field operators, and that the strength is set by the field-enhanced coupling rate  .   As shown in the later sections, these linearized equations are able to fully describe several phenomena, including optomechanical cooling, amplification, and parametric normal mode splitting (i.e. strong, coherent coupling). They can be solved analytically, which is best performed in the frequency domain (see Sec. ).  For completeness, we display the linearized quantum equations in frequency space:   -ia[] & =(i2)a[]+ig(b[]+(b^)[])   & +_exa_in[]  -ib[] & =(-i_m-_m2)b[]+ig(a[]+(a^)[])   & +_mb_in[].  Here  is the Fourier transform of . Note the important relation , which has to be taken care of while solving the equations.  It is equally useful to consider the linearized version of the classical equations of motion for the light amplitude and the displacement, Eqs. () and ():    & =(i2)+iGx  m_effx & =-m_eff_m^2x-m_effx+G(^*+^*)  Finally, we display them in frequency space, in the form that we will employ in Sec. .   -i[] & =(i2)[]+iGx[]  -m_eff^2x[] & =-m_eff_m^2x[]+im_eff_mx[]   & +G(^*[]+(^*)[])  Again, note .   Experimental realizations and optomechanical parameters    The increasing availability of high-quality optomechanical devices, i.e. high-Q mechanical resonators that are efficiently coupled to high-Q optical cavities, has been driving a plethora of experiments during the last years that are successfully demonstrating the working principles of cavity optomechanics. We now discuss some of the most frequently used architectures.             *    Optomechanical parameters    The following table summarizes the relevant optomechanical parameters for some typical current experimental implementations. These are: the mechanical resonator frequency  and mass ; the fundamental mechanical (phonon) and optical (photon) dissipation rates  and , respectively; the ``'' product, which is a direct measure for the degree of decoupling from the thermal environment (specifically,  is the condition for neglecting thermal decoherence over one mechanical period); the sideband suppression factor  that determines the ability to realize ground-state cooling (see Sec.); and finally the bare optomechanical coupling rate , which corresponds to the cavity frequency shift upon excitation of a single phonon.                              *   Some parameter combinations are of particular relevance for optomechanical tasks. The following figures provide an overview of the state of the art in current experiments. The data is compiled from published experiments. These are labelled as follows:  1 , 2 , 3 , 4 , 5 , 6 , 7 , 8 , 9 , 10 , 11 , 12 , 13 , 14 , 15 , 16 , 17 , 18 , 19 , 20 , 21 , 22 , 23 , 24 , 25 , 26 , 27 , 28 , 29 , 30 , 31 . Different symbols indicate the different optomechanical implementations: suspended mirrors (), optical microresonators (), photonic crystal cavities (), suspended nanoobjects (), microwave resonators (), cold atoms ().                                                        Suspended mirrors    An obvious way to realize optomechanical interactions in a cavity is to suspend one of the cavity's mirrors. The mechanical motion changes directly the cavity length and hence the frequency response of such a ``rubber cavity''       The first experimental implementations of this type were a Fabry-Perot cavity with moving mirrors and date back to the early attempts of laser interferometeric detection of gravitational waves . While there the purpose of suspending the macroscopic cavity mirrors is to achieve acoustic isolation, optomechanical effects, in particular quantum mechanical radiation pressure fluctuations, eventually pose the fundamental limit for its interferometric sensitivity  (see Section  for a detailed discussion). At the same time this configuration allows to exploit cavity optomechanics for the center of mass motion of truly macroscopic test masses. Experiments of that type have to date resulted in the demonstration of the optical bistability  (Sec. ), of the optical spring effect  (Sec. ) and of optical cooling  (Secs. , ) with suspended mirrors on the gram scale and even of feedback cooling of suspended mirrors on the kilogram scale at the LIGO facility . A practical challenge of these experiments is their operation at very low mechanical frequencies (1 kHz), which requires sophisticated isolation against acoustic noise. For such experiments this is achieved by suspending the macroscopic mirrors over several stages. To minimize mechanical losses it has recently been suggested to levitate the macrosopic mirror in an optical trap . Finally, this kind of setup also allows to monitor and to optomechanically control internal mechanical modes of macroscopic mirrors , which are a dominant source for unwanted cavity phase noise e.g. in gravitational wave detectors , in cavity QED  or in frequency stabilization of atomic optical clocks .   Another possibility is to use highly reflecting micromechanical devices as a Fabry-Perot end mirror. These systems include coated cantilevers  and micropillars , micrometer-sized mirror pads on top of cantilevers , or micromechanically suspended optical coatings  and photonic crystal slabs . Efficient optomechanical coupling in this configuration requires the size of the mechanical structure to be much larger than the wavelength of the light: typical cavity lengths range from  to , with an optical finesse up to , which is generally limited by losses due to the finite cavity mirror sizes. It has been pointed out that additional interference effects may be able to overcome this limit significantly . Compared to the macroscopic mirrors discussed above, these micromechanical devices allow access to higher mechanical frequencies (up to some tens of MHz) and, in principle, to higher mechanical quality factors. In particular, the possibility of exact geometric control via microfabrication techniques allows to minimize mechanical losses due to clamping .   The accessible mass and frequency ranges in combination with the restrictions on cavity length () and achievable cavity finesse set some practical limitations for this geometry. In particular, sideband-resolution (small ) and large optomechanical coupling  (small , leading to a large ) impose conflicting conditions and need to be traded against each other. On the other hand, along with the macroscopic microwave transducers (see Sec.), this realization provides optomechanical control over by far the largest range of mass and frequency.    Optical microresonators    A situation similar to the Fabry-Perot case occurs in optical microresonators, where light is guided in whispering gallery modes along the rim of a circular resonator . There is a large number of different mechanical normal modes of vibration of these structures. The resulting distortions of the structure directly modify the optical path length of the resonator, shifting its optical resonance frequency and hence generating optomechanical coupling. The small size of microresonators allows to achieve large coupling rates   and to access mechanical frequencies from several MHz up to some GHz. In essence, three different architectures can be distinguished: (i) Microdisk resonators, which are the standard resonator structure in planar photonic circuits and can be fabricated with high precision. Recent experiments have demonstrated large optomechanical coupling rates up to  Hz . A fundamental limit in their performance is given by radiation losses at the sidewalls. Another limitation is due to internal materials losses, which could be improved by using single-crystalline materials. A first demonstration in this direction, specifically optomechanical coupling to internal modes of a single-crystalline  resonator, has recently been reported . (ii) Microsphere resonators, which allow a larger optical quality ; there, the mechanical quality is mainly limited by internal materials losses, in particular for the often used silica microspheres. (iii) Microtoroidal resonators, which are obtained from microdisk resonators by a thermal reflow process that melts the sidewalls into a toroidal topology. The generated smooth surface together with the microfabrication control provides a combination of high optical  and high mechanical quality . This has resulted in the first demonstration of radiation-pressure driven optomechanical parametric amplification  as well as of sideband-resolved operation . Recently, hybrid toroid devices have been developed that combine optomechanical and electromechanical actuation .  The practical benefits of these geometries are the availability of large optical qualities in combination with the resolved sideband regime , essentially owed to the fact that the mechanical frequencies range from  to several . Possible limitations arise from the necessity to propagate light inside a solid-state medium, which increases the sensitivity to optical absorption and thermorefractive cavity noise.   Waveguides and photonic crystal cavities    On-chip waveguides and photonic crystal cavities offer a different implementation architecture.   Photonic crystals are formed by a periodic modulation of the index of refraction of some material (typically silicon), which leads to the formation of optical bands, in analogy to the electronic bands for electron waves propagating in a crystal lattice. Light cannot propagate in the band-gaps. Thus, when artificial defects are introduced into the periodic pattern, localized electromagnetic field modes  can form that do not decay into the continuum inside the structure. These structures are called photonic crystal cavities. To obtain an optomechanical device, in-plane photonic crystal cavities are underetched to form nanomechanical beams. The mechanical motion results in modulations of the cavity boundaries and stresses in the material, both of which contribute to the optomechanical coupling between the cavity photons and the mechanical modes of the structure. This has been demonstrated both for 1D  and for 2D  photonic crystal cavities . The small cavity dimensions in combination with the small mass of the localized mechanical mode result in an optomechanical coupling strength that is much larger than in regular Fabry-Perot approaches, with current experiments achieving . The available mechanical frequencies can range from several tens of  up to several , which significantly reduces the environment thermal occupation . The idea of creating bandgaps by inducing periodic boundary conditions can be extended to the modes of the mechanical beam. Introducing a surrounding periodic structure matched to the phonon wavelength (``phonon shield'') results in a 1D photonic crystal cavity with co-localized photonic and phononic modes with a significantly increased mechanical quality ; see  for more on the design of 1D and 2D optomechanical crystals . It is also possible to integrate two-level quantum systems inside the photonic crystal nanobeam, e.g. by fabricating photonic crystal cavity nanobeams out of diamond  or out of GaAs , which can include artificial qubits formed by for example nitrogen vacany (NV) centers or by quantum dots, respectively. Another possibility is to have hybrid devices with both optical and electrical actuation .  Currently, because of the large available coupling rates , this approach may allow to enter the regime of nonlinear photon-phonon interactions (see Sec. ). Moreover, the large mechanical frequencies in the  range could allow for low-temperature operation in a regime where the average phonon number drops below one even without additional laser-cooling. This would be highly beneficial for quantum applications. Finally, the in-plane architecture is immediately compatible with the architectures of integrated (silicon) photonics and provides a direct route to larger-scale optomechanical arrays, which is interesting in the context of classical and quantum information processing, and for the study of collective dynamics (Sec. ).   It should be noted that optomechanical forces can become strong even in the absence of a cavity, for structures with waveguides running close to a substrate or close to each other. This approach (while somewhat outside the domain of the concepts covered in the present review) could be very fruitful for applications, since it does away with the bandwidth restrictions generated by a cavity . In another equally promising development, the  acoustic vibrations of photonic crystal fibres are being excited and controlled via optomechanical interactions .   Suspended and levitated nano-objects    This class of cavity optomechanics implementations uses a rigid optical cavity that contains a mechanical element either inside the cavity or in the near field of the cavity. It allows in particular the efficient optomechanical coupling to sub-wavelength size mechanical objects, which has been demonstrated for systems such as high-quality mechanical membranes made of high-stress SiN , stochiometric SiN  or AlGaAs , and for carbon nanowires , which have been suspended inside state-of-the-art Fabry-Perot cavities. The embedded nano-objects modify the cavity field either via dispersion  or via dissipation, as suggested in .  An alternative approach to Fabry-Perot resonators is to exploit near-field effects close to the surface of optical microresonators, where the evanescent optical field allows dispersive coupling to other structures. In essence, the mechanical motion modulates the distance  between the interfaces. Due to the near-field character the optomechanical coupling strength scales exponentially with d and hence allows to generate large values for . This has been used to demonstrate optomechanical coupling between a toroidal microcavity and a nearby SiN nanomechanical resonator . Another related possibility is to couple two mechanically vibrating microdisk resonators  or two photonic crystal cavities  via their optical near field.   In order to further suppress mechanical clamping losses, it has been suggested to levitate the mechanical objects either by an additional optical dipole trap or in the standing wave trap formed by the cavity field . This implementation allows a direct extension to matter-wave interferometry  and may enable fundamental tests of quantum theory in a new macroscopic parameter regime (see also Sec. ). The necessary parameter regime for such tests is experimentally challenging  and may even require a space environment . Levitation of micrometer-size  and sub-micrometer size  silica spheres has already been demonstrated in optical dipole traps in high vacuum. An alternative approach could be to combine optical trapping with a low-frequency mechanical suspension , which has been suggested to lead to thermal decoupling of similar quality as purely optical trapping () .  A prominent feature of such setups, with a nano-object inside the standing light wave of a cavity mode, is quadratic coupling to position. The optical frequency shift may be no longer linear but rather quadratic in the mechanical displacement, if the object is placed at a node or antinode. This could lead to interesting applications, such as QND detection of single phonons, as explained in Sec. . These setups have also been suggested to strongly couple two nano-objects, for example a mechanical membrane to a single atom  (see Sec.).   Microwave resonators    Analogous to optical cavities, LC circuits form a resonator for electromagnetic radiation in the microwave regime, i.e. . The motion of a mechanical element capacitively coupled to this microwave cavity results in a shift of capacitance, and thereby of the LC resonance frequency (). Thus, one obtains the standard cavity-optomechanical radiation pressure interaction. The first experiments along this line have been performed by Braginsky and co-workers , and later in the context of resonant bar gravitational wave detection ; already back then these works have demonstrated both cold damping and optomechanical backaction effects such as cooling and parametric amplification. Later, in the context of ion-trap physics, cooling of a micromechanical resonator via an LC circuit was shown . With the advent of microfabricated superconducting circuits it has become possible to enter the size and frequency regime of nanomechanical devices coupled to microwave cavities . Typical available mechanical frequencies range from some  to some tens of . In order to resemble a low-entropy reservoir of the radiation field, which is of particular importance for quantum optomechanics (see Sec. ), the microwave photons need to be kept at cryogenic temperatures. For  photons, environment temperatures in the mK regime are sufficient, which necessitates operation inside a dilution refrigerator. Although the momentum transfer of microwave photons is several orders of magnitude smaller compared to photons at optical frequencies, the bare optomechanical coupling rates  can be made comparable to (or larger than) implementations in the optical domain . The essential idea is to have a very small coupling gap and to optimize the fraction of the total capacitance that responds to the mechanical motion (see also Fig.  ).   A current practical challenge for the microwave schemes is the sparse availability of quantum optics techniques such as the preparation and detection of Fock states or of squeezed states of the radiation field. However, several recent proof-of-concept experiments have demonstrated their availability in principle .   As a sidenote, capacitive coupling has also been used to couple nanomechanical objects directly to two-level quantum systems, e.g. to a superconducting Cooper-Pair box  or to a superconducting phase qubit . Note finally that the coupling need not be capacitive. Recently, it was shown that a microwave resonator can also be coupled via dielectric gradient forces to the vibrations of a nanobeam . This makes available a larger range of materials, which could be beneficial for applications.    Ultracold atoms    The ideas of cavity optomechanics have also been implemented by using clouds of up to  atoms. Their collective motional dynamics can resemble a single mechanical mode that, for the case of ultracold atoms, is already pre-cooled to its quantum ground state of motion. In one case, the collective motion of a cloud of ultracold Rb atoms inside a Fabry Perot cavity was used to observe signatures of shot-noise radiation pressure fluctuations . The dispersive coupling of the collective motion of the cloud to an optical cavity field results in a position-dependent frequency shift and therefore to quantum optomechanical interactions.   Suppose the single-photon dispersive energy shift of a single atom sitting at an antinode of the standing light wave pattern is , with  the atom-cavity vacuum Rabi frequency, and  the detuning between atom and cavity resonance. Then the coupling Hamiltonian between the cavity mode and an atom cloud of  atoms trapped near position  would be . Expanding to lowest order in , this yields a bare optomechanical coupling rate     where  denotes the zero-point fluctuations of a single-atom in the trapping potential, that is  times larger than  of the center-of-mass motion of the cloud. Here we have assumed that the extent of the cloud is small with respect to the wavelength. Sometimes the cloud is actually distributed over several lattice sites. Note that the trapping potential could be provided by another optical lattice or magnetically. Incidentally, we note that the same kind of derivation applies for trapped dielectric particles (Sec. ). We also mention that if the atoms are trapped right at a node or antinode, the leading optomechanical coupling is to  instead of , which leads to different physics (e.g. as in Sec. ).   In another experiment, cavity optomechanics was used to cool the motion of a thermal cloud of Cs atoms trapped inside an optical cavity . Finally, density fluctuations in a Bose-Einstein condensate of  atoms have been used as the mechanical mode inside a Fabry-Perot cavity . In both ultracold cases, due to the strong dispersive atomic coupling and the small mass (leading to a large zero-point motional amplitude), operation was close to the single-photon strong coupling regime, .   More recently, a setup has been demonstrated that couples the motion of a vibrating mirror to the motion of atoms trapped in a standing light wave being reflected from that mirror , without an optical cavity.   Basic consequences of the optomechanical interaction     Static phenomena: Optical potential and bistability    We first deal with the simplest case, when the light force reacts instantaneously to the mechanical motion. This will be relevant for . Then, the radiation pressure force  depends on the displacement  via , the photon number circulating inside the optical mode. Such a 1D conservative force can be derived from a potential (Fig. ):     For the case of a single, high-finesse optical resonance we have , where  is the maximum number of circulating photons, obtained at resonance (proportional to the incoming laser intensity). As a result,     Note that for the case of photothermal forces, the discussion still applies, only with a different prefactor in . The overall potential for the mechanical motion also includes the intrinsic harmonic restoring potential:     The first effect of the radiation force is to shift the equilibrium position to , with . In addition, the effective spring constant is changed to its new value     where the second contribution is called ``optical spring''. In particular for low-frequency mechanical modes, this term can be orders of magnitude larger than the intrinsic mechanical spring . Such an approach essentially amounts to a variant of optical trapping and can be exploited to diminish the unwanted mechanical dissipation and heating connected with the intrinsic mechanical spring being attached to a substrate. In the limit of low light intensity, the resulting correction for the mechanical frequency (obtained from ) is      This corresponds to the limit  of the dynamical case discussed below (note the relation between  and ).  At larger light intensities  may develop into a double-well potential, with two local minima, leading to what we may term static bistability. Both of these minima correspond to stable equilibrium positions, determined by the nonlinear equation . Physically, they represent situations with low/high light intensity and low/high restoring force. The bistable behaviour will occur at negative detunings, , roughly when , such that the original equilibrium position becomes unstable. As negative detunings are necessary for cooling, the bistability limits the achievable cooling laser intensities for the case .   More quantitatively, analysis of the equation  shows that bistability sets in first (at a single value of ) when the maximum correction to the spring constant, , obtained at , equals the intrinsic spring constant . This happens at a critical detuning of  and at a critical laser power determined by     where we employed the relations  and . At higher light intensities, the range of detunings for which bistability is observed widens. In experiments, bistability is revealed in hysteresis, e.g. when recording the transmission or phase shift while sweeping the detuning up and down. The first experiments on optomechanical bistability, with a macroscopic mirror, were reported and analyzed already in the 1980s, both in the optical  and in the microwave domain .  For low-finesse systems, nearby optical resonances may also become relevant for the mechanical motion, leading to a more complicated effective potential, possibly with several local minima (Fig. ).             Dynamical backaction    We now turn to dynamical effects, due to the retarded nature of the radiation pressure force.                To derive the dynamics arising from the optomechanical coupling, one can solve the linearized coupled equations of motion for the light and the mechanics, as presented in section . This is best done in frequency space. We employ the classical linearized equations Eqs. () and () as the basis for our following analysis. This is possible since we will be only interested in the linear response to an external mechanical force, and the averaged linearized quantum equations are identical to their classical version (and do not contain the noise sources anymore).          In the absence of optomechanical coupling, the mechanical oscillator has the susceptibility  (see Sec. ). We will now assume that a weak test force  acts on the mechanical oscillator in the presence of the optomechanical interaction. Solving the coupled set of equations, we can find the mechanical response to that force. This defines the modified mechanical susceptibility, which can be expressed in terms of the original susceptibility plus some modification      :   _xx^-1() & =_xx,0^-1()+()  The coupled equations () and () are solved by expressing  in terms of  and inserting the result into the equation for . This yields the modification of the linear response to an external force:     , where we employed the relation  and obtain . For now, we just define     such that the new terms have the structure that is suggested by the form of the original susceptibility, leading to:     The real and imaginary parts then yield the frequency-dependent mechanical frequency shift  and optomechanical damping rate , whose meaning will be discussed further in the next section. The explicit expressions are (by taking real and imaginary parts, , and ):   * _m()= & g^2_m[+(+)^2+^2/4+(2+^2/4]  _opt()= & g^2_m[(+)^2+^2/4-(2+^2/4]  These expressions provide an exact solution of the linearized problem that is also valid in the regime of strong coupling, where  (Sec. ). Also note that the effect is linear in the laser drive power, i.e. in the circulating photon number: . In the next sections we discuss the resulting physical phenomena, i.e. optical spring effect and amplification and cooling.  The frequency dependence of  will in general yield a non-Lorentzian lineshape for the susceptibility that will even turn into a double-peak structure at strong coupling (Sec. ). However, for sufficiently weak laser drive (), it is permissible to evaluate  and  at the original, unperturbed oscillation frequency . Then, we just have a shifted and broadened mechanical resonance. This picture also explains why we need the assumption  for this approach to hold. A high-Q mechanical oscillator samples the optical density of states at , with a small frequency linewidth  that can be neglected as long as . We will now discuss both quantities, the frequency shift and the damping rate, under this assumption.                         Optical spring effect    We find, with , for the frequency shift of the oscillator induced by the light field:     In the limit of large cavity decay rate (i.e. the Doppler regime, ), this formula yields:     This implies that the mechanical oscillator will be spring-softenened for a red-detuned laser beam (), and spring-hardened for a blue-detuned laser ().   Note that the frequency shift takes a markedly different form when entering the resolved sideband regime. Here, the optical spring effect vanishes at certain detunings and the radiation pressure contributes only to cooling or amplification.    Optomechanical damping rate      Using the same approximation as for the optical spring effect, the optomechanical damping rate is given by the expression   _opt & =n_cavg_0^2(^2/4+(+_m)^2-^2/4+(m)^2)  This yields the full effective mechanical damping rate:     Since  can be both positive and negative, it can either increase or decrease the mechanical damping rate, i.e. cause extra damping or anti-damping. Extra damping leads to cooling (Sec. ), while anti-damping can lead to amplification of thermal fluctuations and finally to an instability if the full damping rate becomes negative,  (see Sec. ).   This behavior can also be observed experimentally: Figure  shows the damping rate and optically induced frequency shift for different ratios of .   The physical origin of the optomechanical damping rate can be described in several ways.              Mechanical picture. Cooling and heating can be understood by the following mechanical consideration. As the mechanical oscillator is performing its harmonic motion, it traces a trajectory in the diagram of radiation pressure force vs displacement, as shown in Fig.  . In the limit where , the intracavity field (and the associated radiation pressure force) respond instantaneously to the oscillator motion. If, however, we still take into account the remaining cavity retardation, this leads to the radiation pressure force getting out of phase with the mechanical motion. We then can split the force  into a component  in-phase with the motion  (responsible for the optical spring effect) and an out-of-phase quadrature term  (responsible for cooling or heating). In the diagram this implies that the oscillator motion traces out no longer a line but an area. The sense in which this area is encompassed gives the direction of energy flow, i.e cooling or amplification.   Scattering picture. Writing the optomechanical dynamical backaction in the above fashion allows to gain physical insight into the origin of cooling and amplification. The expression consists of two terms which are essentially the cavity buildup factor  evaluated at the frequencies  and . These terms describe the strength of the motional sidebands of the intracavity field, generated due to the cavity frequency oscillating because of the motion  of the mechanical oscillator. Perturbation theory analysis of the classical coupled mode equations reveals that the intracavity field consists of sidebands :     where  is the unperturbed field and  contains the Stokes  and anti-Stokes  sidebands:      These two sidebands become asymmetric for nonzero laser detuning due to the cavity density of states. Applying energy conservation implies that the mode-density induced sideband asymmetry extracts or adds power to the mechanical oscillator by shifting the frequency of the pump photons     , i.e. , which yields a cooling rate identical to the expression derived above ( denoting the cavity round trip time). Consequently cooling and amplification can be viewed to originate from the imbalance of Stokes and anti-Stokes scattering.   For the case of resolved sidebands () the cavity absorption spectrum  develops a series of sidebands due to the mechanical oscillator's motion, similar to the absorption spectrum of an oscillating ion  (Fig. ):      Here  denotes the modulation index. For the simple case of a weak coherent oscillation (with amplitude ) one obtains to lowest order two sidebands only, i.e. . The lower and upper motional sidebands that appear in the spectrum are, in analogy to trapped-ion physics, related to motional increasing and motional decreasing scattering processes          .  Feedback picture. Finally, one can also understand the cooling by considering a feedback picture. In this picture the mechanical oscillator motion modulates the cavity field, the latter gives rise to a radiation pressure force, which in turn acts back onto the mechanical oscillator. Cooling arises again from the phase relationship (retardation) between the mechanical motion and the radiation pressure force. Note that the feedback is not entirely noiseless: quantum noise adds to the intracavity radiation pressure force, giving rise to a quantum limit of cooling treated in section .  It is instructive to consider several limiting cases of the cooling rate expression.              Resolved-sideband regime. First, in the limit where the mechanical frequency is much larger than the cavity decay rate () the cooling rate exhibits pronounced maxima and minima near the lower and upper sideband (). The maximum cooling rate is attained on the lower sideband ():        The cooling rate in the resolved sideband regime can also be expressed in a different way, as detailed in . In the resolved sideband regime (considering an overcoupled single-sided cavity for simplicity), the relation between intracavity photon number and input power is given by , thus:      As one can see, the cooling rate in the sideband limit does not depend on the cavity linewidth.   Doppler regime.  In the unresolved sideband regime (Doppler case, i.e. ), the maximum cooling or amplification rate is reached for a detuning equal to :        Note that in this case the mechanical cooling and amplification rate exhibit a strong dependence on the inverse (cubic) cavity decay rate. This shows that the cooling rate strongly diminishes in the Doppler regime.  Note that sub-Doppler cooling in the unresolved sideband regime can still be achieved by using pulsed optical pumping schemes .    Quantum optical measurements of mechanical motion    One of the principal advantages of cavity optomechanical systems is the built-in readout of mechanical motion via the light field transmitted through (or reflected from) the cavity. In the following, we will discuss several variants of optical measurement schemes. We first address the measurement of position, where we will find that quantum mechanics places fundamental restrictions on the overall precision in the regime typically employed in experiments (i.e. weak measurements). Then we discuss alternative schemes, where there are no such limitations. Some supply a measurement of a selected quadrature of mechanical motion, i.e. the amplitude of the  or  contribution to . Other schemes measure the discrete phonon number. Both approaches are examples of so-called quantum non-demolition (QND) measurements. We close the section by pointing out some experimental issues in phase measurements, and by discussing feedback cooling based on the possibility of precise read-out.    Parametric displacement sensing and the standard quantum limit (SQL)    Measuring the displacement of a mechanical resonator via the transmission or reflection phase shift typically involves integrating the data over a long time, in order to suppress the noise. It is therefore an example of a weak, continuous measurement. It turns out that such a measurement applied to the coordinate of a harmonic oscillator cannot be more precise than what is known as the ``standard quantum limit''. In the following we give a brief qualitative and quantitative discussion. More about this topic can be found in .   Introduction and qualitative discussion  The optical cavity represents an interferometer and thus allows a direct measurement of the mechanical position via the phase shift of transmitted or reflected light. In practice this requires either a homodyne or heterodyne detector, in which the signal is brought into interference with a local oscillator that serves as a phase reference. The optomechanical cavity frequency pull  is converted into a phase shift  imparted on the photons during their lifetime  inside the cavity (assuming slow motion, ). If one tries to measure this phase shift using  photons passing through the cavity (and interfering with a reference beam to read out the phase later), then the fundamental uncertainty relation between number and phase yields a shot-noise limited imprecision of . It seems that this would allow for an arbitrarily precise readout, provided one uses a sufficiently large number of photons. Indeed, this would be true for an instantaneous readout with a very intense flash of light.  However, in many experiments one rather performs a weak measurement: The noisy signal  determined from the phase measurement is effectively integrated over many oscillation periods to average away the noise and get a sufficient signal-to-noise ratio. That this will pose a problem can be seen from the general quantum-mechanical uncertainty principle which states that it is impossible to follow the trajectory  of a particle with arbitrary precision (or, to know both position and momentum at the same time). It is instructive to see qualitatively how that limitation is enforced in our case. The fluctuating radiation pressure force (again, due to the photon shot noise) imprints an unavoidable jitter on the mechanical motion. Each of the photons imparts a random kick, and their overall effect on the momentum and position will grow like , as in a random walk. That effect is called ``backaction noise'' and counteracts the increase of phase readout precision at large . Thus, there is an optimum at intermediate photon numbers, where the sum of the two effects is minimal.   The quantitative analysis outlined below will be phrased in terms of noise spectra, describing the imprecision and backaction noise contributions to the overall measurement error. In that context, the appropriate question to ask is how large the error is given a certain measurement time (which sets the bandwidth over which the spectra are to be integrated). In thermal equilibrium, the mechanical oscillator's phase and amplitude will fluctuate on the scale of the damping time . Thus, this is the longest reasonable measurement time at our disposal. The outcome of the analysis will be that one can determine the trajectory (or rather its two quadratures) up to a precision given by the oscillator's zero-point fluctuations  during a time . This statement (see Eq. ()) is known as the ``standard quantum limit'' of displacement detection in a weak measurement. It is independent of whether the oscillator is in its ground state or at high temperatures.                        The standard quantum limit  Let us first state more formally why there must be a standard quantum limit. The oscillator's trajectory can be decomposed into quadratures:     where  and  remain constant during intervals smaller than the damping time. Since  and , the commutator  carries over to  and , yielding . Heisenberg's uncertainty relation thus reads     , and any simultaneous measurement that tries to measure both quadratures with equal precision is limited to .     Here we only discuss the most important results. For a much more extended recent discussion of the quantum limits to weak measurements we refer the reader to . We will consider a single-sided optical cavity driven at laser detuning  (the optimal case), where the number of photons circulating inside the cavity is . All noise spectral densities will be symmetrized in frequency (indicated by ).  The noise in the optical phase readout  induces an imprecision in the  measurement, where , as discussed above. Inserting the photon number , we find . This can be understood as the integral of a flat noise spectral density  over the bandwidth  set by the measurement time . The complete expression for the quantum noise limited imprecision noise spectral density reads:     where we also kept the growth of the noise at higher values of . This is due to the fact that the cavity is a low-pass filter, suppressing the contribution of motional frequencies  to the phase output. On the other hand, the phase noise itself is independent of , so referring it back to the input leads to larger imprecision at higher .  At the same time, the backaction noise force has the following spectral density (cf. Sec. ):   S_FF() & =n_cav4^2G^2(1+4^2^2)^-1  In general, the product of imprecision noise and backaction force noise densities fulfills a fundamental inequality, see e.g. , a variant of the Heisenberg uncertainty relation:    In our particular case, we see that the equality ``'' is realized, i.e. the cavity displacement detector is as good as allowed by quantum mechanics.   The total noise registered at the detector, expressed in terms of  (``referred back to the input''), reads:    Here we have added the intrinsic thermal fluctuation spectrum, the imprecision noise, and the effect of the backaction noise force on the displacement, calculated via the mechanical susceptibility  (see Sec. ). In doing so we have assumed a situation where there are no cross-correlations between the force noise and the imprecision noise. See  for a more complete discussion including the general case. In the following, we will denote the sum of the imprecision and backaction noises as the total added noise, . Inserting the relation (), and treating  as variable (e.g. by tuning ), we can minimize . The minimum (at any given, fixed frequency) is reached at , and this yields . By using the quantum FDT at  (see Eq. ()), we can introduce the spectral density of mechanical zero-point fluctuations, . We arrive at the fundamental inequality     This is the standard quantum limit (SQL) of weak displacement detection. The measurement adds at least the zero-point noise, on top of the intrinsic fluctuations. Roughly speaking, the effect on the noise looks as if the oscillator's energy were increased by , i.e. half a phonon. However, only the backaction contribution really corresponds to a physical increase of the oscillator's effective temperature, and at the SQL this contribution is half of the overall effect, i.e. , the other half being provided through the imprecision noise.  If we measure at the mechanical resonance, , then the added noise of the cavity displacement detector is . This corresponds to the zero-point fluctuations, in a measurement time , just as stated in the introduction. Obviously, if one is limited by laser power, it is better to have a high-quality oscillator (small ), which boosts  and makes it easier to reach that imprecision level. The power to reach the standard quantum limit therefore is a natural expression to characterize a transducer. It is given by the expression:       Both the imprecision noise and the backaction noise are shown as a function of laser power (or optomechanical coupling) in Fig. . When referring to ``precision beyond the standard quantum limit'' in this context, one wants to emphasize that one can make the imprecision noise alone lower than the SQL (which implies the backaction noise is already appreciable). This situation has been achieved in optomechanical systems for mechanical oscillators of nanoscale  and microscale dimensions .  The observed thermal noise at any large temperature can also be used to obtain the value of the standard quantum limit via the relation     This is a useful expression, since it is independent of the calibration of the  measurement.                   In the context of measurements at the SQL, an important step for optomechanical experiments is to observe the effects of radiation-pressure shot noise on the mechanical oscillator. This has now been achieved already in cold atom setups , which are conducted routinely at low temperatures, and where the particularly low effective mass of the atomic cloud leads to a very strong single-photon coupling rate . This is of advantage, since the ratio of quantum backaction to thermal force noise (at ) is given by:     These atomic cloud experiments have allowed to access the radiation pressure shot noise spectrum, e.g. via tracking the heating of the cloud (see Figure ).                         Current solid-state based devices still exhibit both significantly smaller ratios  and deleterious effects of thermal noise, which make the observation of radiation pressure shot noise effects a challenging task. One possible strategy is to measure the cross-correlations between a strong beam exerting radiation pressure force fluctuations and another beam measuring the resulting displacement fluctuations (; see also  for a more recent analysis). This idea has been demonstrated for a model situation with deliberately introduced classical noise instead of the quantum shot noise of a laser beam . In another experiment, it was demonstrated how the radiation pressure backaction can be employed for amplifying an interferometric signal, which can lead to a sensitivity lower than the SQL . Recently, first signatures of a direct observation of radiation pressure shot noise have been reported .   Optical QND measurements    The weak displacement measurements discussed in the last section effectively try to measure non-commuting observables simultaneously, namely the two quadrature components of motion. They are therefore limited fundamentally by the Heisenberg uncertainty principle. However, it is also possible to perform measurements of a single observable. This observable can be measured with arbitrary precision, thereby approaching an idealized projection measurement. Repeating the measurement before the state had a chance to decay would reproduce the same outcome. This is because the system's Hamiltonian commutes with the observable (neglecting decay). Therefore such measurements are called quantum non-demolition (QND) . These have been successfully realized in the quantum optical domain .   Single quadrature measurements    It is possible to optically measure only one quadrature component of the mechanical motion to arbitrary precision . This is important, since it can be used for a full reconstruction of the mechanical quantum state, extracting its Wigner density using quantum state tomography (see below). In addition, it can serve to measure the correlation of mechanical quadratures with either the light field quadratures or those of another mechanical object. The resulting correlators can then be used to test for entanglement. The fundamentally limited precision of a standard displacement measurement would not be sufficient for such tests.  One way of achieving this makes use of a simple property of harmonic motion: Any force applied at time  does not affect the position a full period later, at . Thus, the unavoidable perturbation of the momentum connected with a position measurement does not destroy the precision of ``stroboscopic'' periodic observations at times . An equivalent but more practical approach is to do a displacement measurement with a laser beam (at detuning ) whose intensity is modulated at frequency . This reads out only one quadrature (say, ) in the decomposition     whose phase  is determined by the phase of the laser amplitude modulation. The backaction noise exclusively affects the other quadrature . All this can be derived in the Hamiltonian formulation (Sec. ). Suppose the modulated drive yields an intracavity amplitude , in a frame rotating at the cavity resonance. Then the standard linearization gives     where we have omitted rapidly oscillating terms and adopted the rotating frame for the mechanical resonator in the second step. This is a QND Hamiltonian for measuring . Deviations from this idealized picture are small in the resolved sideband limit, i.e. for . As a side-effect, the state conditioned on the measurement result becomes squeezed, since the variance of  after the measurement approaches zero. First experimental steps along these lines have been taken in .  There is an alternative approach for QND detection of single quadratures: measuring much faster than the oscillation period of the mechanical resonator. Such an approach requires very short, intense laser pulses that essentially implement an instantaneous projection measurement of displacement. Picking another quadrature to measure then simply involves performing the measurement at another time, when the phase of the harmonic oscillations has advanced. This approach has been proposed and analyzed in . Because of the short pulses, this scheme operates in the non-resolved sideband regime . First experiments in this direction have recently been reported in . It has also been pointed out that properly controlled pulse sequences can alter the effective optomomechanical interaction, enabling for example sub-Doppler cooling rates in the non-resolved sideband regime .  In both of these approaches, quantum state tomography  then would work by repeatedly preparing the same mechanical state, measuring the probability densities of the quadratures at a large number of phases , and applying the inverse Radon transform to obtain the Wigner density.   Reconstruction of the Wigner density of quantum states of vibrational motion has, for example, successfully been achieved for ions .              Mechanical Fock state detection    Another crucial observable in the mechanical oscillator is the phonon number . It is especially important, since measuring the discrete Fock states  is a very direct proof of the quantum nature of an oscillator. We note that the first measurements of phonon number in a fabricated, mesoscopic mechanical oscillator have recently been performed in a nanoelectromechanical system, exploiting the strong interaction between a piezomechanical vibration and a superconducting qubit . Here we discuss a route towards observing quantum jumps between mechanical Fock states in an optomechanical system .  The idea is that any measurement of  instead of  will be closely connected to the oscillator's energy, and thus the phonon number. This then permits QND detection of the phonon number in a mechanical resonator (for an early detailed analysis of this concept in an anharmonic two-mode nanomechanical system, see ). In practice, for an optomechanical system this requires changing the standard setup to another variant where the light field couples to the square of the displacement. That can be achieved for example by placing a thin membrane (or any other dielectric object) inside an optical cavity and positioning it near a node (or antinode) of the standing light wave that forms one optical mode. In that case, the light intensity at the object's position, and thereby the object's effect on the optical resonance frequency, depends quadratically on the displacement . The optomechanical coupling (sometimes termed ``dispersive'' in this case) thus reads     where . If the membrane is highly reflecting, an alternative way of deriving Eq. () is to focus on two optical modes (to the left and right of the membrane). Their coupling, provided by photon tunneling through the membrane, then leads to an avoided level crossing in the optical spectrum as a function of . At the degeneracy point, both the upper and lower optical branch frequencies are extremal , leading to Eq. () for each of them. Quadratic couplings have recently also been observed in a cold atom setup .  The phase shift observed in reflection from the cavity will measure , but averaged over the photon lifetime . If , the time-average of this term reduces to . Alternatively, one may keep only this contribution in Eq. (), invoking the rotating wave approximation. Thus, this setup in principle allows a QND measurement of the phonon number. Cooling the oscillator to near its ground state and then measuring the phase shift vs. time, one should be able to observe quantum jumps between mechanical Fock states, similar to the jumps that have been observed between photon number states . To this end, the phase shift  induced by a single phonon must be resolved during the lifetime  of the ground state, by reflecting a sufficient number of photons from the cavity. Note that one must suppress any deviations from the ideal case, such as imperfect placement away from the degeneracy point  or deviations from a perfectly one-sided cavity. Such deviations lead to extra noise acting on the membrane that hampers the phonon QND measurement. A careful analysis  shows that this requires , where  includes any absorption in the membrane or cavity, but not the ``good'' decay channel through the entrance mirror. In practice, for setups where , this is identical to the single-photon strong coupling regime, to be discussed further in Sec. .  Detailed quantum jump trajectory simulations of the phonon detection process have been first presented in , for the idealized case of a single optical mode. More recently, studies of the complete two-mode setup  have been able to reveal the physics discussed above .  The detection of quantum jumps between mechanical Fock states is obviously extremely challenging. However, one might detect quantum signatures of the mechanical oscillator in another way: When driving it strongly into a coherent mechanical state of mean phonon number , there will be Poissonian phonon shot noise of size . A setup like the one described above may then detect this noise, which reveals the granularity of mechanical quanta , much in the same way that measurements of electrical current noise can reveal the charge of the charge carriers . Furthermore, higher moments of the phonon shot noise may be observed in this way as well. These display distinctly nonclassical features  for an in-depth analysis see .                   Optical feedback cooling (cold damping)     The high sensitivity provided by the cavity readout of mechanical motion can also be used for directly cooling the mechanical motion via active feedback. The main idea is to obtain the oscillator position by a phase-sensitive detection of the cavity output and to use it to generate a negative feedback on the oscillator, i.e. a force  proportional to the time derivative of the output signal. This increases the damping rate of the system by  without increasing the thermal noise (cold damping). The scheme has been suggested in  and has been experimentally realized in several optomechanical devices  with radiation pressure as the feedback force. Because the scheme relies on the precise readout of the instantaneous oscillator position, the ideal configuration comprises both weak coupling and a fast cavity decay, i.e.  (adiabatic regime). The quantum limits of this cooling method have been discussed in  and it has been shown that ground-state cooling by cold damping is possible. A detailed discussion can be found for example in . The maximum amount of cooling is limited by the imprecision of the read-out. An important aspect here is the phenomenon of ``noise squashing'', where the noise on the detector and the noise-driven motion of the mechanical oscillator become correlated (see Fig. ).             In the context of cold atoms, feedback cooling of a single neutral atom has been implemented in a cavity QED setup .   Optomechanical cooling    Optomechanical quantum control requires the mechanical oscillator to be in or near its quantum ground state. Unless the mechanical frequency  is in the  range (which is true only for some recent nanomechanical setups ), even dilution refrigerator temperatures of  are not sufficient to ensure . Thus, additional cooling of the selected mechanical mode is needed.   In a previous section (Sec. ), we have already discussed dynamical backaction effects and the resulting optomechanical damping rate. It is obvious that this can be used for cooling the mechanical motion. The purpose of the present section then is to develop the quantum theory of cooling, which in particular describes the limits for cooling that cannot be obtained from a discussion of the damping rate alone. We will focus in this section on intrinsic cavity cooling. For a comparison of this approach to feedback cooling (discussed above), see .   A simple classical theory of an oscillator at initial temperature  subject to extra damping  (proportional to the laser power) would predict that its temperature is reduced down to     However, this classical expression ceases to be valid at sufficiently low , when the fluctuations of the radiation pressure force due to photon shot noise set a lower bound to the achievable temperature. In the following, we discuss the full quantum theory that permits to calculate the quantum limits to cooling and predicts that, in many cases, ground state cooling is possible only in the resolved sideband regime .   It should be noted that sideband resolution does not intrinsically prohibit optomechanical ground state cooling. For example, the displacement may not only couple to the cavity frequency, , but also to the decay rate, yielding . This mechanism is quite plausible both for nano-objects that scatter light out of the cavity (depending on where they sit in the standing light wave pattern), and for vibrating objects that are evanescently coupled to some tapered fibre, as well as for other geometries. This kind of behaviour has been observed experimentally , and it has been predicted  that this can yield novel behaviour for cooling, with the possibility of reaching the quantum ground state even when . Similar results hold for pulsed cooling schemes  and photothermal cooling.  Another interesting option is to consider a nonlinear medium inside a cavity, which may enhance the efficiency of cooling .  Finally, one could do away with the cavity by exploiting other sharp changes of radiation forces as a function of wavelength. This has been proposed e.g. for a Bragg mirror  or for microspheres with their narrow internal whispering gallery resonances .   We will focus on radiation pressure cooling in cavity setups, which is conceptually the simplest case. Recently it has been argued that photothermal forces, which have been exploited for optomechanical cooling early on , could in principle also lead to the quantum ground state .    Quantum theory of radiation pressure cooling       In the following, we will work in the weak coupling regime, , where a perturbative picture applies. The quantum theory of optomechanical cooling  is related to earlier approaches for trapped ions  and for cavity-assisted laser cooling of atomic and molecular motion . The idea is best explained in a Raman-scattering picture. Photons impinging at a frequency red-detuned from the cavity resonance will, via the optomechanical interaction, preferentially scatter upwards in energy in order to enter the cavity resonance, absorbing a phonon from the oscillator in the process. As a consequence, they will be reflected blue-shifted by , carrying away a quantum of mechanical energy. These ``anti-Stokes'' processes happen at a rate  (to be calculated below). More precisely, the transition rate from phonon state  to  will include a bosonic factor ,     The ``Stokes'' process, where photons return red-shifted and leave behind an extra phonon, happens at a smaller rate  (with ) due to the suppression in the final density of available photon states, if the laser is red-detuned. Note that we choose to follow the notation  for these rates, as it is used in the context of atomic laser cooling.  Given these rates ( for upward transitions in the mechanical oscillator,  for downward transitions), the full optomechanical damping rate is the net downward rate,     The average phonon number  (with the Fock state populations ) changes according to the rates , leading to:     Here we have introduced the extra transition rates due to the oscillator's thermal environment, which has a mean phonon number :  and . In the absence of optomechanical effects, these would establish equilibrium at . Now, however, the steady-state final phonon number (requiring  in ()) will be     Even in the optimal case, i.e. in the absence of any coupling to a mechanical thermal environment (), this leads to a minimal phonon number of                    The rates  can be calculated using Fermi's Golden Rule, applied to the interaction of the oscillator with the fluctuating radiation pressure force: , where  according to Eq. (). In the weak coupling limit, all the transition rates can be calculated once the quantum noise spectrum  of the force is known (see e.g.  for more on quantum noise spectra). Re-expressing the result in terms of noise spectra yields:     where we introduced the photon number noise spectrum . Exploiting shifted photon operators, one can show  that the photon number spectrum of a laser-driven cavity is     Inserting this into Eq. (), one obtains  and from there the optomechanical damping rate , which coincides with the expression obtained using the linearized equations of motion (Sec. , Eq. ()). We obtain the final minimum phonon number () as     Experimentally, one can still vary the laser detuning  to minimize this expression. In the resolved sideband regime , this leads to     which permits ground state cooling, while in the opposite limit () we find       These two results are almost identical to the case of atomic laser cooling (in the atomic laser cooling expressions, a scalar prefactor is different due to the directional dependence of the spontaneous emission).            In the presence of a thermal environment, the final phonon number () can be written as the result of coupling to two baths at average occupations  and  with coupling rates  and , respectively:       Finite thermal cavity occupancy. This formula is modified when the cooling field has thermal occupation. This is in particular the case for microwave fields due to their low frequency. If the cavity occupation is given by , then the final occupation is modified to (in the resolved sideband limit):    This implies that the final phonon number can never be below the effective thermal occupation of the drive field . It should be noted that when the radiation field and the mechanical oscillator initially have the same bath temperature (as will be the case in equilibrium, without extra absorption), the equilibration of these two oscillators of frequency  and  will lead to an effective cooling of the lower frequency mechanical oscillator, as                Equations-of-motion approach. An alternative way to calculate the final phonon number is to write down the linearized equations of motion for the oscillator and light field, eliminate the light field dynamics, and exploit the known spectra of the quantum Langevin forces driving both the mechanics and the cavity (see Sec. )            .  We do this by considering the influence of the quantum backaction force noise driving the mechanical oscillator. Adopting the classical equations of motion for the mechanical oscillator (but keeping the quantum part of the symmetrized noise spectrum), we find an average energy of:    where  is the symmetrized version of the spectrum introduced above and we assumed the laser to be dominant, , and also . This leads to the correct quantum result:    This expression reveals that the energy, consisting of the zero point motion and an additional residual term, is caused by the quantum fluctuations of the laser field. The fact that the quantum fluctuations of the laser field also give rise to the zero point energy can be understood by noting that the dominant bath that the mechanical oscillator is coupled to is the laser field itself when  In this sense then, the correct quantum limit for cooling can be formulated on a semiclassical basis, where it is sufficient to consider only the quantum fluctuations of the drive field.  Optical output spectrum. The output spectrum of the light that emerges from the optomechanical cavity can be calculated using the input-output formalism (Sec. ). In close analogy to the fluorescence spectrum of a laser-cooled trapped ion, the specrum is given by the expression:  S()& I_0(L)   & +A^-n_fI_side(m)   & +A^+(n_f+1)I_side(+_m)  This spectrum refers to the frequency-resolved photon flux. Here      is the Lorentzian shape of the sidebands, where the width of the sidebands is given by the overall effective mechanical damping rate . The weight of the main peak       at the laser frequency is (for a single-sided Fabry Perot resonator)        As expected, the spectrum consists (in addition to the carrier) of blueshifted (anti-Stokes) photons at  (second line of Eq. ()) and redshifted (Stokes) photons at  (third line). The sideband asymmetry changes as a function of cooling laser power. Detailed balance causes the initially asymmetric sidebands (as ) to become progressively more symmetric, with  in the limit where  is entirely determined by the cooling process (). This provides a means to determine the temperature of the mechanical oscillator via the spectral weight of the two sidebands, a technique that has been widely used in the trapped ion community and is termed sideband thermometry . There, the spectral weight can be directly measuring via optical shelving. A variant of this method has recently been demonstrated in an optomechanical cooling experiment . In this method the excitation laser is placed on the upper ( ) and subsequently on the lower sideband () and the rate of scattering into the cavity  is measured. This yields  and  provided the laser is quantum limited. A treatment in the presence of laser noise, which can yield a contribution to the asymmetry, is given in Appendix .           Experiments and practical limitations    The first experimental attempts to damp the motion of a mechanical oscillator with radiation pressure dynamical backaction were carried out by Braginsky and coworkers . In these experiments a microwave cavity was employed, and a modification of the damping rate of the end-mirror pendulum could be observed. Microwave cooling deeply in the resolved-sideband regime was moreover implemented in the field of gravitational wave detectors, in the form of a high Q cryogenic sapphire transducer, where it served the role to reduce the effective noise temperature .   Optical feedback cooling of a micromechanical mirror using the radiation pressure force was demonstrated in 1999 . Dynamical backaction cooling in the optical domain was achieved using photothermal forces in 2004 , and using radiation pressure forces in 2006 .   These early experiments operated in the Doppler regime (). As outlined in the previous section, an important requirement for many applications is the resolved sideband regime. This was demonstrated in the microwave regime for the first time  and later in the optical domain . Since then, a plethora of novel systems (e.g. , ,  and many more) have been realized in the resolved sideband regime (see Fig. ). All these experiments were, however, essentially room temperature experiments.                  To initialize a mechanical oscillator in the ground state at thermal equilibrium, the condition  has to be realized. In general, the probability to find the system in the ground state is related to the average occupation number  by . Note that in the field of trapped ion experiments, the motional ground state can nowadays routinely be prepared with more than  probability . Reaching the ground state (often referred to as ) is challenging for low frequency oscillators, as the thermal freezeout for a   oscillator would equate to   These temperature are far below those attained with a dilution refridgerator. Ground state cooling with conventional cryogenics can therefore be reached only for  oscillators. Indeed, the first demonstration of quantum control at the single phonon level was demonstrated with a  piezoelectric mechanical oscillator cooled to below  m .  It is challenging to reach the quantum ground state of micromechanical oscillators at lower frequencies. A widely pursued strategy has been to combine cryogenic precooling with dynamical backaction laser cooling. The precooling thereby allows to reduce the starting mode temperature. This technique has over the past years allowed a substantial reduction of the phonon occupancy.   While initial cryogenic experiments had demonstrated cooling to a level of a few dozen quanta in the optical domain , further experimental progress allowed to reduce the motional energy to a level close to the zero point motion in several experiments both in the microwave domain  and in the optical domain , with ground state probabilities ranging from 0.2 to 0.7.   Specifically, in the microwave domain, increasing the coupling strength by improved cavity designs resulted in cooling to around  quanta  () and to  () using a superconducting resonator coupled to micromechanical drum mode , respectively (). In both experiments the limitation for the occupancy was set by the fact that the cavity had a low, yet finite residual thermal occupation. This also led to the observation of squashing in the mechanical noise spectrum data of this experiment for some drive powers. All these experiments have been performed in dilution refrigerators with base temperatures as low as about 25 mK.   Also in the optical domain, new geometries allowed to improve the cooling performance to  quanta () for improved microtoroidal resonators  and to 0.8 quanta () for a nanomechanical mode of a photonic crystal beam .  In  a spoke-supported microresonator was precooled to  quanta in a He-3 buffer gas cryostat (ca. 750 mK temperature) and optically pumped by a Ti:Sa laser. In this experiment, the occupancy was limited by the cavity decay rate  and in addition by reheating of the sample due to the laser, which in the case of glass reduces the Q-factor due to two-level systems in the amorphous glass The experiment by  involved a  mechanical mode and an external cavity diode laser drive. The cooling was limited by reheating of the sample to its initial temperature of ca.  inside a He-4 flowthrough cryostat and the fact that the mechanical Q factor exhibited a strong temperature dependence, as well as unwanted effects at higher drive powers. In all cases, higher fidelity ground state preparation - as achieved in ion trapping - will require further reduction of the effects of laser heating of the sample, further increases of the mechanical quality factor or higher optomechanical coupling rates.  The technique of radiation pressure dynamical backaction cooling has many similarities to atomic laser cooling . Nevertheless there are substantial differences. For instance, optomechanical cooling does not proceed by the use of a two-level system, but by a cavity that is excited with a coherent laser field. From an experimental point of view, optomechanical cooling of a mechanical oscillator to the ground state is impeded by several challenges. First, in contrast to atomic laser cooling where the atoms are well isolated, mechanical systems are usually coupled to a high temperature bath with correspondingly large motional heating rates. In addition, optomechanical laser cooling is extraordinarily sensitive to laser phase (i.e. frequency) noise. In the following two sections the fundamental limits of cooling are reviewed due to both laser phase noise and thermorefractive cavity noise.  A selection of cooling experiments is displayed in Fig. . There, we plot the initial and final phonon numbers vs. the sideband resolution parameter  that determines the minimum achievable phonon number.     Laser phase noise   In the last section, the laser input noises were considered to be essentially quantum noises, i.e. the laser beam is considered a perfect coherent state. However, real laser systems exhibit excess noise, e.g. due to relaxation oscillations that can be derived from the dynamical equations of laser theory. In these cases, the laser frequency noise cannot simply be inferred by the laser linewidth and simplified models fail to provide an accurate description of the laser's phase and amplitude noise. Lasers exhibit generally significant excess noise for frequencies below the relaxation oscillation frequency, which can differ strongly, from the k range in Nd:YAG or fiber lasers to several  in the case of diode lasers . This noise will lead to radiation pressure fluctuations that heat the mechanical oscillator, as has been discussed in , Moreover, phase noise impacts state transfer and entanglement generation  and can impact sideband asymmetry measurements. For a more detailed discussion we refer the reader to Appendix .   Cavity frequency noise  In addition to laser phase noise - which in principle can be mitigated by properly filtered laser systems - a more fundamental limit to dynamical backaction laser cooling arises from the fact that at finite tempererature, the cavity frequency will exhibit thermodynamical fluctuations . These are due to local temperature fluctuations that affect the dielectric properties of the cavity itself (for microtoroids, microspheres, or photonic crystals) or of the mirror. For more details, we refer to Appendix .    Strong coupling regime    We now discuss what happens when the laser power  is increased further. At first, this will just improve cooling, since . However, as we will see in the next section, qualitatively new features start to appear when , or equivalently when . This regime is referred to as the strong coupling regime , where the driven optical mode and the mechanical mode hybridize to form two new modes, with a splitting set by . Furthermore, even for lower laser drive powers interesting features in the transmission spectrum of the cavity appear if it is probed weakly in the presence of a strong drive. This will be the phenomenon of optomechanically-induced transparency, discussed in Sec. .   Optomechanical normal-mode splitting    The strong coupling regime is discussed most easily if we assume the non-dissipative part of the Hamiltonian to dominate all decay channels, i.e. . In that case, we can just consider the following part of the linearized Hamiltonian,     In the most interesting red-detuned regime, where , we can even start our discussion employing the rotating-wave-approximation for the coupling, , which is the beam-splitter Hamiltonian of Eq. (). The Hamiltonian of these two coupled oscillators is then easily diagonalized by going over to the two eigenmodes. These modes now represent excitations that are hybrids between the mechanical oscillations () and the fluctuations of the driven cavity mode () around the strong coherent amplitude. Their eigenfrequencies are:     In particular, right at resonance , one observes an avoided crossing, with a splitting of  between the two excitation branches. At this point, the eigenmodes are symmetric and antisymmetric superpositions of light and mechanics, with new annihilation operators . Far from resonance, one recovers the two bare frequencies  and , and the excitations become again of purely optical and mechanical nature, respectively.               This is the picture appropriate for , where we assume that  is the dominant decay channel. In the opposite case  (assumed in the previous sections), the two peaks at  merge and the avoided crossing cannot be observed.   In principle, the complete scenario, including the decay channels and the transition into the strong-coupling regime, is described fully by the solution of the linearized equations of motion, Eqs. () and (). As discussed in Sec. , one can solve these coupled equations analytically. In this way, for example, one arrives at an exact expression for the mechanical susceptibility, Eq. (). When plotting this vs. frequency for increasing values of , one observes peaks at  that can be clearly resolved for . The evolution of the mechanical spectrum in the strong coupling regime  as a function of laser detuning  is displayed in Fig. . The same kind of analysis also applies to the transmission spectrum of the cavity that can be expressed via the same solution.   However, instead of referring to these rather lengthy exact expressions, we can simplify things by considering the regime , which allows us to perform the rotating-wave approximation already employed above. We can then write down the linearized equations of motion for the mean values:              Solving for the complex eigenvalues of this non-Hermitian matrix, we recover the expression for the two branches  given in Eq. () above, except with the replacements  and . With , we have  * _ & =_m+2-i+_m4   & g^2+(+i(_m-)/22)^2  In particular, at resonance  () we find , where we assumed  to slightly simplify this formula. Thus, the eigenfrequencies change character at the threshold , where the root changes from purely imaginary () to real-valued (). This corresponds to the transition into the strong-coupling regime, with two well-resolved peaks. Each of those peaks is of width (FWHM) . This is because both of these excitations are half optical, and so each of them shares half of the optical decay rate. Away from the degeneracy point , the relative contributions of the two decay channels  and  get re-weighted according to the unequal distribution of optical and mechanical excitation in the two branches.            It turns out that cooling becomes less efficient when one approaches the strong coupling regime. In fact, the exact solution of the linearized equations of motion can be employed to derive the appropriate modification to the formulas for the final occupany in the case of strong optomechanical coupling:     Here  is the standard result () derived above for the weak-coupling regime , and to simplify the expression we assumed the resolved-sideband regime  where  and , as well as strong cooling , neglecting terms of still higher orders in .   The peak splitting in the strong coupling regime () and the resulting modification to cooling (notably the limitation arising from the finite cavity decay rate) was predicted in . It was analyzed extensively in ; see also  and the supplementary material of . More generally, the full expression  for  can be given, including any possible thermal occupation of the cavity field (which has been observed in microwave setups):   n_f & =n_th_m4g^2+^24g^2+_m+4g^24g^2+_mn_cav^th   & +n_th_m^24_m^2+(n_cav^th+12)^2+8g^28_m^2.    The first experimental observation of strong optomechanical coupling () was reported in . Subsequently, experiments on other setups have been able to achieve significantly larger ratios , see . In addition, the regime of  (see below) was reached as well , where coherent quantum state transfer between light and mechanics could take place (see Sec. ).  The photon statistics of an optomechanical system in the strong coupling regime have been found to display interesting antibunching behaviour and photon correlations , and the same analysis discussed four-wave mixing in a setup driven by a strong pump field and another (``Stokes'') field. One may also consider having a nonlinear medium inside the optical cavity. In , the effects of an optical parametric amplifier cavity on the phenomenon of optomechanical normal mode splitting have been studied.               The spectroscopic signatures of strong coupling indicate whether the coupling exceeds the cavity decay rate. If the coupling rate exceeds also the thermal decoherence rate () the interaction between the mechanical oscillator and the light field becomes quantum coherent, i.e. the timescale of the mutual coupling is faster than the timescale for one quantum of noise to enter from the environment:     This parameter regime of coherent coupling is a precondition for many quantum protocols such as quantum state transfer between the cavity field and a mechanical mode (see section ). Experimentally, this regime has been reached using a superconducting membrane coupled to an LC circuit , and in the optical domain using a toroidal spoke-supported microresonator  (cf. Figure ).      Optomechanically induced transparency                 Electromagnetically induced transparency  is a phenomenon which occurs in multi-level atoms and manifests itself as a cancellation of absorption in the presence of an auxiliary laser field. It arises from electronic interference or, in an equivalent picture, is due to a dark-state resonance of the excited state. This phenomenon has been demonstrated for cold atomic ensembles, giving rise to a host of phenomena, ranging from optical pulse storage to slowing or advancing of light pulses. An analogous phenomenon also occurs in optomechanical systems, as predicted theoretically in  and analyzed further for optical pulse storage . Optomechanically induced transparency has been observed in experiments. Injecting a strong control laser beam into the lower (red-detuned) sideband of an optomechanical system, the optomechanical interaction causes the cavity resonance, as seen by a second, weak probe laser field to be rendered transparent. The simultaneous presence of a strong control laser () and a weak probe laser () lead to a transmission  of the weak probe laser given by:     Here  denotes the detuning of the strong control field from the cavity resonance , and  denotes the detuning between the control laser and probe laser, i.e. . Moreover, the coupling efficiency  has been introduced, and the mechanical susceptibility      as well as the optical susceptibility . Note that, with regard to the transmission, we used the terminology appropriate for a waveguide-coupled unidirectional cavity (e.g. whispering gallery mode resonator), and we follow the discussion to be found in the supplementary material of . Plotting the expression  reveals that when the resonance condition  is met, a transparency window arises. When the coupling laser is placed on the lower sideband (), the expression for the transmission of the probe in the vicinity of  (which corresponds to ) reduces to:     where for simplicity we assumed critical coupling, i.e. . Evaluating the above expression for  yields:     Here  is the optomechanical cooperativity: . Thus a cooperativity of unity is required to change the transmission to 50. It is noted that the assumption underlying these theoretical considerations, of two coherent drive fields, requires from an experimental point of view two laser fields that are coherent for times longer than the effective mechanical damping time.  The physical origin of the transparency window can be understood by realizing that the beat of the probe field and the coupling laser induces a time varying radiation pressure force. If the beat frequency matches the mechanical oscillation frequency, then the mechanical oscillator is driven resonantly. The driven oscillator in turn creates sidebands on the intracavity field. Considering the strong coupling laser only, in the resolved sideband limit, the lower motional sideband is far off cavity resonance and can be neglected. In contrast, the upper sideband of the coupling laser, created by the mechanical motion, has precisely the same frequency as the probe field and is moreover phase-coherent with the probe field. This leads to an interference that yields a cancellation of the intracavity field on resonance, giving rise to the transparency window. The phenomenon thereby results from the destructive interference between reflection amplitudes for photons scattered from the coupling laser and photons of the probe field.   The width of the (Lorentzian) transparency feature in the weak coupling regime (where ) is given by the total effective mechanical damping rate:     We note that at stronger drive this feature smoothly evolves into the normal mode splitting discussed above (Sec. ). The narrow transparency window is concomitant with a rapid variation of the transmission phase of the probe beam. This implies that a pulse with a bandwidth smaller than  will experience a group delay (without distortion of the pulse). The change of the phase of the transmitted light is given by the expression (for ):     Evaluating this expression for zero detuning () leads to a group delay of     However, the bandwidth of the pulse needs to be smaller than the transparency window for undistorted pulse propagation, which limits the delay-bandwidth product to . Using an array of optomechanical systems, the delay-bandwidth product can be increased and may therefore serve as a way to store an optical waveform in long lived phonons. Such cascaded optomechanical systems can be realized using e.g. photonic crystals .             Optomechanically induced amplification and electromagnetically induced absorption   If instead we consider the control laser being injected on the upper sideband (), an additional optical signal in the probe beam is amplified . The analogous effect in atomic physics is referred to as electromagnetically induced absorption  (EIA). The amplification process can parametrically amplify a small signal (provided the resonance condition is met), by virtue of the constructive interference of the light scattered from the pump (control) to the signal (probe) frequency, in direct analogy to the above phenomenon of optomechanically induced transparency. Theoretically the phenomenon can be described by the same equations as the effect of transparency, except for the fact that now the mechanical damping is reducing with increasing power on the upper sideband. The maximum gain is set by the maximum power which can be injected onto the upper sideband ( ), which is limited by the onset of the parametric oscillatory instability, in which the coherent amplification of mechanical motion from the noise occurs. The maximum average gain in this case is given by by . As for any non-degenerate parametric amplifier, the amplification process has to add half a quantum of noise for fundamental reasons , and the total added noise is given by  in the presence of thermal fluctuations. In the ideal case the relative phase between pump and signal is not important for the EIA process. However, any relative phase fluctuations between pump and signal need to take place on a timescale long compared to the inverse effective mechanical damping rate.  However, this optical amplification process does not lead to a stimulated optical amplification process, as in the case of optical Brillouin scattering. The reason is that unlike the optical Brillouin scattering case, the optical dissipation is larger than the mechanical dissipation ( ). This implies that the mechanical mode can experience exponential buildup, while in a Brillouin laser the opposite is the case         .               Classical Nonlinear Dynamics      Up to now we have mostly discussed effects that can be fully understood within the linearized equations of motion, i.e. within the quadratic approximation () to the optomechanical Hamiltonian. However, the approximation itself can be used to predict its breakdown: In the blue-detuned regime (),  becomes negative, decreasing the overall damping rate. At first, this leads to heating (instead of cooling), enhancing the oscillator's effective temperature. Once the overall damping rate  becomes negative, an instability ensues. In that case, any tiny initial (e.g. thermal) fluctuation will at first grow exponentially in time. Later, nonlinear effects will saturate the growth of the mechanical oscillation amplitude (Fig. ). A steady-state regime is reached, with oscillations proceeding at a fixed amplitude . These are called self-induced (back-action induced) optomechanical oscillations. In fact, they are analogous to lasing action, but now in a mechanical system and with the incoming laser radiation providing the pump. Therefore, this optomechanical effect can also be understood as one variant of ``mechanical lasing'' or ``phonon lasing''. Just as for lasers/masers, the optomechanical system displays a threshold and linewidth narrowing above threshold, described by a Schawlow-Townes type limit.                  Parametric instability and attractor diagram    In this section, we present the classical theory of the optomechanical instability produced by radiation pressure backaction, following . Our main goal is to discuss the amplitude  of the steady-state mechanical oscillations, as a function of system parameters such as laser power, detuning, and mechanical damping rate. We will find that for a fixed set of parameters,  can in general take on multiple stable values, corresponding to several stable attractors of this dynamical system. That effect is known as dynamical multistability, and in experiments it may lead to hysteretic behaviour. Our discussion will be directly applicable for the radiation-pressure induced parametric instability. However, note that very similar physics and analogous formulas apply for the case when this instability is induced by photothermal forces. In fact, if the thermal decay time  is long (), one can re-use most parts of the discussion below, effectively only replacing  by  (see  for a discussion of the differences).  The threshold of the instability can be obtained in a linear analysis by demanding that     This will define the limits of an interval where , i.e. where the system is unstable. This interval widens as the laser power is increased.  A simple argument can now be used to obtain the amplitude . We start from the ansatz     for the self-induced oscillations. This is good for typical experimental parameters, where , such that both damping and optomechanical effects only show up after many oscillation periods. We will discuss the breakdown of this ansatz in the following section on chaotic dynamics.  From Eq. (), one can obtain the time-dependence of the radiation pressure force  (which will depend on  and ). In steady-state, the time-averaged power input due to this force, , must equal the power lost due to friction, . This can be recast into a condition resembling Eq. (), by defining an amplitude-dependent effective optomechanical damping rate:     In the low-amplitude limit , this reduces to the standard definition of  used up to now. Then the power balance condition is simply     which is an implicit equation for . This strategy can be used for arbitrary optomechanical systems, also containing more optical modes or other types of radiation forces.  We need yet another condition, to fix the oscillation offset , which is not identical with the unperturbed oscillator equilibrium position. The time-averaged radiation pressure force deflects the harmonic oscillator:       In general, Eqs. () and () need to be solved simultaneously for the unknowns  and . However, if , one can already see the instability in a regime where the shift  is small and can be neglected, such that only Eq. () is relevant.  We still have to obtain . This can be deduced by solving the classical equation for the light field amplitude (Sec. ),     where we defined  to be the amplitude reached inside the cavity right at resonance (in terms of Sec. , we have ). After inserting the ansatz (), the solution  can be written in a Fourier series , with coefficients     where  is the Bessel function of the first kind and the global phase . Now the force  and the time averages  and  can be calculated. One has  and . These series can be efficiently summed numerically, to obtain the explicit dependence of Eqs. () and () on  and the system parameters.  The result is best discussed graphically. In Fig. , we show the attractor diagram, i.e. the possible amplitudes  as a function of any system parameter (in this case, the detuning ). This diagram can be generated by plotting the value of  and then showing the contour lines  that indicate possible attractors. Note that stable attractors are only those where  grows with  (the upper half of each line). In the case shown here (), the structure of sidebands at  both for red and blue detuning shows clearly. Remarkably, one can have stable self-induced oscillations even on the red-detuned side (), but only for finite amplitude . This is consistent with the fact that the linearized theory there predicts cooling at .  Mathematically, the onset of small-amplitude oscillations, starting from , is an example of a Hopf bifurcation. In this regime, , where  is any system parameter (such as the detuning or the laser power), and  its threshold value.   An important feature is the dynamical multistability, i.e. the existence of several stable solutions for a fixed set of external parameters. This is observed for sufficiently good mechanical quality factors, when higher-amplitude attractors become stable. It leads to hysteresis in experiments, and might also be used for high-sensitivity ``latching'' measurements. For more on this and the effects of noise and slow dynamics of the amplitude, see .   In experiments, an optomechanical instability due to retarded light forces was first studied in a low-finesse setup with photothermal forces , where the retardation is due to finite thermal conductivity and the theory described here applies with appropriate modifications, see . Subsequent studies of the photothermal setup observed parts of the attractor diagram, confirmed dynamical bistability, and uncovered a new regime where more than one mechanical mode gets involved in the nonlinear dynamics .   The parametric instability driven by radiation pressure backaction, as discussed here, was first demonstrated in a microtoroid setup . The full attractor diagram still has to be observed in an experiment.  A recent experiment has demonstrated mechanical lasing (i.e. coherent oscillations) in a setup where two optical modes are involved and photon transitions between those modes provide the power to feed the mechanical oscillations . The attractor diagram for the parametric instability in systems involving more than one optical mode (including a 'membrane in the middle') will display qualitatively new features due to the effects of optical Landau-Zener dynamics .  Just as in a laser, the phase of the self-induced oscillations is arbitrary. Thus, external noise, including thermal Langevin forces acting on the mechanical oscillator and radiation pressure shot noise, will impart a slow phase diffusion. The effect of a force  on the phase scales inversely with the amplitude, , as can be seen easily in a phase-space diagram. Thus, the diffusion constant for the phase scales with , diverging just above threshold . This is the optomechanical analogue of the Schawlow-Townes result for the linewidth of a laser . More precisely, the scenario is closer to the case of a maser, since the thermal noise is not negligible in the mechanical oscillator:     A full discussion of the linewidth narrowing and phase diffusion in optomechanical oscillations can be found in , where the effects of photon shot noise are taken into account as well.  Up to now, we have discussed exclusively the classical dynamics. In the quantum regime , the parametric instability threshold is broadened due to quantum fluctuations, with strong amplification of fluctuations below threshold. The existence of attractors with finite amplitude shows up, e.g., in phase-space plots of the Wigner density, and it changes the phonon (as well as photon) statistics .  Interesting new collective physics results if many such optomechanical oscillators are coupled together. In particular, this can lead to synchronization, which we will discuss in some more detail in the section on multimode optomechanics (Sec. ).                                 Chaotic dynamics    If the laser input power is increased sufficiently, the coupled motion of the light field and the mechanical oscillator becomes chaotic. In that regime, amplitude and phase fluctuate in a seemingly random fashion that depends sensitively on initial conditions, even in the absence of noise sources. Technically, the ansatz () of sinusoidal oscillations breaks down, and the full dissipative driven dynamics of four degrees of freedom ( and the complex light amplitude ) has to be taken into account. The chaotic regime is characterized by positive Lyapunov exponents, where any tiny deviation from the initial trajectory grows exponentially with time.   Chaotic motion in optomechanical systems has been explored relatively little so far, although it had been observed early on  and has been studied more systematically in a subsequent experiment .           Multimode optomechanics    Up to now we have almost exclusively considered one optical mode coupled to one mechanical mode. This is the ``minimal model'' of cavity optomechanics, captured by the Hamiltonian (). Of course, it is clear in principle that every mechanical resonator has a multitude of normal modes, and every optical resonator likewise has many different modes as well. It is relatively straightforward to write down the appropriate extension of () to the more general case:   H & =_k_cav,ka_k^a_k+_j_jb_j^b_j   & -_j,k,l[g_0]_kl^ja_k^a_l(b_j+b_j^)+eq:MultimodeHamiltonian  Here the various optical () and mechanical () modes interact according to the optomechanical coupling constant tensor , whose entries depend on the details of the optical and vibrational modes and their mutual interactions. We left out the laser drive and the coupling to the radiation and mechanical environments.   Before we go to the general case, it should be noted that restricting one's attention to the minimal model is often justified for many purposes. The incoming monochromatic laser drive will select one optical resonance. With regard to the mechanical motion, all the mechanical resonances will show up in the RF spectrum obtained from a displacement measurement, but we may choose to focus on one of those resonances, as long as they are well separated. Likewise, cooling or heating in the resolved sideband regime singles out a particular mechanical mode via the choice of laser detuning. In the bad cavity limit, multiple modes can be cooled (or amplified) simultaneously .   In the following, we want to discuss some scenarios and features where it becomes crucial to go beyond the minimal model. It is clear that going to structures with two or more mechanical or optical modes leads to a wealth of different possible schemes (Fig. ), only a few of which have been explored so far. Further examples can be found in the next section, on quantum optomechanics (Sec. ).   It was pointed out by Braginsky that scattering of photons between two optical modes can lead to a parametric instability . This analysis was intended primarily for interferometric gravitational wave observatories, where the free spectral range may match relevant mechanical frequencies.                 We have already mentioned a setup with a membrane in the middle of a cavity (Sec. ), in the context of QND phonon detection . This setup can be viewed as consisting of two optical modes, where photons can tunnel between those modes via transmission through the membrane. Having two optical modes is essential for the quadratic dependence of optical frequency on displacement that arises from the avoided crossing in the optical mode spectrum.   Besides the QND scheme, setups with two relevant optical modes can be realized in a large variety of implementations and have many additional interesting features. Mechanical oscillations can take the system through the avoided crossing, potentially resulting in Landau-Zener-Stueckelberg physics and optical Rabi oscillations for the optical two-state system, coherently shuffling photons between the two branches . Cooling and squeezing in the presence of quadratic optomechanical coupling has been analyzed . Moreover, displacement sensing in a two-mode setup can be much more efficient than the standard scheme . The optomechanical system of two coupled optical modes can also be viewed as a photonic version of the Josephson effect and its classical dynamics can give rise to chaos .   If the mechanical resonance frequency matches the transition between the optical branches, one can implement a version of optomechanical phonon lasing  that is directly based on a population inversion between the two optical levels, just like in a real laser. The Landau-Zener physics mentioned above will significantly modify the dynamics of these self-oscillations for large amplitudes . An interesting variant of this situation can be implemented for whispering gallery optical and acoustical modes in toroids or spheres in a stimulated Brillouin scattering scheme . In the same kind of Brillouin setup, the reverse process has been demonstrated as well, i.e. cooling via a photon transition between the lower and upper optical mode . Recently it has been pointed out theoretically that schemes with two optical modes can be exploited to enhance the quantum nonlinearities in optomechanical systems , see Sec. . The photon-phonon translator discussed in Sec.  is another example of a possible device that employs two optical modes.  Likewise, there are many schemes where more than only a single mechanical mode is relevant. These could be the various normal modes of a given mechanical structure, or several vibrating objects placed inside a cavity or coupling to one optical mode (see Sec. ). We mention only a few illustrative examples. An array of multiple membranes inside a cavity was studied theoretically in  with regard to mechanical normal modes, entanglement and collective interactions. A recent experiment demonstrated tripartite optomechanical mixing between one microwave mode and two mechanical modes . Effects of multiple mechanical modes can also be studied for levitated setups. It has been proposed that an array of levitated dumbbell-shape dielectric objects can undergo an ordering transition.  The nonlinear dynamics of the self-oscillations (``mechanical lasing''; Sec. ) become particularly interesting when more mechanical modes are involved. It has been shown experimentally  that collective self-oscillations may arise when several mechanical modes are excited simultaneously, using a strong blue-detuned drive for a ``bad cavity'' whose linewidth encompasses several mechanical normal modes of the structure (a cantilever in that case). More recently, it was pointed out that optomechanical systems are very promising for observing synchronization phenomena . Assume an array of optomechanical oscillators, each of which consists of a mechanical mode coupled to an optical mode that is driven by a blue-detuned laser beam such as to go into the ``mechanical lasing'' regime (Sec. ). If these ``clocks'' are coupled mechanically or optically, their mechanical frequencies can lock to each other, even if they have been distinct initially. Under appropriate conditions, a variant of the Kuramoto-model can be derived for optomechanical systems , which is a paradigmatic model of synchronization physics. For two mechanically coupled cells, the equation turns out to be of the form     where  is the intrinsic frequency difference,  the difference of mechanical oscillation phases, and  an effective coupling constant that can be related to microscopic parameters. If  is large enough, synchronization ensues (). If, one the other hand, several oscillators couple to the same optical mode, the behaviour can become of a form that is not described by any Kuramoto-type model. This has been analyzed recently in detail .  Synchronization may be important for metrological applications, where several synchronized optomechanical ``clocks'' of this type are expected to be more stable against noise . Experimentally, some signs of synchronization in an optomechanical device have been observed recently  for two optically coupled optomechanical oscillators, each of them implemented as a double-disk SiN structure. Mechanical spectra showed the onset first of self-oscillations and then of synchronization as a function of laser detuning.  Two coupled mechanical modes of widely different damping rates can give rise to Fano lineshapes in their excitation spectrum when they hybridize. This has been demonstrated in an optomechanical system , and suggested for information storage and retrieval in long-lived mechanical ``dark'' states.  Optomechanical photonic crystal structures present an opportunity to design more complex optomechanical circuits. These might be 1D or 2D array structures, where many optical and mechanical modes are arranged in a periodic layout and coupled to each other. Alternatively, one can think of more intricate circuits, more similar to computer chips, where different elements fulfill various functionalities (sensing, amplification, general signal processing).   Optomechanical arrays of this type have been studied theoretically only in a few works so far, both with respect to their collective classical nonlinear dynamics , their quantum many-body dynamics  and for engineering quantum dissipation , as well as with respect to quantum applications: A suitably engineered array of optical and mechanical modes coupled to a waveguide can slow down and store light . Photon-phonon entanglement in an optomechanical array of three cells was studied in . Many nanomechanical modes in an array geometry can be entangled via the light field, using a suitable parametric drive to select mode pairs . These studies pave the way towards future architectures for (continuous variable) quantum information processing with optomechanical circuits.   Quantum Optomechanics    Quantum mechanics has already figured at several places in our discussion so far, notably in setting the limits for displacement sensing or cooling. We will now turn to discuss potential future optomechanical experiments where quantum behaviour will take center stage. We will discuss ways to create interesting quantum states both in the optical and mechanical system, and to create entanglement between the various subsystems. We will then turn to nonlinear quantum effects whose understanding requires us to go beyond the linearized optomechanical interaction, i.e. beyond the quadratic Hamiltonian of Eq. (). Finally, we will see how these effects are envisaged to form the ingredients of future optomechanically aided protocols for quantum information processing.   Light-assisted coherent manipulation of mechanics    The light field can be employed in principle to generate arbitrary quantum states of the mechanical oscillator. In this section, we will restrict ourselves to the action of the linearized interaction Hamiltonian of Eq. (),     When injecting Gaussian optical states, as is the case for the usual laser drive, this can produce arbitrary mechanical Gaussian states, i.e. coherent and squeezed states out of the ground state (which has to be reached first, either via optomechanical or bulk cooling techniques). As long as the linearized Hamiltonian is valid, non-Gaussian mechanical states can only be produced from non-Gaussian optical states. The parameters that can be varied easily are the laser detuning  and the laser input power. Any pulse of light will generate a radiation pressure force pulse that shifts the oscillator's wave function and thereby permits to create a coherent state.  It is only slightly more difficult to create a squeezed state. As we saw in Sec. , a far-detuned light beam creates an ``optical spring effect'', i.e. a change in the mechanical frequency by . As is well known, a time-dependent modulation of , i.e. a parametric driving of the mechanical oscillator creates a squeezed state: see  for an analysis in the case of optomechanical systems, where one can employ a modulation of the laser power. For , the resulting effective mechanical Hamiltonian turns out to be (in a frame rotating at , and in rotating wave approximation) the standard squeezing Hamiltonian     such that  in the absence of dissipation. Thus, in this time-dependent scheme, squeezing grows exponentially with time. However, a realistic analysis needs to take into account the initial thermal population, as well as dissipation and decoherence, and distinguish between the steady-state situation and the transient case. When several mechanical modes are coupled to the same optical mode, a modulated laser drive will generate two-mode squeezing or beam-splitter interactions between pairs of modes that are selected according to their frequency. This can form the basis for continuous variable quantum state processing in optomechanical arrays .  Measurements can also be used to generate interesting mechanical states in a probabilistic manner, i.e. conditioned on the measurement result. This includes squeezed states via single-quadrature detection (Sec. ) or mechanical Fock states via phonon number readout (Sec. ). Further below we will comment on other ways to generate more nonclassical states (including non-Gaussian states), by nonlinear effects (Sec. ) or various state transfer protocols (Sec. ).   Mechanics-assisted readout and manipulation of light    The optomechanical interaction can be exploited to detect and manipulate the quantum state of the light field.  An example that was suggested early on is the possibility of a QND detection  for the light intensity circulating inside the cavity . The displacement of the end-mirror, induced by the radiation pressure force, can serve as a noiseless meter for the light intensity. In addition, as the radiation pressure force is proportional to the photon number, it increases in discrete steps. If the photons are sufficiently long-lived and the interaction strong enough, this may even enable QND photon detection, by registering the resulting mechanical displacement. In practice, however, that regime is extremely challenging to reach, as it would require  (see the section on quantum nonlinear dynamics below, Sec. ).  Regarding the manipulation of the light's quantum state, one of the most straightforward applications of optomechanics consists in squeezing the noise of the light beam . In this context, the change of the cavity length due to the intensity-dependent radiation force can be compared to the effect of a Kerr medium inside a rigid cavity. The resulting physical picture depends sensitively on the detuning and the frequency at which the noise of the light beam is analyzed. In the simplest case, one may imagine that a temporary fluctuation in the incoming intensity of the light beam induces a change in the cavity length via the radiation pressure force. This, in turn, shifts the optical resonance and thereby affects the circulating and outgoing intensities, potentially suppressing the noise. It should be noted that for a single-sided optical cavity (without internal losses) there can be no change of the amplitude noise at zero frequency, since the incoming and outgoing intensities have to be equal. However, there can be amplitude squeezing at finite frequencies (and phase squeezing down to zero frequency). The squeezing effect diminishes towards frequencies above the mechanical resonance. Finite temperatures degrade squeezing, as the thermal motion of the mirror imprints extra noise on the light beam. At low frequencies, and for detunings on the order of , the light beam's noise is increased  by a factor , where  is the equilibrium phonon number.   A recent review of the current efforts towards demonstrating radiation pressure shot noise effects and squeezing in optomechanical experiments can be found in . First experiments in this direction have simulated the quantum fluctuations by classical intensity noise . More recently, the very strong coupling and low temperatures attainable in realizations of cavity optomechanics with atomic clouds have allowed to obtain first signatures of genuine optical squeezing  at the quantum level.    Optomechanical entanglement    The optomechanical interaction can be used to engineer entanglement between the light beam and the mechanical motion, or between several light beams or several mechanical modes. However, a prerequisite for all of these approaches is to cool the mechanical oscillator to near its ground state and to achieve sufficiently strong coupling.  In the following, we first describe entanglement in the single-photon strong coupling regime (for more on this regime, see Sec. ) and then turn to continuous variable entanglement.  A particularly simple physical picture applies in an idealized situation where we imagine starting with a superposition of photon states inside the cavity. Then, the radiation pressure force assumes different, discrete values for each photon number, displacing the mechanical harmonic oscillator potential by  per photon. If initially the mechanics was in its ground state, it will evolve into a coherent state , oscillating around the new, displaced origin that depends on the photon number. Thus, we immediately arrive at a non-factorizable, i.e. entangled state of the form:     Here  is the photon number,  are the arbitrary initial amplitudes for the photon field (e.g. corresponding to a coherent state), and  a phase-shift that can be obtained by solving the time-dependent Schr�dinger equation for this problem. The state () can be interpreted as a ``Schr�dinger cat'' type state, where a ``microscopic'' degree of freedom (the optical cavity mode) is entangled with a ``macroscopic'' (or mesoscopic) degree of freedom, the vibrating mirror. This picture has been first analyzed in .   Several signatures of entanglement exist. In this example, where the overall state is pure, we can simply trace out the mechanical vibrations, arriving at the reduced density matrix of the optical field, which will be found in a mixed state whenever there is entanglement. However, at multiples of the mechanical period, light and mechanics completely disentangle, since the coherent state  will have returned back to the origin, independent of photon number. At these times, the photon state becomes pure again, even independent of the mirror's effective temperature. The optical field's coherence thus demonstrates decay and revivals. This can in principle be tested in an interferometric optomechanical ``which-way'' experiment, where a photon can take either of two paths, one of which contains an optomechanical cavity (see Fig. ). The revivals can be observed in the interference visibility, as a function of the time the photon has spent inside the cavity. However, any mechanical decoherence occuring in the meantime will spoil these perfect revivals of the photon field's coherence. This can in principle be employed for highly sensitive optical tests of sources of mechanical dissipation and decoherence and fundamental quantum physics in general . Experiments of this kind could quantify the decoherence of superpositions of heavy objects (i.e. the mirror), and thus potentially shed new light on the quantum-to-classical transition (see Sec. ). In particular, models of gravitationally induced decoherence might be tested , where the (admittedly tiny) hypothetical extra decoherence rate becomes potentially observable only for relatively massive objects. Such experiments will require the challenging regime of  (when the displacement induced by a single photon may become on the order of the mechanical zero-point motion). It has been recently suggested that nested interferometry allows to reduce this requirement significantly .               On the other hand, entanglement can also exist on the level of continuous variables , of the type first proposed in the famous Einstein-Podolsky-Rosen article . The analysis of entanglement in this context has to be performed by taking into account the dissipative nature of the systems involved, and typically relies on solving the linearized quantum equations of motion (including, if needed, input-output theory for treating the reflected or transmitted light beam). In the regime where linearized equations of motion are valid, Gaussian states of the mechanics and the light field will be produced, and their entanglement (of the continuous-variable type) can be characterized completely once the correlations between the various mechanical and optical quadratures are known. A typical measure of entanglement that is commonly applied here is the logarithmic negativity, which can be calculated easily for Gaussian states , both pure and mixed.   The entanglement between mechanical vibrations and the optical cavity field (already described above in a picture appropriate for strong coupling) has been analyzed in more detail for the continuous-variable case in . Recently, it was pointed out that a suitable time-dependent modulation of the drive can improve the efficiency of photon-phonon entanglement .  It is also possible to create entanglement of two spatially separate mirrors. When a strong pump beam runs through a nonlinear optical  medium acting as a nondegenerate optical parametric amplifier, two-mode squeezing produces entanglement between the quadratures of pairs of emanating light beams. This entanglement could then be transferred via the radiation pressure force onto two spatially separated mirrors that are part of optomechanical cavities on which these light beams impinge . In this way, optomechanics would help to create mechanical EPR-type entanglement at a distance. The verification of EPR entanglement between macroscopic test masses by sensitive measurements has been studied in more detail for the context of gravitational wave interferometer setups . In the context of optomechanics, we usually consider the system to be driven by a coherent laser beam. However, it is natural to ask whether special opportunities arise when the light that is injected displays quantum features. For example, injecting squeezed light can be beneficial for entangling nanomechanical resonators via the optomechanical interaction .  In another approach, one could achieve the same goal without the optical entanglement created by a nonlinear medium, and instead perform an optical measurement after the interaction has taken place, in an entanglement swapping scheme. If two independent light beams interact with separate optomechanical cavities, then the beams can afterwards be brought to interfere at a beamsplitter, and a suitable Bell state measurement can then be used to generate entanglement between the distant mechanical resonators  (see  for a similar proposal).   Alternatively, the driven optical field inside the cavity automatically induces an effective interaction between several mechanical modes, thus providing yet another way to generate mechanical entanglement, without the need for any optical nonlinearities or entanglement swapping schemes. In the case of two mechanical resonators (or two normal modes of one resonator) coupling to the same driven cavity mode, this may be understood as a consequence of the optical spring effect (Sec. ). For the case of a single mechanical mode , eliminating the driven cavity mode by second-order perturbation theory creates an effective interaction term . Proceeding through the same argument for the case of two mechanical modes gives rise to an effective mechanical interaction. It is of the form     if we assume for simplicity that both mechanical oscillators couple equally strongly to the optical mode.   In order to successfully entangle different mechanical modes, one has to laser-cool those modes, since the mechanical vibrations would be far from their ground state for typical bulk temperatures. The optically induced steady-state entanglement between two movable mirrors under simultaneous laser-cooling has been studied carefully in , and later for somewhat different setups in . There is an interesting caveat for such studies: It is insufficient to apply the Markov approximation to describe the dissipative dynamics of the mechanical vibrations in this context, even though for many other purposes in optomechanics that is a very reliable approach. In fact, it can be shown that in a proper treatment  there is an optimum intermediate laser-cooling strength for which entanglement is maximized (an effect entirely missed by the common Markovian treatments).  The light-induced interaction given in Eq. () can form the basis of a general scheme for quantum state processing with many nanomechanical modes. In order to selectively address pairs of such modes for entanglement and state transfer, one simply has to modulate the coupling strength (i.e. the laser intensity) at sum and difference frequencies of those modes. Such a parametric scheme only requires one appropriately modulated laser input to address whole arrays of modes, if the proper layout is chosen .  Another possibility consists in exploiting optomechanics to entangle two light-beams. In these cases, the optomechanical interaction essentially serves the purpose of a  nonlinear medium. This has been proposed e.g. for an optomechanical setup where two degenerate, orthogonally polarized cavity modes are driven strongly and their interaction with the moveable mirror creates EPR correlations  between the quadrature variables of the beams emanating from these modes. Another option is to entangle the two sidebands reflected from a vibrating mirror, which works even in the absence of a cavity, for a strong short incoming laser pulse . For this situation, a more detailed analysis of the entanglement between mirror vibrations and the full light field (infinitely many degrees of freedom) was performed in . Optically trapped mirrors in a cavity optomechanics setup can als be exploited to entangle light beams .   Quantum hybrid systems    Optomechanical systems already represent a quantum hybrid system, i.e. a coupling between two quantum systems of a different physical nature: light and mechanical vibrations. In general, hybrid approaches may be useful for purposes such as quantum information processing, in order to combine the advantages of different physical systems in one architecture. Some systems may be strongly interacting (good for computation), some are very coherent (good for long-term storage), and yet others are easily transported over long distances (good for communication).   In principle, other components may be added easily to optomechanical setups. This is because both the light field and the mechanical vibrations are quite versatile in coupling to a variety of systems, such as cold atoms, spins, superconducting and other electronic qubits, etc. Consequently, there are already several proposals along these lines.  In a cloud of atoms, the total spin can sometimes be treated as a harmonic oscillator, identifying its small fluctuations around a preferred direction as position and momentum quadratures. This picture is useful when discussing experiments where the state of the light field is transferred to the atomic spin state and back again . More recently, it has been suggested that light might also be used to couple the collective spin of an atom cloud to a nanomechanical oscillator . In such a setup, a light beam passing first through an optomechanical cavity and then through an atom cloud carries information in its quadratures about the sum and the difference of position and momentum variables of the mechanics and the spin state. A subsequent QND measurement then is able to prepare the two systems in an EPR state, conditioned on the measurement result. As another example, coupling to the internal transitions of atoms can enhance cooling . One can also consider more involved internal level schemes for the atoms. For example, a vibrating mirror could be coupled strongly to the collective spin of a cloud of three-level atoms displaying electromagnetically-induced transparency phenomena . In addition, it has been suggested that coupling the collective spin of an atom cloud parametrically to a resonator can lead to the phenomena known from optomechanics  (amplification and cooling of the spin, frequency shifts, and squeezing of light), with the collective spin replacing the mirror motion.  After the pioneering experiments on optomechanics using cold atoms (Sec. ), a number of different possibilities have been explored theoretically to couple the motion of atoms to other systems. For example, the light field inside the cavity may be used to couple the motion of a single atom to the vibrations of an end-mirror or a membrane , where the strong coupling regime seems to be within reach. This could be the basis for exploiting all the well-known tools for manipulating and reading out the motion of a single trapped atom to gain access to the membrane motion. It would also be an interesting system to observe the entanglement between a microscopic and a macroscopic degree of freedom. Another model system that has been studied  and is now being implemented  is a cloud of atoms in a standing light wave reflected from a vibrating mirror (without a cavity). This could allow long-distance coupling between atoms and mechanical objects spaced apart by macroscopic distances.  A variety of other ideas exist for merging cold atom systems with optomechanics. Both the optomechanics of Bose-Einstein condensates  and degenerate cold atom Fermi gases  have been explored theoretically in some depth. Even the Mott-insulator to superfluid transition of atoms in an optical lattice coupled to a vibrating mirror has been analyzed, as an example of a strongly interacting quantum system subject to the optomechanical interaction .  The idea of doing optomechanics on trapped atoms has found an interesting counterpart in proposals for doing optomechanics on levitated dielectric objects (Sec. ). The promise of this approach lies in a drastically enhanced mechanical quality factor. Some proposals considered trapping and cooling a mirror , which has the advantage (over other objects) that scattering of the light into unwanted directions is greatly reduced. Alternatively, one can have dielectric spheres or other particles trapped in an optical lattice or by other means . A more detailed analysis of fundamental applications and protocols can be found in . If the promise of very long mechanical coherence times is fulfilled, then these platforms could offer the best means to test novel decoherence mechanisms (see the discussion in Sec. ). Some early experiments and studies on cavity optomechanics with sub-wavelength nano-objects  (and Sec. ) have already explored the optical coupling and some of the scattering mechanisms that may become relevant in this domain, even though they did not yet benefit from a suppression of mechanical dissipation.   Connecting the world of superconducting or other solid-state qubits to optomechanical systems represents an intriguing possibility in the context of quantum information processing. This has become particularly relevant since the pioneering experiment at UCSB  that demonstrated strong coupling between a superconducting phase qubit and the  oscillations of a piezoelectric nanoresonator, swapping a single excitation from the qubit into the resonator. First experiments have demonstrated how to manipulate a mechanical nanoresonator both via the optomechanical interaction and electrically , which is an important ingredient for a future hybrid platform of solid-state qubits with electrical interactions coupled to mechanical nanoresonators coupled to the light field. Theoretical proposals have already pointed out how to use systems of this type to map solid-state quantum information into photons and back again . More elementary, the nanomechanical structure can serve as an intermediary to generate entanglement between microwave and optical fields .  An equally promising avenue is to merge the fields of solid-state quantum optics and cavity optomechanics. First experiments deliberately introducing semiconductor materials in cavity optomechanical setups now exist. These include -diameter GaAs vibrating disk structures with very high optomechanical coupling strength  and coupling of the light field to a semiconductor nanomembrane . The excitonic transitions of quantum dots embedded in such materials could couple to the mechanical vibrations either directly via deformation potentials or indirectly via the light field .    Quantum protocols    The previous sections introduced some basic quantum-physical features in optomechanical systems, such as producing and reading out nonclassical states of light and mechanics. As soon as this can be achieved reliably, one may envisage building a toolbox for quantum manipulation in these systems, and exploit it for purposes of quantum communication and quantum information processing. This would follow the pioneering ideas and efforts in the ion trap community, where it has been suggested early on that one can exploit the motional degrees of freedom to facilitate quantum gates between the internal states of ions . Micro- and nanomechanics offers the added value that they can be functionalized and hence couple to many different physical degrees of freedom. Optomechanical devices therefore offer a fruitful addition to the vast array of physical systems that are being explored for quantum information processing .  One of the most prominent protocols is quantum state transfer. In the context of optomechanics, this would allow to realiably convert an optical pulse into a mechanical excitation (and vice versa). In principle, this is straightforward, since the linearized optomechanical interaction describes a coupling between two oscillators (mechanical and driven cavity mode), which can be tuned via the laser intensity (Sec. ). For the red-detuned case, , in the resolved-sideband limit, we found a beam-splitter type of interaction:     Thus, the excitations  on top of the strong coherent laser drive can be swapped onto the mechanical resonator. Such an operation would be performed in a pulsed scheme. The coupling  becomes time-dependent via the laser intensity, and it would be switched on for just the right amount of time to perform a complete state swap between the two oscillators ( and ). Two laser pulses are needed for this scheme. A red-detuned control pulse at  determines the time-dependent coupling . A second, ``signal'' pulse serves to excite the -oscillator into some target state that then will be written onto the mechanics. Since  oscillates at the frequency  in the frame rotating at  , the signal pulse has to be injected at a frequency , i.e. right at the cavity resonance. Ideally, the whole swapping pulse sequence is shorter than the cavity decay time, which however requires a two-mode setup with different decay rates for the modes (since the control pulse cannot be shorter than  for a single mode). A detailed analysis of swapping protocols can be found in .             There is also a simple classical picture for what happens during such a pulse sequence: The superposition of signal and control beam leads to a beat-note in the intensity at . This translates into a radiation pressure force that resonantly excites the mechanical oscillator.  The optomechanical interaction can also be exploited for conversion between different optical wavelengths. That scheme is illustrated schematically in Fig. . It involves two optical resonances, each of which is driven by a strong control beam, red-detuned by . When an input signal (e.g. a pulse) is injected at the resonance of mode 1, it will be converted to an output signal emanating from the resonance of mode 2. This has been demonstrated recently in .  First experimental proof-of-principle demonstrations have shown these concepts in the high-temperature, classical regime . In this context it was pointed out  that the requirement for coherent state transfer of this type is . The next challenge will be to drastically improve the fidelity and demonstrate true quantum state transfer , e.g. by reconstructing the mechanical quantum state (Sec. ).   Recently, state transfer between a mechanical mode and an itinerant microwave coherent state has been reported . In this experiment, a suitably shaped microwave pulse was written onto the motional state of a micromechanical membrane and later retrieved via quickly switched control beams, hence realizing a coherent mechanical memory for microwave pulses in the weak coupling regime. Another protocol that does not require the strong coupling regime is based on quantum state teleportation .  If a single photon is sent into the setup and transferred to the mechanical resonator, this will prepare the resonator in a Fock state or some nonclassical state in general . That may be the most efficient route towards generating nonclassical mechanical states in optomechanical systems as long as the single-photon strong coupling regime (Sec. ) has not been reached.            Up to now, we have only described how single localized phonons (stored inside the mechanical resonator) can be converted to photons and back again. An equally interesting, or perhaps even more useful, scheme would take traveling phonons and convert them to photons. Such a device has been proposed recently and has been termed an optomechanical ``traveling wave phonon-photon translator'' . Although the frequency is shifted by many orders of magnitude, the wave function of the outgoing single photon is designed to be a faithful replica of the incoming phonon's wave function.   The basic idea is the following: Phonons are traveling down a phononic waveguide and enter a localized phononic mode, where they experience the usual optomechanical interaction. Frequency upconversion is achieved by having a high-intensity stream of incoming photons. In a Raman-type scattering process, the phonon combines with one of those photons to form a single photon at a slightly different frequency, so energy conservation is obeyed. The strong pump beam and the weak stream of outgoing converted photons can be efficiently separated by being coupled to two different optical modes. Indeed, a suitably engineered optomechanical structure  has two optical modes coupling to the phonon displacement field in the following way (which is conceptually identical to the membrane-in-the-middle setup discussed in Sec. ):     If mode  is pumped strongly, we can replace the field operator by the classical amplitude:  (assume  real-valued). If , then the resonant terms to be retained are:     This clearly displays the elementary process of converting a single phonon to a single photon (and back). It also shows that the conversion rate can be tuned via the pump strength . All the remaining challenge lies in ensuring that 100 of the phonons arriving at the device are indeed converted into photons. This is essentially an impedance-matching problem, since the coupling of the phonon mode to the phonon waveguide (ideally set by  if other losses can be neglected) is usually much weaker than the coupling of the optical mode to the photon waveguide (set by ). Without extra fine-tuning, most of the phonons would be reflected. This can be overcome by a judicious choice of the coupling. Indeed, from the point of view of the phonon mode, the coupling () to the lifetime-broadened photon mode  gives rise to a Fermi golden rule transition rate . This is the rate at which a given localized phonon would be converted and decay into the photonic waveguide, and it is identical to the optomechanical cooling rate in the sideband-resolved regime. By matching this to the coupling to the phononic waveguide, i.e. demanding , one creates a situation that is equivalent to a two-sided cavity with equal mirrors, where 100 transmission can be achieved on resonance. Consequently, in the present setup ideally 100 of the phonons can be converted if . A detailed analysis considers the full scattering matrix that describes scattering of incoming phonons into the photon waveguide (or reflection back into the phonon waveguide), and it includes the unwanted effects of extra intrinsic losses and noise     .  On a classical level, the device described above takes the slow amplitude and phase modulations of the phonon field, i.e. of a soundwave traveling down the waveguide, and transposes them into the optical domain by shifting the carrier frequency from mechanical frequencies (e.g. ) up to optical frequencies. The fact that the bandwidth is set by the smallest damping rate in the problem, which is , can be an advantage if one uses the device as a narrow-bandwidth frequency filter. For example, two photon-phonon translators in series (the first one operated in reverse, i.e. going from photons to phonons) implement a potentially very narrow filter in the optical domain.  Phonon-photon conversion has been analyzed for transferring solid-state quantum information to the optical domain  and for transferring optical pulses between different wavelengths and pulse shaping .   One example for the more advanced possibilities of optomechanical quantum protocols is to perform continuous variable quantum teleportation. Besides employing this for generating entanglement between distant mechanical oscillators (as mentioned above), one may also teleport an arbitrary input state of the light field onto the mechanics. The generic idea is to start with the entanglement between the mechanical motion and a light beam, and then to let the beam interfere at a beamsplitter with another light beam, carrying an arbitrary input state. A subsequent measurement in both output ports of the beamsplitter (Bell measurement) then yields a classical measurement result on the basis of which one manipulates the mechanical state, leaving it in a final quantum state that equals the arbitrary input state. Such a scheme has been analyzed for a strong short laser pulse impinging on a vibrating mirror in a free-beam setup (without a cavity) , where the reflected optical Stokes and anti-Stokes modes at  get entangled with the vibrations, and for a time-dependent drive of an optomechanical cavity .   Nonlinear quantum optomechanics    The optomechanical interaction     is cubic in field operators, i.e. the corresponding Heisenberg equations of motion are nonlinear. However, in experiments this nonlinearity so far has only played a role in the classical regime of large amplitude oscillations (both mechanical and with regard to the light field), see Sec. . In the quantum regime, we have thus far resorted to the ``linearized'' description, with a quadratic interaction Hamiltonian of the type , see Eq. (). This linearized approach is good enough to understand many facets of cavity optomechanics: displacement detection down to the SQL (Sec. ), the theory of optomechanical ground-state cooling (Sec. ), light/mechanics hybridization in the strong-coupling regime  (Sec. ), optomechanically induced transparency (Sec. ), optomechanical squeezing of light (Sec. ), and almost all of the various entanglement and state transfer schemes presented in the previous sections. The experimental advantage of the linearized interaction is that its strength  can be tuned at will by the incoming laser power. In this way, a small value of  (fixed by the setup) may be compensated for by a stronger laser drive, until technical constraints become important.  The disadvantage of relying on the linearized interaction is that, by itself, it will always turn Gaussian states (of the light field and the mechanics) into Gaussian states. These may be squeezed or entangled, but they will never have a negative Wigner density, which may be required for certain quantum applications. It should be noted that there are some ways around this restriction, by introducing a nonlinearity at some other stage of the experiment: For example, one may send in single-photon pulses and then transfer these Fock states onto the mechanics using the linearized interaction. Another, sometimes equivalent, option is to perform single-photon detection at the end, thereby creating nonclassical states via post-selection of events. These strategies are therefore related to the general schemes that have been exploited already for linear optics quantum computation by adding single-photon sources and photodetectors .  Thus far, we have encountered only two ideas on true nonlinear quantum optomechanics: The optical QND detection of the phonon number (Sec. ) is such an example, and it indeed would prepare (probabilistically) Fock states of the mechanical oscillator. Another example, discussed already very early in the literature, is the optomechanical ``Schr�dinger cat'' type of entanglement, where a single photon should ideally be able to displace the mechanical oscillator by about a mechanical zero-point width (Sec. ).  These examples require a large value of , which is a challenge. We remind the reader that in a typical (Fabry-Perot type) setup the value of  can be estimated as     Here  is the effective size of the cavity , and  the effective mass. Both can be made small by miniaturizing the setup, and consequently record values of  are achieved in micrometer-size devices, like photonic crystal nanobeams or very small disks and toroids. This is even in spite of the fact that miniaturization also drives up the mechanical frequency . In such setups,  currently takes values on the order of up to some  (see Sec. ).  Next, we should discuss in which sense  can be ``large''. The steady-state displacement produced by a single photon on average () is     Thus, to displace by more than the zero-point width (mechanical ground state width), one needs . However, if the photon decay rate  is large, then one can see only the average displacement produced by the photon number fluctuating around , and one would not resolve the granularity of the photon stream. Such a situation should still be well described within the linearized approximation. To obtain truly nonlinear effects, one would rather like to make sure the following picture applies. Take any single photon entering the cavity. If its lifetime is large enough (, the resolved-sideband regime), it will displace the oscillator by the amount given in Eq. (). This then implies  as a necessary (but not sufficient) condition.  These considerations directly lead us to consider the ratio     If that ratio is larger than one, then the presence of a single phonon would shift the optical frequency by more than a cavity linewidth. More precisely, the mechanical displacement produced by a superposition of 0 and 1 phonons would be measured so efficiently that the passage of a single photon through the cavity already destroys the superposition. We can also look at the light field's back-action: In the ``bad cavity'' limit (), a single passing photon with a lifetime  gives an average momentum kick  to the mechanical oscillator, which would be larger than its zero-point momentum uncertainty  if . One can make a connection to the Lamb-Dicke parameter used in ion-trap physics, by defining the ratio of momentum kick to momentum zero-point fluctuations: .   The ratio  has been called the ``granularity parameter'' , as  allows to reveal the granularity of the photon stream (the discreteness of individual photons). It has reached values on the order of and larger than one in experiments with clouds of ultracold atoms (see Sec. ).  There are other ways of interpreting  as well: The (sideband-resolved) cooling rate  would be so large that one enters the strong-coupling regime (Sec. ) already for . Alternatively,  can be written as the ratio between the mechanical zero-point fluctuations and the width of the optical cavity resonance, expressed in terms of a displacement (where the optomechanical coupling enters):     where .  There is an additional interesting aspect about . It can serve as a ``quantumness'' parameter , with larger values denoting a gradual classical-to-quantum crossover. All the parameters of any given standard optomechanical setup can be boiled down to the following five dimensionless combinations:     Here the first four do not depend on the value of Planck's constant. This is obvious for the first three (the sideband-resolution ratio, the mechanical quality factor, and the laser detuning in units of mechanical frequency). It is less obvious for . However, this can be written as     Here  is the light energy stored inside the cavity, which is connected to the laser driving power. In this sense,  serves as a dimensionless classical measure of laser power. Only the ratio  depends on , as can be seen from Eq. (): .  Thus, one can imagine keeping all four classical ratios fixed, and only increasing  by changing parameters in the setup. This is then completely equivalent to increasing Planck's constant, allowing one to resolve more and more quantum features as  grows. It should be noted that of course even for  one can observe quantum effects, but only in the linearized regime. Proving the quantumness of these effects produced by linearized interactions usually requires a quantitative comparison (e.g. with the light field's or the oscillator's zero-point fluctuations). In contrast, some features observed for larger values of  may even be qualitatively distinct from classical predictions. An example noted above are the quantum jumps of phonon number that could be observed for  (Sec. ).  The third important ratio involving the coupling is     This is the ratio between the strength  of the effective photon-photon interaction induced by the mechanics, and the optical linewidth. When this starts to be larger than one (and ), then the presence of one photon shifts the resonance sufficiently that a second photon cannot enter the cavity. That leads to the photon-blockade phenomenon (see below).  In , the regime of  was considered using both full numerical master equation simulations and a quantum Langevin approach. There, it was found that for increasing values of  quantum fluctuations start to have a pronounced effect on the mechanical lasing instability that is observed at blue-detuned laser driving. The strongly enhanced susceptibility of the system just below the threshold amplifies the effects of these fluctuations, and the threshold is smeared and shifted. In this quantum regime, the co-existence of several attractors (known from the classical case, see Sec. ) results in non-Gaussian mechanical Wigner densities and mechanical states with non-Poissonian phonon distributions and large Fano factors . It was found that in this regime for appropriate parameters one can even generate true nonclassical mechanical states, with partially negative Wigner densities . These states are present in the steady state (under constant drive), so the Wigner densities could then be read out according to the schemes presented in Sec. .  In , master equation simulations were further extended to discuss the full range of detunings and the excitation spectrum of the cavity. Multiple optical sidebands are found, and the mechanical state of the oscillator is seen to develop non-Gaussian states particularly at detunings which drive multi-photon transitions.   The nonlinear quantum optomechanical regime leads to very interesting photon correlations. In particular, under appropriate conditions one may observe optomechanically induced photon blockade . This shows up in the photon-photon correlations as strong anti-bunching, , which has been calculated and discussed in  for the case of weak laser driving. The regime of optomechanical photon blockade requires sideband resolution () as well as strong single-photon coupling with  and . In a more recent work, the analysis of photon correlations in this regime was extended to cover the full temporal evolution of  and the Fano factor, as well as higher moments of the photon counting statistics .  In , an exact solution was presented for the regime where only a single photon is transmitted through such a strongly coupled optomechanical setup, which is important for the generation of entanglement (Sec. ).  The understanding of the strongly nonlinear quantum regime is aided by the following picture, already discussed partially in Sec. , and first employed in : For any given photon number , the mechanical equilibrium position is shifted by an amount . One should thus consider the mechanical Fock states in this new displaced parabolic potential.   If an additional photon enters the cavity, the potential suddenly shifts, but the mechanical wave function at first remains the same. Thus, the overlaps of the given initial wave function and the displaced new Fock states will determine the strength of possible transitions. These overlap integrals are known as Franck-Condon factors from the theory of molecules, where vibrations may be excited during electronic transitions.  We conclude by briefly describing the formal treatment via the well-known polaron transformation, as applied to an optomechanical system . We consider the standard optomechanical Hamiltonian (in the frame rotating with the laser frequency)     where  is proportional to the laser amplitude. We complete the square to obtain      for the first three terms in . This shows two things: First, an effective photon-photon interaction is generated, viz. the  term, which is crucial for nonlinear effects and quantum gates.                   Second,  photons shift  by , i.e. they shift the equilibrium oscillator position by  to the right. This can be accomplished by a unitary  acting on the wave functions. After applying that transformation to the Hamiltonian, via , we obtain a Hamiltonian that would be diagonal in the absence of driving and decay:   H & =-(+g_0^2a^a)a^a+b^b+   & _L(a^e^(b-b^)(g_0/)+h.c.)+U^H_bathU.  Note that in these new coordinates the addition of one photon shifts the wave function to the left, whereas the center of the mechanical oscillator potential is now forced to remain fixed (in contrast to the actual physical situation, where the potential shifts and the wave function is fixed). The exponential (polaron operator) in the laser driving term generates the Franck-Condon overlap factors.             The energy level scheme for the nonlinear quantum optomechanical regime (Fig. ) displays equally spaced phonon ladders whose offset shifts depending on the photon number: . In this scheme, the driving laser only induces energy-conserving transitions, horizontal in the diagram. Different transitions are activated upon changing the detuning. Multi-photon transitions become possible via virtual non-resonant intermediate states (e.g. adding two photons at once).   Future Perspectives  The fast experimental and theoretical advances in cavity optomechanics during the recent years are constantly opening up new avenues with respect to applications and tests on the foundations of physics. Here we remark briefly on the broader outlook.   Foundational aspects    The ability to achieve coherent quantum control over the center of mass motion of massive mechanical objects provides a fresh approach to fundamental tests of quantum theory in a hitherto unachieved parameter regime. Specifically, quantum optomechanics offers a universal scheme for experiments in the quantum regime of massive mechanical objects from clouds of  atoms or nanometer-sized solid-state devices of  atoms and a mass of  kg, to micromechanical structures of  atoms and  kg, to macroscopic centimeter-sized objects for gravitational wave detectors comprising more than  atoms and weighing up to several kg. In principle, this offers a range of almost 20 orders of magnitude in mass and 6 orders of magnitude in size for macroscopic quantum experiments.   A specific example where quantum optomechanics provides a new direction for future experiments is the quantum measurement problem, which addresses the question why quantum superpositions do not seem to occur at the level of macroscopic objects . Various new theories and phenomena beyond quantum theory have been suggested in order to achieve an irreversible decay of superposition states, i.e. decoherence, into well-defined classical states . Each of these approaches predicts a particular scaling of the decoherence rates with particle number or mass, and with the actual distinctness of the states involved in the superposition. For sufficiently macroscopic systems and sufficiently distinct superposition states, these predictions deviate significantly from the decoherence rates expected from standard quantum theory . Current matter-wave experiments with molecules may soon start to enter such a regime . Systematic tests of the validity of quantum theory necessarily also involve tests of such scaling laws and the large  mass range offered by quantum optomechanical systems will provide a unique opportunity. One way of producing quantum states involving superpositions of mechanical states is via optomechanical entanglement (see Sec. ). Probing the decoherence of such optomechanical superposition states, for example via the interference visibility in a single-photon interferometer , may allow decisive tests of specific 'collapse' models . A particularly exciting perspective is to extend these experiments to the large masses that are available in gravitational wave interferometers (see  for a recent review) and that were recently cooled to 200 thermal quanta above the quantum ground state . Another route that has been suggested is to analyse the contrast of matter-wave interference of levitated nano-objects, where superpositions of macroscopically distinct position states are generated via optomechanics . It has been shown that such experiments would in principle allow to enter a regime in which all non-standard decoherence theories can be systematically tested . The demanding experimental boundary conditions with respect to temperature and background pressure (to minize the effects of standard decoherence) might require the added benefit of a space enviroment. First studies along this line are currently being performed  .  Another fascinating long-term perspective is the possibility to make use of the accessible large masses in quantum optomechanics experiments to explore the scarcely studied interface between quantum physics and gravity. Some of its aspects are already covered by the decoherence tests discussed above, as the models of Karolyhazy , Diosi  and Penrose  identify gravity as the dominant player of their state-vector collapse. A completely different approach has been taken by a recent proposal  that suggests that quantum optomechancis experiments could test directly predictions from quantum gravity. Specifically, the availability of large masses in combination with quantum optical state preparation and readout is shown to be sensitive to possible deviations from the quantum commutation relation even at the Planck scale. This would open the route to table-top quantum optics tests of quantum gravity predictions.   The possibility to interconnect optomechanical devices in large scale arrays has already been discussed in the context of investigating synchronization effects . The dynamics in such arrays may also enable the study of many-body quantum effects, which could complement the current efforts in quantum simulations, yet in a solid-state architecture . Another scarcely explored direction is to exploit the role of nonlinear mechanical responses. For example, the double-well potential of bistable mechanical resonators  could be the starting point for macroscopic tunnelling experiments.   Finally, it is interesting to note that also in a broader context, the topic of controlled photon-phonon interaction is receiving increasing attention. For example, a recent experiment has demonstrated quantum entanglement between optical phonon modes of two separate macroscopic solids, specifically of milimiter-scale bulk diamond at room temperature , which has been generated from photon-phonon entanglement. Besides providing an interesting alternative to obtain quantum effects involving macroscopic objects this is also of direct relevance for applications, such as solid state quantum memories. Other examples include new schemes to achieve coherent conversion of bosonic modes, and even suggestions to exploit the measurement of optomechanical recoil energies for mesoscopic mass standards.   Applications    Although the field of cavity optomechanics is only in its beginnings, several domains of applications have become obvious already now. In laser sciences, these include tunable optical filters, based on the fact that optomechanical coupling can lead to extreme tuning of the mechanical frequency up to several octaves, as well as optomechanical implementations of laser stabilization . In addition, the compatibility of some optomechanical devices with silicon photonics (see Sec. ) enables on-chip optical architectures with added versatility. For example, exploiting strong optical nonlinearities provided by optomechanical cavities (see Sec.) adds an important and long-sought feature to optical information processing. Along the same lines, embedded optomechanical cavities have been shown to serve as an all-optical memory element , or have been proposed as a new technology for single-photon detection . In the first case, the binary states of a bistable nanomechanical resonator are controlled and monitored by an optomechanical cavity; in the latter case, a single photon would induce a measureable frequency shift to an optomechanical cavity, thereby resulting in a detection that is in principle destruction-free and photon-number resolving. In the long run, these features may provide a new momentum to all-optical information processing .  For sensing applications, cavity optomechanics provides several new aspects: for example, while damping of mechanical motion has been used to increase the bandwidth of scanning microscopes since decades , cavity optomechanical devices allow both readout and damping of much higher mechanical frequencies, hence providing faster sampling and scanning rates. At the same time, the high sensitivity of the optical readout allows new integrated optomechanical platforms for acceleration sensing. A recent demonstration using optomechanical crystals achieved an on-chip acceleration resolution of 10 with a test mass of only a few ng. Optomechanical cooling in combination with on-chip mechanical sensors has recently also been suggested to provide a reduction in thermal noise for the optical readout . In turn, the ability to coherently amplify mechanical motion provides a route to radiation pressure driven coherent oscillators with compact form factor and low power consumption. Finally, the combination with optomechanical preparation of squeezed mechanical states (see Sec.) could lead to a new mechanical sensing technology with unprecedented levels of sensitivity due to the reduced position variance of the readout device.  From a quantum information processing perspective cavity optomechanics offers a new architecture for coherent light-matter interfaces in a solid-state implementation. Mechanical motion can serve as a universal transducer to mediate long-range interactions between stationary quantum systems (see Sec.). The specific trait of optomechanical systems is the interconversion between stationary qubits and flying (photonic) qubits, which constitutes one of the main elements of long-distance quantum communication and a future quantum internet . At the same time, strong optomechanical coupling in the single-photon regime opens up the field of non-Gaussian quantum optomechanics with a wealth of quantum operations and protocols (see Sec.). The phenomenon of optomechanically induced transparency enables slowing of light pulses or even their storage, hence providing an interesting solid-state implementation of a quantum memory (see Sec.).   Eventually, combining cavity optomechanics with other transduction mechanisms will allow to exploit the full functionality of micro- and nanomechanical devices. Such quantum hybrid systems utilize the mechanical motion to achieve coupling between otherwise incompatible or uncoupled quantum systems (see Sec. ). A particularly exciting perspective of opto-electromechanical hybrid devices is their ability for coherent conversion between optical and microwave frequencies. Cavity cooling in these hybrid structures could also be applied to certain modes of a heat bath in integrated electronic circuits, for example to suppress unwanted thermalization effects in spintronic devices . Another interesting direction is to couple individual qubits, for example single atoms or single spins, to optomechanical devices. In combination with large mechanical frequencies such structures could allow mechanically mediated qubit interactions without additional laser cooling of the mechanical modes, thereby significantly relaxing the experimental requirements for information processing in qubit registers.   Acknowledgements  We would like to thank our many colleagues and co-workers in the field, from whom we have learned a lot about this subject in numerous discussions. We are grateful to Anton Zeilinger for enabling a stay at the ``Internationale Akademie Traunkirchen'' in the summer of 2010, during which this review was started.  Among the many helpful remarks we received from colleagues, we would like to thank in particular Sebastian Hofer, Max Ludwig, Oskar Painter, Albert Schliesser and Dan Stamper-Kurn for their critical reading of the manuscript and valuable feedback, and Uros Delic, David Grass and Nikolai Kiesel for their assistance with figures and references.  Each of us acknowledges support by a Starting Grant of the European Research Council (ERC StG). In addition, we like to acknowledge the following funding sources: the DFG with the Emmy-Noether program (F.M.), the DARPA ORCHID program (F.M., T.J.K.), the European FP7 STREP project MINOS (M.A., T.J.K.) and the Marie-Curie ITN cQOM (M.A., T.J.K., F.M.). T.J.K. acknowledges funding from the Swiss National Science Foundation (SNF) and the NCCR of Quantum Engineering. M.A. acknowledges support from the Austrian Science Fund FWF (projects FOQUS, START), from the European Commission (Q-Essence) and from the European Space Agency ESA.      Appendix: Experimental Challenges   Influence of classical excess laser phase noise on laser cooling    We briefly consider the role of laser noise in optomechanical cooling. Of particular interest is phase noise, described by the phase noise spectral density  (or alternatively described by its equivalent frequency noise ). Excess phase (and amplitude) noise can be found in many laser systems due to relaxation oscillations, which can even in the case of diode lasers extend well into the GHz regime . Such excess phase noise has has been experimentally observed to heat the mechanical oscillator  and has been analyzed theoretically . The spectral density of force fluctuations caused by this noise when pumping on the lower sideband in the resolved sideband regime, is given by (with ):     By comparing this force noise to an effective thermal Langevin force of the laser () near the mechanical resonance an equivalent laser noise occupation  can be derived. The final occupancy of the mechanical oscillator in the presence of optomechanical sideband cooling is subsequently , where  denotes the average occupancy of the thermal bath. The excess contribution of the frequency noise is therefore:    The lowest occupancy that can be attained in the presence of excess phase noise is given by      This expression can also be recast into a condition for the amount of phase noise that would lead to unit occupancy, i.e. . Given the cavity photon number required to cool near to the ground state (), we find that  if the frequency noise exceeds the level      If this level of noise is present, phase noise will preclude ground state cooling. This formula also reveals that to mitigate the effect of phase noise it is generally desirable to have a large vacuum optomechanical coupling rate and a low mechanical damping rate, to increase the level of tolerable phase noise.   Influence of cavity frequency noise on laser cooling    The cavity frequency fluctuations are driven by thermodynamical temperature fluctuations. Considering the situation were light propagates inside a dielectric cavity (microtoroid, microspheres, photonic crystals) or penetrates a mirror surface, the temperature fluctuations of the sampled volume  are determined both by the absolute temperature and the heat capacity of that volume:    Here  is the specific heat capacity (per mass). In general, these temperature fluctuations will exhibit a spectral density that depends on the resonator geometry and boundary conditions for the thermal transport. For some cases, such as silica microspheres, the spectral densities  are known analytically  and the corresponding frequency noise, , can be evaluated (where  in the case of thermorefractive noise and  in the case of thermoelastic noise). While it has been noted that one can in principle compensate also thermorefractive noise , the noise is of particular relevance to optomechanical cooling as it provides a limit to the minimal occupancy. This can be understood with the model referred to in the last section, ie. the fact that cavity frequency noise will translate into radiation pressure force fluctuations in the presence of a strong cooling laser.   Finite thermal cavity occupancy. A further source of cavity noise can arise from the fact that the cooling field has thermal occupation. This is in particular the case for microwave fields due to their low frequency. If the cavity occupation is given by , then the final occupation is modified to (in the resolved sideband limit):    This implies that the final phonon number can never be below the effective thermal occupation of the drive field . It should be noted that when the radiation field and the mechanical oscillator initially have the same bath temperature (as will be the case in equilibrium, without extra absorption), the equilibration of these two oscillators of frequency  and  will lead to an effective cooling of the lower frequency mechanical oscillator, as    Influence of classical excess laser noise on sideband thermometry  Excess noise of the readout laser (characterized by an occupancy  ) compromises the self-calibration of the sideband thermometry method (Sec. ), as it can lead equally to an asymmetry, since in the presence of laser noise  and . This asymmetry can in this case be understood by arising from noise squashing and anti-squashing of the classical and quantum noises alike. This noise induced asymmetry on the upper and lower sideband can also be viewed as originating from the effects of optomechanically induced  transparency (OMIT) and optomechanically induced amplification (or EIA).      

Optomechanics


Florian Marquardt
Arnold Sommerfeld Center for Theoretical Physics, Center for NanoScience, and Department of Physics, Ludwig-Maximilians-Universitat
Munchen
 Theresienstr. 37, D-80333 Munchen, Germany

S.M. Girvin
Department of Physics, Yale University

PO Box 208120, New Haven, CT 06520-8120




The concept that electromagnetic radiation can exert forces on material objects was predicted by Maxwell, and the radiation pressure of light was first observed experimentally more than a century ago .  The force  exerted by a beam of power  retro-reflecting from a mirror is .  Because the speed of light is so large, this force is typically extremely feeble but does manifest itself in special circumstances (e.g. in the tails of comets and during star formation).  Beginning in the 1970's it was appreciated that one could trap and manipulate small particles and even individual atoms with optical forces . 

Recently there has been a great surge of interest in the application of radiation forces to manipulate the center of mass motion of mechanical oscillators covering a huge range of scales from macroscopic mirrors in the LIGO project  to nano- or micromechanical cantilevers , vibrating microtoroids   and membranes .  Positive damping permits cooling of the motion, negative damping permits parametric amplification of small forces . Cooling a mechanical system to its quantum ground state is a key goal of the new field of optomechanics.

Radiation pressure also appears in the form of unavoidable random back action forces accompanying optical measurements of position as the precision of those measurements approaches the limits set by quantum mechanics .   The randomness is due to the photon shot noise, whose observation is a second key goal of the field.

In pioneering work, Braginsky and collaborators  first detected mechanical damping due to radiation in the decay of an excited oscillator.  Very recently both measurement and mechanical damping of (the much smaller) random thermal Brownian motion (i.e. cooling of the center of mass motion) was achieved by several groups using different techniques (see also  for a brief review). These include the intrinsic optomechanical cooling (to be described below) by photothermal forces   or radiation pressure   and active feedback cooling  based on position measurements. 







Retarded radiation forces

The typical experimental setup in optomechanics consists of an optical cavity where one of the end-mirrors can move (Fig. ). For example, experimentalists have attached micromirrors to AFM cantilevers or nanobeams . When the cavity is illuminated by a laser, the circulating light gives rise to a radiation pressure force that deflects the mirror. Any displacement of the mirror, in turn, will change the cavity's length and thereby alter the circulating intensity, since the optical cavity mode frequency shifts with respect to the fixed laser frequency. It is this coupled dynamics that produces a wealth of interesting effects in such systems. The role of the cavity is twofold: It resonantly enhances the circulating intensity, and it makes the intensity depend very sensitively on the position. Although the setup described here may seem rather special at first sight, it is in fact just one incarnation of a very generic nonlinear nonequilibrium situation: On the most general level, we are dealing with a resonance (the optical cavity mode) that is driven (by a laser), and whose resonance frequency is pulled by the displacement of some mechanical degree of freedom (the movable mirror). Having the resonance frequency depend in this manner on the position immediately implies that there will be a mechanical force. Given this general description, it is no wonder the same physics has by now been realized in a diverse variety of physical systems, including superconducting microwave circuits  and ultracold atoms . However, in the following we will employ the terms appropriate for the simple optical setup, keeping in mind that the concepts can readily be translated to other situations.

Intrinsically, the movable mirror is a harmonic oscillator. However, as the radiation force depends on the mirror's position, it modifies the mechanical properties of the mirror. The force gradient will change the mirror's spring constant, an effect known as "optical spring", which has been used to increase the frequency of a mirror by a factor of more than twenty, essentially trapping it using light . The potential in which the mirror moves can be changed drastically by the radiation forces, eventually giving rise to  multiple stable positions if the circulating intensity is large enough .

There is yet another crucial feature about the radiation forces: they respond with a time-lag. In the setup discussed here, this is due to the finite ring-down time of the cavity, i.e. the time needed for photons to leak out (proportional to the cavity's finesse). The radiation force as a function of mirror position is a simple Lorentzian (Fabry-Perot resonance). Let us imagine that the mirror is placed on the slope of the resonance (see Fig. ).  As the mirror oscillates, e.g.  due to thermal fluctuations or because of driving, it moves back and forth along the slope. On approaching the resonance, the force will be smaller than expected, due to the time-lag, and it  remains larger when the mirror retracts. Overall, the radiation force extracts work from the mirror: . This amounts to an extra damping, which will cool down the mirror by reducing thermal fluctuations. As discussed  below, positioning the mirror on the opposite side of the resonance leads to a negative effective damping constant. These effects are sometimes labeled "dynamical back-action", since they involve the light field acting back on the mechanical motion after having been perturbed by the mirror. Alternative optomechanical cooling schemes include Doppler-cooling in Bragg mirrors  and "active feedback cooling" . 

The optomechanical damping rate  scales linearly with laser intensity and depends sensitively on the position of the mirror. In the naive classical picture described here, it reduces the effective temperature according to , where  is the bulk equilibrium temperature and  the intrinsic mechanical damping rate. Note that we are talking about the effective temperature of a single mechanical mode of the structure that carries the mirror: Optomechanical cooling will not reduce the bulk temperature of the setup. This, however, is fully sufficient, if in the end the experiment is only sensitive to this particular degree of freedom. An analogous situation arises in molecule interferometers, where the center-of-mass motion may be quantum, even though the internal motion of atoms in the molecule remains hot.




Quantum picture of cooling: Towards the ground state

The classical time delay description given above shows how the viscous damping force is produced.  As a transition to the full quantum picture, it is convenient to switch from the time domain to the frequency domain.  Periodic motion of the mechanical system at frequency  leads to amplitude and phase modulation of the optical amplitude inside the cavity.  This modulation leads to sidebands displaced from the optical carrier frequency by .  This is precisely analogous to Raman scattering from a solid whose index of refraction is periodically modulated in time (and space) by sound waves.  Hence the lower and upper sidebands are referred to as Stokes and anti-Stokes respectively.  If both phase and amplitude modulation are present, they interfere causing one sideband to be stronger than the other.  This can be achieved by detuning the optical carrier frequency from the cavity resonance.

Quantum mechanically, the lower sideband comes from a process in which a carrier photon loses energy  by creating a phonon inside the mechanical oscillator.  Correspondingly the anti-Stokes upper sideband comes from a process that removes energy  from the mechanical oscillator.  This is the process needed for cooling. Because the sideband photons differ in energy by , a difference in intensity of the two sidebands implies a net energy transfer by the optical field from or to the mechanical system.  The required asymmetry is achieved by putting the optical carrier frequency below the nominal cavity Fabry-Perot resonance.  As shown in Fig. , this puts the anti-Stokes line closer to the cavity resonance and the Stokes line further away.  This yields an asymmetry in the density of states seen by the Stokes and anti-Stokes photons and hence an asymmetry in the rate of their production, as can be analyzed nicely in the "quantum noise" approach .

Although this scheme produce cooling, we cannot approach the quantum ground state unless the Stokes intensity is close to zero.  This is reasonable since the Stokes process excites the mechanical system to higher energy levels.  As shown in Fig. () the huge Stokes/anti-Stokes asymmetry can be achieved only in the good cavity limit where the cavity resonance linewidth is smaller than the sideband spacing . Another condition is that the optical intensity be high enough that the resulting optical damping almost instantly removes any thermal phonons which enter the mechanical oscillator from the surroundings.  Then, the full quantum expression for the minimum achievable mean phonon number of the oscillator is 


n_min = ( 4 _M  )^2, 

where  is the optical ring-down rate of the cavity. While not technically easy, one can in principle detect the approach to the mechanical ground state by the disappearance of the anti-Stokes sideband. Mechanical and optical resonances hybridize  in the strong-coupling regime when  exceeds the cavity decay rate .

At present, experiments have not yet reached the ground state, though phonon numbers as low as  have been obtained very recently using optomechanical cooling . Current challenges include starting from a low bulk temperature (requiring cryogenic operation), making sure to have a large mechanical quality factor (which limits the achievable cooling ratio), and fighting spurious heating from light absorption. Figure  illustrates the current status for intrinsic cooling (without feedback).







Displacement readout 

Detecting the mirror's motion is in principle straightforward, since the optical
phase shift is directly proportional to the mirror's
displacement . Typically, the Lorentzian frequency spectrum of the mirror's position fluctuations is obtained in this way. The peak width
yields the total damping rate, including the effective optomechanical damping.
 The area under the spectrum reveals the variance of ,
which is a measure of the effective temperature, according to the classical
equipartition theorem. 

It is well known that quantum mechanics puts a fundamental constraint on the
sensitivity of any such "weak" displacement measurement. Indeed, being able to follow
the motion over time with arbitrary precision would reveal the mirror's trajectory, which
is forbidden by Heisenberg's uncertainty relation. The photon shot noise limits the precision for estimating the phase shift. In principle, this can be overcome by increasing the light intensity. However, then another effect kicks in: The shot noise of photons being reflected from the mirror imprints an unavoidable "jitter", masking the mirror's "intrinsic" motion. This effect is called measurement back-action. The standard quantum limit is reached when both effects are equally strong. It corresponds to resolving the mirror's position to within its ground state uncertainty, after averaging the signal over a damping time. The quantum limit has been approached up to a factor of five recently, with an imprecision of . Detecting the measurement back-action effects is still an outstanding challenge (but see ). Back-action free measurements of quadratures of the mechanical motion are another option.

However, in order to see genuine "quantum jumps", it is necessary to carry out 
a quantum non-demolition measurement with respect to an observable that, unlike position,
is conserved by the Hamiltonian. The most important example in this
context would be the phonon number. Recently, a modified optomechanical
setup was introduced , with a movable membrane in-between two fixed end-mirrors.
In such a situation, the optical frequency shift can be made to depend
quadratically on the displacement. This would enable phonon number (Fock state) detection,
once the parameters are optimized further and the system can be cooled into the
quantum regime.

Nonlinear dynamics, instability, amplification







Beyond the linearized dynamics discussed up to now, 
such systems can display much richer, nonlinear effects as well. 
Recall that on the decreasing slope of the force vs. position curve, work is performed on the mirror, effectively reducing the overall damping as   now becomes negative. Once the laser intensity is strong enough to make the total "damping rate" negative, any tiny amplitude oscillation will grow exponentially . This growth finally saturates due to nonlinear effects, and the mirror settles into periodic, self-sustained oscillations, as observed in experiments . Their amplitude is determined by the laser intensity, the detuning, and the strength of the intrinsic mechanical friction, as well as other parameters.

Note that the parametric instability we have just described is conceptually identical to what happens in a laser above the lasing threshold. Here, the mechanical vibration plays the role of the laser's light mode, and the pump is provided by the radiation that drives the cavity. 

To obtain the attractors for the motion, one may pose a simple question: How does the work per cycle performed by the radiation field depend on the mirror's oscillation amplitude? The power fed into the system has to match the power dissipated by friction. When one draws a map of the possible amplitudes of oscillation that are consistent with this condition, an intricate structure emerges  (see Fig. ). In particular, at fixed parameters a large number of possible amplitudes may exist simultaneously. This multistability has begun to be explored in experiments , and it might even be useful for sensitive measurements . 

At even higher optical drive powers, the mirror may enter a state of chaotic motion , which still remains mostly unexplored. In addition, one may ask about possible quantum effects in the nonlinear dynamics . 

Nonclassical states, squeezing, entanglement

The question arises how to use the optomechanical interaction to produce genuinely nonclassical states of the light field and/or the mechanical motion. We list some ideas in the following that may be implemented in the future. 

As we have seen, the cavity length changes in response to the circulating intensity. In this regard, the setup is equivalent to a nonlinear optical medium, with an intensity-dependent index of refraction. Such a Kerr medium may be used to produce squeezing in the light field, e.g. by suppressing the intensity fluctuations (amplitude squeezing), and this can be translated directly to optomechanics . With regard to the mirror, squeezed states might be produced by varying the optical spring constant in time. As indicated above, mechanical Fock states could be produced via measurements.  

Entanglement between the light field and the mirror can be generated easily, in principle. Suppose for a moment that the cavity is closed and the field is in a superposition of different photon numbers, e.g. in a coherent state. Each of these Fock states of the radiation field will exert a different radiation pressure force, thereby displacing the mirror by a different amount. This creates an entangled state, which may be called a "Schrodinger cat", as the mirror involves many billions of atoms (see e.g.  and others). Remarkably, after a full period of the mirror oscillation, the entanglement would be undone, like in a quantum eraser experiment. 
It has been suggested that producing entanglement in this way and checking for its decay over time could eventually be a means to test for potentially unknown sources of decoherence, probably even including hypothetical gravitationally induced collapse of the wave function of the massive mirror . 

When several movable mirrors or membranes are included, the radiation field can be exploited as a medium which couples these mechanical elements to each other , leading to entanglement if thermal fluctuations are sufficiently suppressed. Experimental proof of entanglement then requires correlation measurements via optical probe beams.

Overview of experimental setups

Among the setups that have been realized during the past five years, most
involve cantilevers  or nanobeams  as mechanical elements. Masses typically range from  to  (and even  ), while frequencies are often in the MHz regime ( to ). Light is typically reflected from Bragg mirrors made from multi-layered dielectric materials. A rather different approach is based on microtoroid optical cavities made from silica on a chip . The light circulating inside an optical whispering gallery mode inside the toroid exerts a radiation pressure that couples to a mechanical breathing mode.

The biggest challenge in all of these devices is to obtain both a high optical finesse (currently in the range from  to ), and a high mechanical quality factor ( to  for beams and cantilevers).
As explained above, an alternative approach  involving a  nanometer thin membrane inside a fixed optical cavity can circumvent this problem to some degree, and has reached a finesse of  and a mechanical quality factor of . 

Optomechanical ideas have recently been realized in a number of other systems as well. For example, it is possible to replace the optical cavity by driven radio-frequency  or microwave  circuits, whose resonance frequency depends on the motion of a capacitively coupled nanobeam. The setup involving superconducting microwave resonators is especially promising as it can be coupled to Josephson junctions, qubits and amplifiers on the same chip. Incidentally, the essence of optomechanical cooling has also been demonstrated using a current-driven superconducting single electron transistor in place of the optical cavity .

Another recent development exploits the radiation forces that occur between two glass fibres or between a fibre and a dielectric substrate, where the coupling is through the evanescent light field . These devices operate on the nanoscale, and they can generate large forces without the need for a high finesse cavity. One may thus envisage integrating mechanical devices with photonic crystals, fibres and other optical elements on a chip, serving as the basis for optically controlled mechanical information processing and sensing.

For a long time, radiation forces had already been used to cool, trap and manipulate atoms, before being applied to mechanical structures. It is therefore amusing to note that the concepts of optomechanics are being transferred back to the domain of cold atoms. Several experiments  have now demonstrated how the mechanical motion of clouds of ultracold atoms inside an optical cavity can couple to the light field and display the effects we have been discussing. Given the small mass of the atom cloud, the mechanical effects of a single photon can be significant. This allows to study optomechanics in a new domain. One might also entangle an atomic ensemble and a nanomechanical system (e.g. ). 

Outlook, new directions, and challenges

In the short term, experiments are racing towards the ground state of mechanical motion, to enable manipulation in the quantum regime. Achieving this goal would open the door towards possible applications, for example in the area of quantum information processing. It would also permit us to answer fundamental questions, such as whether we understand decoherence processes in massive objects. Sensitive measurements (of displacement, mass, etc.) are another area where optomechanical systems will find applications, and while they do not urgently require going into the quantum regime, they could benefit from the improved sensitivity. 

In the longer term, optomechanics may also be viewed as a light-mechanics interface to realize hybrid structures for (classical or quantum) information processing, switching or storage, in integrated photonic circuits on a semiconductor chip. 

We acknowledge support by (S.M.G.) NSF grants DMR-0653377 and DMR-0603369, as well as (F.M.) the Emmy-Noether program, NIM, and SFB 631.

Reinforcement Learning with Neural Networks for Quantum Feedback  Thomas Fösel Max Planck Institute for the Science of Light, Staudtstr. 2, 91058 Erlangen, Germany  Petru Tighineanu Max Planck Institute for the Science of Light, Staudtstr. 2, 91058 Erlangen, Germany  Talitha Weiss Max Planck Institute for the Science of Light, Staudtstr. 2, 91058 Erlangen, Germany  Florian Marquardt Max Planck Institute for the Science of Light, Staudtstr. 2, 91058 Erlangen, Germany Physics Department, University of Erlangen-Nuremberg, Staudtstr. 5, 91058 Erlangen, Germany   	Machine learning with artificial neural networks is revolutionizing 	science. The most advanced challenges require discovering answers 	autonomously. This is the domain of reinforcement learning, where 	control strategies are improved according to a reward function. The 	power of neural-network-based reinforcement learning has been highlighted 	by spectacular recent successes, such as playing Go, but its benefits 	for physics are yet to be demonstrated. Here, we show how a network-based 	``agent'' can discover complete quantum-error-correction strategies, 	protecting a collection of qubits against noise. These strategies 	require feedback adapted to measurement outcomes. Finding them from 	scratch, without human guidance, tailored to different hardware resources, 	is a formidable challenge due to the combinatorially large search 	space. To solve this, we develop two ideas: two-stage learning with 	teacher/student networks and a reward quantifying the capability to 	recover the quantum information stored in a multi-qubit system. Beyond 	its immediate impact on quantum computation, our work more generally 	demonstrates the promise of neural-network-based reinforcement learning 	in physics.     We are witnessing rapid progress in applications of artificial neural networks (ANN) for tasks like image classification, speech recognition, natural language processing, and many others . Within physics, the examples emerging during the past two years range across areas like statistical physics, quantum many-body systems, and quantum error correction . To date, most applications of neural networks employ supervised learning, where a large collection of samples has to be provided together with the correct labeling.  However, inspired by the long-term vision of artificial scientific discovery , one is led to search for more powerful techniques that explore solutions to a given task autonomously. Reinforcement learning (RL) is a general approach of this kind , where an ``agent'' interacts with an ``environment''. The agent's ``policy'', i.e. the choice of actions in response to the environment's evolution, is updated to increase some reward. The power of this method, when combined with ANNs, was demonstrated convincingly through learning to play games beyond human expertise . In physics, RL without neural networks has been introduced recently, for example to study qubit control  and invent quantum optics experiments . Moving to neural-network-based RL promises access to the vast variety of techniques currently being developed for ANNs.  In this work, we introduce network-based RL in physics (fig:SetupAndGenerality) and illustrate its versatility in the domain of quantum feedback. Specifically, we devise a unified, fully autonomous, human-guidance-free approach for discovering quantum-error-correction (QEC) strategies from scratch, in few-qubit quantum systems subject to arbitrary noise and hardware constraints. This approach relies on a network agent that learns feedback strategies, adapting its actions to measurement results. As illustrated in fig:SetupAndGeneralityb-d, our method provides a unified approach to protect a quantum memory from noise. It covers a wide range of scenarios where one would otherwise have to select an existing scheme (stabilizer codes, adaptive phase estimation, etc.) and adapt it to the given situation. Our findings are of immediate relevance to the broad field of quantum error correction (including quantum-error-mitigation techniques) and are best suited to be used in few-qubit quantum modules. These could be used as stand-alone quantum memory or be part of the modular approach to quantum computation, which has been suggested for several leading hardware platforms.  Given a collection of qubits and a set of available quantum gates, the agent is asked to preserve an arbitrary quantum state  initially stored in one of the qubits. It finds complex sequences including projective measurements and entangling gates, thereby protecting the quantum information stored in such a few-qubit system against decoherence. This is a very complex challenge, where both brute force searches and even the most straightforward RL approaches fail. The success of our approach is due to a combination of two key ideas: (i) two-stage learning, with an RL-trained network receiving maximum input acting as a teacher for a second network, and (ii) a measure of the recoverable quantum information hidden inside a collection of qubits, being used as a reward.  Recent progress in multi-qubit quantum devices  has highlighted hardware features deviating from often-assumed idealized scenarios. These include qubit connectivity, correlated noise, restrictions on measurements, or inhomogeneous error rates. Our approach can help finding ``hardware-adapted'' solutions. This builds on the main advantage of RL, namely its flexibility: it can discover strategies for such a wide range of situations with minimal domain-specific input. We illustrate this flexibility in examples from two different domains: in one set of examples (uncorrelated bit-flip noise), the network is able to go beyond rediscovering the textbook stabilizer repetition code. It finds an adaptive response to unexpected measurement results that allows it to increase the coherence time, performing better than any straightforward non-adaptive implementation. Simultaneously, it automatically discovers suitable gate sequences for various types of hardware settings. In another, very different example, the agent learns to counter spatially correlated noise by finding non-trivial adaptive phase-estimation strategies that quickly become intractable by conventional numerical approaches such as brute-force search. Crucially, all these examples can be treated by exactly the same approach, with no fine-tuning. The only input consists in the problem specification (hardware and noise model).  In a nutshell, our goal is to have a neural network which can be employed in an experiment, receiving measurement results and selecting suitable subsequent gate operations conditioned on these results. However, in our two-stage learning approach, we do not directly train this neural network from scratch. Rather, we first employ reinforcement learning to train an auxiliary network that has full knowledge of the simulated quantum evolution. Later on, the experimentally applicable network is trained in a supervised way to mimic the behavior of this auxiliary network.  We emphasize that feedback requires reaction towards the observations, going beyond optimal control type challenges (like pulse shape optimization or dynamical decoupling), and RL has been designed for exactly this purpose. Specifically, in this work we will consider discrete-time, digital feedback, of the type that is now starting to be implemented experimentally , e.g. for error correction in superconducting quantum computers. Other wide-spread optimization techniques for quantum control, like GRAPE, often vary evolution operators with respect to continuous parameters , but do not easily include feedback and are most suited for optimizing the pulse shapes of individual gates (rather than complex gate sequences acting on many qubits). Another recent approach  to quantum error correction uses optimization of control parameters in a pre-configured gate sequence. By contrast, RL directly explores the space of discrete gate sequences. Moreover, it is a ``model-free'' approach , i.e. it does not rely on access to the underlying dynamics. What is optimized is the network agent. Neural-network based RL promises to complement other successful machine-learning techniques applied to quantum control .  Conceptually, our approach aims to control a quantum system using a classical neural network. To avoid confusion, we emphasize our approach is distinct from future ``quantum machine learning'' devices, where even the network will be quantum .  Reinforcement Learning  The purpose of RL (fig:SetupAndGeneralitya) is to find an optimal set of actions (in our case, quantum gates and measurements) that an ``agent'' can perform in response to the changing state of an ``environment'' (here, the quantum memory). The objective is to maximize the expected ``return'' , i.e. a sum of rewards.  To find optimal gate sequences, we employ a widespread version of reinforcement learning  where discrete actions are selected at each time step  according to a probabilistic ``policy'' . Here,  is the probability to apply action , given the state  of the RL-environment. As we will use a neural network to compute , the multi-dimensional parameter  stands for all the network's weights and biases. The network is fed  as an input vector and outputs the probabilities . The expected return can then be maximized by applying the policy gradient RL update rule :    with  the learning rate parameter, and  the expectation value over all gate sequences and measurement outcomes. These ingredients summarize the basic policy gradient approach. In practice, improvements of eq:simplePolicyGradient are used; for example, we employ a baseline, natural policy gradient, and entropy regularization (see Appendix). Even so, several further conceptual steps are essential to have any chance of success (see below).  eq:simplePolicyGradient provides the standard recipe for a fully observed environment. This approach can be extended to a partially observed environment, where the policy would then be a function of the observations only, instead of the state. The observations contain partial information on the actual state of the environment. In the present manuscript we will encounter both cases.  Reinforcement Learning Approach to Quantum Memory  In this work we seek to train a neural network to develop strategies to protect the quantum information stored in a quantum memory from decoherence. This involves both variants of stabilizer-code-based QEC  as well as other, more specialized (but, in their respective domain, more resource-efficient) approaches, like decoherence-free subspaces or phase estimation. We remind the reader that, for the particular case of stabilizer-code-based QEC, the typical steps are: (i) the encoding, in which the logical state initially stored in one qubit is distributed over several physical qubits, (ii) the detection of errors via measurement of suitable multi-qubit operators (syndromes), (iii) the subsequent correction, and (iv) the decoding procedure that transfers the encoded state back into one physical qubit. We stress that no such specialized knowledge will be provided a priori to our network, thus retaining maximum flexibility in the tasks it might be applied to and in the strategies it can encompass (fig:SetupAndGeneralityb).  We start by storing an arbitrary quantum state  inside one physical qubit. The goal is to be able to retrieve this state with optimum fidelity after a given time span. Given hardware constraints such as the connectivity between qubits, the network agent must develop an efficient QEC strategy from scratch solely by interacting with the quantum memory at every time step via a set of unitary gates (such as CNOTs and bit-flips) and measurements. They are chosen according to the available hardware and define the action set of the agent. Importantly, the network must react and adapt its strategy to the binary measurement results, providing real-time quantum feedback.  This particular task seems practically unsolvable for the present reinforcement learning techniques if no extra precautions are taken. The basic challenge is also encountered in other difficult RL applications: the first sequence leading to an increased return is rather long. In our scenarios, the probability to randomly select a good sequence is much less than . Moreover, any subsequence may be worse than the trivial (idle) strategy: for example, performing an incomplete encoding sequence (ending up in a fragile entangled state) can accelerate decay. Adopting the straightforward return, namely the overlap of the final and initial states, both the trivial strategy and the error-correction strategy are fixed points. These are separated by a wide barrier – all the intermediate-length sequences with lower return. In our numerical experiments, naive RL was not successful, except for some tasks with very few qubits and gates.  We introduce two key concepts to solve this challenge: a two-stage learning approach with one network acting as teacher of another, and a measure of the ``recoverable quantum information'' retained in any quantum memory.  Before we address these, we mention that from a machine-learning point-of-view there is another unconventional aspect: Instead of sampling initial states of the RL-environment stochastically, we consider the evolution under the influence of the agent's actions for all possible states simultaneously. This is required because the quantum memory has to preserve arbitrary input states. Our reward will be based on the completely positive map describing the dissipative quantum evolution of arbitrary states. The only statistical averaging necessary is over measurement outcomes and the probabilistic action choices. Further below, we comment on how this is implemented in practice.  As known from other RL applications (like board games ), it helps to provide as much information as possible to the network. In our case, this could mean providing the multi-qubit quantum state at each time step. However, that information is not available in a real experiment. In order to solve this dilemma, we train two different networks in succession (fig:NetworkLayouta,b): The first network is fully state-aware. Later on, we will use it as a teacher for the second network which essentially only gets the measurement results as an input (plus the information which gate or measurement has been applied). This splits the problem into two sub-problems that are easier to solve. In this approach, the main remaining challenge is to train the state-aware network, while the supervised training of the second network is fairly straightforward in our experience. In contrast, directly training the second network via RL would be tremendously harder, if not impossible, because the input would be significantly less comprehensive than the completely positive map.  At this point, we see that evolving all initial states simultaneously is not only more efficient, but even required to prevent the state-aware network from ``cheating''. Otherwise, it might simply memorize the initial state, wait for it to relax, and then reconstruct it – which, of course, is not a valid strategy to preserve a principally unknown quantum state. Such a behavior is avoided when the network is asked to preserve all possible logical qubit states with the same gate sequence. It turns out that this can be implemented efficiently by evolving just four initial quantum states  (for a single logical qubit); tracking their evolution fully characterizes, at any point in time, the completely positive map  of the multi-qubit system that maps  to . Moreover, we have found it useful to apply principal component analysis, i.e. to feed only the few largest-weight eigenvectors of the evolved s as input to the network (see Appendix).  We are now ready to define our problem fully from the point of view of reinforcement learning. The state space of the RL environment is the space of completely positive maps. This information is not accessible in a real-world experiment, where the measurements provide partial information about the RL-environment. This reinforcement-learning problem is therefore classified as a partially observed Markov process. This is what is considered in our second learning stage, and our method to solve it relies on a recurrent network. In the modified input scheme of the first learning stage, the agent observes the full state space and we therefore deal with a fully observed Markov process. In both cases, the RL environment is stochastic due to the measurements. As described above, the action set is defined by the available hardware instructions (unitary gates and measurements).  Two-stage learning with parallel evolution is essential, but not yet sufficient for our challenge. We now introduce a suitable reward that indicates the likely final success of an action sequence ahead of time. In our case, we follow the intuitive idea that this reward should quantify whether the original quantum information survives in the complex entangled many-qubit state that results after application of unitary gates and measurements, and with the system subject to decoherence.  We note that, in the ideal case, without decoherence, two initially orthogonal qubit states are always mapped onto orthogonal states. Therefore, they remain 100 distinguishable, and the original state can always be restored. With a suitable encoding, this remains true even after some errors have happened, if a suitable error-detection and decoding sequence is applied (``recovery''). By contrast, irreversible loss of quantum information means that perfect recovery becomes impossible. In order to make these notions concrete, we start from the well-known fact that the probability to distinguish two quantum states  and , by optimal measurements, is given by the trace distance . Let  be the quantum state into which the multi-qubit system has evolved, given the initial logical qubit state of Bloch vector . We now consider the distinguishability of two initially orthogonal states, . In general, this quantity may display a non-trivial, non-analytic dependence on . We introduce the ``recoverable quantum information'' as:    The minimum over the full Bloch sphere is taken because the logical qubit state is unknown to the agent, so the success of an action sequence is determined by the worst-case scenario. In other words,  specifies a guaranteed value for the remaining distinguishability for all possible logical qubit states. Thus,  is a property of the completely positive map that characterizes the dissipative evolution.  The recoverable quantum information  is much more powerful than the overlap of initial and final states, as it can be used to construct an immediate reward, evaluating a strategy even at intermediate times. In the idealized case where errors have occured, but they could in principle be perfectly recovered by a suitable detection/decoding sequence,  remains 1. As we will see below, this behavior steers the network towards suitable strategies.  can be extended towards multiple logical qubits.  As far as  is concerned, error correction steps are only required to prevent the multi-qubit system from venturing into regions of the Hilbert space where any further decoherence process would irreversibly destroy the quantum information (and lower ). If one wants the network to actually implement the final decoding sequence, to return back an unentangled state, this can be done by adding suitable contributions to the reward (see below).   Results  We now apply the general approach to different settings, illustrating its flexibility. The training of the state-aware network is analyzed in fig:TrainingOverviewFigure. In the example, the qubits are subject to bit-flip errors uncorrelated in space and time, with a decay term  in the underlying master equation (see Appendix). All of the four qubits may be measured, and there is full connectivity. During training (fig:TrainingOverviewFigurea,b), the network first learns to avoid destructive measurements which reveal the logical qubit state. Afterwards, it discovers a gate sequence of s that creates an entangled state, implementing some version of the 3-qubit repetition code . The particular CNOT sequence shown in the figure generates one possible encoded state out of several equally good ones. The symmetry between these alternative encodings is broken spontaneously during training. The encoding already increases the reward above the trivial level (obtained for storing the logical qubit in one physical qubit only). Finally, the network starts doing repeated parity measurements, of the type , flipping the state of ancilla  only if the states of  and  differ (here  is a measurement). This implements error detection, helping to preserve the quantum information by preventing the leakage into states with two bit flips that cannot be corrected if undetected. fig:TrainingOverviewFigureb illustrates the progression from random quantum circuits to a nearly converged strategy. During any single trajectory, the recoverable quantum information can have sudden jumps when measurements are performed (fig:TrainingOverviewFigurec), with collapses and revivals.                                      *  Can we understand better how the network operates? To this end, we visualize the responses of the network responses to the input states (fig:tSNEc), projecting the high-dimensional neuron activation patterns into the 2D plane using the t-SNE technique . Similar activation patterns are mapped close to each other, forming clearly visible clusters, each of which results in one type of action. During a gate sequence, the network visits states in different clusters. The sequence becomes complex if unexpected measurement results are encountered (fig:tSNEb). In the example shown here, the outcome of the first parity measurement is compatible with three possibilities (one of two qubits has been flipped, or the ancilla state is erroneous). The network has learned to resolve the ambiguity through two further measurements, returning to the usual detection cycle. It is remarkable that RL finds these nontrivial sequences (which would be complicated to construct ab initio), picking out reward differences of a few percent.                           The flexibility of the approach is demonstrated by training on different setups, where the network discovers from scratch other feedback strategies (fig:ManyScenariosa) adapted to the available resources. For example, we consider a chain of qubits where CNOTs are available only between nearest neighbours and in addition we fix a single measurement location. Then the network learns that it may use the available CNOTs to swap through the chain. However, if every qubit can be measured, the net discovers a better strategy with fewer gates, where the middle two qubits of the chain alternate in playing the role of ancilla. We also show, specifically, the complex recovery sequences triggered by unexpected measurements. They are a-priori unkown, and RL permits to discover them from scratch without extra input. Generally, additional resources (such as enhanced connectivity) are exploited to yield better improvement of the decoherence time (fig:ManyScenariosb). In another scenario, fig:ManyScenariosc, we find that the network successfully learns to adapt to unreliable measurements by redundancy.  In a separate class of scenarios, we consider dephasing of a qubit by a fluctuating field (fig:CorrelatedNoise). If the field is spatially homogeneous and also couples to nearby ancilla qubits, then the dephasing is collective: , where  is white noise and  are the coupling strengths (to qubit and ancillas). Note that, in this situation, one can use neither dynamical decoupling (since the noise is uncorrelated in time) nor decoherence-free subspaces (since the  can be arbitrary in general). However, the same RL program used for the examples above also finds solutions here (fig:CorrelatedNoise), without any input specific to the situation (except the available gates). It discovers that the field fluctuations can be tracked and corrected (to some extent) by observing the evolution of the nearby ancillas, measuring them in suitable time intervals. For more than one ancilla, the network discovers a strategy that is adaptive: The choice of measurement basis depends on the history of previous observations. Brute-force searches in this setting become quickly impossible due to the double-exponential growth of possibilities. The computational effort involved in such a brute-force approach is analyzed in detail in the Supplementary.                                 Up to now, the network only encodes and keeps track of errors by suitable collective measurements. By revising the reward structure, we can force it to correct errors and finally decode the quantum information back into a single physical qubit. Our objective is to maximize the overlap between the initial and final states, for any logical qubit state (see Appendix). Moreover, we found that learning the decoding during the final time steps is reinforced by punishing states where the logical qubit information is still distributed over multiple physical qubits. The corresponding rewards are added to the previous reward based on the recoverable quantum information. The network now indeed learns to decode properly (fig:LSTMresultsa). In addition, it corrects errors. It does so typically soon after detecting an error, instead of at the end of the gate sequence. We conjecture this is because it tries to return as soon as possible back to the known, familiar encoded state. For the same reason, error correction sometimes even happens without an explicit reward.  So far, we have trained the state-aware network. However, this cannot yet be applied to an experiment, where the quantum state is inaccessible to us. This requires a network whose only input consists in the measurement results (and the selected gates, since the policy is probabilistic), requiring some sort of memory. An elegant solution consists in a recurrent neural network. We use the widespread long short-term memory (LSTM) approach .                               Once the first, state-aware network has been trained successfully, it is used as a teacher in supervised learning to train the second, recurrent network (fig:LSTMresultsb). This could then be applied as a controller to experimental runs, deciding on gate sequences depending on measurements. It might also be refined by RL, e.g. to adapt to changes in the parameters (decoherence rates etc.). Learning to correct (see above) is essential for successful training of the recurrent network, since the latter must learn to consider measurement results distributed in time and deduce the proper corrective actions.  We have trained the recurrent network based on a fully converged state-aware network. Inspecting the LSTM neuron activations (fig:LSTMresultsc), we see that different neurons activate for different events and some clearly display prolonged memory (remaining active during certain time-intervals relevant for the strategy). For example, one neuron switches on during the recovery sequence after an unexpected measurement, while another seems like an internal counter operating during the periodic detection sequence.  We now come back to the statement in the introduction that our approach is fully autonomous and can be applied to a broad range of problems with small human effort. In all the preceding examples, and also in general, the only human input to our approach is the problem specification, primarily the noise model (specifying the dissipative time evolution governing the quantum state) and the particular action set (i.e., the available hardware instructions related to the setup and its connectivity). Importantly, fine-tuning the hyperparameters (like learning rate, network architecture, etc.) is not required; in the Supplementary, we demonstrate that a common set of hyperparameters can be used for all the scenarios.  Possible future applications  The physical setups considered in today's quantum computing platforms contain many components and features that go beyond the simplest scenario of short-range coupled qubits. Conceptually, the approach developed in the present work is general enough to find future application in any of the following experimentally relevant domains.  An important example is cavities, which can be used as long-lived quantum memory, especially in the microwave domain. When they are coupled to qubits, nonlinear operations can be performed that may aid in error correction of the cavity state, as the Yale group has demonstrated (``kitten'' and ``cat'' codes ). Our approach allows to cover such situations without any changes to the reinforcement learning method. Only the description of the physical scenario, via the set of available actions, and of course the physics simulation will have to be updated. Cavities also give access to unconventional controls, e.g. naturally occurring long-distance multi-qubit entangling gates provided by the common coupling of the qubits to the cavity. In addition, they permit direct collective readout that is sensitive to the joint state of multiple qubits, which may be used to speed up error detection operations. Again, RL based quantum feedback of the type proposed here can naturally make use of these ingredients.  Novel hardware setups, like cross-bar type geometries , give rise to the challenge to exploit the unconventional connectivity, for which our approach is well suited. In the future, it may even become possible to co-optimize the hardware layout (taking into account physical constraints) and the strategies adapted to the layout. In the simplest case, this means discovering strategies for automatically generated alternative layouts and comparing their performance.  The actions considered by the agent need not refer to unitary operations. They might also perform other functions, like restructuring the connectivity itself in real-time. This is the case for the proposed 2D ion-trap architecture where the ions are shuffled around using electrodes . Similar ideas have been proposed for spins in quantum dots, which can be moved around using electrodes or surface-acoustic waves. Again, no changes to our approach would be needed. The modifications are confined to the physics simulation. Depending on the present state of the connectivity, the set of effective qubit gates would change.  Like any numerical approach, our method is invariably limited to modest qubit numbers (of course, these will increase with further optimizations, possibly up to about 10). It is important, therefore, to recall that even an improvement of the decoherence rate in an isolated few-qubit module can have useful applications (as a quantum memory, e.g. in a quantum repeater). More generally, it is clear that classical simulation of a full-scale quantum computer in the domain of quantum supremacy is out of the question, by definition. This is a challenge widely acknowledged by the entire community, affecting not only optimization but also design, testing, and verification of a quantum computer. One promising way to address this challenge at least partially, advocated by a growing number of experimental groups, is the so-called modular approach to quantum computation and quantum devices. This consists in connecting small few-qubit quantum modules together via quantum network links . The main advantage of this approach is the ability to control and debug small quantum modules as opposed to an entire large monolithic quantum computer. Our approach is very well suited to this strategy. In principle one can even envision a hierarchical application of the quantum module concept (with error correction strategies applied to multiple modules coupled together), but for that case our approach would need to be extended (e.g. by using RL to find one- and two-qubit gates acting on the logical qubits stored inside the modules).  Conclusions  We have seen how a network can discover quantum error correction techniques from scratch. It finds a-priori unknown nontrivial detection/recovery sequences for diverse settings without any more input than the available gate set. The trained neural networks can in principle be used to control experimental quantum devices. The present approach is flexible enough to be applied directly to a range of further, qualitatively different physical situations, like non-Markovian noise, weak measurements, qubit-cavity systems, and error-corrected transport of quantum information through networks. An obvious challenge for the future is to successfully discover strategies on even more qubits, where eventually full protection against all noise sources and multiple logical qubits could be realized. There is still considerable leeway in improving the speed of the physics simulation and of GPU-based training (for further details on the current computational effort, see sec:computational-resources).  On the machine learning side, other RL schemes can be substituted for the natural policy gradient adopted here, like Q-learning or advantage-actor-critic techniques, or RL with continuous controls. Recurrent networks might be employed to discover useful subsequences. The two-stage learning approach introduced here could also be applied in other RL scenarios, where one would first train based on expanded state information. In general, we have shown that neural-network based RL promises to be a flexible and general tool of wide-ranging applicability for exploring feedback-based control of quantum and classical systems in physics.  Acknowledgements We thank Hugo Ribeiro and Vittorio Peano for fruitful comments on the manuscript.  Author Contributions All authors contributed to the ideas, their implementation, and the writing of the manuscript. The numerics was performed by T.F., P.T. and T.W.  Data availability The data that support the plots within this paper and other findings of this study are available from the corresponding author on request.  Note added: Shortly before submission of the present manuscript to the arXiv, a preprint  appeared exploring RL with recurrent networks for optimal quantum control (without feedback).        Physical time evolution  To track the time evolution for an arbitrary initial logical qubit state (identified by its Bloch vector ), we start from , factorizing out the (fixed) state of all the other qubits. Now consider the four quantities  	 		_0(0) & =12(_e_j(0)+_-e_j(0))  		_j(0) & =12(_e_j(0)-_-e_j(0)) 	  where  and  are the basis vectors; note that the right-hand side of eq:initialization_rho0 is independent of .  and the  are evolved stepwise, for each time-interval  according to the update rule  	 		_0(t_f) & =[_0(t_i)]([_0(t_i)])  		_j(t_f) & =[_j(t_i)]([_0(t_i)]) . 	  In the absence of measurements,  is the completely positive map for the given time-interval. In the presence of measurements, it is an unnormalized version (see below). We explicitly renormalize such that always .  and the  give us access to the density matrix for every logical qubit state, at any time :      Physical scenarios  We always start from the initial condition that the logical qubit is stored in one physical qubit, and the others are prepared in the down state (). If explicit recovery is desired, we use this original qubit also as the target qubit for final decoding. The time evolution is divided into discrete time steps of uniform length  (set to  in the main text). At the start of each of these time slices, we perform the measurement or gate operation (which is assumed to be quasi-instantaneous) chosen by the agent; afterwards, the system is subject to the dissipative dynamics. Thus, the map  for the time interval  is of the form  for unitary operations  and  for projection operators  ( indicates the measurement results) where  is the dissipative part of the Liouvillian (we only consider Markovian noise). Note that the measurement results are chosen stochastically according to their respective probability . In the examples discussed in the figures, we use two different error models, the bit-flip error (bf) and the correlated noise error (cn):  	 		D_bf & =T_dec^-1_q_x^(q)_x^(q)-  		D_cn & =T_dec^-1(L_cnL_cn^-12 L_cn^L_cn, ) 	 where  applies the corresponding Pauli operator to the th qubit and . Here,  denotes the coupling of qubit  to the noise. Note that in the bit-flip scenario the single qubit decay time , whereas in the presence of correlated noise it is .  Recoverable quantum information  Based on eq:methods_construction_rho_xyz,  as introduced in the main text can be written as    in the (for us relevant) case that  for all .  The trace distance  has often a non-trivial dependence on the logical qubit state  and finding its minimum can become nontrivial. However, the location of the minimum can sometimes be ``guessed'' in advance. For any CHZ quantum circuit , i.e. for all the bit-flip examples considered here, the anti-commutator relation  is satisfied for all distinct ; it can be shown that this restricts the minimum to lie along one of the coordinate axes: . For the correlated noise, the trace distance  is symmetric around the -axis and takes its minimal value at the equator.  After a measurement, the updated value of  may vary between the different measurement results. To obtain a measure that does not depend on this, we introduce  as the average over all possible values of  (after a single time step), weighted by the probability to end up in the corresponding branch. If the action is not a measurement, there is only one option and thus .  Protection reward  The goal of the ``protection reward'' is to maximize  at the end of the simulation, i.e. the ability to in principle recover the target state. A suitable (immediate) reward is given by                 with  and  as defined above,  the decay time for encoding in one physical qubit only (``trivial'' encoding),  the time step, and  a punishment for measurements which reveal the logical qubit state. Based on this reward, we choose the return (the function of the reward sequence used to compute the policy gradient) as    where  is the return discount rate; for more information on the (discounted) return, see e.g. .  Recovery reward  The protection reward does not encourage the network to finally decode the quantum state. If this behavior is desired, we add suitable terms to the reward (only employed for fig:LSTMresults):    where , unless  where we set . This means decoding is only rewarded after . We set  if  for any , and otherwise .  denotes the partial trace over all qubits except , and  labels the target qubit. The condition  implies that the logical qubit state is encoded in the specific qubit  (this is not a necessary criterion).  is  if (at the final time ) the logical qubit state is encoded in the target qubit only and this qubit has the prescribed polarization (i.e. not flipped), and otherwise .  As return, we use    with the same return discount rate  as for the protection reward.  With this reward, we aim to optimize the minimum overlap  between the (pure) target state  and the actual final state  reduced to the target qubit, given by the partial trace  over all other qubits.  Input of the state-aware network  The core of the input to the state-aware network is a representation of the density matrices , , , and . Together, they represent the completely positive map of the evolution (for arbitrary logical qubit states). For reduction of the input size (especially in view of higher qubit numbers), we compress them via principal component analysis (PCA), i.e. we perform an eigendecomposition  and select the eigenstates  with the largest eigenvalues . To include also the eigenvalue in the input, we feed all components of the scaled states  (which yield ) into the network, where the states are in addition sorted by their eigenvalue. For our simulations, we select the 6 largest components, so we need  input neurons (4 density matrices, 16 is the dimension of the Hilbert space, 2 for real and imaginary part).  In addition, at each time step we indicate to the network whether a potential measurement would destroy the quantum state by revealing the quantum information. Explicitly, we compute for each measurement whether  for all  and every possible projector  (i.e. every possible measurement result), and feed these boolean values into the network. Note that this information can be deduced from the density matrix (so in principle the network could learn that deduction on its own, but giving it directly speeds up training).  Because all relevant information for the decision about the next action is contained in the current density matrix, knowledge about the previous actions is not needed. However, we have found that providing this extra information is helpful to accelerate learning. Therefore, we provide also the last action (in a one-hot encoding). We note that it is not necessary to feed the latest measurement result to the network, since the updated density matrix is conditional on the measurement outcome and therefore contains all relevant information for future decision.  To train the state-aware network to restore the original state at the end of a trajectory, it becomes necessary to add the time to the input. It is fully sufficient to indicate the last few time steps where  (when decoding should be performed) in a one-hot encoding.  Layout of the state-aware network  Our state-aware networks have a feedforward architecture. Between the input layer and the output layer (one neuron per action), there are two or three hidden layers (the specific numbers are summarized in the last section of the Appendix). All neighboring layers are densely connected, the activation function is the rectified linear unit (ReLU). At the output layer, the softmax function  is applied such that the result can be interpreted as a probability distribution.  Reinforcement learning of the state-aware network  Our learning scheme is based on the policy gradient algorithm . The full expression for our learning gradient (indicating the change in ) reads         where  is the (discounted) return (cmp. eq:protection_return,eq:recovery_return). This return is corrected by an (explicitly time-dependent) baseline  which we choose as exponentially decaying average of , i.e. for the training update in epoch , we use  where  is the baseline discount rate and  is the mean return at time step  in epoch . We compute the natural gradient  by multiplying , the (Moore–Penrose) inverse of the Fisher information matrix . The second term is entropy regularization ; we use it only to train the state-aware network shown in fig:LSTMresults. As update rule, we use adaptive moment estimation (Adam ) without bias correction.  Layout of the recurrent network  The recurrent network is designed such that it can in principle operate in a real-world experiment. This means in particular that (in contrast to the state-aware network) its input must not contain directly the quantum state (or the evolution map); instead, measurements are its only way to obtain information about the quantum system. Hence, the input to the recurrent network contains the present measurement result (and additionally the previous action). Explicitly, we choose the input as a one-hot encoding for the action in the last time step, and in case of measurements, we additionally distinguish between the different results. In addition, there is an extra input neuron to indicate the beginning of time (where no previous action was performed). Since this input contains only the most recent ``event'', the network requires a memory to perform reasonable strategies, i.e. we need a recurrent network. Therefore, the input and output layer are connected by two successive long short-term memory (LSTM) layers  with  inter-layer activations. After the output layer, the softmax function is applied (like for the state-aware network).  Supervised learning of the recurrent network  The training data is generated from inference of a state-aware network which has been trained to sufficiently good strategies (via reinforcement learning); for every time step in each trajectory, we save the network input and the policy, i.e. the probabilities for all the actions, and we train on this data. It is possible to generate enough data such that overfitting is not a concern (for the example in fig:LSTMresults, each trajectory is reused only 5 times during the full training process). For the actual training of the recurrent network, we use supervised learning with categorical cross-entropy as cost function ( is the actual policy of the recurrent network to train, and  the desired policy from the state-aware network):   Due to the LSTM layers, it is necessary to train on full trajectories (in the true time sequence) instead of individual actions. Dropout  is used for regularization. The training update rule is adaptive moment estimation (Adam ).  Physical parameters and hyperparameters  The physical parameters used throughout the main text are summarized in the following table. Times are always given in units of the time step (gate time).  We have used a few separately trained neural network throughout this work which differ slightly in hyperparameters (e.g. in the number of hidden layers and neurons per layer). This is not due to fine-tuning, and in the Supplementary Information we demonstrate that we can successfully train the neural networks in all scenarios with one common set of hyperparameters. The strategies found by the neural networks are not influenced by using different sets of hyperparameters. Different hyperparameters may influence the training time etc. In the following table, we summarize the architecture of the networks, i.e., we list the number of neurons in each layer.   Each output neuron represents one action that can be performed by the agent and thus, the output layer size is equal to the number of actions. In the bit-flip scenarios (), the actions are CNOTs according to connectivity, measurements along  as indicated in the corresponding sketches, deterministic bit flips on each qubit, and idle. When dealing with correlated noise, cf. , the available actions are instead measurements along  and  on all ancilla qubits, and the idle operation. Note that our whole approach is general and able in principle to deal with arbitrary quantum gates.  The hyperparameters used for training the state-aware networks are summarized in the following table: 	 	 		[a] The exact value for the learning rate used in the simulations is in fact ; the irrational factor of  is caused by a slight deviation between our implementation and the standard Adam scheme which in the end resulted only in a redefinition of the learning rate. 	  *0.5  The hyperparameters used for training the recurrent network (cf. fig:LSTMresultsb and fig:LSTMresultsc) are summarized in the following table:

Physical time evolution    Lindblad equation and completely positive map   We start by discussing how to describe the dynamics of open quantum systems as a brief introduction for people from other fields, and to fix notation.  The state of any Markovian quantum system at time  is completely characterized by the density matrix . Its time evolution can always be described by a Lindblad equation     where the Hamiltonian  represents the coherent part of the dynamics and the Lindblad operators  (or jump operators) the incoherent part;  are their corresponding decay rates.  is the commutator of two operators, and  the anti-commutator.  denotes the Hermitian conjugate of .  For compact notation, the terms on the right-hand side can be combined into one superoperator, the Liouvillian :    We now introduce the completely positive map  to formally write down the time evolution of all density matrices in the time interval from  to :    If  does not change over time, the completely positive map is given by ; otherwise, it can be obtained from  where  denotes the time-ordered exponential.  Measurements can be nicely integrated into this framework. For each measurement variable and obtained result, there is a projection operator , and we associate a superoperator  defined by its action  on all density matrices . If some measurements are performed at intermediate times  with corresponding superoperators , and otherwise  follows the Lindblad equation characterized by the Liouvillian , the completely positive map has the form  where  (note that explicit normalization is required because projections are in general not trace-preserving).  For our purposes, it is more convenient to consider  instead of , so in the following we will usere  is always a linear map (even if it includes measurements).   Simulation of a logical qubit   This formalism is usually applied directly to single density matrices. However, as motivated in the main text, we require an efficient scheme which is capable of processing all possible logical qubit states, ie the ``full Bloch sphere'', in parallel. This is possible due to two circumstances: the linearity of the completely positive map, and the fact that all initial states are arranged on an affine space.  In Methods, we specify an explicit scheme to construct four quantities , ,  and  which give access to the density matrix  for an arbitrary logical qubit state  at any time :  	_n(t) & = 		rho_0(t)+_jn_jdelta_rho_j(t)1+(_jn_jdelta_rho_j(t)) =   	& = 		rho_0(t)+xdelta_rho_x(t)+ydelta_rho_y(t)+zdelta_rho_z(t)1+x(delta_rho_x(t))+y(delta_rho_y(t))+z(delta_rho_z(t)) 	   Without measurements, ie under trace-preserving quantum operations like unitary transformations and dissipation, the variables , ,  and  follow the same dynamics as the density matrices themselves, ie their time evolution is given by the completely positive map . However, they have to be treated differently under measurements where renormalization becomes important. Reusing our notion of  from eq:linearized_cp_map, we have  	rho_n(tf) & = 		cp_map_tf_ti[rho_n(ti)](cp_map_tf_ti[rho_n(ti)]) =   	& = 		cp_map_tf_ti[rho_0(ti)+_jn_jdelta_rho_j(ti)](cp_map_tf_ti[rho_0(ti)+_jn_jdelta_rho_j(ti)]) =   	& = 		cp_map_tf_ti[rho_0(ti)]+_jn_jcp_map_tf_ti[delta_rho_j(ti)](cp_map_tf_ti[rho_0(ti)]+_jn_jcp_map_tf_ti[delta_rho_j(ti)])  We see that it is not required to explicitly renormalize , ,  and , and in particular that it is not correct to renormalize them separately (which would be ill-defined because the  can be traceless). However, a common prefactor is allowed as they appear both in the numerator and the denominator, and for convenience we choose the prefactor  such that  is always satisfied. This leads to the update equations given in Methods.                                     Recoverable quantum information    Definition   In the main text, we have defined the recoverable quantum information as    An alternative definition would be    Both expressions coincide as long as all , ie no information about the logical qubit state has been revealed. For the remaining cases, it is not clear to the authors what is the most natural generalization.  For the following considerations, it will not make a difference which definition is used. Likewise, it does not play a role in the numerical simulations discussed in the main text because, due to our operation sets, only two cases can occur: either no information about the logical qubit has been revealed (), or all superpositions have been destroyed (both definitions yield ).                     Properties                The purpose of the following discussion is to develop an intuitive understanding for .  We start by giving three basic properties of the underlying trace distance  for antipodal logical qubit states:  	 is invariant under unitary transformations. 	 can only decrease under the influence of dissipation (pure states yield the maximum value ). 	 can be decreased and also increased by measurements, but only under the constraint that the average over all measurement results cannot exceed the prior value: 		   		Here,  is the value directly before the measurement, and  the updated value for result ;  denotes the corresponding probability to find this result. (The extreme cases  and   can occur and are discussed below).  (1) is a general property of the trace norm. (2) and (3) follow from the contractivity of the trace norm under trace-preserving quantum operations [p 406]suppl:nielsen_quantum_2011 (here, the completely positive maps for dissipative dynamics  and non-selective measurements , respectively). Trace-preserving quantum operations are those which can be written in the form  for a complete operator set  [p 360]suppl:nielsen_quantum_2011.  To illustrate property (3) in an example, we consider the following situation: two qubits are subject to bit-flip errors, ie . Initially, the logical qubit is stored in one physical qubit, and the ancilla is prepared in the down state (). Then, the protocol depicted in fig:suppl_magic_quantitya is applied: first, a CNOT gate entangles the data qubit with the ancilla. During the following idle time,  decays like . Afterwards, the qubits are disentangled again by a second CNOT gate (which leaves  invariant). If in this situation a measurement on the ancilla reveals that it is still in the down state,  grows to . However, the probability to find the ancilla in the down state is only , and if a flip is detected (),  drops to  as it cannot be determined which qubit has flipped. Hence, on average nothing is won: . (This basically shows that the described protocol allows quite well to detect errors, but it is not possible to resolve them, and thus it cannot be used to slowdown the decay.) Exemplary  curves for the repeated application of this protocol are shown in fig:suppl_magic_quantitya.  We proceed by considering the textbook three-qubit scenario with bit-flip error channels [p 427ff]suppl:nielsen_quantum_2011 and inspecting it from the perspective of  (see also fig:suppl_magic_quantityb). Compared to the decay  for the ``trivial'' single-qubit encoding, eg , the encoding  (bit-flip code, repetition code) improves the situation in the beginning: . However, the asymptotical behavior for  is still the same. This behavior can be explained as follows: as the populations for single bit-flips accumulate over time, the probability grows that a second bit-flip (on another qubit) occurs which cannot be resolved anymore. The only way to actually protect the logical qubit is a suitable error detection scheme, ie to keep track of possible bit-flips via repeated parity measurements. Such a measurement delays the decay again for some time: after a syndrom detection at , we have  (assuming a quasi-instantaneous syndrom detection during which no further errors can occur). Thus, even though measurements cannot (on average) improve  immediately (cmp property 3), they are useful (and necessary) to prevent future losses in .  Last, but not least,  correctly describes the loss in recoverability of the quantum state due to measurements which reveal information about the logical qubit state (see also fig:suppl_magic_quantityc). If all superpositions are destroyed,  drops to  (independent of the measurement result); this happens, for example, in the ``trivial encoding'' (with the logical qubit stored directly in one physical qubit) if a measurement is performed on this data qubit. In comparison, partial destruction of superpositions is reflected by an accordingly smaller decrease in . By contrast, measurements which reveal no information about the logical qubit state do not change  on average ().   Computation   The numerical evaluation of  is technically challenging. The computation of the trace norm  for a given point  on the Bloch sphere is already expensive as it involves the eigendecomposition of its argument. Moreover, the dependence of  on the Bloch vector  can be complex, which makes it non-trivial to locate the minimum that determines .  In our experience, it is not valid to approximate the trace-norm  in  using the Hilbert-Schmidt norm , which is numerically far easier to calculate (and minimize). Likewise, other simpler quantities (like the purity of the multi-qubit state) are not sufficient to replace .  In the Methods, we have claimed that for CHZ circuits (all unitary operations are combinations of CNOT, Hadamard and phase gates; measurement of variables in the Pauli group; state preparation in the computational basis [p 464]suppl:nielsen_quantum_2011), the anti-commutator relation  is satisfied for all distinct ; our bit-flip scenarios fall into this category of CHZ circuits. Furthermore, we have argued that  (for ) if this anti-commutator relation is satisfied. In the following, we briefly sketch the proof for this statement. We note that ``'' is a priori clear, so just ``'' has to be shown. The assumption  directly implies that , ie there is a common eigenbasis  for all three . Further, we can conclude that     and for , Jensen's inequality (note that square root is a concave function) yields the lower bound  	[]xdelta_rho_x+ydelta_rho_y+zdelta_rho_z_1 &  		_nx^2_ndelta_rho_x^2_n+y^2_ndelta_rho_y^2_n+z^2_ndelta_rho_z^2_n =   	& = 		x^2delta_rho_x_1+y^2delta_rho_y_1+z^2delta_rho_z_1  Minimization over the Bloch sphere () leads to the desired result.   State-Aware Network   Reward scheme    Protection reward The purpose of the protection reward is that the agent learns how to protect the quantum information against the error mechanisms of the quantum system, ie to preserve a state that could in principle be recovered without the need to actually perform the recovery sequence (also cmp Methods). For instance, in the bit-flip examples, the agent learns to go into a proper encoding and to perform afterwards repeated parity measurements. Most of the networks in sec ``Results'' of the maintext are trained solely with this type of reward; only for fig:decoding_and_event_aware in the main text, an additional recovery reward (see below) has been considered.  For convenience, we will set the simulation time step to  in this discussion.  As discussed in sec:magic_quantity and the main text,  is a powerful measure for the capability to recover a target state (without the need to actually perform these steps), and so the objective is to maximize the value of  at the final time . For learning efficiency, and (very important for us) to credit already partial success, we aim for an immediate reward. This reward should essentially be of the form : as the learning algorithm optimizes the reward sum, , the agent is guided towards the desired behavior, to maximize .  In practice, we have found it useful to implement the reward scheme rather in the following form, which will be motivated below:                 where  denotes the time per gate operation,  is the decay time of the quantum state in the trivial encoding, and  is the punishment for a measurement which reveals the logical qubit state.  will be defined in the next paragraph. Note that  is still designed such that optimizing  leads to the highest possible reward sum .  The updated value of  after a measurement can depend on its outcome. We define  as the expectation value for . For measurements, this is the average for all possible measurement results, weighted according to their probability. For unitary gates, there is no ambiguity and thus . We will motivate below why it makes sense to consider this quantity.  When computing the (discounted) return  from the reward, we choose to distribute only  backwards in time, while  is assigned directly to the respective action:      is the discount rate; we choose a value of , corresponding to a half-life in the range between 10 and 20 time steps.  The expressions in eq:definition_magic_reward,eq:definition_magic_return are chosen for the following reasons:  	For measurements, there is the special situation that, dependent on the quantum state, they might reveal information about the logical qubit state. This is always accompanied by the destruction of superpositions, and in our operation sets, it even leads to their complete destruction. Because no other action could lead to a worse state and the exceptionally strong variation in  would cause learning instabilities, it makes sense to treat those cases separately. 		 		These ``destructive'' measurements are characterized by the fact that  drops to  independent of the measurement result. If this situation occurs, we deviate from a reward that is directly related to , and instead set the immediate reward  to a fixed negative value . Furthermore, because this situation could easily be avoided by choosing this particular action different, we do not distribute this reward over the previous time steps when we compute the return. 		 		As an alternative, those measurements could simply be excluded from being performed by an external instance. We decided against doing so because in the real-world application we aim for (control of a quantum experiment), an agent needs to be able to detect these cases on its own. 	Even after excluding those measurements which reveal the logical qubit state,  can still jump in special situations; for example, in the two-qubit scenario discussed in sec:magic_quantity:properties, there are measurements that make  increase in case of the anticipated result, at the expense of getting  for the unlikely one. These strong fluctuations in  would lead to large variations in the reward and thereby can easily cause learning instabilities. This can be improved by using the variable  as defined above: we can easily replace  because in the end, the reward is used to compute an estimator (for the learning gradient, see sec:reinforcement_learning), and on average both coincide. Since  is much more stable than , we can easily get rid of the instabilities; as an intended side-effect, this also reduces the ``normal'' noise level on the learning gradient (due to the deviations between the estimator and the true value) because now each simulation averages directly over all possible measurement results, something that otherwise would have to be done over many epochs. 	The first case in eq:definition_magic_reward is a scaled version of  due to the following consideration: For the trivial encoding, we have (at the start of the simulation)  since in this case  for , whereas for perfect conservation of the quantum information, ie constant , we would get . Note that typically, even the ideal action sequence does not reach constant , but it provides a good approximation for comparison with other strategies. From comparing the values  and , we can see that the typical value range for  depends on parameters of the physical model. In practice, this makes it difficult to change these properties, especially the type of error channels and the corresponding decoherence rates. For a proper normalization, we can simply divide  by ; in addition, we can always add the constant value which we choose to be , such that the trivial encoding earns  and the ideal strategy .   Recovery reward In practice, the goal is to eventually recover the logical qubit state from the physical qubits. This means that the quantum system should finally be brought into a state where the logical qubit state can be read off easily from one target qubit, with a pre-defined interpretation for the polarization. To train the network towards this behavior, we will introduce a recovery reward  (see below) that is given in addition to the protection reward (which only addresses preserving the recoverable quantum information ). Furthermore, we extend the input of the neural network to also contain the time. It is fully sufficient to add a ``countdown'' for the last time steps to signal the network when the decoding should start (when also the decoding reward can be earned). We input this countdown in a one-hot encoding. Note that it does not matter how many time steps exactly remain when giving the decoding signal (and the recovery reward), if there are sufficiently many left to fit the decoding sequence, which of course is initially unknown. For our example shown in fig:decoding_and_event_aware of the main text the countdown is started when , and the decoding reward is only given afterwards.  A successful recovery requires to correct for the errors (if some occurred) and to decode, such that in the end the logical qubit is stored solely on a specified target qubit. All other qubits should be disentangled and in particular the state of the target qubit should not be flipped compared to the initial state.  To achieve this, we extend the reward scheme by two contributions: First, an additional decoding reward can be earned during the last few time steps. Second, a correction reward can be earned at the last time step (but only if the decoding has been successfully performed). We combine them into the recovery reward     where  and  are the scalings for the decoding and correction reward respectively. In the following, we will discuss first the explicit form of  (for decoding) and later that of  (for correction).  We design the decoding reward to ease learning for the network. Instead of providing a reward only if all qubits of our example are in their respective desired target state of either containing or not containing information about the logical qubit state, it helps to immediately reward also partial success, ie whenever one more qubit is brought into the desired state. Thereby, this disentanglement of qubits can be learned stepwise until all qubits are decoded correctly.   In order to quantify such a reward, we aim for a criterion to determine whether a qubit (ignoring all other qubits) contains at least a small fraction of quantum information about the logical qubit state. We obtain a mathematically sufficient criterion by investigating the partial trace over all other qubits: in order to conclude that qubit  definitely contains information about the logical qubit state, we evaluate whether    depends on the logical qubit state . Expressed in terms of the variables ,  and  (cmp eq:construction_rho_xyz), stating that the quantity  does depend on  and therefore  carries information about the logical qubit state is equivalent to the condition that at least one of the corresponding partial traces is non-vanishing:  	(_q(delta_rho_x(t)) 0)  	(_q(delta_rho_y(t)) 0)  	(_q(delta_rho_z(t)) 0)  We have successfully applied this criterion to train the network analyzed in fig:decoding_and_event_aware of the main text. To see why this is strictly speaking not a necessary condition (and thus not generally applicable), consider the Laflamme-Miquel-Paz-Zurek suppl:laflamme1996perfect encoding. There, this criterion would predict that there is no quantum information in any of the qubits, even though the expected result is that it is distributed over all of them. Nonetheless, for our example of the repetition code it is very useful to help the network to learn the decoding with a close to perfect success rate. One can now specify a desired target state, where eg the first qubit is supposed to contain the quantum information, but none of the remaining qubits. By evaluating condition eq:tracecrit for each qubit, we identify how many qubits are in the desired target state of containing or not-containing quantum information and calculate        where  denotes the time where the neural net obtains the signal to decode, ie, where the countdown starts. As the decoding reward is essentially  (see eq:recovery_reward), a positive reward is given if the number of qubits in the desired state increases from one time step to the next, and the network is punished with a negative reward if the number of qubits in the desired state decreases. The corresponding coefficient  has to be sufficiently large such that the decoding reward can compete with the protection reward (we choose ). This is because during and after the decoding,  decays faster, lowering the protection reward. Note that the decoding reward is set to zero if the recoverable quantum information is already too small. In our particular example, we have chosen the threshold to be .  Having decoded the multi-qubit state leaves the logical qubit solely on a specified physical qubit. However, this is not necessarily the initial logical qubit state. Preserving the recoverable quantum information  only implies that the initial logical qubit state could in principle be recovered from the actual qubit state. To trigger the network to perform corrections, such that the final state is not flipped with respect to the initial logical qubit state, we calculate whether the Bloch vector of the specified physical qubit after the final time step is rotated with respect to the Bloch vector of the initial logical qubit state. To quantify this, we consider the overlap  for a given logical qubit state ;  denotes the partial trace over all qubits except for the target qubit. As a successful error correction scheme needs to work for all possible logical qubit states, we focus on the worst-case, ie we consider     (cmp eq:overlap_criterion). According to , we can write  in terms of , ,  and . If  and no information about the logical qubit state has been revealed ( for all ),  simplifies to     with ;  denotes the smallest eigenvalue. In our bit-flip scenarios, only the two cases  can occur after decoding into the target qubit. We set  if (at the end of the simulation) the decoding has been performed completely and , and otherwise . Like for the decoding reward, the coefficient  has to be sufficiently large such that the correction reward can compete with the protection reward (we choose ).  In the learning gradient, we do not consider directly the reward , but rather the return which we choose as    with discount rate .   Network Input    As discussed in Methods, the input to the state-aware network consists of (i) a representation of four evolved density matrix contributions (that represent the evolution of all logical qubit states), (ii) one neuron per measurement in the action set which predicts whether executing that particular measurement would reveal information about the logical qubit state, (iii) the previous action, and (iv) a counter indicating the physical time during the last few time steps; (iv) is given only if we want the agent to perform explicit recovery. Here, we provide additional information for (i) and (ii):   	As the state-aware network is supposed to have perfect information, its input should make it possible to reconstruct the quantum state for any logical qubit state.  		 		This information is contained in , or any (non-trivial) combination of these quantities. In particular, this includes ;  consists of the density matrices for the logical qubit states  (fully depolarized), ,  and  (up to normalization which only matters if information about the logical qubit state has been revealed). We prefer  over  because it is in a more ``compact'' format: ,  and  are usually dominated by one eigenstate (as long as the quantum information is well preserved), whereas ,  and  already start from two components with equally large contribution, so the double number of PCA components would be required for the same amount of information. In practice, we have found that this indeed makes a difference in learning. 		 		The straightforward approach would be to feed these density matrices directly into the neural network (one input neuron per matrix component). However, we have found it useful to pre-process the density matrices via principal component analysis (PCA). The key motivation is to reduce the input size of the neural network: compared to the  entries of a density matrix, we downsize the input to  components where  is the number of PCA components which we would typically choose polynomially in  (note that the eigenstates are of dimension , and the density matrices of dimension ). So, the input size still grows exponentially with  even for the PCA-ed input, but compared to the non-PCA case we still win an exponential factor. A nice side-effect is that the PCA automatically decomposes density matrices into main channels and error contributions (and sorts these components by influence); we suppose that this helps the network to better recognize the input states. 	As already explained in sec:reward_scheme, a particular pitfall are measurements which reveal information about the logical qubit and thereby ``destroy'' the quantum state. In the following, we describe an extension to the input which helps the network to detect these cases. 		 		From eq:construction_rho_xyz, it can be seen that the knowledge about the logical qubit state is determined by the vector 		        		The ideal case where no information has leaked out, ie all logical states are still equally likely, is equivalent to . We now consider the effect of measurements on . For a measurement with two possible results (let  and  be the corresponding projection operators), the ``measurement bias'' vector 		        		describes the change of : 		    		Therefore,  indicates how much additional information about the logical qubit state is gathered by performing the corresponding measurement. 		 		For our set of operations, each measurement is either unbiased or leads to a complete ``collapse'' of the quantum state; from eq:update_knowledge_bias, we see that the condition  should distinguish these cases. So, we compute  for each measurement in the action set and provide it as additional input to the network. Because this information can be extracted from ,  and , this is in the strict sense no additional input, but rather a ``rewording'' of a special property in a convenient format. 		 		We have observed that these neurons indeed accelerate the learning process, especially in the early training phase.      Reinforcement Learning Algorithm    Reinforcement learningsuppl:sutton_reinforcement_1998 is a general framework to autonomously explore strategies for ``optimum control'' problems. In the terminology of reinforcement learning, the control problem is represented by an ``environement'' and the controller by an ``agent''. This agent can successively choose between different actions; for this purpose, it typically has (at least partial) knowledge about state of the environment.  In the policy gradientsuppl:williams_simple_1992 approach, the agent directly computes a policy function  which gives the probability to choose action  in state ;  is a (multi-dimensional) parameter representing the internal state of the agent, for us typically the weights and biases of the neural network. Training means to search for weights  which yield some desired behavior.  The simplest way to train such a policy is given by the ``vanilla'' policy gradient    where  denotes the expectation value (according to the policy ) and  the return collected for the particular action sequence (see sec:reward_scheme for our choice of the return). In practice, an estimate for  is computed from a finite number of simulations, and then the parameters  are updated -- again in the simplest case -- according to the update rule     (``steepest ascent'') with the learning rate ; this procedure defines one epoch, and is repeated multiple times.  There are various modifications to the learning scheme as discussed so far which often lead to significant improvements in terms of learning speed and stability. Specifically, we make use of the following techniques:  	Instead of eq:vanilla_update_rule, we actually use the adaptive moment estimation (Adam) update rulesuppl:kingma_method_2015 		 			 				&  					+ B_n mv   				m &  					_1 m + (1-_1)g   				v &  					_2 v + (1-_2)g^2 			 			 		 		with the Adam hyperparameters ,  and ;  denotes the element-wise square, and with  we mean the element-wise square root of . The coefficient  can depend on the epoch index  and is proposed by the Adam inventors to counteract the zero bias for  and  in the early training phase (); in the results shown here and in the main text, we did not employ bias correction which is realized by . Both variants yield comparable results for us. 	A particular difficulty which occurs in our challenge is that we have a quasi-continuous spectrum for the reward, and it is necessary to resolve small differences in there. Improving this aspect is one of the advantages of the natural policy gradientsuppl:peters_natural_2008, defined by 		   		with the Fisher information matrix 		   		for actions  and states  being distributed according to the policy ;  denotes vector transpose. For more information, see suppl:amari_natural_1998,suppl:kakade_natural_2002,suppl:peters2003nat_grad,suppl:peters_natural_2008,suppl:pascanu2013nat_grad (the appendix of the latter also gives a recipe for an efficient implementation based on L and R operations). 	Policy gradient schemes can often be enhanced by subtracting a baseline from the return, ie 		   		where  is in the simplest case an average of past values for the return. The motivation is that for suitable , the variance of  is smaller than the variance of  alone, and so the estimator for this modified learning gradient should have smaller fluctuations. 		 		There is a tailored way to choose the baseline  for the natural policy gradient suppl:peters2003nat_grad, but we do not use this one because another aspect is more important for us. Due to the structure of the protection reward (see sec:reward_scheme), the corresponding return is explicitly time-dependent: for successful strategies where  and , the return behaves as , ie  drops from  to  near the end of a trajectory. Also the distribution of the recovery reward in time is highly uneven (only assigned in the final time steps). To compensate for this time dependence of the return, we use a time-dependent baseline: 		   		In practice, we choose the baseline  as exponentially decaying average of the return : in epoch , the baseline takes the value 		   		where  is the discount rate and  is the mean of the return at time step  found in epoch . 		 		We have observed that this explicitly time-dependent baseline considerably improves learning stability and leads to much faster learning. 	Without any countermeasures, policies often strongly tend to prefer few actions only. In order to encourage exploration, it has been found useful to introduce entropy regularization suppl:williams_function_1991: the learning gradient  used in the update equation (cmp eq:vanilla_update_rule,eq:adam_update_rule) is substituted by  where 		    		is the Shannon entropy (note that also the alternative definition with  is common). For the problem we consider, however, the choice of its coefficient  is problematic: we observed that either there is no significant amplification of exploration, or the trade-off between maximizing the reward and maximizing the entropy is so strong that their common optimum is shifted away considerably from the optimum of the return. This means,  at the end of the simulations reaches a significantly lower value if entropy regularization is applied. We have found that it is the best strategy to start with entropy regularization for better exploration and later smoothly reduce its effect (by slowly decreasing ). Because we discovered this relatively close to the submission of this paper, only one of the networks shown in the main text (fig:decoding_and_event_aware:learning_curve_state_aware) is trained with entropy regularization, suddenly switched off at epoch 12000.    Smoothening the learning gradient   We emphasize that, whenever possible, we try to consider as many cases as possible in one go, in order to reduce the noise on the learning gradient; this is like a golden thread running through the whole work presented here. Concretely, we take the following actions:  	Our physical simulations are based on density matrices instead of wave functions. The advantage of density matrices is that they already represent the ensemble-averaged behavior of a quantum system. Dealing with wave functions would have required to sample all possible trajectories, or at least a sufficiently large subset, in order to get comparably accurate statistics. Therefore, the fact that a single density matrix contains a complete description of the quantum system prevails over the higher consumption of computational resources (density matrices are higher dimensional objects than wave functions and therefore their time evolution is numerically more expensive and they require more memory). 	Furthermore, we also want the neural network to perform well on all possible logical qubit states. In principle, this can be achieved by training on randomly chosen logical qubit states (which requires a fair sampling and sufficient coverage of all possible states during training). Instead, however, it is much more efficient and also easier to consider the full Bloch sphere in each ``trajectory'': by evolving four variables with the dimension of a density matrix ( as explained in sec:phys_time_evolution) and rewarding the neural network based on its performance in the worst case, we directly train the network to find suitable strategies for all of them. Note that this kind of parallelism for the logical qubit state is also necessary to prevent the network from ``cheating'' (cmp sec:state_aware:layout). 	Another point where we prefer to train rather on the average behavior than on specific examples is how measurements are treated in the reward scheme. The  value after a measurement can depend on the measurement result. If the agent (here, the neural network) has decided to perform a measurement, it has no further influence on the obtained result, and so it makes sense to make the reward for this action independent of this random decision. Therefore, we take the average over all possible  values (weighted by the corresponding probabilities to find them); sec:reward_scheme describes how this can be done in a consistent way.    Recurrent network   The state-aware network develops powerful strategies for protecting the quantum information in a given qubit architecture and for a given error model. This network has, however, complete knowledge of the quantum state (or, more precisely, the completely positive map describing the evolution, represented via four density matrices, as explained in the Methods) meaning that it cannot be employed in an experiment, where information is only gained through measurements. We therefore need a neural network that is blind to the quantum state and is only aware of the measurement results. This is inherently a non-Markovian decision process: this situation requires memory to correlate previous measurements and make a decision based on their outcome. We therefore implement this state-blind network as a recurrent neural network in the form of a long short-term memory (LSTM) network suppl:hochreiter97. The state-aware network is used as a supervisor to teach the recurrent network the correction strategy. Here we only perform supervised training but the recurrent network could in principle be trained further with reinforcement learning such that it adapts its strategy to the concrete experimental setting with a potentially uncertain knowledge about the decoherence rates or other parameters.  In contrast to feedforward neural networks with single artificial neurons as building blocks, LSTM networks consist of neurons with internal memory and more complex structure suppl:goodfellow16. An LSTM neuron comprises a cell, input gate, output gate, and a forget gate. Each gate is a conventional artificial neuron with a nonlinear activation function that regulates the flow of information whereas the cell is responsible to remember values over time. The ability to correlate input signals over arbitrary time intervals renders LSTM networks powerful tools for processing and predicting time series in real-world applications. A more detailed description of LSTM networks can be found in Ref. suppl:goodfellow16.  The goal of our recurrent network is to learn the complete procedure of quantum error correction from the state-aware network: encoding the logical qubit, detection and recovery strategies, decoding the logical qubit, and finally, unitary operations that ensure that the final state is parallel to the initial state on the Bloch sphere. We consider the four-qubit system subject to bit-flip errors as explained in the main text. As a first step, the state-aware network is trained with immediate reward based on the recoverable quantum information and, in the last time steps, an additional immediate reward that enforces the decoding procedure is used. At the end of the time span, the network is given a reward to rotate the final state parallel to the initial state. The reward scheme is explained in sec:reward_scheme. After convergence is achieved, a training dataset for the recurrent network is generated.         The recurrent network receives as input the action taken by the state-aware network, , and the measurement result in the -basis (in case a measurement was performed), , and outputs the policy, , that determines the action at the next time step, see fig:lstm_training_validation(a). The goal of the recurrent network is therefore to find a non-trivial function, , that correlates the policy at time  to the input at all previous times, ie,    In the case of quantum error correction, the long-term memory is particularly important during a recovery operation after an unexpected measurement result. This is because the network needs to carefully keep track of the error syndrome and apply a correction after the recovery operation. During validation, the performance of the recurrent network is tested on the physics environment (this is the same environment that the state-aware network is trained on). In this case, its own action at time  (including the measurement outcome if the case) is fed to the input at  as shown in fig:lstm_training_validation(b).                      The key hyperparameters of the training procedure are listed in tab:lstm_hyperparams. The function that is optimized during training (the loss function) is taken to be the cross entropy between the policy of the recurrent and state-aware networks.    Hidden representation analysis via t-SNE   The goal of the state-aware network is to find an optimal encoding and correction scheme that protects the quantum information from decoherence. For bit-flip noise, the network finds various versions of the 3-qubit repetition code that are discussed at length in the main text. To understand how the strategy is reflected in the hidden representation of the network, we employ the t-distributed Stochastic Neighbor Embedding (t-SNE) technique suppl:maaten08 to the last hidden layer of the network. t-SNE is a nonlinear dimensionality-reduction technique that maps high-dimensional data to a two- (or three-) dimensional space and preserves the structure of the original data. In particular, nearby objects in the high-dimensional space are mapped to nearby points in the low-dimensional space.  In the following we give a brief description of the t-SNE algorithm. The similarity between the datapoints  and  in the high-dimensional space is modelled by a Gaussian joint probability distribution, ,    and a Student t-distribution, , in the low-dimensional space    The t-SNE algorithm aims at finding a low-dimensional representation of the data that minimizes the mismatch between the two probability distributions. This mismatch is quantified by the Kullback-Leibler divergence, , which the algorithm minimizes using gradient descent.  A critical parameter of the t-SNE technique is the perplexity, , which is defined as    The variance, , increases as the entropy (and hence the perplexity) increases. The perplexity can therefore be interpreted as a measure of the number of neighbors considered by the algorithm. With a large perplexity, the algorithm is inclined to retain the global structure of the data, whereas a low perplexity emphasizes the local structure.   Implementation    Our RL implementation is based on the Theano framework suppl:al-rfou_et_al._theano:_2016, and we usually run it on GPU. Since Theano provides efficient solutions for all our neural-network related needs, we do not expect that too much can be achieved here via software optimizations. The easiest way for us to accelerate the learning part is to use one of the currently available, more powerful GPUs (currently, we have Nvidia Quadro P5000).  For the physical time evolution, we needed to implement our own simulation tools because there is no ready-to-go package meeting our specific requirements. Our current physics code is NumPy-based and runs on CPU; this is inefficient as it involves a lot of overhead and causes a memory bottleneck between physics (CPU) and network training (GPU). In addition, evolving quantum systems is a well-suited task for execution on GPU, and could therefore benefit greatly from its computing power. To improve all this, we plan a GPU-based implementation also for the physical time evolution in the future.  The numerically relevant subproblems in the time evolution scheme are (i) updating  for the time evolution, (ii) extracting the actual network input, and (iii) computing  for the reward. Practically, (i) means matrix-vector multiplications between a superoperator (the completely positive map) and , , ,  (interpreted as vectors); due to the sparsity of these superoperators, this operation is still relatively runtime-efficient (despite the high dimensions of the operands), and the completely positive maps describing one time step for each action of the network can be stored together in memory. For (ii), a principal component analysis has to be performed, and (iii) involves the computation of trace distances. Thus, several matrices with the dimension of  have to be diagonalized in (ii) and (iii).  For the special case of CHZ circuits (all unitary operations are combinations of CNOT, Hadamard and phase gates; measurement of variables in the Pauli group; state preparation in the computational basis [p 464]suppl:nielsen_quantum_2011), we can exploit the special structure of the multi-qubit quantum states that are generated. Because we still require the full density matrix, we cannot reach polynomial runtime behavior (in terms of the qubit number) like for the evolution of pure states according to the Gottesman-Knill theorem suppl:gottesman1998heisenberg; however, we can still gain an exponential factor compared to the general (non-CHZ) case. The key idea behind the efficient evolution of pure states suppl:cleve1997stabilizers,suppl:aaronson2004improved_stabilizers is to characterize such a state as the simultaneous eigenstate of several commuting stabilizers (with eigenvalue  for each of them). In our adaption, we keep track of the matrix diagonal and the stabilizers determining the eigenbasis (here: stabilizers are those which commute with the density matrix). Then, (i) involves dense matrix-vector and sparse matrix-matrix multiplications (both for reduced dimensionality), and cheap update operations for the stabilizers. The effort for the diagonalization in (ii) and (iii) is completely eliminated since the matrices are already in diagonal form, and only significantly faster operations remain.                         In our typical 4-qubit bit-flip examples, a reasonable level of convergence for the state-aware network is achieved within 25000 epochs. With our current implementation, the overall runtime (for the physical time evolution and the ANN training together) is around 20 hours, and the CHZ-specific optimizations reduce this time to below 6 hours. Both values are measured on the same machine (CPU: Intel Xeon E5-1630 v4, GPU: Nvidia Quadro P5000). For a well-optimized software implementation in combination with the most powerful hardware that is currently available on market, we estimate that a relative speedup of factor  is feasible.   Additional information on figures   Training progress due to the protection reward   In order to make the training progress in fig:training:learning_curve nicely visible, we needed to rescale the figure axes. The  axis is divided into three parts (to epoch 500, from epoch 500 to 2500, and from epoch 2500); inside these segments, the epoch number grows linearly. The data points are averaged over the last 10 epochs in the first segment, over the last 50 epochs in the second segment, and over the last 250 epochs in the third segments. The  axis is scaled as , ie we essentially plot the negative logarithmic error probability (as  is the success rate for the optimal recovery sequence). The logarithmic scaling of the  axis is performed after taking the average.  From the  value at the end of a simulation, we can extrapolate an effective decay time (cmp sec:more_on_figures:effective_decoherence_time). fig:learning_curve replots the learning curve from fig:training:learning_curve in maintext, where the ticks on the right  axis indicate the effective decay time .                Discussion of trajectories of the converged state-aware network   In fig:training(b) and (d) we show examples of gate sequences produced by the neural network. The measurement symbols indicate measurements in the -basis and the outcome encoded in the color, ie dark red represents ``0'' or ``up'' and orange represents ``1'' or ``down''. The light blue background of the quantum circuits indicates which qubits carry information about the logical qubit state. It is calculated from the criterion (eq:tracecrit). In Figure 2(c) of the main text we show the recoverable quantum information  as a function of time at different training stages. The results of the converged network (green lines) show a barely visible decay of  with time. However, a close look at this trajectory reveals interesting substructure. Therefore, in fig:trajs(a) we show this trajectory (labeled ``traj. 1'') from the main text, the corresponding sample-average, as well as another typical trajectory. Here it becomes visible, that both trajectories are subject to a fast decay in the first few time steps, where the encoding does not yet slow down the normal decoherence process. After distributing the information about the logical qubit on several physical qubits, the effective decoherence rate is reduced, but only after the first parity measurement  increases again. Note that this increase of the recoverable quantum information is not guaranteed, but depends on the measurement outcome: If the measurement result indicates that the two qubits are still in the same state (which is the most likely outcome after a sufficiently short time span) then the one can safely assume that no error occurred so far and a small revival of  is observed. However, if by chance the measurement outcome indicates a bit flip, a drop of  would occur instead. The corresponding gate sequences are displayed in fig:trajs(b). The network immediately performs the CNOTs to switch to the encoded state, where the decay of  is slowed down. Curiously, this particular network consistently performs two unconventional additional actions (a bit flip and a measurement), before preparing the first parity measurement. (training another neural network does not reproduce these two actions). One could speculate, that the seemingly unnecessary very first measurement of the second qubit is performed in order assure the state of this qubit since it is then used as the measurement ancilla.  In the inset of fig:trajs(a) it becomes visible, that the subsequent repeated parity measurements lead to a periodic tiny decay and recovery of the recoverable quantum information, since in these trajectories, all the measurement outcomes indicate that no error occurred. Note that, although a different sequence of parity measurements is performed for trajectory  and , the recoverable quantum information in both cases is the same. The slight shift of the trajectories that eventually appears is due to a repeated measurement in trajectory , see fig:trajs(c). Only when an error is detected, as in trajectory  (fig:trajs(d)), the behavior changes: The recoverable quantum information drops, until additional parity measurements determine which qubit was actually subject to the bit-flip. Then  partially recovers. Note that these are tiny small-scale drops compared to the large-scale drops visible for the not yet converged network in fig:training:magic_vs_time of the main text (which are cause by more then single bit-flip errors or unclear situations because too much time passed between consecutive measurements).  The dashed line in fig:trajs(a) shows the sample average over  trajectories. It decays faster than trajectory , where no error occurred at all due to all the trajectories with bit flips (and a corresponding drop in ) at various different times that enter the average (note that the ``revival'' of the sample average is only an artefact due to the small number of trajectories used here).   t-SNE   In fig:analysis and fig:decoding_and_event_aware of the main text, we show graphical representations of the quantum states via the yellow rectangles. The border of the rectangles is colored according to the action the network takes for the particular input. In detail, we show the six states with the largest contribution to the density matrix  ordered by their associated probability. The exact value of the probability is visualized by the blue bars next to the states. The states with a probability less than 5 are semi-transparent. This represents as a showcase how an initial superposition state  evolves. The black (white) circles correspond to 1 (0) so that, eg, the state  is equivalent to .  Here we apply the t-SNE technique to the hidden representation of a fully converged neural network that is trained via reinforcement learning to protect four physical qubits against bit-flip noise as explained in the main text. The network has three hidden layers of 300 neurons each. To improve speed, we first perform a principal component analysis that maps the original 300-dimensional data onto a 50-dimensional space. Aside from perplexity, all other parameters of t-SNE are kept at their default value suppl:pedregosa11. To highlight both the global and the local structure of the hidden representation, we apply the t-SNE algorithm using three different values of perplexity (compared to the data set): small, intermediate, and large. In the following we discuss the map presented in the main text, which is computed for an intermediate value of perplexity and captures a subtle interplay between global and local features. Later we will discuss two additional maps with large and small perplexity.  Intermediate perplexity. In fig:analysis in the main text, we perform the t-SNE algorithm on a network validated on 1024 trajectories, each with 200 time steps, which yields a data set of 204,800 points. A perplexity of 2500 is used. A point on the map corresponds to the 2D-projected hidden representation for a particular input (the four density matrices of the RL-environment), and is colored according to the action the network takes. The map features several dense clusters as well as smaller islands and collection of points. To understand this pattern, we study a steady-state detection sequence that is visualized in fig:analysis:expected_msmts. An inspection of the density matrices reveals that, in steady state, one quantum state has the largest contribution, which is the state the network aims to protect from decoherence. The other states are the leading error channels that the network aims to remove by applying the steady-state detection cycle: CNOT(1,3)CNOT(4,3)M(3)CNOT(1,3)CNOT(2,3)M(3). In this case, the network uses the second qubit as the ancilla and an encoding of the quantum information in the other three qubits of the form    The density matrix can be uniquely identified at any time during the steady-state detection cycle. For instance: (i) the states after a measurement have a higher coherence than before the measurement, (ii) after a cnot operation the ancilla is entangled with the other qubits, and (iii) the orange and purple nuclei correspond to a different state of the ancilla qubit. These differences are clearly understood and exploited by the neural network judging from the clusters in the hidden representation.        The detection strategy is six-fold periodic and can be visualized in the hidden representation via the gray trajectory in fig:analysis:tsne. The nodes of the trajectory are displayed as white circles. The trajectory features jumps between the six largest clusters of the map, which contain most of the points of the map. This is because unexpected measurements (which interrupt the detection cycle and take the network outside the main clusters as described below) are improbable events: using the parameters from the simulation we obtain a probability of  over the entire trajectory that all measurements on the ancilla qubit yield the expected result. A peculiar feature of the main clusters is their strongly asymmetric shape, which is due to the slow drift of the density matrix subject to decoherence. This can be visualized in the inset of fig:analysis:tsne, where the orange cluster on the right-hand size of the map is colored according to a function that varies linearly with time (white corresponds to  and dark orange to ). The detection strategy therefore forms nearly closed loops in the hidden representation that slowly drift as time progresses. Some clusters are spread out so much that they are ``cut'' by other clusters. An example can be seen in fig:tsne_intermperpl_time, where the map is colored according to time. Comparing this map with the map in the main text one notices the dominant CNOT13 cluster on the left-hand side of the map being cut by the M3 cluster. This ``artifact'' is likely due to the fact that the perplexity is not sufficiently high and the global structure is not fully captured.  The quantum system is brought out of the steady state by an unexpected measurement result, which means that a measurement on the ancilla qubit does not project the quantum system onto the state with the largest contribution (see the discussion in the above paragraph). This interrupts the periodic detection sequence; the network employs a fully adaptive strategy in this regime that is carefully optimized during training since it plays a key role in the capability to recover the quantum information. This recovery strategy deals with markedly different quantum states and thus corresponds to different trajectories in the hidden representation. An example of a recovery trajectory is displayed by the blue line in fig:analysis:tsne, where the white stars denote the nodes of the trajectory. These points belong to small clusters outside the dominant clusters.  In the following we discuss key features of this particular recovery strategy. At step 1, an unexpected measurement result projects the quantum state onto a mixture of three pure states with comparable contribution, which correspond to a bit flip of qubit 2 (largest contribution), qubit 1 (second largest), and qubit 3 (ie, the ancilla qubit), see fig:analysis:surprising_msmt. The probability that qubit 2 flipped is roughly twice as large as the one of qubit 1 and 3 (whose probability is about the same). This can be understood as follows. Consider the state at the beginning of the detection cycle (eg, belonging to the blue cluster in the figure)    where the subscript ``A'' denotes the ancilla. The ancilla is the physical qubit that has been designated by the network to be measured. The first part of the detection cycle, CNOT(1,3)CNOT(4,3)M(3), projects the ancilla state onto  assuming an expected measurement result. The error channels in which qubits 1, 2, or 4 flip map the ancilla state into , , , respectively, meaning that an expected measurement result  leaves the flip of qubit 2 to be the leading error channel. The second part of the detection cycle, CNOT(1,3)CNOT(2,3)M(3), maps the ancilla state back onto , while the error channels are mapped onto , , and , respectively. Clearly, in the case of an unexpected measurement result , the three major contributions are the flips of qubits 1, 2, and the ancilla itself. Since only qubit 2 was not corrected after the first part of the detection cycle, it carries a contribution that is twice as large. These features can be clearly seen in the density matrix.  After projection onto an unexpected state (step 1), the network begins a recovery cycle that should ideally be as short as possible. The network enforces this by targeting the state with the largest contribution in the density matrix. As a result, application of CNOT(4,3)CNOT(2,3)M(3) (steps 2--4) intentionally swaps the ancilla of the leading contribution to . At this particular time step, the outcome of the measurement yields  meaning that the network needs to perform another cycle (steps 5--7) to bring the quantum system back to a coherent state. After the measurement at step 7, it is finally revealed that the ancilla was flipped.  Large perplexity. In the following we perform the t-SNE algorithm on a network validated on 16 trajectories, each with 200 time steps, which yields a data set of 3200 points. To faithfully reproduce the global structure of the representation, we use a relatively large perplexity (compared to the data size) of 200. Upon a visual inspection of the map in fig:tsne_largeperpl, six main clusters can be identified that likely reflect the six-fold periodicity in the detection scheme. Note that after the next layer (ie, the output layer), these clusters are converted to nearly deterministic actions. Each cluster has a non-trivial substructure with a nucleus of tightly packed points and peripheral domains with smaller density. We identify the nuclei with the steady state of the quantum system in which measurements yield the expected outcome and increase the coherence. This is the most abundant situation due to the small decoherence rate used in the simulations and, thus, a small probability that a measurement yields a result with an unexpected outcome. Consequently, the nuclei contain the majority of the points of the cluster.              Each nucleus has a representative input (density matrix) that is shown in fig:tsne_largeperpl(a). A steady-state detection strategy is six-fold periodic and is reflected in the hidden representation as jumps between the nuclei. An inspection of the density matrices in fig:analysis:surprising_msmt reveals that, in steady state, one quantum state has the largest contribution, which is the state the network aims to protect from decoherence. The other states are the leading error channels that the network aims to remove by applying the steady-state detection cycle, see the discussion from the intermediate-perplexity section.   Despite being tightly packed, the nuclei show some substructure as well due to the fact that the quantum system decoheres over time. This slow drift of the density matrix can be seen in fig:tsne_largeperpl(c), where the nucleus belonging to the red cluster is colored with a function that depends linearly on time, from  (white) to  (black).  The peripheral domains of a cluster belong to states in which the quantum system is brought out of the steady state by an unexpected measurement result, which means that a measurement on the ancilla qubit does not project the quantum system onto the state with the largest contribution. The recovery cycle can also be visualized in the hidden representation of the network, where the white stars denote the points belonging to the cycle. Initially (before step 1) the quantum system is in steady state and the point belongs to the nucleus of the brown cluster. The points during the recovery operation belong to the peripheral domains. The corresponding density matrices have common features with the cluster they belong to, yet are sufficiently dissimilar and are clearly separated from the nuclei. After the recovery cycle (after step 7), the quantum system goes slowly back to steady state and no longer ends up in a nucleus but rather in another conglomerate of points close to it. We have observed this to be a generic feature of all trajectories and is caused by the slight decrease of coherence of the states after a recovery cycle, which the network observes through the density matrix.  Small perplexity. In the following we use the t-SNE technique to visualize the hidden representation in the small-perplexity regime for getting a deeper insight into the local structure of the data. We evaluate 1024 trajectories of 200 time steps each yielding a dataset of 204,800 points with a perplexity of 400. The resulting map is displayed in fig:tsne_smallperpl and features several long and thin clusters that would form the nuclei in the high-perplexity regime as well as smaller and less dense clusters that would likely form the peripheral domains. In fig:tsne_smallperpl(a) the map is colored upon the action the network is about to take. There are six actions the network takes: four are related to the detection and recovery strategies mentioned above, and the other two, CNOT(1,2) and CNOT(1,4), are performed at the very beginning of the trajectory to encode the logical qubit. The slow decay of the coherence is revealed particularly well on this map, see fig:tsne_smallperpl(b). Despite revealing the local structure of the map with great detail, the global information is somewhat distorted. For instance, note the long orange stripe on the right-hand side of the map in fig:tsne_smallperpl(a) that is ``cut'' towards the middle by another cluster. This cut becomes particularly obvious if one follows this cluster in fig:tsne_smallperpl(b).   Effective decoherence time    In fig:variations(a) and (b) of the main text we show different qubit connectivities that are realized by restricting the set of available gates that the neural network can use. Only single qubit gates and CNOTs between connected qubits can be performed. We also restrict the qubits on which measurements are available. In the gate sequences shown in fig:variations:conn_seq the effect of a geometrical restriction becomes clearly visible: A simple parity measurement requires now (on average) more than three operations (which would typically be two CNOT and one measurement). For example, in the case of the circular geometry, where measurements are only allowed on an ancilla qubit with a single nearest neighbour it requires at least six operations to entangle two different qubits to the ancilla. One of those can be the nearest neighbour of the ancilla, which requires a single CNOT to entangle it, but the second qubit state needs first to be swapped with the nearest neighbour state (three CNOTS), followed by the entanglement (one CNOT) and the actual measurement. Similarly also for the chains, the gate sequence for the repetition code becomes effectively longer than compared to the all-to-all connected system. This increases the average time between consecutive parity measurements which affects both the slow-down of the overall decay of  as well as the recovery of  after an error actually occurred. The physical consequences of preserving the recoverable quantum information as good as possible can be understood in terms of a prolonged effective decoherence time . Therefore, depending on the average length of the gate sequences necessary to perform parity measurements and pinpoint errors, we expect different effective decoherence times for the different configurations. In fig:variations:conn_bar of the main text, we show this effect. In particular, we extract the effective decoherence time  from the average decrease of  after the total time  and plot the ratio  where . We use that the recoverable quantum information decays approximately exponentially with time, ie,     where  denotes the sample average (over  trajectories) of the recoverable quantum information at the final time . The result show a clear trend: While all configurations increase the effective decoherence time and thus provide additional stability against bit-flip errors, the all-to-all connected systems allows for the largest improvement, followed by the chain where the neural network can use all qubits for measurements. Notably, this chain configuration performs better than the chain with one measurement qubit only (located on a central spot, at the edge would be even worse). This is, because in the first case the network switches between several qubits for measurements which leads to an advantage as compared to the fixed location. The circular configuration clearly requires the longest gate sequences and consequently it achieves a smaller increase of  than the other systems.   Introducing measurement errors   In fig:variations:msmt_errors of the main text, we give a further example how neural networks can adapt their strategies to different environments which they are trained on. In particular, while in all other figures we have used perfectly reliable measurement outcomes, we now introduce a measurement error probability and see how a network trained with this new environment learns an adapted strategy instead of converging to the same solution as before.  We implement measurement errors by modifying the form of  (cmp eq:linearized_cp_map) for measurements: for completely reliable measurement results as considered in all other simulations, measurement result  is associated with  (including the dissipative dynamics during the following idle time , cmp Methods), and for measurement errors this expression is modified to    where  is the probability that result  is reported given that the quantum system is actually projected into state . Explicitly, we considered ``mixing matrices'' of the form     for different values of the measurement error probability  between  and . For each value of  shown in fig:variations:msmt_errors we trained a separate neural network from scratch.  We find that the neural network counters increasing measurement errors by repeating the same measurement for several times. This helps to identify the true measurement outcome and to avoid wrong conclusions. On the other hand, repeating a measurement increases the time until the next parity measurement where new information about errors can be gained. Thus, depending on the percentage of false measurements, the neural networks learn to perform only a few or many additional measurements. We show the fraction of measurements, ie how many actions of all actions are measurements, in fig:variations:msmt_errors of the main text. This data is obtained as an average of  samples and we also indicate the standard deviation (for the first data point it is so small that the error bars vanish behind the dot). We observe that the average number of measurements used increases significantly. Here, in fig:msmt_trajs we show a typical trajectory for each measurement error probability that was used. In the lowest two trajectories, where the error probability is already very large, one can readily identify examples of repeated measurements where some show a differing, false outcome. The anomalous outcome is specific to one measurement in contrast to a bit-flip that would also affect all future measurements.          The behavior of the state-aware network with recovery reward   According to the recovery reward structure described in sec:reward_scheme, only errors of the specified target qubit need to be corrected to earn the correction reward. Errors occurring on any other qubit might or might not be corrected, as long as their status of being flipped or not is remembered for the interpretation of further parity measurements and the final decoding. Since the correction reward is only obtained after all time steps, in principle the network could decide to correct also the errors of the target qubit only at the very end (after decoding). However, we observe that the network corrects errors on the target qubit after an intermediate time - it typically performs a few further parity measurement to determine the qubit where the error occurred. Even when this is clarified with more than  certainty, it usually performs a few more parity measurements. We believe that this is done to optimize the immediate reward earned due to preserving the recoverable quantum information. This is more pressing (since otherwise reward might be lost) than the actual correction which will only be rewarded in the very end. Furthermore, we observe that sometimes also errors on other qubits are corrected. This might be related to our observation of some ``corrections'' even in the absence of a correction reward. There we conjecture that the network performs these corrections in order to return to a well-known state.  While the correction is a rather slowly learned property (cf fig:rewards), decoding is learned rapidly and with very close to perfect success. We observe that the network immediately starts decoding after receiving the signal and fills up all remaining time steps with actions that are equivalent to idle, since they do not operate on the qubit that carries the logical qubit state (eg measurements on already decoded qubits, cf inset of fig:decoding_and_event_aware:learning_curve_state_aware in the main text where the error indicates the time step where the decoding signal is started). This is due to our reward structure that punishes the network if it entangles additional qubits to continue error correcting. In practice, of course, one would want to immediately read-out or proceed to perform operations on the decoded qubit, since it no longer profits from any protection.  In fig:rewards(a) we show the mean of the rewards earned during the first  training epochs. We show the reward split up in its four components and averaged over the time  and a batch of  different trajectories: the mean of all immediate rewards earned at individual time steps for preserving the recoverable quantum information (blue); the mean reward (negative) for performing destructive measurements (black); the mean of all rewards earned for performing decoding (green); the mean correction reward (black). The shaded areas indicate the corresponding standard deviation which gives an approximate understanding of how strongly the individual parts contribute to the learning gradient.  In fig:rewards(b) we show how successfully the different aspects of the full quantum error correction were learned: In blue we show the recoverable quantum information   after the last time step averaged over the validation batch. In black we show the fraction of trajectories in the validation batch where no destructive measurement (destroying the logical qubit state) was performed. In green we show the fraction of trajectories where the decoding into the desired target state was successful (checked at the last time step). And in red we show a measure of the overlap  to indicate how well the initial logical qubit state has been preserved overall (for the definition, see Methods).   It is interesting to note that the overlap criterion rises much slower than all the other quantities. In particular, the network learns rather early and very fast to avoid destructive measurements and to decode properly. This is achieved with a very close to perfect success rate. There is a fast increase in preserving the recoverable quantum information at the very beginning which is associated to avoiding destructive measurements and finding a good encoding. This is followed by a slow convergence (not shown in the figure but for much longer training times of several  epochs) where the network optimizes the error correcting sequence by avoiding non-destructive but also not helpful actions. Also the overlap measure converges much slower, indicating that correcting actual bit flips consequently is learned only at later training times. This is partially related to the fact that it can only be learned if the recoverable quantum information is already decently preserved and the decoding is performed properly, as well as to the fact that important bit flips (on the target qubit for the logical qubit state) that really need to be corrected occur not that often. The decoding is very early on learned with a high success rate, ie, typically all trajectories of a batch (with very few exceptions that become even rarer during later training stages) end up correctly decoded. The large standard deviation indicated around the decoding reward despite its already high overall success is due to the fact that the decoding steps are not necessarily performed at the same time steps for all trajectories (even if at the end of the time all trajectories end up in the correct state).          Validating the recovery success   We need a suitable measure to judge the success of the recovery sequence. In our (bit-flip) applications, the remains of the logical qubit state (after successful decoding) should be stored only in one target qubit with maximum overlap to the (pure) target state . This is quantified by  ( denotes the partial trace over all qubits except for the target qubit), and to describe the worst-case scenario over the whole Bloch sphere, we consider     (cmp eq:worst_case_overlap). This defines how well the final state preserves coherence and how well it matches the target state in terms of direction. Since ``random guessing'' already leads to a value of , we rather plot  in fig:decoding_and_event_aware(a) and (b) of the main text.   Performance of the recurrent network   In fig:decoding_and_event_aware:learning_curve_event_aware of the main text we plot the relevant validation quantities for the recurrent network during training. Those are the recoverable quantum information at the final time, , and a measure of the overlap, . Both quantities rise monotonically during training and converge towards the level of the state-aware network. Interestingly, preserving the quantum information (captured by ) is learned faster than rotating the logical qubit (captured by ). This is likely because no long-term memory is required to preserve  (the periodicity of the error detection sequence is six time steps only) whereas rotating the logical qubit requires memorizing the entire recovery procedure and therefore demands longer-term memory (in fig:decoding_and_event_aware:neuron_act the correction is applied thirteen time steps after the unexpected measurement result).  The key aspects of the strategy learned by the recurrent network are visualized in the quantum circuit of fig:decoding_and_event_aware:neuron_act during validation. The usual detection strategy is a modified version of the repetition code in which the network alternates the measurement qubit. The encoded state of the logical qubit is of the form . After the unexpected measurement result visualized at the left of the black rectangle at  in the figure, the network initiates the recovery procedure. As usual, mainly three states contribute to the density matrix at this time as seen in the figure: the state in which only qubit 3 flipped (largest contribution), qubits 2 and 3 flipped, and qubits 1 and 3 flipped (smallest contribution). Note that the density matrix is only plotted for convenience --- the recurrent network does not have access to it. After , the network copies the quantum information from qubit 2 to 3, and after  checks whether qubit 2 flipped. At , the state in which qubits 2 and 3 flipped is ruled out by measurement. Afterwards, the two remaining states are compared and, at , the measurement confirms that qubit 1 flipped. In principle, the network has sufficient information to apply a bit flip to qubit 1 at this point. However, it turns out that after this six-step recovery, the quantum state has a slightly lower coherence than in steady state. Between  and , the network therefore conducts a further purification procedure. The recovery procedure ends at  when a correction to qubit 1 is applied.  To understand how the strategy is reflected in the internal operation of the recurrent network, we study the hidden representation of the last hidden layer. In fig:decoding_and_event_aware:neuron_act we plot the output of the selected LSTM neurons during the above-described detection and recovery procedure. The hidden representation and quantum circuit are aligned such that the neuron activations result from feeding the corresponding action to the input of the network. The first six neurons (1c--6c) are mainly involved in the steady-state detection procedure judging from their periodic activations before the unexpected measurement result. Each of these neurons fire whenever a specific gate of the detection sequence is applied. The neurons involved in the recovery process (1r--4r) display correlations over longer times:  	Neuron 1r starts firing after an unexpected measurement outcome and keeps firing until the final correction to qubit 1 is applied. This neuron presumably tells the network whether a recovery procedure is currently underway. 	Neuron 2r fires particularly strongly if a measurement on qubit 3 yields an unexpected result. In contrast, neuron 3c fires if the same measurement yields an expected result. 	A more peculiar firing pattern can be observed for neuron 3r: during steady-state detection the neuron displays a smooth and periodic activation, which the network likely uses as an internal clock during the standard sequence. However, during recovery the pattern changes and the neuron fires when the gate CNOT(1,2) is applied. Note that this gate is only applied during recovery (it may also be applied during encoding and decoding but not during detection) and signals that qubit 2 is now disentangled and should be measured at the next time step. 	A dual role is played by neuron 4r as well. During steady-state detection it fires if CNOT(1,4) is applied. During recovery, however, it fires whenever qubit 2 is used as ancilla. This provides relevant information to the network regarding the encoding of the logical qubit.    Correlated Noise Scenario   To further verify the flexibility of our approach, we consider in fig:corr_noise of the main text a different error model than in the rest of the result discussion: in fig:corr_noise, we have correlated noise described by the Lindblad equation (cmp Methods)     with decoherence time  and the Lindblad operator    where  labels the qubit,  is the corresponding magnetic moment, and  is the Pauli  operator for the respective qubit. In this discussion, we will always assume that qubit 1 is the data qubit; the remaining ones are called the ancilla qubits.  The action set consists of measurements on these ancillas along the  and  axis, plus the idle operation; note that we do not allow CNOT gates here. The described setup allows to extract information about the noise on the data qubit from measurements on the ancillas. The agent can decide in which order these measurements (regarding both the qubit and the axis) are performed, and how many idle steps are chosen in between; a priori, it is not clear which strategy is the best. As we will see, this question becomes very complex for more than one ancilla, especially because improvements can be achieved by employing adaptive feedback schemes (further action sequence depending on previous measurement results).  For a benchmark of the behavior of our neural network, we extrapolate an effective decay time from the averaged value  at the end of the simulations, assuming an approximately exponential decay. These values are directly comparable to the theoretical results that we will compute below. To make their interpretation easier, we always normalize by the ``trivial'' decay time  for a single qubit (see eq:corr_noise_triv_decay_time), and call this ratio  the (coherence) improvement.  In order to actually judge how well our networks perform on this problem, we will in the following describe alternative approaches to find suitable measurement schemes in the two- and three-qubit scenario. We emphasize that already for this problem, the effort in terms of manpower for these alternative ways exceeds considerably that for training a neural network.  Single qubit scenario If all ancillary qubits are ignored (mathematically described by a partial trace over all qubits except for the data qubit), or equivalently if there are no ancillas,  decays as  with the ``trivial'' decay time     (called  in the Methods).  1+1 qubit scenario With one ancilla qubit, it is already possible to achieve a slowdown in the decay. This two-qubit case can be treated fully analytically.  The best strategy is to measure the  and  axis of the ancilla qubit in an alternating manner. To get insights into the effect of the intermediate idle time , we will derive a closed form for the effective decay time  in the following; the result, eq:corr_noise_one_ancilla_eff_decay_time, is used to plot the analytical predictions in fig:corr_noise:improvement_two_ancillas of the main text.  We start by investigating the dynamics of the quantum system if this protocol is applied. Immediately after each measurement at time , the quantum system (for logical qubit state ) is in a product state of the two qubits:           Starting from a pure state at , we have . The values  depend only on  and the intermediate idle time : the  component is perfectly conserved (), and for the --components we have    (the ``'' in front of  depends on whether the measurement result indicates a rotation into clockwise or counter-clockwise direction) with  	 		(()) & = 			e^-2/T_triv^cn_2^2/_1^2 (4T_triv^cn_2_1) 			   		g() & = 			1()e^-2/T_triv^cn 			 	   describes the loss in coherence, and  is the Bayesian guess for the acquired angle. For , we can conclude that   *  In order to determine the optimum value for the idle time , we compute the effective decay time which is given by ; this form can be obtained easiest by observing the long-term decay for repeated measurements with the same idle time . Inserting eq:tick_tock_g, we get       where the explicit form for  is given in eq:tick_tock_theta.          1+2 qubit scenario For one data qubit plus two ancillas, the authors are not aware how to perform an analytical study like for the two-qubit scenario with reasonable effort. Instead, we follow a different strategy: we choose a maximum number of successive measurements within one cycle (we will call this the search depth) to select a subset of all possible feedback schemes, and perform a brute-force search over them.  For a proper definition of the search depth, we start from the realization that if both ancillas are measured without time delay, the quantum system is in a product state of the data qubit and the two ancillas. This means that all correlations are lifted in that process, and thus no further decision can benefit from adaptive response to measurement results before this point in time. Hence, (quasi-)simultaneous measurements split long action sequences into smaller subcycles. For any decision tree (which determines the response to the probabilistic measurement results), we define its depth as the maximum number of idle periods before the cycle is terminated, or equivalently the number of measurements excluding the very last one (that is launched without time delay).  For all strategies that are represented by a finite-depth decision tree, we can compute exact values for effective decay times (in a numerical way, see below). However, there is a considerable limitation for the depth of the brute-force search as discussed in the next paragraph.  The brute-force search does not only have to scan over all (adaptive) decision trees for measurements, but it also needs to find suitable lengths of the intermediate idle times. We discretize the (continuous) parameter range for these idle times by fixing  different values. For search depth , this leads to a total number  of possible feedback schemes following the recursive expression  	 		N_1 & = 16n   		N_d+1 & = 4n(N_d+2)^2 	 	  (derivation see below). From , we can see that there is a double-exponential growth of possibilities with the search depth:      grows so fast that in practice only very small search depths  are accessible in reasonable time (but  only with very high effort). We restrict ourselves to , but to still obtain insightful results, we fix the first measurement to the intuitively most reasonable choice (for the ancilla with the largest , the axis orthogonal to its last known position), and due to the symmetry of this situation, we can analyze the two subtrees independent of each other such that the search can effectively be extended by one level. Following this approach, we could identify four different strategies (see fig:corr_noise_decision_treesa) which prevail for different combinations  of the magnetic moments (see fig:corr_noise_decision_treesb). For these four fixed strategies, we in turn run a fine-grid search to further optimize the idle times. Note that all these results might be non-exhaustive due to the various restrictions of the search space.  We proceed by describing the remaining technical aspects of the search technique. First, we will discuss the rationale behind the recursive relation in eq:corr_noise_bfts_complexity:  	: We can first choose between  different idle times, and then between  different measurement variables (which qubit,  vs ). For , the cycle must be terminated at this point, so an immediate measurement must follow (the  or  axis of the other qubit); this decision may be depend on the previous measurement result. In total, this makes  possible combinations. 	: Again, we have the choice between  different idle times and  different measurement variables. Then, we can -- dependent on the measurement result -- choose between all  combinations in the search tree with depth reduced by , or the two instantaneous measurements on the other qubit to terminate the cycle immediately. In total, this makes  possible combinations for .   In order to judge a particular feedback scheme, we have to determine an effective decay time. For each branch  in the decision tree, we can find out the probability  to end up in this branch, the total time span  (sum of all idle times), and the loss  of quantum information (). From this information, we can compute an (averaged) effective decay time:     This dependency on  and  makes it hard to narrow down the search. Suppose  and  represent two alternatives for the same subtree. If  and , then  is clearly the better option (one ``'' and one ``'' would be enough). However, if  and , then it depends on the other branches of the decision tree whether  or  should be preferred.   Hyperparameter analysis                                                                                                   In this section, we analyse the influence of hyperparameters in our learning scheme. First, we fix one common set of hyperparameters and apply it to the physical scenarios shown in the main text. In a second step, we modify this hyperparameter set in various ways and discuss the effect of these changes on the learning behavior.  The central results are:  	The learning rate is the only crucial hyperparameter, but there is a clear signature which tells whether it has to be increased or decreased. 	All the other hyperparameters do not decide about the success of the learning process (as long as they stay in reasonable bounds). 	However, some of these hyperparameters have an influence on how fast the learning progresses, and thus can be tuned to optimize the training time.    Common hyperparameter set   We fix one common set of hyperparameters (values are listed in tab:common_hyperparameter_set) and apply it to the physical scenarios shown in the main text. The resulting learning curves are plotted in fig:common_hyperparameter_set a. The training works straightforward for all cases except for the ``triangle'' setup; there, several attempts are required, and we show the best one in each case. However, the limited success rate is not a property of the specific hyperparameter set used here, but also occurs for the hyperparameters used in fig:variations:conn_seq.  To demonstrate robustness against variations of the physical parameters, we change two of them, the decoherence time (fig:common_hyperparameter_set b) and the number of time steps (fig:common_hyperparameter_set c), but still apply the same hyperparameter set as above. Again, we run training jobs for all the scenarios. Note that in the example with  time steps (fig:common_hyperparameter_set c) to keep the number of data points per learning update constant, we have to increase the batch size. Again, learning works smooth for all scenarios, except for the ``triangle'' setup where multiple attempts are needed.   Modified hyperparameter sets   To analyse how the hyperparameters influence the training progress, we consider several modified hyperparameter sets (tab:modified_hyperparameter_set) and again apply them to all scenarios (with the original values for decoherence time and number of time steps). Because some of the hyperparameters are implicitly coupled, we have to properly compensate for this. For example, just decreasing the batch size effectively raises the learning rate, and so one would observe the combined effects of a smaller batch size and a higher learning rate. We counter these dependencies by suitably adjusting the correlated variables (eg here, decreasing the learning rate accordingly), independent of whether this would make a difference or not.  The results are shown in fig:modified_hyperparameter_set. We make the following observations:  	The learning rate has the largest impact on the learning progress. If it is chosen too small, the convergence is slowed down significantly, whereas if the high learning rate is too high, the situation is even worse as it leads to instabilities which finally lead to a collapse in the learning process. Hence, there is a simple rule of thumb how to find a suitable value for the learning rate: if instabilities show up, the learning rate has to be decreased; as long as the learning curve is smooth, the learning rate can be increased until the point where instabilities occur. 	The results indicate that a larger batch size seems to be favorable. The most plausible explanation for this behavior is the fact that we use the natural gradient (see sec:reinforcement_learning) which involves the Fisher information matrix. Since the exact value of the Fisher information matrix is not accessible, we need to compute an estimate for it (in each epoch), and the quality of this estimate increases with the number of data points, ie the batch size. The resulting statistical noise might be amplified by the fact that it is actually the inverse of the Fisher information matrix which enters the calculation of the learning gradient. 	The network architecture seems to play a minor role.

Perturbation theory of optical resonances  of deformed  dielectric spheres
Andrea Aiello
andrea.aiello@mpl.mpg.de 
Institute for Theoretical Physics, Department of Physics, University of Erlangen-Nurnberg, Staudtstrasse 7, 91058 Erlangen, Germany
Max Planck Institute for the Science of Light, Staudtstrasse 2, 91058
Erlangen, Germany
Jack G. E. Harris
Department of Physics, Yale University, New Haven, CT, 06520, USA
Florian Marquardt
Institute for Theoretical Physics, Department of Physics, University of Erlangen-Nurnberg, Staudtstrasse 7, 91058 Erlangen, Germany
Max Planck Institute for the Science of Light, Staudtstrasse 2, 91058
Erlangen, Germany

We analyze the optical resonances of a dielectric sphere whose surface has been slightly deformed in an arbitrary way. Setting up a perturbation series up to second order, we derive both the frequency shifts and modified linewidths. Our theory is applicable, for example, to freely levitated liquid drops or solid spheres, which are deformed by thermal surface vibrations, centrifugal forces or arbitrary surface waves.
A dielectric sphere is effectively an open system whose description requires the introduction of non-Hermitian operators characterized by complex eigenvalues and not normalizable eigenfunctions. We avoid these difficulties  using the Kapur-Peierls formalism which enables us to extend the popular Rayleigh-Schrodinger perturbation theory to the case of electromagnetic Debye's potentials describing the light fields inside and outside the near-spherical dielectric object. We find analytical formulas, valid within certain limits, for the deformation-induced first- and second-order corrections to the central frequency and bandwidth of a resonance. As an application of our method, we compare our results with preexisting ones finding full agreement.
Introduction
In this paper we address the problem of determining the optical resonances  of slightly deformed  dielectric spheres. Inside an almost spherical dielectric body embedded in vacuum or air, light is  confined by near-total internal reflection  and  propagates with little attenuation  along the inner surface of the body. This form  of propagation is denoted as whispering gallery modes (WGMs), which are typically characterized  by a high quality factor  . For a perfect (ideal) dielectric sphere in air or vacuum, the predicted  can easily exceed   at optical frequencies. However, several physical processes (amongst which scattering from surface roughness can be the most prominent one), limit the effective value of  to less than  . Our goal is to develop a perturbation theory that allows us to calculate the   factor of the optical resonances of   dielectric spheres whose surface is slightly deformed by different physical processes.

The study of light interacting with spherical or near spherical dielectric bodies dates back to Aristotle who first described (although incorrectly) the rainbow as due to light reflection from raindrops . In much more recent times microscopic glass spheres have been  widely used as passive and active optical resonators in linear and nonlinear optics regimes for numerous  physical, chemical, and biological applications (see, e.g.,  and references therein). Lately, dielectric optical resonators of many diverse shapes have been regarded as optomechanical systems . Even more recently, optomechanical devices consisting of drops of various liquid materials have been proposed and demonstrated . In these devices the near-spherical free surface of the drop provides for both the optical and the mechanical resonators. As an example thereof,  we have suggested the use of millimeter-scale drops of superfluid He magnetically levitated in vacuum as a novel type of optomechanical device . The surface of a levitated drop may differ from a perfect sphere for several reasons, as shown in Fig. . For example, a rotating liquid drop is squeezed along the axis of rotation and takes the form of an oblate spheroid. On top of this,  thermally excited capillary waves (ripplons) will result in corrugations upon the droplet's surface.
All these optical and optomechanical devices are describable as open systems, that is physical systems that leak energy via the coupling with an external environment .
The mathematical description of either classical or quantum open systems requires the use of non Hermitean operators, which are characterized by complex-valued eigenvalues .
One important challenge with non Hermitean operators is that they may not possess a set of orthonormal eigenfunctions. This implies that the familiar Rayleigh-Schrodinger perturbation theory is no longer applicable and different methods must be used.
Amongst these methods,  the quasi-stationary states approach and the Kapur-Peierls formalism are quite popular . Quasi-stationary (Gamow or Siegert functions ) states are solutions of a wave equation with  purely outgoing boundary conditions and can be used to build a perturbation theory called ``resonant-state expansion (RSE)'' . In optics, the RSE technique has been put forward in  and successfully applied to three-dimensional dielectric resonators in  . However, basically the same method was already used in  to find optical resonances in microdroplets within first-order perturbation theory. The main problem with quasi-stationary states is that they are not orthonormal in the conventional sense and the standard normalization integral diverges . 
Conversely, Kapur-Peierls theory is not affected by these normalization problems   and automatically furnishes a biorthogonal complete set of functions suitable for  use in perturbation theory. This formalism was originally developed in the context of nuclear scattering theory and was recently applied to the study of the resonances of one- and two-dimensional open optical systems .
In this work we  use Kapur-Peierls formalism to develop, for the first time, a perturbation theory of optical resonances of three-dimensional open optical systems (near-spherical dielectric bodies), correct up to and including second-order terms.
We  find analytic formulas for the characteristic values (complex wave numbers) of these resonances and we  apply our theory to dielectric spheres with various deformations.
The application we have in mind is a situation in which the wavelength is much smaller than the sphere's radius (e.g.  or  times). In this case, which is of great experimental significance, the use of numerical techniques (like the ones routinely used in commercially available  finite element method (FEM) solvers) becomes very challenging if not prohibitive. For this reason, we  do not present comparison to FEM results in the present manuscript.  However, we  compare our results with the analytical predictions (limited to first-order perturbation theory), of previous works and  find complete agreement.
The paper is organized as follows. In Sec. II we briefly describe what we regard as ``the unperturbed problem'', namely the determination of the optical resonances of a dielectric sphere using the formalism of Debye potentials and scattering theory. Then, in Sec. III we furnish a review of the Kapur-Peierls formalism, which sets the basis for the remainder.  In Sec. IV we apply this formalism to develop a perturbation theory for the Debye potentials. In Sec. V we describe in detail both the deterministic and random deformations of the initially spherical dielectric body. Then, in Sec. VI we use Rayleigh-Schrodinger perturbation theory to achieve the main goal of this work, namely finding  the optical resonances of slightly deformed dielectric spheres. Finally, in Sec. VII we draw some conclusions.
Resonances  of a dielectric sphere
The mathematical problem of the interaction of electromagnetic waves with dielectric spheres is more than one century old and represents a vast literature. The standard reference is still Stratton's classic book . However, a more modern and thorough exposition can be found in . In this section we briefly review  the so-called Debye potentials approach and establish the basic notation that we shall use throughout this work.
Setting the problem
Consider a sphere of radius  made of a homogeneous  isotropic dielectric medium (medium )  
surrounded by air or vacuum (medium ).
 We use SI units with electric permittivity , magnetic permeability  and speed of light  in vacuum.
Let  and  denote the electromagnetic fields in medium  and medium , respectively. For our purposes it is sufficient to presume that all fields vary as , where ,  being the wave number of light in vacuum. These fields obey the Maxwell equations


_j & =0, 
_j & =0,  
 i _j + _j & =0,  
- i _j + _j & =0, 
(here and hereafter , unless stated otherwise) and the constitutive equations
_j  = _j _j, and _j  = _j _0 _j,
with  (we assume that both media are nonmagnetic) and  , where  is the real-valued refractive index of medium  and  is the  refractive index of air or vacuum. The assumption that the dielectric is nonmagnetic implies that there is no physical difference between the magnetic strength  and the magnetic induction , so in the remainder we shall consider  as the independent field.
Following , we express the solutions of the set of equations Maxwell in terms of the transverse electric (TE) and transverse magnetic (TM)  Debye scalar potentials  and , respectively, as follows:


and


Equations Maxwell and constitutive are automatically satisfied by the fields TE and TM when the  Debye potentials obey the scalar Helmholtz equation

^2 U + k^2 n^2_j U =0 ,
where  denotes either  or .

This equation  must be completed by the interface conditions which  require the continuity of  tangential components of  and  (or, )  across the surface of the sphere , that is 


where  and .
Because of the  symmetry of the problem imposed by boundaryTan,  it is convenient to solve the Helmholtz equation Debye in spherical coordinates . Following  we rewrite the Laplace operator  as
^2 U = 1r ^2r^2 ( r U  )- L^2r^2  U ,
where  with . Now, we look for solutions of Debye of the form

where  are the standard spherical harmonics  satisfying , and ,  denotes the reduced radial Debye potentials. Substituting Sepa into Debye and using E20, we obtain the ordinary differential equation

- _j''(r) + [ l(l+1)r^2 - k^2 n_j^2 ] _j(r) =0,
where   for TE polarization,  for TM polarization and . This equation must be supplied with  the interface conditions for the reduced radial potentials . Substituting TE and TM into boundaryTan and using Sepa we obtain
_1(a)   =   _2(a), _1'(a) &  =  p  _2'(a),
where  and here and hereafter  for TE polarization and  for TM polarization. We remark that in the literature equation eqPsi is often written in a ``quantum-like'' form as
- _j''(r) + [l(l+1)r^2 + V_j ]_j(r) = E  _j(r),
where  and  (see, e.g.,  and ). We shall exploit this quantum-classical analogy in the next section.
Scattering solutions
The  general solution of eqPsi can be written  as
_j(r) = C_1   r  j_l(n_j k r) + C_2  r  y_l(n_j k r),

where  and   are spherical Bessel functions of the first and second kind, respectively . Using the spherical Hankel functions 
 and  , we can rewrite GenSol1 as
_j(r) = C_3   r  h^(1)_l(n_j k r) + C_4  r   h^(2)_l(n_j k r),
where  and .

Since  and  for , while  and  for ,  the everywhere regular solutions to eqPsi are:
_1(r) = &   A_ l  r  j_l(n_1 k r) , &  r a, 
 &  
_2(r) = &     I   r      h^(2)_l(k r) + S_l  r  h^(1)_l(k r), & r>a, 
where  is the amplitude of the incident wave and  that of the scattered wave with azimuthal index .  is the amplitude of the same wave inside the sphere.
Assuming only outgoing waves means setting . This choice leads to the so-called ``resonant-state'' formulation of scattering theory . These states, also known in the quantum theory of scattering  as decaying, meta-stable, Gamow , or Siegert  states, are nonphysical because they are not normalizable in the standard manner (that is, they are not square-integrable).
Here  we choose instead , which means assuming an incident wave of unit amplitude.
Substituting Radial  into BC we determine the interior wave amplitude
A_l(k) = 2  i pk a1
f_l(k a),
and the scattering amplitude
S_l(k) = -f_l(-ka)f_l(ka),
where we have defined the Jost function ,
f_l(z) = 
 p  j_l(n_1 z) [ z  h^(1)_l(z) ]' - h^(1)_l(z)[(n_1 z) j_l(n_1 z) ]',
with the prime symbol  denoting the derivative with respect to the argument of the function (e.g., ).
Using AnCont it is straightforward to show that for  real,  and we can write
S_l(k) =   [ 2 i _l(k) ],
where  denotes the phase shift of the scattered wave . In the absence of the dielectric sphere  and evidently scattering does not occur. In this case the equations above give ,  and .
Resonances and Q-factors
In equations ampA and ScatMat   is the real-valued wave number of the ingoing wave. 
However, the resonances of the sphere are associated with the poles of the analytical continuation of    into the entire complex plane: , where here and hereafter  and .
The continuation of  is meromorphic, that is analytic except at its poles. The latter are characterized by  and coincide with  the roots of  the transcendental equation
f_l(k a) =  0.
This equation, where  is a fixed number, has a denumerably infinite set of solutions denoted  whose determination is detailed in appendix . From AnCont it follows that  , that is the resonance poles are located in the complex -plane in pairs symmetric with respect to the imaginary axis. Therefore, if  is a solution of Poles, then  is also a solution. We label the poles with  by the negative index , so that . A ``central'' pole labeled with  and characterized by  , , exists only for  odd (even) and TE (TM) polarization. A portion of the spectrum of TE resonances of a dielectric sphere with refractive index , is shown in Fig. . 


Each resonance , can be characterized by the quality factor  defined by
Q(k',k'') - 12kk = - 12 k'k''.
 From this equation it follows that
Qk'' = 2  Q   Qk' .
This means that  is more sensitive to variations of losses () than of frequency (), by a factor  . This is why also a tiny perturbation of  may cause a relevant variation of .
This feature is relevant  for the estimation of the variation of  due to a small perturbation of the shape of the dielectric sphere.
The quality factor depends dramatically upon the value of . For example, solving equation Poles numerically for a  sphere with refractive index  (superfluid He),   (TE polarization),  and , we have found   and , respectively, where we have chosen in both cases the first resonance labeled by . These values yield
Q(4000) = - 12 (k_1,4000 a)(k_1,4000 a) 10^13,
for , and
Q(1000) = - 12 (k_1,1000 a)(k_1,1000  a) 5 10^3 ,
for . Thus, although  changes only by a factor of , the corresponding  changes by about  orders of magnitude. This huge variation in  is largely determined by the imaginary parts of the resonances, because
Q(4000)Q(1000) = &  (k_1,4000 a)(k_1,1000a) (k_1,1000 a)(k_1,4000 a) 
 &  40001000 ( 2 10^9 ).
Kapur-Peierls formalism
In the previous section we have presented the standard theory of scattering from a piecewise constant spherically symmetric potential (dielectric sphere) and we have written the equation Poles determining the resonances of the system . This approach, based on the continuous (with respect to ) set of functions Radial, is not very convenient for perturbation theory where it is desirable to deal with a denumerable set (a basis) of normalizable functions. The Kapur-Peierls (KP) formalism, originally developed in the context of nuclear physics  and recently adapted to optical resonator theory , naturally yields a  complete set of biorthogonal functions .
Preliminaries on Kapur-Peierls formalism
Before starting our discussion, it is useful to briefly outline the general approach of KP perturbation theory. In the standard quantum mechanics Rayleigh-Schrodinger time-independent perturbation theory, one first finds the full set of eigenstates of the  Hamiltonian of the unperturbed system. Afterwards, the perturbative corrections to any one eigenstate can be expressed generically as sums over these eigenstates. In KP  perturbation theory, the setting is slightly changed: One first solves an auxiliary eigenproblem whose eigenvalues  are functions of a continuous parameter, the complex scattering frequency (here represented by the complex wavenumber ). One then determines the discrete set of resonances in  by imposing . Finally, the perturbative correction for a given resonance is obtained by summing over the previously obtained set of eigenstates that belongs to the resonance's particular value of . This makes the whole procedure more involved than Rayleigh-Schrodinger theory, since for each resonance we are dealing with a different set of infinitely many eigenstates (which are still loosely related to the whole set of resonances, but not identical to those).
 Kapur-Peierls dispersion theory is well known within nuclear physics . However, this formalism is much less known in the optics community. A useful purpose may therefore be served by shortly reviewing the Kapur-Peierls  approach to scattering theory . As in the previous section, we consider again the scattering of a scalar wave  (any of the two Debye potentials) by a dielectric sphere; this simple example illustrates the main features of the theory and provides for the Kapur-Peierls eigenvalues and eigenfunctions characterizing the ``unperturbed problem''. When the scatterer is not perfectly spherical the simple theory presented in this section is no longer applicable and the use of perturbation theory becomes necessary. This will be presented in the next section.
We begin by rewriting eqPsi as
( _j - k^2 ) _j(r) = 0, (j=1,2),
where we have defined the differential operator
 _j 1n_j^2 [ -^2r^2 + l(l+1)r^2  ],
associated with the boundary conditions BC that we rewrite as:

_1'(a)_1(a)  = p  _2'(a)_2(a) ,
where  for TE polarization and  for  TM polarization. We know from the previous section that the solution of Compact  can be written for  as
_2(r) = &     I   r      h^(2)_l(k r) + S_l  r  h^(1)_l(k r),
which implies,
_2'(r) = &     I   [(kr)      h^(2)_l(k r) ]' + S_l   [(kr) h^(1)_l(k r)]',
where the prime symbol  denotes the derivative with respect to the argument of the function.  
Kapur-Peierls theory is based upon the observation that
using Psi2 and Psi2der we can express  and  via  and  to obtain
S_lI = -h_l^(2)(ka)h_l^(1)(ka)  _2'(a) + c_l(-k a)_2(a)_2'(a) - c_l(k a)_2(a),
where
c_l(k a) 1a   [(ka) h^(1)_l(k a)]'h^(1)_l(k a).
In Secs.  and  we have shown that the poles of the analytic continuation of , with , determines the resonances of the systems. From ratioSI it follows that these poles occur when the denominator vanishes, that is when . Evidently, this happens when there is no incident wave, that is  and the ratio  becomes singular.
Using the boundary conditions BCOpD we can transform the  relation  into the equivalent one,
_1'(a) - p  c_l(k a)_1(a)=0.

This implies that we can determine the resonances of the system by knowing the solutions  of the interior problem  with boundary conditions EqPolesKP.
We shall give a constructive proof of this statement in  subsection  by deriving the so-called dispersion formula for the scattering amplitude .  However, first we need to prove some basic results. 
The Kapur-Peierls eigenfunctions
Let us consider the auxiliary eigenvalue problem
( _1 - _nl(k) ) _nl(k,r) &  = 0, r a,
with boundary conditions
_nl(k,0) = 0, _nl'(k,a) - p c_l(ka)_nl(k,a) = 0,
 where  is a discrete numerical index,  are the so-called Kapur-Peierls (right) eigenfunctions with , and  is given by Cl. The (right) eigenvalues  depend on the parameter  via the boundary conditions AuxBC. Here and hereafter   must be regarded as a fixed constant, the same for all eigenvalues , which are complex numbers on account of the boundary condition AuxBC.
The normalized solutions of Aux1 are
_nl(k,r) = 1Z_nl  r  j_l ( n_1  q_nl  r),
where 
and
Z_nl = a^3 2[j_l^2( n_1 q_nl a) - j_l-1( n_1 q_nl  a) j_l+1( n_1 q_nl  a) ].
The eigenvalues are given by , where , are  the complex roots of the -dependent transcendental equation , where

F_l(z,w) = p  j_l(z) [ w  h^(1)_l(w) ]' - h^(1)_l(w)[z  j_l( z) ]' .
From diff it follows that if  is a solution of EigenKP, then  is also a solution and both   and   yield the same eigenvalue . Different values of  produce different eigenvalues; typically  for .
The operator defined by Aux1 and AuxBC is not self-adjoint because  is a complex number. This implies that there exist left eigenfunctions  and left  eigenvalues   defined by the so-called adjoint equation
( _1 - _nl(k) ) _nl(k,r) &  = 0, r a,
and the adjoint boundary conditions
_nl(k,0) = 0, _nl'(k,a) - p c_l^*(ka)_nl(k,a) = 0.
It is not difficult to show  that  and  .
Moreover,  our  normalization Norm  yields
_0^a _n'l^*(k,r) _nl(k,r) r = &  _0^a _n'l(k,r) _nl(k,r) r  
= & _n  n'.
This equation shows that the normalized Kapur-Peierls eigenfunctions  belong to a  biorthogonal set of functions.
Typically the  functions  form a complete set , that is
_n _nl(k,r) _nl^*(k,r')  = &  _n _nl(k,r) _nl(k,r')   
= &  ( r - r' ),
but usually this is not easy to prove (see, e.g.,  for a discussion).
For our functions KPfun1 we  have not been able to evaluate the left side of this equation analytically, but
numerical evaluation for some values of  and  confirmed the validity of Complete. Therefore, we assume without demonstration the completeness of the Kapur-Peierls functions KPfun1.
The Kapur-Peierls dispersion formula
From (-) it follows that the interior function  obeys the boundary conditions
_1'(a) -  p c_l(ka) _1(a) =  I 2   pi   _l(ka),
where we have introduced the Riccati-Bessel functions  and  . These conditions reduce to EqPolesKP when no incident wave is present and .
Consider then the auxiliary functions  and  defined by
_j(r) _j(r) - X(r), (j=1,2),
where  is any function satisfying the constraint
X'(a) - p c_l(ka) X(a) =  I 2   pi  _l(ka).
It is then evident that  obeys the same boundary conditions AuxBC satisfied by the Kapur-Peierls functions, that is
_1'(a) -  p c_l(ka) _1(a) =  0.
Therefore, using Complete and AuxFun we can write
_1(r) = _n a_n  _nl(k,r),
where



a_n = &  _0^a _nl (k,r) [ _1(r) - X(r)  ]  r 
&  b_n - c_n.
From Compact and OpD and using , we obtain
b_n = &  _0^a _nl (k,r)  _1(r) r 
= &  _0^a ( _1 _nl (k,r) ) _1(r) - _nl (k,r)( _1 _1(r))_nl(k) -k^2 r 
= &  1n_1^2  _nl(k,a)_nl(k) -k^2  [_1'(a) - p  c_ l(ka)  _1(a) ].
Subtracting  from both sides of the matching condition  we obtain . Using (,) and As we can rewrite this equation as
1k [ I  _l(k a) + S_l  _l(k a) ] - X(a) 
= _n b_n _nl(k,a) - _n c_n _nl(k,a).
Substituting Bs into Join and using  BCpsi1, gives
1k [ I  _l(k a) +  & S_l  _l(k a) ] 
= & -I  pn_1^2  2 i_l(ka) _n _nl(k,a)_nl(k) -k^2 
& + [ X(a) - _n c_n _nl(k,a) ].
Since  is arbitrary and the condition ConstraintX involves both  and , we  can always choose  such that  to cancel the last term in Join2, and  in a manner that ConstraintX becomes an identity.
Then, solving Join2 for , we obtain
S_lI = - _l(k a)_l(k a)  [ 1 + 2  i k R_l(k) ],
where
R_l(k) = pn_1^2  1_l(k a)_l(k a)  _n  _nl^2(k,a)_nl(k) -k^2,
and  for TE polarization and  for  TM polarization.
It should be noticed that the sum in Join4 is simply equal to  times the Green function  for the internal problem , evaluated at  . We shall use this property later in Sec. .
Equations (-) are an example of what is usually called a ``dispersion formula'' in nuclear physics. They give an explicit expression of the scattering amplitude  in terms of its  singularities (poles). In particular,  Join4 provides for a practical recipe to find resonances: first we calculate the Kapur-Peierls eigenvalues  by solving (often numerically) the transcendental equation  to determine . Then, we look for the roots of the fixed point equation
_nl(k) = k.
It is understood that the only physically acceptable branch of the multi-valued function  is the one with .
It is evident that Join5 reproduces the resonance equation Poles. To show this we must simply  substitute, consistently with Join5,  with  in  . This makes EigenKP coincident with Poles, that is .
We remark that for a fixed value of the index , there may be several different solutions , of Join5  such that . An example thereof is reported in . However, in our case we found via numerical evaluation of Join5 that there is only one solution for fixed ; this is illustrated in Fig.  for two particular cases. Therefore, in the remainder we choose the natural numeration of the resonances so that  and .




Perturbation theory for the Debye potentials
In the previous section we have described the Kapur-Peierls formalism. This yields a biorthogonal and complete set of basis functions defined in the interior region of the dielectric sphere. The goal of this section is  to develop a perturbation theory for the Helmholtz equation  Debye using these functions.
Description of the deformations of the surface of a dielectric sphere
We assume that the sphere's free surface can be described in spherical coordinates  by the equation , where
g() a + a  h(),
is the surface profile function and  describes the distance, in the direction , of the deformed sphere surface from a reference unperturbed sphere of radius . We suppose that for a given  fixed direction , the equation  has only one solution. By definition, for a perfect sphere of radius  the profile function is   constant, namely  and . Conversely,  the surface profile function of the deformed sphere is effectively determined by
h() =  _L=2^_M=-L^L h_LM Y_LM(),
where
 h_LM = _0^2  _0^  Y_LM^*() h() .
The relative permittivity  of the deformed sphere can be evidently described by the piecewise constant function
= n_1^2 H(g() - r ) + n_2^2 H( r - g() ),
where   denotes the Heaviside step function .
For a perfect sphere  of radius  we define . From  it follows that we can rewrite  as the sum of the unperturbed permittivity  and a perturbation term :
_r() = _r^(0)(r) + _r() ,
where
_r() = &  - (n_1^2 - n_2^2 )
& [ H ( r- a  + a h()  ) - H(r- a  )] .

In the case of small deviations  from the reference spherical surface, we can approximate P65 with
_r() &  (n_1^2 - n_2^2 )
& a  h()[ (r-a) - a h()2 
where  and we have expanded   to  second order because we plan to calculate quadratic corrections to the resonant wave numbers.
Evidently, there is a freedom in attributing the singular local terms in P70 to either the internal  or the external  region . We choose to define  in the internal region  solely. This implies that we can define an effective potential  as:
V(, ) =  _r()n_1^2
 V^(1)() + ^2  V^(2)(),
where  is a formal  parameter serving to build a perturbation series with , and  we have defined

with

A caveat is in order here. The Debye potentials representation presented in Sec.  is valid for electromagnetic fields in uniform dielectric media. This condition is certainly satisfied by the physical dielectric bodies considered in this work. However, the use of the potential PertV introduces an effective inhomogeneity at . As the Debye potentials representation is still valid inside the dielectric body , in the spirit of perturbation theory it is reasonable to extend this representation to the whole region , keeping in mind that this is an approximation.
Kapur-Peierls perturbation theory
According to the previous discussion, we consider now a perfect sphere whose refractive index is modified by a small perturbation   defined for
 only. It must be put equal to  at the end of the calculations.
Because of the both radial and angular dependence  of  we have to generalize the radial equation Compact to
( - k^2 ) () = 0,
where
 = &  1n_1^2 ( -^2r^2 + L^2r^2 )+ V(,) 
&  _0 + V(,).
As we deal with fields in the interior region only, in the remainder the index  will be omitted. The Kapur-Peierls eigenvalue equation for the unperturbed operator  reads as
( _0 - _nl(k) ) _nlm(k,) &  = 0,
where
_nlm(k,) = _nl(k,r) Y_lm(,),
and , with  and  being the so-called radial, azimuthal and magnetic numbers. The radial eigenfunctions  are defined as before by (-). Since the
 boundary conditions AuxBC are independent of the magnetic number , each eigenvalue   is  times degenerate.
Now, suppose that . In this case when a wave with given radial, azimuthal and magnetic numbers  and  impinges upon the inhomogeneous dielectric sphere, it is scattered into many (possibly infinitely many) waves with different numbers  and . This occurs because the non spherically symmetric potential  couples different modes of the field . Therefore, the ``single-channel'' Kapur-Peierls theory developed in the previous section is not directly applicable and the theory must be generalized (see, e.g., ). However, because of the spherically-symmetric surface of the inhomogeneous dielectric body, we still have well defined internal and external scattering regions characterized by  and , respectively. In this case it is not difficult to show  that the original Kapur-Peierls equation Aux1 can be replaced by
the new eigenvalue equation
( - _nlm(k) ) _nlm(k,) &  = 0,
and the fixed-point equation Join5 becomes
K_nlm^2 = _n l m(K_nlm),
which must reduce to  for . However, it is important to keep in mind that while Join5 is an exact relation, equation Res10 rests upon the approximation of replacing a near-spherical homogeneous dielectric body with an inhomogeneous spherical one.
Now, according to Rayleigh-Schrodinger  perturbation theory suitably adapted to the case of a biorthogonal basis , we assume that  and   can be expanded in powers of :
_nlm(k,)= &   _nlm^(0)(k,)  
& +   _nlm^(1)(k,)  + ^2 _nlm^(2) (k,) +  ,
    _n l m (k) =   _n l m^(0)(k)    +   _n l m^(1)(k)  +  ^2 _n l m^(2)(k) + ,
where . 
Similarly, we write
K_nlm = K_nlm^(0) +  K_nlm^(1) + ^2  K_nlm^(2) + ,
with .
Suppose that by using standard techniques we have calculated the first two terms of the expansion p130B.
 Substituting Res20 into Res10 and using p130B, we obtain
 (  k_nl &  +  K_nlm^(1) + ^2  K_nlm^(2) + )^2 
  = &  _n l( k_nl +  K_nlm^(1) + ^2  K_nlm^(2) + ) 
& +   _n l m^(1) ( k_nl +  K_nlm^(1) + ^2  K_nlm^(2) + )   
& +  ^2 _n l m^(2) ( k_nl +  K_nlm^(1) + ^2  K_nlm^(2) + )  + 
Expanding the functions on the right side of this equation in Taylor series around  and equating the terms with the same powers of   on both sides we find, up to and including second-order terms,
k_nl^2 =  & _n l(k_nl),   
K^(1)_n l m =  &   _n l m^(1)(k_nl)2 k_nl - . _n l(k)k_k=k_nl  ,  
K^(2)_n l m =  &   12 k_nl - . _n l(k)k_k=k_nl
. 
&   _n l m^(2)(k_nl) + K^(1)_n l m . _n l m^(1)(k)k_k=k_nl 
&   .  - (K^(1)_n l m)^2 [ 1 - 12. ^2 _n l(k)k^2_k=k_nl ]
.
The two terms
._n l(k)k_k=k_nl and 12   .^2 _n l(k)k^2_k=k_nl,
can be calculated substituting the Taylor expansion of  around ,

into ,
and equating to zero the terms with the same power of . After a straightforward calculation we find:
._n l(k)k_k=k_nl = &  - 2 k_nln_1  (k_nl),  
and
12   .^2 _n l(k)k^2_k=k_nl   = &  ^2(k_nl)n_1^2 - k_nl an_1 1. F_l(z,  k_nl a) z _z = n_1 k_nl a 
& [ ^2 F_l(z,  w) w^2 - 2  ^2 F_l(z,  w)z  w  (k_nl)
&  +^2 F_l(z,  w) z^2  ^2(k_nl) ]_z = n_1 k_nl a 
     w = k_nl a  ,
 
where
(k_nl) . F_l(n_1  k_nl a,w) w _w = k_nl a . F_l(z,  k_nl a) z _z = n_1 k_nl a .
Incidentally, we note that iterating this procedure it is possible to calculate the function  in the neighborhood of any point   with the desired degree of accuracy.
Equations p170 are the main result of this section; they formally solve completely our problem. The zeroth-order equation p170A simply reproduces the resonances of the unperturbed system. The other two equations gives first- and second-order corrections in terms of the two functions  and  that will be explicitly calculated in the next section. The physical meaning of the denominator in p170B is explained in ; it amounts to a renormalization factor connecting Kapur-Peierls eigenmodes with Gamow (i.e., decaying) modes. The second and third term within the curly brackets in p170C  represent  second-order corrections that, in general, should not be neglected with respect to . 
Rayleigh-Schrodinger perturbation theory
In this section we use Rayleigh-Schrodinger perturbation theory to find the optical resonances of a deformed dielectric sphere. The only (trivial) difference with respect to familiar quantum perturbation theory is the use of biorthogonal bases .
 Let us consider  a specific unperturbed resonant wavenumber  where  and  have now fixed values. The corresponding unperturbed Kapur-Peierls eigenvalue is , which we assume to be non-degenerate at the interesting values of . Here, with ``non-degenerate'' we mean that there is single radial  wavefunction  defined by Numbers and associated with the eigenvalue  via the eigenproblem Aux2  .  However, there are  different solutions  of Aux2 associated with the same eigenvalue  , which are obtained by multiplying the unique radial wavefunction  by the  angular-dependent spherical harmonics :
 _nlm(k,) 
 =  _nl(k,r) Y_l,-l(), , _nl(k,r) Y_ll() .
These solutions span a -dimensional degenerate subspace, which we call  . According to degenerate perturbation theory, we build the new set of eigenfunctions  , defined by
 _nlm^D(k,) 
 =  _nl(k,r) Y_l,-l(), , _nl(k,r) Y_ll() ,
where
Y_lm() _m' =-l^l C_lm^m' Y_lm'().
As usual, the coefficients  can be determined solving the eigenvalue equation
 _m'' =-l^l (_nlm', V^(1) () _nlm'' )_C_lm^m'' 
 = ^(1)_nlm(k)  C_lm^m',
where here and hereafter we use the shorthand notation


(note that the radial differential is   and not .)
Substituting Numbers and PertVb into Deg4 and solving it for , we obtain the first-order correction to :
^(1)_nlm(k) = - a  v(k)  _nl^2(k,a)   _lm,
where  and
_lm ( Y_lm , h() Y_lm )_,
with . This result allows us to find the first-order corrections  by substituting Deg6, evaluated at , into p170B.
It should be noted that although   is real by definition,  may be not, because  is, in general, a complex number. However, using Poles and KPfun1  it is not difficult to show that for TE polarization,
- a  v(k_nl)  _nl^2(k_nl,a)2 k_nl - . _n l(k)k_k=k_nl = - k_nl,
and p170B becomes
K^(1)_nlm(k_nl) = - k_nl  _lm.
Since  is a real number, from Deg7b and Q it follows that the  factor of TE waves is not affected by first order corrections. However, for TM polarization  a simple expression as Deg7b does not exist because the left side of Deg7c displays a complicated functional dependence on  that will not be reported here. This implies that the  factor of TM waves may be affected  by first-order corrections.
The independence of  from the wave number , the polarization , the refractive index  and from the radial part of the radial function , is a surprising result of first-order perturbation theory, which was discovered already in the nineties of last century .
Discussion of the first-order corrections
From the definition Deg7 and  ThermalH it follows that
 is a real number independent of  and coincides with the -th eigenvalue of the  Hermitean matrix    defined by
 [H_l]_m m' = (Y_lm , h() Y_lm')_, (m,m' = -l,  , l).
Moreover, for fixed  and  the coefficients   in Deg3 coincide with the components   of the  -th  eigenvector  associated with , namely .
The matrix elements Deg7g can be calculated from ThermalH and expressed in terms of the Wigner -symbols  as:
(Y_lm ,  h() Y_lm')_= &    (-1)^m(2 l +1)_L=2^
2L+14 
                            l & l & L 
                            0 & 0 & 0 
                           _M=-L^L h_LM
                            l   & l   & L 
                            -m & m' & M 
                           

= &    (-1)^m(2 l +1)_l'=1^lh_2l',m-m'
4l'+14 
                            l & l & 2l' 
                            0 & 0 & 0 
                          
                            l   & l   & 2l' 
                            -m & m' & m-m' 
                          ,
where the second expression follows from
 the properties of the -symbols requiring that  only terms with   even,  and , contribute to . This means that at first-order level the resonance  is not affected by ``rapid'' surface fluctuations characterized by .
The matrix  can be huge. For a  droplet of radius , refractive index  and illuminated by light of wavelength  in vacuum, the value of  is around  . Diagonalizing a matrix of dimension  with sufficient accuracy may be a serious task depending on the distribution of the matrix elements and on available computational resources. 
We discuss a way to  circumvent these problems in appendix .
Second-order corrections
Because of the form PertV of the perturbation, the second-order correction  contains two terms:
^(2)_nlm(k) = &   ( _nlm^D , V^(2)()   _nlm^D )_
 + _n',l',m' D_nl ( _nlm^D , V^(1)()   _n'l'm' )_( _n'l'm' , V^(1)()   _nlm^D )__nl(k) - _n' l'(k) 
&  A + B.
Using PertVb and Deg2 we can rewrite the first term in the equation above as:
A =  - a^2 v(k)_nl(k,a) _nl'(k,a)  T_lm,
where we have defined
T_lm (Y_lm, h^2()Y_lm )_,
 and .
Similarly, after a straightforward calculation we obtain for the second term,
B = &  a^2 v^2(k)_nl^2(k,a)  
& _l'' [ _n'' _n'l'^2(k,a)_nl(k) - _n' l'(k)  T_lm^l' ] ,
where
T_lm^l'  &   _m' = -l'^l' (Y_l'm', h()Y_lm )_^2,
and the prime symbols above the sums in  and  dictate the exclusion of the term with . These sums are really formidable and, for high values of , represent  a hard numerical challenge. However, a huge simplification can be made by noticing that after replacing everywhere  with ,
 the sum with respect to  with  in Second30 can be rewritten as
_n' _n'l'^2(k_nl,a)k_nl^2 - _n' l'(k_nl) = G_l'(k_nl,a,a) ,
where p170A has been used and  is the Green function defined in sec. . Comparing this equation with Join3 and Join4 we  obtain a closed expression for the infinite sum  Second40:
G_l'(k_nl) =   a  n_1^2  j_l'(n_1 k_nla)  h_l'^(1)(k_nla)f_l'(k_nla),
where  is the Jost function defined by Jost. Therefore, we can eventually rewrite Second30 as:
B = &  a^2 v^2(k)_nl^2(k,a) [ _n'n _n'l^2(k_nl,a)k_nl^2 - _n' l(k_nl)  T_lm^l 
& + _l'l G_l'(k_nl)  T_lm^l' ] .
Eventually, the awkward double sum in Second30 was split in two simpler single sums, one with respect to  and the other with respect to .
Summary of the main results and discussion
Collecting the results above we can summarize our main findings as follows. The first-order correction to the unperturbed resonant wavenumber  is given by Deg6 evaluated at , that is
^(1)_nlm(k_nl) = - a  v(k_nl)  _nl^2(k_nl,a)   _lm,
where
_lm ( Y_lm , h() Y_lm )_,
is independent of  and
  ,
  ,
  ,
   ,
where (,,) and Deg3 have been used.
 The first-order correction Deg6b depends on the index  via  the term . This may or may not fully remove the degeneration of the unperturbed states Deg2 according to the form of the deformation . For example, we shall see later that when the sphere is deformed into an ellipsoid of revolution, only the states that differ by the sign of  remain degenerate. Therefore, in this case we pass from a  degenerate subspace (which, as previously discussed, can be huge) to a smaller -dimensional space.
 The second-order correction is obtained from (-) and it is equal to
 ^(2)_nlm(k_nl) = &  -a^2  v^2(k_nl) _nl^2(k_nla)  
& [ p c_l(k_nla)v(k_nl)  T_lm -  _n'n _n'l^2(k_nl,a)k_nl^2 - _n' l(k_nl)  T_lm^l  
&- _l' l G_l'(k_nl)  T_lm^l' ],
where  for TE polarization,  for  TM polarization and   (, ) have been used. The terms ,  and  are defined by (,) and Second30bis, respectively. The three coefficients  and , contain all the information about the perturbation. They are the fundamental quantities that must be calculated for a given perturbation function  and all of them are independent from the resonant wave number , the polarization , the refractive index  and the radial part of the radial function . These coefficients, which are independent of the radial wave function, depend upon the eigenvectors and the eigenvalues of the matrix , which is defined by Deg7g, via the functions  given by Deg3. The meaning of the various sums in Second60 is graphically illustrated in Fig.  below.


Once  and  have been calculated, they must be substituted into p170 to obtain the perturbed characteristic value  correct up to second-order terms. From  we can  calculate the central frequency  and the bandwidth  of the resonance identified by :
_nlm = c  K_nlm, _nlm = -2 c  K_nlm,
and  the  factor as well using the definition Q. The result, up to and including second-order terms (here we put ), is:
1Q(K_nlm) &     1Q(k_nl) [ 1 + R^(1)_nlm  
& + (  R^(2)_nlm - K^(1)_nlmk_nl  R^(1)_nlm ) ],
where we have defined
R^()_nlm K^()_nlmk_nl - K^()_nlmk_nl, (
From Deg7b it follows that for TE waves  and  Second70 reduces to the very simple form
1Q(K_nlm) 1Q(k_nl) ( 1 + R^(2)_nlm ).
 
Examples
Our results are in agreement with previous works where first-order perturbation theory for leaking electromagnetic modes in open systems was developed . To see this, let us consider the following two examples.
Equatorial bulge
Consider a TE excitation of the droplet, this sets . Suppose that  describes an ellipsoid of revolution  with polar and equatorial radii  and , respectively, with . The ellipticity (or, eccentricity) of this ellipsoid is denoted  and defined by
e = 1-a_P^2a_E^2  .
The surface profile function of the ellipsoid of revolution is
a + a  h() =  a_P  a_Ea_E^2 ^2 + a_P^2 ^2  ,
which, when , can be approximated by
 h() - e^212[1+3 (2 ) ]=-235  e^2 Y_20().
Then, from this equation and  Deg8 it follows that
(Y_lm ,  h() Y_lm')_=   _m m' e^23 l(l+1)-3 m^24 l(l+1)-3 .
Substituting Deg9 into Deg7b we obtain, for ,
K^(1)_nlm(k_nl)k_nl = - e^212 [ 1-3 m^2l(l+1)],
which is in perfect agreement with  (note: because of a different definition, the parameter  used in  is equal to our ).
Shrinking sphere
As a second example, consider as a perturbation the change of the radius of the sphere from  to , such that . Let  be a root of the equation Poles  with  (TE polarization) and denote with  and  the two corresponding resonances of the bigger and smaller cavity. Then, trivially,
k_nl(b) = &  k_nl(a)1-aa 
&  k_nl(a) ( 1 + aa + a^2a^2 + )
&  k_nl(a) + K^(1)_nlm + K^(2)_nlm + 
The surface profile function cavEq of the sphere of radius  is evidently . This implies that . The matrix  has elements  and, therefore, . A straightforward calculation shows that
T_lm = (a/a)^2 and T_lm^l' = (a/a)^2  _l l'.
Then, Deg7 yields
K^(1)_nlm = k_nl(a)  aa,
in perfect agreement with Deg20. From p170  and Second60 we obtain:
k_nl(b) k_nl(a) ( 1 +   aa + N_nl a^2a^2  ) ,
where  is a finite complex-valued numerical coefficient that can be calculated explicitly once  and  have been fixed. Equation Deg50 is in agrement with   Deg20 up to  corrections.
Summary
In this work we have used the Kapur-Peierls formalism, originally developed in the context of nuclear scattering theory, to find the optical resonances of almost spherical dielectric objects, such as liquid drop. This permitted us to develop a second-order perturbation theory for the electromagnetic Debye potentials describing the light fields. We have thus found analytical formulas for the complex characteristic values of the resonances, whose real and imaginary parts are proportional to, respectively, the central frequency and the bandwidth of the optical resonance. When limited to first-order perturbation theory, our results are in perfect agreement with older results  . The present work provides the basis for applications
of  our technique to various optical and optomechanical systems.
This work was supported by the European Union’s Horizon 2020 research and innovation programme under grant agreement No 732894 (FET Proactive HOT), (A.A. and F.M.)
A.A. is grateful to Carlos Viviescas for useful discussions. J.H. acknowledges Charles Brown for his contribution and
support from the W. M. Keck Foundation Grant No. DT121914, AFOSR Grant No. FA9550-15-1-0270, DARPA Grant No. W911NF-14-1-0354, and NSF Grant No. 1205861. This project was made possible through the support of a grant from the John Templeton Foundation.
Spherical Bessel and Hankel functions
Spherical Bessel and Hankel functions are frequently encountered in scattering theory. Many of their properties can be found in Appendix A of  and in Appendix A.9 of .
Some properties utilized in this paper are:
  Recurrence:
j_l-1(z) = &   2 l +1z j_l(z) - j_l+1(z).
  Differentiation:
z  j_l+1(z)   =  (l+1) j_l(z) - d d z [ z j_l(z)],
  Parity:
j_l(-z) = &  (-1)^l j_l(z),  
y_l(-z) = &  (-1)^l+1 y_l(z),  
h^(1)_l(-z) = &  (-1)^l h^(2)_l(z). 
  Analytic continuation:
[ j_l(z) ]^* = &  j_l(z^*),  
[ y_l(z) ]^* = &  y_l(z^*),  
 j_l(-z^*) = &  (-1)^l [ j_l(z) ]^*,  
 y_l(-z^*) = &  (-1)^l+1 [ y_l(z) ]^*,  
 h_l^()(-z^*) = &  (-1)^l [  h_l^()(z) ]^*, (=1,2), 
[ h^(1)_l(z) ]^* = &  h^(2)_l(z^*). 
 Integrals:
_0^a & j_l(x   r) j_l(y  r) r^2 r  
 & =  a^2 x^2-y^2[ y  j_l(x a) j_l-1(y a)- x j_l-1(x a) j_l(y a)],  
_0^a j_l^2(x   r)   r^2 r 
 = a^3 2[j_l^2(x a) - j_l-1(x a) j_l+1(x a) ]. 

Relations 1. and 2. also hold for ,  and .
TE and TM resonances of a dielectric sphere
The complex-valued resonances of the sphere are generally associated with the poles of the scattering amplitudes ScatMat. These poles are found by solving with respect to the complex variable  the transcendental equation
f_l(z) = &  p  j_l(n_1 z) [ z h^(1)_l(z) ]' - h^(1)_l(z)[(n_1 z) j_l(n_1 z) ]' 
 =  &   0,
where  for TE polarization and  for  TM polarization. Equation Poles admits solutions only for certain characteristic values of the complex variable . These characteristic values form a denumerable set , where  and , for all . We label the poles with  by the negative index , so that . For  odd (even) and TE (TM) polarization there exists a  pole denoted  such that  and .
Figure  shows two typical distributions, symmetric with respect to the vertical axis, for TE and TM polarization,  of the roots of  in the complex -plane  for a glass sphere of radius , refractive index  and azimuthal number .

Filled and open black circles mark, respectively, characteristic values  and  associated  with resonant and not resonant modes of the field. The latter are very leaky modes that are sometimes called external whispering gallery modes . Grandy  suggested that to distinguish between resonant and not resonant characteristic values one should evaluate,
*[label=(*)]
the phase shift ,
the scattering strength ,
the interior wave amplitude , and
the specific time delay
_l 1a _lk = 12  i (k a)S_l.
However, it is possible to show that these conditions are almost equivalent  and that, for example, it is sufficient to verify the presence of a sharp peak in   per each value of , as shown in Fig. .

In practice,  we wish    to be the pole with  and the smallest imaginary part (the subsequent resonant values will be ordered according to  , et cetera.)  Therefore,
the resonant    can be found by comparing the solutions of Poles with the characteristic values of TE and TM modes of the same dielectric sphere but embedded in a medium of infinite conductivity (closed sphere), having these values null imaginary parts. They  are the real-valued solutions , with , of  :
  
 .
Thus, we define  as  the solution of  closest  to the smaller root    of PolesC, namely
   z_1l^r = z C    f_l(z) = 0,  z >0,  z-x_1l = .
Then, given a solution  of ,   if either  or , because  and  are solutions of the same equation.
This empirical rule is illustrated in Fig. , which shows the location in the complex -plane a few solutions of PolesApp (filled and open red circles) and PolesC (blue squares on the real axis) for a glass sphere of radius , refractive index  and azimuthal number .


Perturbative diagonalization of 
As ,  we can diagonalize  using perturbation theory after defining
H_l = H_l^(0) + H_l^(1),
where

with   defined by Deg9. If  each eigenvalue of  is doubly degenerate
and Deg7 can be approximately rewritten as:
_lm ^(0)_lm + ^(1)_l,m,
where   and  denote the eigenvalues of the  matrix  defined by
H_l m ^(1)
  (Y_l m  , h_rip()Y_l m  )_& (Y_l m  , h_rip() Y_l,- m  )_
  (Y_l,- m  , h_rip() Y_l m  )_& (Y_l,- m  , h_rip() Y_l,- m  )_
,
with  . Explicitly,
^(1)_l,m = 12 ( H_11 + H_22 ),
where here and hereafter we use the shorthand notation , and
= ( H_11 - H_22)^2 + 4 H_12^2.
 If  we can apply non-degenerate perturbation theory to obtain
_l0 ^(0)_l0 + (Y_l 0  , h_rip()Y_l 0  )_.
Similarly, the functions  spanning the degenerate subspace  can be approximated by
Y_lm() Y_lm() + (1-_m0) Y_l,m^(0)(),
where
  Y_l,m^(0)() = C_1  Y_lm() + C_2  Y_l,-m(),
with the superscript ``'' marking the zero-order character of these corrections, and

Dynamically Generated Synthetic Electric Fields for Photons Petr Zapletal Cavendish Laboratory, University of Cambridge, Cambridge CB3 0HE, United Kingdom Max Planck Institute for the Science of Light, Staudtstraße 2, 91058 Erlangen, Germany Stefan Walter Max Planck Institute for the Science of Light, Staudtstraße 2, 91058 Erlangen, Germany Institute for Theoretical Physics, University Erlangen-Nürnberg, Staudtstraße 7, 91058 Erlangen, Germany Florian Marquardt Max Planck Institute for the Science of Light, Staudtstraße 2, 91058 Erlangen, Germany Institute for Theoretical Physics, University Erlangen-Nürnberg, Staudtstraße 7, 91058 Erlangen, Germany  Static synthetic magnetic fields give rise to phenomena including the Lorentz force and the quantum Hall effect even for neutral particles, and they have by now been implemented in a variety of physical systems. Moving towards fully dynamical synthetic gauge fields allows, in addition, for backaction of the particles' motion onto the field. If this results in a time-dependent vector potential, conventional electromagnetism predicts the generation of an electric field. Here, we show how synthetic electric fields for photons arise self-consistently due to the nonlinear dynamics in a driven system. Our analysis is based on optomechanical arrays, where dynamical gauge fields arise naturally from phonon-assisted photon tunneling. We study open, one-dimensional arrays, where synthetic magnetic fields are absent. However, we show that synthetic electric fields can be generated dynamically. The generation of these fields depends on the direction of photon propagation, leading to a novel mechanism for a photon diode, inducing nonlinear unidirectional transport via dynamical synthetic gauge fields.    The field of cavity optomechanics, addressing the interaction between light and sound, has made rapid strides in recent years Aspelmeyer2014. Experiments have shown ground state cooling chan2011,teufel2011, measurements of motion with record sensitivity wilson2015, efficient conversion between microwave and optical photons Andrews2014, dynamics of vibrations near exceptional points xu2016, and the control of single phonons hong2017, to name but a few achievements.   Due to the optomechanical interaction, mechanical vibrations can change light frequency. During this process, the mechanical oscillation phase is imparted onto light field. This provides a natural means to generate synthetic magnetic fields for photons, as was first suggested in Refs. hafezi2012,schmidt2015. Together with reservoir engineering metelmann2015, these ideas form the theoretical basis underlying a recent series of pioneering experiments on optomechanical nonreciprocity kim2015,wang2015,ruesink2016,fang2017,bernier2017,barzanjeh2017. While those still operate in few-mode setups, future extensions to optomechanical arrays chang2011,heinrich2011,xuereb2012,ludwig2013 will enable studying photon transport on a lattice in presence of an arbitrary tunable synthetic magnetic field schmidt2015. A similar optomechanical design underlies the first proposal for engineered topological phonon transport peano2015. These developments tie into the wide field of synthetic magnetic fields and topologically protected nonreciprocal transport, first envisaged and implemented for cold atoms jaksch2003,lin2009,aidelsburger2011,aidelsburger2013 and then for photons haldane2008,wang2009,hafezi2011,fang2012,rechtsman2013,hafezi2013,mittal2014, phonons peano2015,nash2015,susstrunk2015,wang2015a,brendel2017,brendel2018,seif2018, and other platforms goldman2014,hartmann2016.  In these works, gauge fields are fixed by external parameters, e.g., the phases of external driving beams. It was understood only recently that optomechanics provides a very natural platform for creating dynamical classical gauge fields walter2016: if the mechanical resonator is not periodically modulated by external driving but rather undergoes limit-cycle oscillations, the phase of those oscillations becomes a dynamical gauge field. This field is a new degree of freedom that can be influenced by photons.  The theory of classical dynamical gauge fields is not only important as a starting point for high-energy quantum field theory (e.g. Yang-Mills and Higgs theories yang1954,anderson1963,higgs1964), but is also an active area of research in modern condensed matter physics (e.g. in the gauge theory of dislocations kleinert1989, spin ice castelnovo2012 and nematic liquid crystals lammert1993,lammert1995). We emphasize that our main goal is different from the attempts to build quantum simulators for existing high-energy gauge theories (suggested theoretically for ultra-cold atoms in optical lattices banerjee2012,zohar2016, superconducting circuits marcos2013,marcos2014, cavity quantum electrodynamics ballantine2017, and trapped ions hauke2013), where the experimental implementation remains very challenging (see Ref. martinez2016 for the first steps). Rather, our work provides new insights for all physical systems where limit-cycle oscillators assist transitions between linear modes, by connecting these systems to the general mathematical framework of classical dynamical gauge fields. This includes different kinds of limit-cycles (electrical, mechanical, optical, and spin oscillators, pumped using electrical feedback, optomechanical backaction, etc.), different kinds of linear modes (microwave, mechanical, optical, magnon resonances, etc.), and almost arbitrary nonlinear coupling, using optical or mechanical nonlinearities, Josephson junctions, etc. For concreteness, we describe it here for the case of optomechanics, but the mathematics and the predictions are general and of wide experimental applicability.  If the gauge field dynamics results in a time-dependent vector potential, conventional electromagnetism dictates that this describes an electric field. In this work, we predict that synthetic electric fields can arise in elementary optomechanical systems, in a dynamical way. The scenarios in which these electric fields arise, and their physical consequences, are qualitatively different from the more conventional self-consistently generated magnetic fields discussed in our previous work walter2016. They can arise even in a linear arrangement of coupled photon modes, where static vector potentials do not have any effect, since they can be gauged away. This makes them a very relevant phenomenon for present-day experimental implementations, in setups as simple as two coupled optical modes. Moreover, the appearance of electric fields turns out to depend on the direction of photon propagation. In this way, we uncover a novel mechanism for nonlinear unidirectional transport of photons (a photon diode). This works especially well in arrays, where transport is significantly suppressed in the blockaded direction.  Synthetic electric fields for photons have been previously analyzed only in the context of prescribed external driving yuan2015,yuan2016, i.e. not dynamically generated. In these cases, the nonlinear dynamics and unidirectional transport explored in our work are absent.                                            *  Dynamical gauge fields for photons. — The optomechanical interaction can be used to realize phonon-assisted photon tunneling, which, as we have shown previously, offers a natural route towards classical dynamical gauge fields for photons walter2016. Photons hopping between optical modes  and  absorb or emit a phonon from a mechanical mode . A pictorial representation of this process is shown in Fig. b. Many implementations are conceivable (photonic crystal devices, coupled toroids, and microwave circuits Aspelmeyer2014), but a suitable realization might simply consist of the well-known membrane-in-the-middle setup thompson2008,sankey2010. The Hamiltonian is     where  are the optical frequencies of modes ,  is the frequency of the mechanical oscillator and  is the tunneling amplitude walter2016. In the following, we set . The phonon-assisted photon tunneling is selected by tuning the mechanical frequency, . The Hamiltonian () is valid within the rotating-wave approximation for  and ,, where  is the photon decay rate and  is the amplitude of the mechanical oscillations: .  During the photon tunneling process , the mechanical phase  is imprinted on the photons, similar to an Aharonov-Bohm (Peierls) phase. This can be used for optomechanical generation of static gauge fields, as proposed in Ref. schmidt2015, and the scheme can be readily implemented in optomechanical crystals safavi-naeini2011,paraiso2015 or the membrane-cavity setup thompson2008,sankey2010,wu2013. It was experimentally realized in Ref. fang2017.  To implement dynamical gauge fields for photons, i.e., fields that are themselves dynamical degrees of freedom, the oscillation phase  (the ``gauge field'') has to evolve freely, which is the case if the mechanical mode performs limit-cycle oscillations walter2016. The limit-cycle oscillations can be generated by pumping an ancillary optical mode, situated at a different frequency, on the blue sideband marquardt2006. This pumping does not impose any particular phase on the mechanical oscillator and thus the phase is able to evolve according to its own dynamics. In this way, the phase  turns into a dynamical gauge field, being influenced by photon transport and acting back on photons. The system of Eq. () can be used as a building block for optomechanical arrays with dynamical gauge fields for photons, as we first proposed in Ref. walter2016. We use the equations of Ref. walter2016 as our starting point, to predict the new phenomenon of synthetic electric fields generated by nonlinear dynamics, giving rise to unidirectional photon transport.  The basic physics behind our results. – We start with a preview of our results, emphasizing the physical intuition. Any oscillator driven by a resonant force  experiences a drift, , of its phase . In our case, the force is the radiation pressure oscillating at the beat note between the two optical modes, and we obtain , where  is the phase difference between the optical modes. If the forcing phase  is kept constant, this results in a stable fixed point . For a limit-cycle oscillator, that behavior is known as phase locking (injection locking) to an external drive (see Ref. SupplentaryMaterial for more details).  However, in our case an interesting self-consistency problem arises: the phase difference  of the two optical modes depends on  itself, as the phase  is imprinted onto the photons during the phonon-assisted photon tunneling. The phase of the force thus follows the oscillation phase. We now discuss qualitatively the resulting physics, which will be bolstered by detailed analysis later. Two cases need to be distinguished, depending on which optical mode is driven by the laser (see Fig. a and Fig. b). If the higher optical mode (labeled '2') is driven, then we find . The crucial term  comes about due to the resonant excitation of the lower mode via the phonon-assisted transition . Comparing with the stable fixed point for  deduced above, we conclude that any value of  is now stable.  The situation drastically changes if the lower optical mode is driven by the laser. Then, we find , where the sign has flipped because the roles of optical modes have been interchanged (now the higher mode is excited by the phonon sideband of the driven lower mode). This corresponds to an unstable fixed point. Once  tries to move away,  will follow, such that  is forever repelled. This results in a finite phase drift , corresponding to an effective shift of the mechanical frequency. Thus, the phonon-assisted tunneling process towards the higher optical mode is no longer in resonance but detuned by . This off-resonant excitation shifts the optical phase difference according to . The equation  can then be fulfilled at a certain value of , which has to be obtained self-consistently. This is the qualitative origin of the nonlinear dynamics that gives rise to what we will identify below as a synthetic electric field  acting on photons.  Dynamics and synthetic electric fields. — Let us analyze the dynamics of the two-site system () with the mechanical oscillator performing limit-cycle oscillations. The optical mode  is driven by a laser of amplitude  at frequency , probing photon transport through the system. The optical and mechanical amplitudes are assumed large such that quantum noise can be neglected, which is an excellent approximation for all existing optomechanical experiments studying nonlinear dynamics.  Following Ref. walter2016, the classical equations of motion for the optical amplitudes  and the mechanical phase  read    & =_M-JBRe[a_1^*a_2e^-i],  a_1 & =i_1a_1-iE_1-iJBe^-ia_2-2a_1,  a_2 & =i_2a_2-iE_2-iJBe^ia_1-2a_2,  where  and  are optical and mechanical detunings, respectively (switching to suitable rotating frames). The mechanical amplitude  is considered fixed. These equations form the starting point of our analysis.  If only one optical mode is driven, no external phase is imprinted. The mechanical oscillator is free to pick any phase despite the interaction with the optical modes. The phase forms a classical gauge field with  symmetry. The gauge transformation   & +_2-_1,  a_j & a_je^i_j, for j=1,2,  generates a new valid solution of the dynamical equations, for any real functions . The transformation also preserves optical and mechanical frequencies whenever it is time-independent, i.e., . However, if  are time-dependent, Eqs. () and () have to be supplemented by a shift in frequencies:  and . Any time-evolving phase  can be viewed as generating a synthetic electric field     for photons. For example, if mode  is driven, we can re-gauge using , which results in a description where the mechanical phase is static but . This describes an effective optical frequency shift, which can be interpreted as a synthetic electric field for photons in the same way that an energy difference between electronic levels indicates a voltage drop, i.e., a real electric field. In conventional electromagnetism, an electric field can be represented either as a time-dependent vector potential or a scalar potential gradient. Analogically, the synthetic electric field  is described either by the time-evolution of the mechanical phase or by an effective frequency shift. As we will show,  has important consequences for photon transport.   Dynamical phase diagram. — Here,  is not prescribed externally but it arises due to the dynamics of coupled optical and mechanical modes. The optical modes induce the force  acting on the mechanical phase. The resulting phase evolution may generate a field  which effectively modifies the optical frequency difference and, consequently, the population of the optical modes.  The results of the dynamical analysis are shown in Fig. . The results were obtained by linear stability analysis and numerical simulations.   We consider the fully resonant situation where physical effects are most pronounced, as both optical driving and phonon-assisted photon tunneling are resonant (). The system always converges to a steady state. The steady-state value of  depends on two dimensionless parameters: the rescaled limit-cycle amplitude  and the rescaled laser amplitude .   The dynamical analysis becomes more intuitive by ``integrating out'' optical modes. This leaves us with an effective potential ), whose minima determine steady-state values of  (see Ref SupplentaryMaterial for the full analytical expression):     In the white region of the phase diagram, Fig. c, the potential  has a single minimum at  (see the blue inset). For the lower-frequency mode, , being driven, this steady state becomes unstable in the colored region of the phase diagram, where the potential  has two minima at finite values of . The field  can develop such a nonzero value for  (above the dashed orange line). In terms of physical parameters, the occupation of the driven optical mode has to exceed the phonon number in the limit-cycle oscillation.  In contrast, if the higher-frequency mode, , is driven,  always has a single minimum at  for any values of system parameters.  The states are not qualitatively changed for finite mechanical and laser detunings (see Ref. SupplentaryMaterial).  We now study effects of the dynamically generated synthetic electric field on light transport. The transmission  is the ratio of the output power leaking from the non-driven mode,  (if mode 1 is driven) or  (if mode 2 is driven), and the driving power . We find that    is suppressed when a finite field  detunes the tunneling process from resonance. In Figs. d and  e,  and , respectively, are depicted along the cut in Fig. c denoted by the dashed black line.  When light propagates to higher optical frequencies, the phonon-assisted photon tunneling is suppressed due to the synthetic electric field. In contrast, the field always vanishes when light propagates towards lower optical frequencies. In this way, dynamical gauge fields give rise to a new mechanism for unidirectional light transport.               Nonlinear unidirectional light transport in a one-dimensional array. — The physics of synthetic electric fields also affects photon transport in arrays (Fig. c). For more details see Ref. SupplentaryMaterial.  Fig. a shows the result for a 1D array: for a sufficiently large laser drive, the system switches into a state where finite  develops to the right of the laser drive. This is the direction where photons need to gain energy when tunneling, and where we already saw in the two-site system that (i) a finite field can develop, and (ii) it suppresses photon transport. In the array, this results in a rapid exponential suppression of light intensity. In contrast, light easily propagates towards the left, where  remains zero. In Fig. b, we plot the ratio  of transmission to the sites adjacent to the driven site  as a function of . The suppression of light propagation to the right, i.e., , is achieved above the threshold of the laser amplitude. At  sites distance from the driven site, the ratio is exponentially increased to .  Our numerical simulations indicate that unidirectional light propagation can also be observed in two-dimensional square arrays. In the future, one might study how these phenomena affect synchronization dynamics of coupled optomechanical self-oscillators heinrich2011,lauter2015,weiss2017.  Experimental parameters required for generating the synthetic electric field. — We estimate that unidirectional light transport can be observed for experimentally realistic parameters. For the membrane-in-the-middle setup, feasible parameters are , , a zero-point fluctuation amplitude of  and a number of photons in the cavity  sankey2010. A typical phonon number in limit-cycle oscillations driven well above threshold is  with a corresponding real oscillation amplitude  marquardt2006. Optical modes can be represented by hybridized modes of a cavity with avoided crossing sankey2010. The splitting of their frequencies  can match the mechanical frequency. For these experimental parameters,  and  are promising for observing unidirectional light transport (see Fig. ). The phonon number can be decreased below the photon number in the driven mode by driving mechanical self-oscillations closer to threshold marquardt2006, fulfilling the necessary condition for a finite synthetic electric field (Fig. ).  Conclusions. — While synthetic gauge fields for photons have been investigated thoroughly in recent years, little has been known about the dynamical situation. In this work, we have uncovered how a synthetic electric field can be spontaneously created in a readily realizable optomechanical setup. The resulting nonlinear photon-diode type of unidirectional transport can lead to a large isolation ratio, especially in arrays. We demonstrate how the interplay of nonlinearity, dynamics, and artificial gauge fields can produce novel physical effects and possible new devices.  We thank A. Nunnenkamp and J. Harris for useful comments, and O. Hart for a careful reading of the manuscript. This work was supported by the European Union's Horizon 2020 research and innovation programme under grant agreement No 732894 (FET Proactive HOT).  apsrev4-1 tocsection     0 0 0 1         Dynamically Generated Synthetic Electric Fields for Photons – Supplementary material center  Phonon-assisted Photon Tunneling  In this section, we derive the Hamiltonian () that describes our scenario in the main text including the photon-phonon interaction term . This term is obtained in optomechanical systems with two (or more) optical modes. Qualitatively, this term arises whenever there are two optical modes that couple to the same mechanical resonator, and the term becomes important dynamically if the mechanical frequency matches the optical frequency difference. The earliest, well-known example is the membrane-in-the-middle setup of the Harris group thompson2008,sankey2010. More generally, such a three-body interaction term will generically arise in systems of nonlinearly coupled modes (e.g. between three optical modes in a -medium, or between microwave modes in the presence of a Josephson nonlinearity).  We consider a membrane in a cavity whose vibrational mode  couples to two optical modes of the cavity. The position of the membrane determines the frequencies  and  of the optical modes  (to the left of the membrane) and  (to the right of the membrane), respectively. Placing the membrane exactly in the middle of the cavity results in equal optical frequencies. Dislocating the membrane slightly from the center introduces splitting  between the optical frequencies. Without loss of generality, we assume . The optical modes  coupled to the mechanical mode  are described by the Hamiltonian     where  is the mechanical frequency,  is the single-photon optomechanical coupling strength and  is the optical coupling strength. For optical modes with a different transversal spatial profile,  can be arbitrarily tuned by the tilt of the membrane sankey2010. Due to the optical coupling, the cavity modes hybridize and that gives rise to supermodes   a_1 & =-J_0a_L+a_RJ_0^2+^2,  a_2 & =a_L+J_0a_RJ_0^2+^2,  at frequencies  and , where . In terms of the supermodes, the Hamiltonian reads     where  J & =g_01+^24J_0^2,  J_res & =g_01+4J_0^2^2.   Next, we assume driving of  with lasers of strengths  at frequencies . Neglecting quantum fluctuations around large optical amplitudes, we can derive equations of motion    & =_M+J_resB(a_1^2-a_2^2)[t]-JBRe[a_1^*a_2e^-i+a_1a_2^*e^-i+2it],  a_1 & =i_1a_1-iE_1-iE_1^rese^-it+iB[J_resa_1(e^-i+it+e^it)-Ja_2(e^-i+e^it)]-2a_1,  a_2 & =i_2a_2-iE_2+iE_2^rese^it-iB[J_resa_2(e^-i+it+e^it)+Ja_1(e^i+e^-i+2it)]-2a_2,  in frames rotating at suitable frequencies (mode  at , mode  at  and mode  at ), where we assume mechanical limit-cycle oscillations  with a fixed amplitude . We define , , , , ,  and .  Now we consider the resonant case, , when the generation of the synthetic electric fields is the most pronounced. In this case, driving of  mostly addresses supermode , since the laser is on resonance with its frequency and the overlap of  with the other supermode  is small provided that . As a result, we can neglect the residual driving of the supermode . Similarly, driving of  leads to addressing mostly the supermode . If the residual drivings are negligible and we tune the mechanical frequency such that , the coupling term  is selected and the other coupling terms in the Hamiltonian () are off resonance. Neglecting the off-resonant coupling terms within the rotating-wave approximation, which is valid for , the equations of motion reduce to Eqs. (), () and () considered in the main text with the effective tunneling amplitude  given by Eq. (). The tunneling amplitude  decreases with decreasing  As a result, a fine tuning of the ratio  is necessary to achieve the optimal trade-off between eliminating the residual driving of unwanted supermodes and maximizing the amplitude of the term .  We have derived the Hamiltonian () for optical supermodes, which is considered as the starting point in the main text, from the fundamental optomechanical Hamiltonian () for two optical modes coupled to a single mechanical mode. In summary, whenever two optical modes and one mechanical resonator are in a mutual interaction, and when the mechanical frequency matches the optical frequency difference (at least approximately), the interaction term  assumed in our work is the generic outcome.  Steady states of the two-site system   In this section, we analyze the steady states of the two-site system with single mode being driven. They are stationary solutions of the equations of motion (Eqs. (), () and () in the main text) constant in time. We first apply a time-dependent gauge transformation to express the time-evolution of the mechanical phase in a form of an effective optical frequency shift. Then we find a stationary condition for the synthetic electric field . Finally, we use an effective potential for the synthetic electric field to study stability of its stationary solutions.  As mentioned in the main text, we assume that only one mode is driven. We label the driven mode by the index . Driving strengths can then be expressed as  for , where  is the Kronecker delta. The detuning of the non-driven mode can be set to zero, since there is no driving frequency. Therefore, the optical detunings can be expressed as . We make use of the time-dependent gauge transformation  & =+,  a_1 & =a_1e^-i_2,k,  a_2 & =a_2e^i_1,k,  which moves the dynamics of the mechanical phase to the time-dependent gauge parameter . By appropriately choosing  we can always achieve . The time-dependent gauge transformation leaves the absolute values of the optical amplitudes unchanged. As a result, a particular value of the gauge parameter is irrelevant. Only its first derivative  influences the optical occupations. The time evolution of the mechanical phase results in an effective shift  of the non-driven optical mode's frequency. Note that the driven mode, , is forced to oscillate with the frequency of the laser drive, and thus it does not experience any frequency shift.  The role of the optical frequency shift  can be understood in analogy to electromagnetism. The mechanical phase corresponds to an effective vector potential. According to conventional electromagnetism, the time evolution of the vector potential generates an electric field. This electric field can be also represented by a scalar potential gradient. In this analogy, the time evolution of the mechanical phase generates a synthetic electric field  for photons, which represent an effective optical frequency shift.  To provide the fixed point analysis for the both cases  at once, we use general indexes  to label the optical modes. According to the gauge transformation (), (), and (), the equations of motion transform to    & =E-_M+JBRe[a_k^*a_l]=0,  a_k & =i_Oa_k-iE-iJBa_l-2a_k,  a_l & =i(_2,k-_1,k)Ea_l-iJBa_k-2a_l,  where we substituted  . Taking the time derivative of Eq. (), we obtain the equation of motion for the synthetic electric field     To find stationary solutions of the equations of motion (), (), and (), we first use that the equations () and () are linear in terms of optical amplitudes. For a given value of the synthetic electric field , the stationary optical amplitudes read   a_k & =E(_2,k-_1,k)E+i2-J^2B^2+(_2,k-_1,k)E_O-(2)^2+i2[(_2,k-_1,k)E+_O],  a_l & =JB(_2,k-_1,k)E+i2a_k.             In following, we set  to present the important features of the steady states. These features are not changed by finite detunings. We discuss the effects of finite detunings at the end of this section. By substituting the stationary values of the optical amplitudes (), () into Eq. (), we obtain the stationary condition for the synthetic electric field     For , when the mode with the higher optical frequency, , is driven, only the single stationary solution, , exists. For , when the mode with the lower optical frequency, , is driven, stationary solutions with a finite synthetic electric field     emerge, in addition to , for .   To gain intuition about the stability of these stationary solutions, we find the potential     such that  is equal to the right hand side of Eq. (). The potential shows that the stationary solution  is always a stable steady state for  when the optical mode with the higher optical frequency is driven (see Fig. ). The stability of the steady state does not depend on the system parameters. For , when the mode with the lower optical frequency is driven, the stability of the steady state depends on the two dimensionless parameters  and . The potential in Fig.  shows that the steady state  is the only stationary solution and it is stable in the white region of the phase diagram depicted in Fig.  of the main text. It becomes unstable as the two steady states with a finite synthetic electric field emerge in the colored region of the phase diagram in Fig.  of the main text. Note that the potential does not provide conclusive information about the stability of the steady states because it does not take into account the dynamics of the optical modes. Therefore, the linear stability analysis was used to confirm that the stability of the steady states is determined correctly by the potential .  A finite mechanical detuning, , detunes the phonon-assisted photon tunneling process from resonance. In this way, the mechanical detuning represents a static synthetic electric field for photons in contrast to the dynamically generated synthetic electric field . If the higher optical frequency is driven, the dynamically generated synthetic electric field  acts against this static synthetic electric field and increases transmission to the lower optical frequency with the increasing laser amplitude. On the other hand, for the lower optical frequency being driven, the dynamically generated synthetic electric field detunes the tunneling process further from resonance with the increasing laser amplitude. As a result, it decreases light propagation to the non-driven optical mode. Above some threshold of the laser amplitude, the synthetic electric field bifurcates as the effective potential have two local minima. This again happens only for the lower frequency being driven.  A finite laser detuning, , suppresses the coherent driving, which results in a smaller optical amplitude of the driven mode. For the higher optical frequency being driven, the synthetic electric field always vanishes even for a finite optical detuning. It vanishes also when the lower optical frequency is driven for small laser amplitudes. Similarly as in the resonant case, the synthetic electric field bifurcates to finite values over the threshold of the laser amplitude for the lower frequency being driven. The threshold and the values of the bifurcated synthetic electric field are modified by the finite optical detuning since it changes the population and the phase of the driven optical mode. However, the qualitative features of the synthetic electric field remain the same. The synthetic electric field is generated only above threshold and only for the lower optical frequency being driven.  Numerical simulations of the full equations of motion  In this section, we present numerical simulations of the system described by the fundamental Hamiltonian () when we consider the laser drive coupling to the original (uncoupled) cavity modes, out of which the supermodes are formed. In this way, we demonstrate the validity of the results presented in the main text where the description of the system is simplified by assuming that individual supermodes can be separately coupled to the laser drive.  We now simulate the dynamics of the uncoupled optical modes  and  according to the fundamental Hamiltonian (). To this end, we derive classical equations of motion    & =-+g_0B(a_L^2-a_R^2),  a_L & =i(_L+2g_0B)a_L-iE_L-iJ_0a_R-2a_L,  a_R & =i(_R-2g_0B)a_R-iE_R-iJ_0a_L-2a_R,  neglecting quantum fluctuations around the expectation values , where we again assume that the mechanical mode, , performs limit-cycle oscillation with a fixed amplitude  as well as  , , and  is the frequency of the laser drive. We consider driving of a single uncoupled optical mode at resonance with the corresponding supermode, i.e.  for  or  for , and  The generated synthetic electric field and the optical transmission are shown in Fig.  as a function of the rescaled driving strength . One can see in Fig. a that a large synthetic electric field is generated for mode  being driven (solid lines). As a result, the transmission to the right (solid lines) is significantly suppressed, see Fig. b.  For driving mode , a small synthetic electric field (dashed lines) is generated. This is in contrast to the simplified model in the main text, where the synthetic electric field completely vanishes when light propagates to the lower optical frequency. The small generated synthetic electric field is a result of the residual driving of the supermode  due to its non-vanishing overlap with the driven uncoupled mode . Since the mechanical frequency, , is chosen to match the optical frequency difference, the supermode  is driven on the blue sideband. However, the residual driving can be suppressed by increasing the sideband ratio , see Fig. a. As a result, a significant suppression of the optical transmission to the right (solid lines) in comparison to the transmission to the left (dashed lines) can be reached, see Fig. b. This leads to unidirectional transport of light which works especially well in one-dimensional arrays. In such an array, the transmission ratio is exponentiated by the length of the array, which results in a large suppression of transport in one direction.  Simulating the dynamics of the uncoupled optical modes, we have shown that unidirectional light transport via synthetic electric fields is achieved for the fundamental model described by the Hamiltonian (). This demonstrates that the model in the main text indeed captures the important features of the interaction between the two optical modes and the mechanical mode in our scenario. Our results show that unidirectional light transport is more pronounced with the increasing sideband ratio .                      Phase locking  In this section, we provide a brief summary of phase locking, which can be reached in the two site system by simultaneously driving both optical modes. Note that the analysis presented in the main text is for a single mode driven only. We present here quantitative features of phase locking, which has been previously well studied in a similar optomechanical system heinrich2011.  The starting point of the analysis are the equations of motion (), () and () in the main text. The stationary values for the optical amplitudes are    a_1 & =-JBE_2e^-i+i2E_1J^2B^2+(2)^2,  a_2 & =-JBE_1e^i+i2E_2J^2B^2+(2)^2.  Note that if both optical modes are driven, the phases  and  of the laser amplitudes  and , respectively, determine the phases  and  of the intracavity modes. This is different to the case when only a single optical mode is driven, where the phase of the driving amplitude is irrelevant.   The stationary value of the mechanical phase  obeys the Adler equation     where  However, the absolute values of the optical amplitudes  and  depend on the phase difference . The Adler equation still determines uniquely the stationary value of  but the full analytical expression of this equation is complicated. Thus it is simpler to switch to the phase difference  of the laser phases  and . The Adler equation then has the form     We can easily read off that the stationary solution of  exists for      The mechanical phase  is locked under this condition to the difference  of the laser drives' phases. Since there is one-to-one correspondence between the laser drives' phases and the intracavity modes' phases, the mechanical phase  can be equivalently though to be locked to the phase difference  of the intracavity modes.  one-dimensional arrays   Here we provide details about one-dimensional arrays analyzed in the main text. We consider an array, depicted in Fig. c of the main text, represented by a stack of membranes inside a cavity. The sites of the array support optical modes  whose frequencies  increase with site index . We assume that the phonon-assisted photon tunneling processes are resonant: , where  is the frequency of the mechanical oscillator assisting tunneling between modes  and . Specifically, we will consider a situation where some optical mode  is driven resonantly from the side, to study light propagation towards the left (), and towards the right (). Alternatively to membrane stacks, suitably designed coupled cavity arrays in optomechanical crystals could implement such a setup.  The mechanical oscillators are again assumed to perform limit cycle oscillations  with free phases and with a fixed amplitude  equal for all mechanical oscillators. By straightforward extension of Eqs. (), (), and () (in the main text), we obtain the coupled equations of motion for the optical amplitudes and the mechanical phases   _j & =-JBRe[a_j^*a_j+1e^-i_j],  a_j & =-iE_j_j,d-iJBe^-i_ja_j+1-iJBe^i_j-1a_j-1-2a_j,  where  is the Kronecker delta. The optical modes are expressed in the frames rotating with their frequencies  and the mechanical modes are in the frames rotating with the difference of optical frequencies on the neighboring sites: .  We study the dynamics of one-dimensional arrays by numerically solving the classical equations of motion () and (). The system converges to a steady state for any values of the parameters  and . Properties of the steady states are discussed in the main text.  


Cavity optomagnonics with magnetic textures: coupling a magnetic vortex to light 
Jasmin Graf 
Max Planck Institute for the Science of Light, Staudtstra�e 2, 91058 Erlangen, Germany 
Hannes Pfeifer 
Max Planck Institute for the Science of Light, Staudtstra�e 2, 91058 Erlangen, Germany 
Florian Marquardt 
Max Planck Institute for the Science of Light, Staudtstra�e 2, 91058 Erlangen, Germany 
Institute for Theoretical Physics, University Erlangen-N�rnberg, Staudtstra�e 2, 91058 Erlangen, Germany 
Silvia Viola Kusminskiy 
Max Planck Institute for the Science of Light, Staudtstra�e 2, 91058 Erlangen, Germany  
Optomagnonic systems, where light couples coherently to collective excitations in magnetically ordered solids, are currently of high interest due to their potential for quantum information processing platforms at the nanoscale. Efforts so far, both at the experimental and theoretical level, have focused on systems with a homogeneous magnetic background. A unique feature in optomagnonics is however the possibility of coupling light to spin excitations on top of magnetic textures. We propose a cavity-optomagnonic system with a non homogeneous magnetic ground state, namely a vortex in a magnetic microdisk. In particular we study the coupling between optical whispering gallery modes to magnon modes localized at the vortex. We show that the optomagnonic coupling has a rich spatial structure and that it can be tuned by an externally applied magnetic field. Our results predict cooperativities at maximum photon density of the order of  by proper engineering of these structures.  
  
Introduction. Optomagnonics is an exciting new field where light couples coherently to elementary excitations in magnetically ordered systems. The origin of this photon-magnon interaction is the Faraday effect, where the magnetization in the sample causes the light's polarization plane to rotate. Conversely, the light exerts a small effective magnetic field on the material's magnetic moments. Shaping the host material into an optical cavity enhances the effective coupling according to the increased number of trapped photons. 
Recent seminal experiments have demonstrated this coupling . In these, an Yttrium Iron Garnet (YIG) sphere serves as the host of the magnetic excitations and, via whispering gallery modes (WGM), as the optical cavity. The optomagnonic coupling manifests itself in transmission sidebands at the magnon frequency. So far, these experiments have probed mostly the homogeneous magnetic mode (Kittel mode) where all spins rotate in phase . Very recently, optomagnonic coupling to other magnetostatic modes  has been demonstrated, albeit still on top of a homogeneous background . 
The Kittel mode, although it is the simplest one to probe and externally tune, is a bulk mode and has a suboptimal overlap with the optical WGMs living near the surface. Another caveat is the state of the art in terms of sample size, which is currently sub-millimetric. This results in modest values for the optomagnonic coupling and motivates the quest for smaller, micron-sized magnetic samples, as well as for engineering the coupling between magnetic and optical modes. Increasing the currently observed values of optomagnonic coupling is an urgent prerequisite for moving on to promising applications such as magnon cooling, coherent state transfer, or efficient wavelength converters .  
In microscale magnetic samples, the competition between the short-range exchange interaction and the boundary-sensitive demagnetization fields can lead to magnetic textures, where the magnetic ground state is not homogeneous . A well studied case is that of a thin microdisk, where the magnetization swirls in the plane of the disk and forms a magnetic vortex in the center , see Fig. a. In the vortex core, the spins point out of plane.  
 
  
Magnetic vortices carry two degrees of freedom: how the magnetization curls (clock or anti-clock wise) defines the chirality , while its pointing up or down at the center of the vortex defines the polarity . These are robust topological properties and make vortices interesting for information processing . Moreover, the position of the vortex can be controlled by an external magnetic field, making this system highly tunable (Fig. c). 
While optomagnonic systems present analogies to optomechanics  (where light couples to phonons ), the possibility of coupling light to magnetic textures is unique to optomagnonics. In this work we study the optomagnonic coupling in the presence of an inhomogeneous magnetic background in a microdisk geometry (note that this differs from Refs. , where the underlying magnetic ground state is uniform). This is a relevant case to study since: (i) YIG disks at the microscale have been experimentally realized and the presence of magnetic vortices demonstrated  (ii) a disk supports optical WGMs while reducing the magnetic volume with respect to a sphere, which could lead to larger optomagnonic couplings, and (iii) the spin excitations in the presence of the vortex are qualitatively different from those on top of a homogeneous magnetization.  
We combine analytical methods with micromagnetic and finite-element simulations to derive the spatial dependence and the strength of the optomagnonic coupling. We study two qualitatively different regimes that can be accessed by nanostructure-patterning: a very thin micromagnetic disk embedded in an optical cavity, and a thicker microdisk that also serves as the optical cavity (Fig. b, c). We demonstrate our method for the coupling between magnon modes localized at the magnetic vortex and the optical WGMs, and predict high values for the optomagnonic coupling and the cooperativity, an important figure of merit in these systems. 
Optomagnonic coupling for magnetic textures. In a Faraday active material, the electromagnetic energy is modified by the coupling between the electric field and the magnetization : 
 
where  is the local magnetization in units of the saturation magnetization , and we used the complex representation of the electric field, . The prefactor  ( in YIG) gives the Faraday rotation  per wavelength  in the material, () is the relative (vacuum) permittivity, and  the refractive index. Eq. eq:UMO-1 couples the spin density in the magnetic material with the optical spin density (OSD), which represents the spin angular momentum density carried by the light field. Quantizing Eq. eq:UMO-1 leads to the optomagnonic Hamiltonian . The coupling is parametric, coupling one local spin operator to two photon operators. 
We consider the coupling of the optical fields to spin wave excitations on top of a nonuniform static ground state , . For small deviations  we can express these in terms of harmonic oscillators (magnon modes). Quantizing  and , from Eq. eq:UMO-1 we obtain the coupling Hamiltonian  where  and 
 
is the local optomagnonic coupling. The Greek subindices indicate the respective magnon and photon modes which are coupled. We use Eq. eq:coupling to evaluate the coupling between optical WGMs and magnon modes in a YIG microdisk with a magnetic vortex, focusing on magnonic modes localized at the vortex. We study two cases: (i) a thin disk where the problem is essentially 2D, and (ii) a thicker disk, where the z-dependence of the problem is non-trivial. The thin disk allows us to compare with analytical approximate results, validating our numerical results. 
Thin Disk. We consider a magnetic microdisk of thickness  and radius . The characteristic magnetic length scale is the exchange length  (for YIG: )  . A vortex is the stable magnetic texture for  and  . The lowest excitation mode consists of the vortex's center-of-mass rotating around an axis perpendicular to the disk's plane , see Fig. c. The frequency  of this gyrotropic mode can be approximated by  with  the gyromagnetic ratio  (for YIG ). The excitation is localized at the vortex core, decaying linearly with distance .  
 
 
 
 
 
 
  
The disk also supports optical WGMs. The approximate 2D analytical solution for these is well known . 
The WGMs can be classified into TM and TE modes, for electric field perpendicular to and in the plane of the disk respectively  . Within this approximation we have two possibilities for finite coupling to the gyrotropic mode: processes involving both TE and TM modes, and those involving only TE modes. For processes involving both TE and TM modes,  lies in the  plane and therefore can couple to the in-plane component of the gyrotropic mode, which is finite both inside and outside of the vortex core. Processes involving instead only TE modes couple exclusively to the out-of-plane component of the gyrotropic mode, which is finite only inside the vortex core . 
For a YIG microdisk, the free spectral range , which is much larger than the typical gyrotropic frequencies. Therefore, magnon scattering between two energetically distinct optical modes would be allowed either in the sideband unresolved case, or possibly with carefully selected modes of other radial optical quantum numbers. Moreover, using an external magnetic field for frequency-matching can be difficult in these structures, since it would alter the static magnetic texture and consequently the modes. In the following we discuss the case of scattering with one TE mode, which is free from these considerations. This is analogous to single-mode optomechanics  or optomagnonics , where the system is driven by a laser whose detuning from the optical mode can be made to match the magnon frequency. 
Coupling to the gyrotropic mode is only possible if there is an overlap with the WGM. Applying a magnetic field  along  displaces the vortex up (down) along  for counterclockwise (clockwise) chirality, as the spins try to align with the field. This provides a knob to control the optomagnonic coupling, as we show in the following. 
 
 
 
  
* 
We first note however that a thin YIG microdisk such that  is a bad optical cavity. To better confine the optical modes, we consider a structure as shown in Fig. b, such that the YIG disk is placed between two dielectric, non-magnetic disks with same radius and height comparable to . We chose  (refractive index ) in order to create an almost continuous material for the WGM resonator. Hence the WGMs live in the whole structure, whereas the magnon modes are confined to the thin YIG disk. The gyrotropic mode can overlap with the WGMS for a displaced vortex, see Fig. a. We continue to call this mode ''gyrotropic'' since it evolves continuously from the gyrotropic mode at . Whereas its frequency has a light dependence on , the mode itself is distorted as the rim of the disk is approached. This reflects the deformation of the vortex core into a C-shaped domain wall due to the stronger influence of the demagnetization fields at the nearest boundary .  
Fig.  shows an example of the spatial dependence of the optomagnonic coupling  for the gyrotropic mode and a WGM. The coupling, given throughout this work as per photon and per magnon, was obtained by combining MuMax  micromagnetic simulations with finite-element simulations for the optical WGM via Eq. eq:coupling. Details on the simulations and the normalization procedure are presented . 
The total coupling is obtained by integrating over the whole volume. The integration volume is however bounded by the magnon mode volume, , since it is smaller than the optical mode . A quick estimate of the maximum coupling is  ( g-factor,  Bohr magneton), showing a suppression of the coupling by a factor . For the thin disk considered here we find , in agreement with the modest maximum value of  obtained numerically, see Fig. . Interestingly, this maximum value is not obtained at the maximum of the OSD, but at points of its maximum slope (as a function of vortex position). This can be understood by noting the antisymmetry under inversion of  for the gyrotropic mode, which leads to a cancellation when integrated weighted by an isotropic factor. This cancellation is lifted most effectively when the vortex is located at highly anisotropic points of the OSD. Fig.  shows  as a function of applied magnetic field, together with the profile for the OSD. This shows clearly that the magnon mode couples effectively to the gradient of the OSD. The value of  is therefore completely tunable by an external magnetic field, in contrast to the usual case of magnonic modes on a homogeneous background. 
Using the ``rigid vortex'' model  for the magnetics, the optomagnonic coupling for the gyrotropic mode can be obtained analytically . Using that the vortex core radius  is small, the first non-zero contribution to the coupling in a Taylor expansion is  
 
with  the vortex position and  the WGM label. This confirms the coupling to the gradient of the OSD. This simplified analytical model is in good agreement with the simulations, see Fig. .  
Thick Disk. The magnetic texture can be considered independent of height when  is only a few . Increasing the height of the disk leads to more complex magnetic textures and the appearance of magnon flexural modes along the -direction , which can hybridize with in-plane modes . Although this effect is already present for , it is even more striking for finite external field. We discuss this regime in the following. 
We consider a ``thick'' microdisk such that  in an applied external field . In this case the vortex ``snakes'' from top to bottom of the disk, see Fig. a-c. This results in highly complex magnon modes, which we obtain by micromagnetic simulations. The spatial structure for the first excited modes is shown in Fig. g. We interpret these as flexural modes of the vortex core, possibly hybridized with the gyrotropic mode. The optomagnonic coupling for these modes at a fixed  is presented in Fig. f. We observe that (i) we obtain values for the coupling in the kHz range, and (ii) the value of the coupling has a non-monotonic dependence on the mode number, due to cancellation effects, as can be seen when compared with the integrated absolute value of the coupling. This system shows also tunability by an external magnetic field, and the coupling is governed by the gradient of the OSD, see Fig. . Taking the Gilbert damping coefficient for YIG  we obtain single-photon cooperativities up to , where  (from COMSOL) and  frequency of the respective magnon mode. For a maximum allowed photon density of , , a five orders of magnitude improvement with respect to the current state of the art. 
Conclusion. We developed a numerical method based in micromagnetics and finite-element simulations for cavity optomagnonicss with magnetic textures. We studied a microdisk where the magnetic static background is a vortex. The system presents two qualitatively distinct regimes. For thin disks the problem allows for an approximate analytical treatment, which we use to benchmark our results. For this case, we propose a heterostructure where the optical cavity surrounds the microdisk for better confinement of the optical modes. A simpler structure from the experimental point of view could be instead an optical cavity on top of the microdisk, where the coupling is evanescent. This could provide the freedom of designing optical modes independently of the magnetic structure. For thick disks, the microdisk serves also as the optical cavity. This system presents a rich magnetic structure, and large values of optomagnonic coupling and cooperativities are in principle achievable. Coupling to other spin wave modes in microdisks, of the WGM kind , could boost these values even further. The predicted values imply a significant improvement with respect to the state of the art, and are attainable within current technology. Our results pave the way for optomagnonics with magnetic textures , including optically induced non-linear vortex dynamics (e.g. self-oscillations of the gyrotropic mode), optically mediated synchronization in vortex arrays, and exotic quantum states entangling vortex and optical degrees of freedom. Finally, our results indicate the potential of these systems for cavity-enhanced Brillouin scattering microscopy to study vortices or other magnetic structures. 
Acknowledgments. We thank A. Aiello for discussions and K. Usami for useful comments on the manuscript. F.M. acknowledges support through the European FET proactive network "Hybrid Optomechanical Technologies". S.V.K. acknowledges support from the Max Planck Gesellschaft through an Independent Max Planck Research Group. 
  
empty 
 
 
  
0  
Gyrotropic Mode 
In this section we calculate the local change in the magnetization  corresponding to small oscillations of the spin with respect to the local equilibrium due to the gyrotropic mode. The obtained results are valid for the thin disk approximation.  
We can parametrize the magnetization outside of the vortex core as 
 
with  the polar coordinates in the system with origin at the center of the core. We describe the magnetization profile inside of the core with the ''rigid vortex'' model  using the following parametrization  
 
 
 
The radius of the vortex core  can be obtained approximately by energy considerations . For a disk with micrometer radius,  is of the order of a few . The time-dependent magnetization as long as the gyrotropic mode is excited can be approximated as  
 
with , where we have ignored damping of the mode. Using the complex representation of  we obtain  
 
We first consider the perturbation outside the vortex core such that  and . In a cartesian coordinate system with center at the unexcited vortex  we get  
 
  
with , . Hence the following expressions hold  
m_ox & =C()e_, 
m_oy & =-C()e_. 
Inserting Eqs. eq:dxdym into Eq. eq:delta_m_g and using  we obtain  
 
with .  
Inside the vortex core, the magnetization acquires an out-of-plane component. In the rigid vortex model, the vortex moves without deforming and for  it is parametrized as  
 
 
 
For the gyrotropic mode, using eq:delta_m_g, we obtain 
m_ix & =-2r_cCb(^2+b^2)^2[2xy+iP(^2+b^2-2y^2)], 
m_iy & =-2r_cCb(^2+b^2)^2[(^2+b^2-2x^2)+iP2xy],  
m_iz & =4r_cPb^2(^2+b^2)^2e^iP.  
If an external in-plane field  is applied, the vortex is displaced from the center of the disk and it is deformed into a C-vortex for fields larger than a certain field , see Fig. AFig3. The calculated mode profile in Eqs.  and  are valid as long as the vortex core is not deformed, that is, for  . Fig. AFig1 shows the gyrotropic mode profile obtained by micromagnetics for a field . The results are in agreement with the mode profile obtained in Eqs. eq:delta_m_out and eq:delta_m_i. 
 
 
  
Normalization of the Gyrotropic
Mode 
We can relate the amplitude  of the gyrotropic mode to the average number of excited magnons in the mode. For this we recall that the local magnetization can be written as  
 
where  corresponds to the local equilibrium direction,  is a local orthonormal basis, and .  is the (complex) amplitude of the spin wave, and  gives us the probability density of magnonic excitations. We can therefore identify  
 
and obtain  ,  from the corresponding expressions in Eqs. eq:delta_m_i and eq:delta_m_out. 
We proceed with finding . While  is determined by the local equilibrium magnetization,  can be chosen. Writing  in cylindrical coordinates results in a natural way to chose  (in what follows we take for notational simplicity  ), 
 
where the second equality defines the angle  in the plane spanned by  and . If we define  to be in the same plane, i.e. , then the local triad is completely determined by . Hence we have , 
and we can write  
_i(r) & =M_sg_Bm_i(r)2e_+^i=-M_sg_B2br_cb^2+^2[()+i()], 
_i^*(r) & =M_sg_Bm_i^*(r)2e_-^i. 
 
 
  
Using this we obtain  
 
Outside of the vortex core,  holds and the fluctuations  are in the plane and along  (see Eq. eq:delta_m_out). Hence we simply get  and hence  
 
In this case we obtain  
 
By normalizing to one magnon in the disk volume, we obtain  
 
For a typical microdisk with  and  we get  
 
In the case of a YIG disk with   evaluates to . 
Whispering Gallery Modes in Cylindrical Geometry 
In the limit of an infinite cylinder, Maxwell equations can be solved analytically due to the translation invariance along the cylinder axis . Hence the problem can be considered as two dimensional. In the following we sketch the solution for completeness .  
The functional form of the electric  or the magnetic  field component is given by solving the Helmholtz equation 
 
respectively for the TM () and the TE () mode. In cylindrical coordinates  with origin at the center of the disk, one obtains in the case   
 
with  the Bessel function of the first kind. Since the magnetic mode is confined to the disk, we can focus only the solution for . The outer solution  however is needed to obtain the allowed values of . This is given by the condition  
 
with  the Hankel function of the first kind and  for a TM and  for a TE mode. The solutions to this transcendental equation are of the form  
 
where the real part  determines the position of the resonance and the imaginary part  the leaking of the mode out of the cavity, and therefore its lifetime. Additionally,  gives the number of interference maxima of the E/B-field in the azimuthal direction and  the number of interference regions in the radial direction. In the following we are interested in the  field, which is the field relevant for the optomagnonic coupling. For the TM mode one obtains simply  
 
while for the TE mode  
 
holds, where  and the subscripts  indicates that the expressions are evaluated for a particular solution  of Eq. eq:k_mp. Since WGMs in a classical sense are located at the rim of the disk, we assume  and hence omit this index in the following discussions. By considering well defined WGMs, , determined by the boundary conditions at the rim, can be taken as real in a first approximation. 
The normalization coefficient to one photon in average in the optical cavity can be found from  
 
 For the TE mode we obtain  
 
 with  
  
Optomagnonic coupling for the thin Disk 
We consider an applied external magnetic field  such that the vortex is displaced a distance  from the disk's center, and calculate the coupling of the gyrotropic mode discussed in Sec.   to a TE-WGM as given in Eq. eq:TE mode. The optical spin density vector is perpendicular to the disk plane (-axis) and therefore couples only to  given in Eq. eq:delta_m_i, which is finite only for . The optomagnonic coupling in this case reads 
 
Here,  are polar coordinates in the system with origin at the center of the vortex. From Eq. eq:TE mode we obtain (, and )  
E_m^TE*E_m^TE& =ie_zA_m^2^2_m^2k_mmr _rJ_m(r)^2, 
where  corresponds to  and  (see inset of Fig.  for details). 
Using also Eq. eq:NJ yields 
 
We note that the last factor in the integrand has a non-trivial dependence on , since the vortex is displaced from the center of the disk. The coefficient  is determined by the number of magnons in the excited mode and given by  for a single magnonic excitation (see Sec. ). Taking a WGM with  captured in a YIG disk with  and , we obtain  
  
Fig.  shows this expression as a function of the vortex position  (red doted line). As we see the result agrees reasonably well with the numerical results presented in the main text, both for the order of magnitude of the coupling (), and as for the non-monotonic behavior.
Additionally this plot displays the magnitude of the OSD (blue line) normalized to one and evaluated at the position of the vortex.  
As discussed in the main text, also the analytical results indicate that the optomagnonic coupling vanishes at the maximum of the OSD, meaning that the magnon mode couples effectively to the gradient of the OSD, and is maximum at the points of maximum slope.
In order to verify this conjecture we define  and  and perform a Taylor expansion of   in small  around the rescaled vortex position  up to first order in . Without giving any further proof we note that an expansion only up to first order in  is sufficient for our purposes since all higher order terms give a negligible contribution. The expansion of  reads 
 
 
  
Inserting this expansion of  into Eq. eq:Gtheo and performing the change of variable  yields 
 
where the absolute value  indicates we are now taking the derivative along the  axis, and the  has been absorbed in the definition of . We see that, due to symmetry, the  the only surviving term is the one proportional to . Performing the integral we obtain  
 
 
 
 
 
For WGM with  in a YIG disk with  and  this yields 
  
This expression is also shown in Fig.  (green line). As we see the approximate expression of the coupling reproduces very well the exact coupling given in Eq. eq:Gtheo, up to a small multiplicative factor. Including higher order terms in the Taylor expansion accounts for this small difference. Since   is proportional to the OSD,  
 
this concludes our proof. Using this expression together with Eqs. eq:NormAmExpl, Gmapprox and equ:rc we obtain Eq. (3) in the main text.  
Note that in Fig. 3 in the main text, both the optomagnonic coupling and the OSD are plotted as a function of the external field , using the nonlinear dependence between the vortex position  and the external magnetic field found by micromagnetic simulations and shown in Fig. .  (the OSD does not depend on Hx, but we translate the vortex position into magnetic field). Due to this nonlinear dependence, the point of maximum slope of the OSD plotted as a function of the magnetic field does not coincide with that one as a function of position (in particular, the steepness of the slope right and left from the maximum of the OSD is inverted, compare Fig.  and Fig. 3). In Fig. 3 we plot the optomagnonic coupling as a function of Hx since this is the externally tunable parameter. 
We end this section by noting that in Eq. eq:Gtheo and the corresponding Fig. , we assumed that under the application of an external field , the vortex remains undeformed until the rim of the disk. This is true up to . Beyond these fields, the vortex core is elongated, forming a small domain wall in the form of a C. The magnon modes in the presence of this distorted vortex differ from the ideal case  used in this analytical calculation. Eq. eq:Gtheo therefore must be taken as an approximate expression for the optomagnonic coupling. Additionally we also have neglected the imaginary part of the wave vector for the WGM.  
Vortex position vs. external magnetic field 
The vortex core can be shifted towards the rim by applying an external magnetic field. Hence the vortex core position can be related to the magnitude of this external field. The vortex's displacement is linear with the field for  and one can write , where the magnetic susceptibility  is defined via  and its parametric dependence is given by  . For higher magnetic field however this dependence deviates from linear. We obtained the position of the vortex as a function of magnetic field using MuMax. The results are plotted in Fig. . 
We used these results to relate position and magnetic field in Fig. 4 
of the main text. 
 
 
  
Optical Simulations 
In order to obtain the optical eigenmodes of the cylindrical cavity we used the finite element simulation tool COMSOL Multiphysics. The simulated geometry consists of a magnetic disk surrounded by an air cylinder, with dimensions listed in Table . The air has to be taken into account, since the electric field captured in the disk can leak out at its boundaries. The size of the air cylinder was chosen such that the evanescent light has at least  before it reaches the boundaries. We work with the insulating magnetic material YIG with the following parameters  
_r & =5 
_r & =1 
& =0, 
where  ( ) is the relative permittivity (permeability) and  the conductivity. The air is simulated with  and . Due to the small height of the thin YIG disk the modes are very leaky causing the quality factor to be very low. In order to prevent that we confine the modes in the disk by sandwiching the YIG disk with two  disks (). The corresponding material parameters of  are  
_r & =4 
_r & =1 
& =0. 
 
 
We use three ``Free triangular'' mesh grids, one for each material. In the YIG and  domains we choose a finer mesh, whereas in the air domain the mesh can be increased without losing accuracy, since the optical field is concentrated closely to the disks. Details are found in table . 
Due to the axial symmetry of the whole geometry we can use the ``2D Axis symmetric space dimension'' in order to save simulation time by simulating just one slice, see Fig. . We used the ``Electromagnetic waves, Frequency domain'' package of COMSOL's RF module which solves for 
 
with  the vacuum wave number,  the angular frequency and  the electric field. As the finite element method requires a finite-sized modeling domain, we need to limit the modeled air stack to a finite size. To account for leakage from the optical mode, we apply scattering boundary conditions at the surface of the air cylinder  
 
with  the normal vector. This should avoid reflection of the electric field at the boundaries of the air cylinder, and as a consequence the obtained eigenfrequencies are complex with an imaginary part describing the loss scattered out of the the disk cavity. To find the TE modes, we simulate the upper half of the whole geometry and apply a ``perfect magnetic conductor'' boundary condition () to the bottom surface of the cut geometry, see Fig. . The full solution is obtained by mirroring with respect to the bottom plane. Therefore within our definition, the TE (-like) modes are even under a vector-parity operation. 
We search for relatively well confined optical WGMs. The micrometer scale of the system will result in low possible azimuthal numbers for the modes, and modest quality factors. We find possible candidates for  in the case of the thin and  in the case of the thick disk. Solving Eq. eq:HelmoltzComsol using these values we obtain modes with an eigenfrequency of  (thin disk) and  (thick disk), respectively. 
Micromagnetic Simulations 
In order to calculate the magnetics we use the GPU accelerated micromagnetic simulation tool MuMax . We simulate both a thin and a thick YIG disk with corresponding dimensions as given in table . The material parameters used are listed in table .  
 
The two different meshes we use can be found in table , where  denotes the amount of cells in the direction  and  the side length. Here we pay attention that the amount of the cells is a power of two or at least has small prime factors (e.g. ) . Furthermore the cell size should not exceed the dipole interaction length of YIG of  in order to ensure that we are able to resolve the finest magnetization structures.  
 
After the geometry and the mesh are set we initialize the magnetization
with a random configuration in the case of the thin disk and already
with a vortex in the case of the big disk in order to save simulation
time. Afterwards the system is relaxed to its ground state for zero-applied
magnetic field in both cases. 
 To find the magnon modes, we apply the following general procedure
: 
Application of a particular external magnetic field and relaxation
of the system to its corresponding ground state.
Excitation of the system with a short square pulse ()
with a strength of  into the  direction.
Evaluation of the magnon mode spectrum by Fourier transforming the
time evolution of e.g. .  
In order to obtain a full mode spectrum as a function of the external
applied magnetic field, the above described procedure has to be applied
for each magnetic field separately, starting with the evolved magnetization
state of the previous B-field step. A sketch of this procedure is
found in Fig.   
Magnon spectrum - thin disk  In this case the
above approach is applied between the magnetic fields  and 
in steps of , where the system is evolved
for  (-) saving the
whole magnetization pattern each  which gives
 time steps. With this chosen time settings we make the
frequency range  to  accessible
with a frequency resolution of . The factor
of  is due to symmetry of the Fourier transformation with respect
to positive and negative values. The spectrum is shown in Fig.  (a). 
Magnon spectrum - thick disk  In this case the
excitation procedure is adopted between the external fields  and
 in steps of , where
the system is evolved for  saving the whole
magnetization each  resulting in 
time steps. With these settings we make the frequency range from 
to  accessible with a frequency
resolution of . The spectrum is shown in Fig.
 (b).  
 
 
  
Spatial dependence of the magnon modes To obtain
the spatial dependence of the magnon modes the same procedure as described
above can be applied for each particular B-field, but by using a space
dependent Fourier transformation on the magnetization components  
 
where the Fourier transformation gets applied to the time evolution
of each simulation cell separately.  
Normalization of the coupling 
In the main text we give values of optomagnonic coupling per photon per magnon. The optical field strength obtained with COMSOL has to be scaled to have an average photon number of one in the optical cavity. The photon number is obtained by dividing the total energy of the WGM, by the energy of one photon  
 
where  represents the energy of the electric field,  the energy of the magnetic field and  the eigenfrequency optical mode. Numerically this is easily obtained by a ``Global evaluation'' in COMSOL.  
In order to calculate the magnon number we need the total energy contained in the magnon mode. This can be obtained numerically by inserting
the obtained mode profile for a given mode  (see Eq. eq:FFTmag) back into MuMax and computing the energy. Since the computed magnetization profile given by Eq. eq:FFTmag is complex, we write the total energy of the mode as 
E_tot^m & =12dr[E^m(Re m(r)+m_0(r) )+E^m(Im m(r)+m_0(r) )] 
where  is the magnetic ground state (note that for  small,  is quadratic in ). The magnon number in the excited mode is obtained by  
 
where  is the eigenfrequency of the chosen magnon mode.  
The coupling Hamiltonian is quadratic in the photon operators and linear in the magnon operators. The full normalization is therefore accomplished by dividing the computed coupling by .  

Cavity Optomechanics in a Levitated Helium Drop

L. Childress

Department of Physics, Yale University, New Haven, CT, 06520, USA

Department of Physics, McGill University, 3600 Rue University, Montreal,
Quebec H3A 2T8, Canada

M. P. Schmidt

Institute for Theoretical Physics, Department of Physics, University
of Erlangen-N�rnberg, Staudtstrasse 7, 91058 Erlangen, Germany

A. D. Kashkanova

Department of Physics, Yale University, New Haven, CT, 06520, USA

C. D. Brown

Department of Physics, Yale University, New Haven, CT, 06520, USA

G. I. Harris

Department of Physics, Yale University, New Haven, CT, 06520, USA

A. Aiello

Institute for Theoretical Physics, Department of Physics, University
of Erlangen-N�rnberg, Staudtstrasse 7, 91058 Erlangen, Germany

Max Planck Institute for the Science of Light, Staudtstr. 2, 91058
Erlangen, Germany

F. Marquardt

Institute for Theoretical Physics, Department of Physics, University
of Erlangen-N�rnberg, Staudtstrasse 7, 91058 Erlangen, Germany

Max Planck Institute for the Science of Light, Staudtstr. 2, 91058
Erlangen, Germany

J. G. E. Harris

Department of Physics, Yale University, New Haven, CT, 06520, USA

Department of Applied Physics, Yale University, New Haven, CT, 06520,
USA

Yale Quantum Institute, Yale University, New Haven, CT, 06520, USA

We describe a proposal for a new type of optomechanical system based
on a drop of liquid helium that is magnetically levitated in vacuum.
In the proposed device, the drop would serve three roles: its optical
whispering gallery modes would provide the optical cavity, its surface
vibrations would constitute the mechanical element, and evaporation
of  atoms from its surface would provide continuous refrigeration.
We analyze the feasibility of such a system in light of previous experimental
demonstrations of its essential components: magnetic levitation of
mm-scale and cm-scale drops of liquid , evaporative cooling
of He droplets in vacuum, and coupling to high-quality optical whispering
gallery modes in a wide range of liquids. We find that the combination
of these features could result in a device that approaches the single-photon
strong coupling regime, due to the high optical quality factors attainable
at low temperatures. Moreover, the system offers a unique opportunity
to use optical techniques to study the motion of a superfluid that
is freely levitating in vacuum (in the case of ). Alternatively,
for a normal fluid drop of , we propose to exploit
the coupling between the drop's rotations and vibrations to perform
quantum non-demolition measurements of angular momentum.



Introduction

Optomechanical systems  have been used
to demonstrate quantum effects in the harmonic motion of macroscopic
objects over a very broad range of physical regimes. For example,
quantum optomechanical effects have been observed in the motion of
objects formed from all three states of matter (solid ,
gas , and liquid );
at temperatures ranging from cryogenic to room temperature ;
with effective mass as large as 100 nanograms ;
and with resonance frequencies ranging from kHz to GHz. Despite rapid
progress, a number of important goals in this field remain outstanding,
for example generating highly non-classical states
of motion with negative quasiprobability distributions or which violate
a Bell-type inequality (even without postselection); efficiently transferring
quantum states between microwave and optical frequencies; and observing
quantum effects in the motion of objects massive enough to constrain
theories of quantum gravity . Access
to these phenomena may be facilitated by devices with reduced optical
and mechanical loss, increased optomechanical coupling, and increased
mass. In addition, new regimes and qualitatively new forms of optomechanical
coupling may be accessed by developing systems in which the mechanical
degrees of freedom are not simply the harmonic oscillations of an
elastic body. In this work, we will show that a levitated drop of
superfluid helium will be a most promising platform that combines
many of these desired features and offers novel possibilities.

To date, most optomechanical devices are realized by using solid objects
(e.g., mirrors, waveguides, or electrical circuits) to confine modes
of the electromagnetic field, and ensuring that these confined modes
couple to the harmonic motion of a solid object. These devices' performance
is determined in part by the properties of the solids from which they
are formed. For example, the materials mechanical
and electromagnetic loss are important parameters, as is the materials
compatibility with fabrication techniques. For this reason, high-quality
dielectrics are typically employed in devices using optical fields,
while superconductors are typically employed in devices using microwave
fields. 











Most solid-based optomechanical devices must be placed in direct contact
with their solid surroundings, both to support them against Earths
gravity and to provide thermal anchoring. This contact can negatively
affect the devices performance, as it represents a
route for mechanical loss. It may also be problematic if the contact
is not able to provide effective cooling (i.e., to counteract heating
from electromagnetic absorption in the device), as elevated temperatures
tend to obscure quantum effects. 

If the mechanical element is a solid object that is levitated in vacuum
(e.g., using optical or magnetic forces) ,
the absence of direct contact can result in very low loss for some
mechanical degrees of freedom (particularly the objects
center-of-mass). However the absence of direct contact also precludes
effective cooling of the element. This is particularly important given
the non-zero optical absorption of conventional materials and the
high optical powers typically required for levitation and/or read
out of the objects motion. As a result, solid objects
levitated in vacuum have operated at elevated bulk temperatures (although
some degrees of freedom may still be cooled to very low effective
temperatures). 

In contrast to solid objects, atomic gases may be levitated and trapped
in vacuum at very low temperatures. This is due to two important features
of atomic systems: first, the gas is heated only via the atoms
spontaneous emission (which can be minimized by using laser fields
that are far detuned from the atomic transitions). Second, the atoms
can all be kept cold by laser cooling and evaporation. When a cloud
of ultracold atoms is trapped inside an optical cavity, its center-of-mass
motion (or some collective mode of the gas) can detune the cavity,
leading to an optomechanical interaction .
This interaction may be quite strong, as the small number of atoms
can be compensated by the cloud's large zero point motion and by adjusting
the detuning between the atomic transition and the cavity. Ultracold
atom-based optomechanical devices have achieved optomechanical figures
of merit and demonstrated quantum optomechanical effects that are
competitive with state-of-the-art solid-based devices. However the
effective mass of atom-based devices is likely to remain several orders
of magnitude lower than solid-based devices, making them less promising
for foundational tests.

Recently, optomechanical devices that employ liquids have been demonstrated.
These can be realized by supporting a drop of liquid 
so that its free surface confines an electromagnetic mode in the form
of an optical whispering gallery mode (WGM). In this case, the drop
serves as both the optical cavity and the mechanical element, as the
drops surface oscillations tend to detune the drops
optical WGMs. Devices based on this approach have been demonstrated
at room temperature and with the drops mechanically anchored (rather
than levitating). However, the relatively high mechanical loss in
room-temperature fluids has precluded them from accessing quantum
optomechanical effects. 

Liquid-based optomechanical devices can also be realized by filling

or coating  a solid electromagnetic cavity
with a fluid. In this case only the mechanical degree of freedom is
provided by the fluid, for example as a density wave or surface wave
that detunes the cavity by modulating the overlap between the liquid
and the cavity mode. This approach has been used at cryogenic temperatures
with superfluid  serving as the liquid .

Liquid He has a number of properties that make it appealing for optomechanical
devices. Its large bandgap (), chemical purity,
and lack of structural defects should provide exceptionally low electromagnetic
loss. In its pure superfluid state, the viscosity that strongly damps
other liquids is absent. The mechanical loss arising from its nonlinear
compressibility varies with temperature  as , and so is
strongly suppressed at low . In addition, its thermal conductivity
at cryogenic temperatures is exceptionally large. 

To date, optomechanical devices based on superfluid-filled cavities
have reaped some advantage from these features (including the observation
of quantum optomechanical effects ).
However the need to confine the superfluid within a solid vessel has
undercut many of the advantages offered by superfluid helium. This
is because direct contact between the superfluid and a solid object
provides a channel for mechanical losses (i.e., radiation of mechanical
energy from the superfluid into the solid) and heating (due to electromagnetic
absorption in the solid). 

In this paper, we propose a new type of optomechanical device that
is intended to combine advantages from each type of device described
above. Specifically, we consider a millimeter-scale drop of superfluid
He that is magnetically levitated in vacuum (Fig. ).
Magnetic levitation would provide high-quality optical WGMs and high-quality
mechanical modes by confining the optical and mechanical energy entirely
within the superfluid. Despite being levitated in vacuum, the drop
would be able to cool itself efficiently by evaporation, thereby compensating
for any residual heating. 

In addition to offering these technical improvements, this approach
would provide access to qualitatively new forms of optomechanical
coupling. A levitated drop of  in its normal state
would retain the low optical loss and efficient cooling of the superfluid
drop, but would experience viscous damping of its normal modes of
oscillation. However its rigid body rotation (which is not directly
damped by viscosity) would couple to the drops optical
WGMs. The coupling arising in such an opto-rotational
system is distinct from the usual optomechanical coupling, with important
consequences for quantum effects. 

Besides establishing a novel optomechanics platform, the proposed
system may also help address long-standing questions regarding the
physics of liquid helium. For example, a levitated drop of 
may contain a vortex line 
which deforms the drop shape and hence detunes the optical WGMs, providing
a probe of vortex dynamics. Alternately, optical measurements of a
levitated drop could probe the onset and decay of turbulence in a
system without walls. 

Most of the essential features of the proposed device have been demonstrated
previously, albeit in disparate settings. These include: the magnetic
levitation and trapping of mm-scale and cm-scale drops of superfluid
helium , the characterization
of these drops surface modes 
for ; the observation of evaporative cooling of
He drops  in vacuum, and the observation
of high-finesse optical WGMs in liquids such as ethanol 
and water  (at room temperature) and in
liquid  
(at  K). This paper uses these prior results to estimate
the optomechanical properties of a levitated drop of liquid He, including
the possible coupling to rotational motion. The discussion presented
here is relevant for both  and , except
where noted otherwise. 

Optomechanical Coupling in a Helium Drop

We begin by discussing the vibrational modes of the drop and deriving
their optomechanical coupling to the optical WGMs. Note that WGMs
in spherical (and near-spherical) dielectrics are discussed extensively
in the literature , so we
do not review their properties here. 

Vibrational modes

The vibrational modes of a helium drop can be calculated by solving
the linearized hydrodynamic equations (Fig. ).
The angular dependence of each mode is given by a spherical harmonic
 (where  and  index the mode's total
angular momentum and its projection on the -axis). The radial
dependence of each mode can be written in terms of spherical Bessel
functions  (where  is the mode's wavenumber and 
determines the number of radial nodes). The physical nature of these
modes falls into two classes:

(i) Low-frequency surface modes (ripplons), whose restoring force
is provided by surface tension. These have frequency 
 for the  degenerate modes
at any given angular mode number  , where  is the
radius of the drop,  is its density, and  is its surface
tension. For a  drop of radius , the
 mode whose optomechanical coupling we will analyze has a frequency
of  Hz .

(ii) Sound modes, whose restoring force is provided by the elastic
modulus. The frequency of these modes depends on the indices 
and  . These
include ``breathing'' modes and acoustic whispering gallery modes,
among others. Their frequencies scale with  where 
is the speed of sound in liquid He. For the example of a 
drop with , the lowest-frequency compressional mode
oscillates at  kHz. 

In the present work we focus on the surface modes, specifically the
lowest nontrivial modes (quadrupole deformations, ). These couple
most strongly to the optical WGMs.














Optomechanical Coupling to Surface Modes

The single-quantum optomechanical coupling can be found from the optical
WGM detuning produced by the surface mode's quantum zero-point fluctuation
amplitude. To calculate this amplitude, we note that the surface deflection
 can be decomposed in terms of the surface
modes as , where
 are the time-dependent mode amplitudes. The
spherical harmonics  are normalized such that .

The potential energy of the modes is determined by surface tension
. For the  modes of interest here, the increase of
surface area is given (to lowest order) by .
We note that in order to obtain this result, care needs to be taken
to preserve the volume of the drop by adjusting the radius (i.e. the
 monopole contribution to ) .
Focusing on the  mode, we then equate the average potential
energy  to half of the
zero-point energy . From this, we find
the zero-point fluctuation amplitude of the  surface mode, as
well as the change of radius at the drop's equator:




Again, for a drop of  with  mm, this is . 

Each optical WGM in the drop is specified by the indices ,
, and  (which specify the WGM's total angular
momentum, its projection along the -axis, and the number of radial
nodes, respectively). The WGM that lies closest to the drop's equator
(i.e., with ) has an optical path length that
is proportional to the drop's equatorial circumference. As a consequence,
we find  for the
bare optomechanical coupling between an equatorial optical whispering
gallery mode and the  surface mode. For 
and , this amounts to 
(see Fig. ). 

We note that the optical frequency of the equatorial WGM couples linearly
only to the surface mode with . All  vibrational surface
modes will be restricted to (considerably weaker) higher-order coupling.

Optical WGMs with arbitrary () 
also couple linearly to the  mechanical mode, with coupling
rates 




WGMs propagating near the equator (i.e., with large )
have the usual sign of the coupling (a decrease of optical frequency
on expansion), while those with small  have the opposite
sign. In a ray-optical picture, they travel along great circles passing
near the pole, and feel an overall reduction of path length when the
drop's equator expands.













The preceding discussion applies strictly to a perfectly spherical
drop. In practice, the magnetic fields used to counteract the pull
of gravity tend to distort the drop's shape .
A rotating drop will also experience distortion due to centrifugal
forces. Such distortions break the degeneracy of the optical WGMs.
Eq. (), with 
replaced by the change of radius , can also be used to
estimate the impact of this distortion on the optical WGMs. A family
of modes with any given  splits into  distinct
frequencies (as modes with given  remain degenerate),
with the frequency shift . In the case of modes
with ,  scenario and a distortion
, the originally degenerate multiplet would split
into a band with THz bandwidth, far larger than the vibrational
frequencies we consider. Indeed, the bandwidth of frequencies produced
from each  manifold would exceed the free spectral range
of the WGMs by more than an order of magnitude, meaning that optical
modes with differing  could undergo avoided crossings
for certain values of the distortion. 


Mechanical and Optical Quality Factors

Damping of mechanical modes

As described in the introduction, the combination of superfluidity
and magnetic levitation should strongly suppress some sources of mechanical
damping. Here we consider the two mechanisms which are expected to
dominate the energy loss from the mechanical modes of a 
drop. The first is due to damping by the He gas surrounding the drop,
and the second is the exchange of mechanical energy between the drop's
mechanical modes (i.e., mediated by its mechanical nonlinearity).
Both of these processes are strongly temperature-dependent.

At sufficiently high temperatures, the vapor surrounding the drop
and the thermal excitations within the drop are dense enough to be
described as hydrodynamic fluids. Experiments in this regime measured
the quality factor  of the  surface modes
for a  drop of radius  mm for  K
K . The measured 
was in good agreement with calculations based on a hydrodynamic treatment
of the three fluids (i.e., the superfluid, normal fluid, and vapor)
. Within this temperature range, 
reached a maximum value () for  K (see Fig.
). At higher , the decrease in
 is due to the higher vapor density. At lower
 the decrease in  is due to the increasing
dynamic viscosity of . 

The counterintuitive increase in viscosity with decreasing  reflects
the increasing mean free path  of the thermal phonons within
the drop. Since  is proportional to  ,
at still lower temperatures the drop will enter a new regime in which
. In this regime the hydrodynamic description fails and
 is expected to increase again. Some support
for this picture can be found in the measurements of Ref. .
For a  mm drop, this regime should occur for .













At these low temperatures, the dominant loss mechanism for the surface
waves (ripplons) is ripplon-phonon-phonon scattering, in which a thermally
excited bulk phonon scatters off the ripplon and is Doppler-shifted,
carrying away energy. This effect has been studied experimentally
and theoretically in , with a resulting
estimate for the  of a surface wave traveling
on a plane surface:




Here  is the surface mode frequency,  is its wavenumber,
is the density, and  is the sound velocity.

While our proposal focuses on mechanical modes of 
drops, for completeness we also note the mechanical losses of 
drop surface modes. For a normal-fluid  drop, one can
apply Chandrasekhar's result for the viscous damping ,
according to which .
Here  is the dynamic viscosity and  is the density. For
 1 K, where P, a 1 mm drop would have  surface
modes with , and the quality factor
would decrease approximately as 
at lower temperatures .
For  mK, a  drop would become superfluid;
however this temperature range is not likely to be accessed via the
cooling methods considered here.

Damping of optical whispering gallery modes

Light confined within a WGM may experience loss due to radiation from
the evanescent portion of the mode, scattering from surface roughness
or bulk defects, or absorption by the host material or its impurities
. Here we consider the contributions
of each of these mechanisms to the quality factor of the optical WGMs
in a levitated drop of liquid helium.

Optical WGMs have been studied in drops of several different types
of liquid. Pioneering experiments by the Chang group 
focused on WGMs in freely-falling drops of ethanol and water and found
optical  as high as . Measurements of
WGMs in suspended drops of oil show 
. Pendant drops of cryogenic liquid 
 demonstrated
.

In comparison with these materials, liquid  should offer
reduced absorption. This is because  is monoatomic (removing
the possibility of inelastic light scattering from bond stretching
or other molecular degrees of freedom), has a large gap for electronic
excitations (19 eV), and is free of chemical impurities and
surface adsorbates.

Liquid He posesses an unusally low index of refraction (),
which would lead to increased radiative loss at fixed  and .
However radiative loss from a spherical resonator decreases exponentially
 with . As a result,
even with the small refractive index of He, radiative loss becomes
negligible in mm-scale drops (see Fig. ). 

Surfaces defined by surface tension are typically very smooth. Nevertheless,
thermally excited ripplons will result in an effective surface roughness.
As described below, we expect this will be the dominant loss mechanism.
To analyze this mechanism we assume that the random thermal surface
deformation is essentially frozen during the lifetime of the optical
WGM. Furthermore, we only consider ripplon modes with wavelengths
small compared to . In this case the Fourier transform 
of the spatial correlation function of surface deflections can be
approximated by the known result for a planar surface, ,
where  is the surface tension. Adapting an analysis for planar
waveguides with a disordered surface ,
the WGM loss rate (via outscattering) is




Here  is the optical WGM's vacuum wavenumber, and 
is the dielectric constant of helium.  is the normalized
transverse mode shape (), such that ,
evaluated at the surface, is roughly the inverse extent of the mode.
Following Ref.  and considering TE
modes only, we take 
as an upper estimate, eventually obtaining 
as a lower bound for . Applying this approach to liquid
 at , with 
N/m, and  gives 
for a drop with . For , the
surface tension and the resulting  are both about 2.5 times lower.

At present there are no experiments on He drops with which to compare
this estimate. However applying this analysis to the liquid 
drops of Refs. ,
gives , i.e. it underestimates
 by roughly an order of magnitude. This may reflect
the fact that the ripplon modes evolve during the WGM lifetime, averaging
out some of the effective roughness. 



We estimate other scattering mechanisms to be significantly less important:
Brillouin scattering from thermal density fluctuations inside the
drop  should give 
> , and Raman scattering from rotons should be even weaker
(following Ref. ). 

Summary of parameters

Based on the estimates above, the most important optomechanical parameters
for a drop of  with  are summarized
in the following table (assuming  mK):


cccc

 &  &  & 


 &  &  & 


center

Notably, this system enters the previously-unexplored regime where
. While our estimate for 
gives an optical linewidth that is only 40 times larger than
the optomechanical coupling rate, the same ``frozen-deformation''
approximation underestimates the quality factor of hydrogen drops
by a factor of 20. Moreover, at lower temperatures, 
increases yet further. The levitated helium drop is thus likely to
approach the single-photon strong coupling regime. 

Evaporative Cooling

The temperature of an optomechanical device is typically set by the
competition between optical absorption (which leads to heating) and
the device's coupling to a thermal bath (which allows this heat to
be removed). For levitated solids, the heat removal process is inefficient,
as it occurs primarily via blackbody radiation, resulting in elevated
temperatures for even moderate optical power. In contrast, a levitated
liquid may also cool itself via evaporation. As described below, evaporation
provides an effective means for maintaining the drop temperature well
below 1 K. However evaporation also couples the drop's radius 
to its temperature . Since many of the device's relevant parameters
(such as the resonance frequencies and quality factors of the optical
and mechanical modes) depend on both  and  it is important
to have a quantitative model of the evaporation process.

Evaporative cooling of helium droplets has been studied both experimentally
and theoretically. Experiments to date have used m- and nm-scale
droplets that are injected into a vacuum chamber. In the ms
time before the droplets collide with the end of the vacuum chamber
they are found  to reach 
mK (150 mK) for He (He). This cooling process can be
understood by considering how energy loss  given by the
latent heat per atom () times the evaporation rate 
(atoms/sec)  leads to cooling according to the heat capacity
 of the droplet: ,
where the total number  of atoms in the drop decreases as 
Simultaneous solution of the differential equations yields the cooling
dynamics. Theoretical models valid in the low-, low- limit
have successfully explained the experiments .
They used an Arrhenius law for the evaporation rate with
 for ,
and considered only ripplon (for ) or free Fermi gas
(for ) contributions to the heat capacity of the drop. 

To model the full range of temperatures attained during cooling, and
to account for phonon contributions to the heat capacity (needed for
large- drops of ), we use primarily measurement-based
values  




 of latent heat , vapor pressure  (which determines
the evaporation rate via 
assuming unit accommodation coefficient), and specific heat .
Figure a shows the expected temperature
 for  and  drops with an initial
radius of 1 mm, cooled from 4.0 K and 2.5 K respectively. Because
 has a higher vapor pressure, it cools more effectively:
For  (), the drop temperature reaches
350 mK (200 mK) after  1 s evaporation time and
slowly cools to 290 mK (150 mK) after  1 minute.
The complete cooling process shrinks the radius of both types of drops
by about 10.

  

















In the absence of any heat load (as assumed for the simulation shown
in Fig. a),  will continue to decrease,
although over impractically long time scales. In an actual experiment
we expect a finite heat load on the drop, which will result in 
asymptoting to a finite value. The asymptotic value of  will determine
the quality factor of the optical and mechanical modes (as described
above). It will also set the (constant) rate at which  will drift
during any experiment. This drift in  will not result in any appreciable
change in the mechanical mode frequencies; however the drift in the
optical mode frequency will need to be tracked, e.g., by standard
laser-locking techniques (see Fig. b,c).

For a  drop with  1 mm, the optical drift rate
is  per Watt of dissipated power (and
is  larger for  because of the lower
binding energy and density of ). To estimate the likely
heatload on the drop, we note that Brillouin scattering in the optical
WGM  should result in absorption of 
of the incident laser power (for m). Assuming an
input power W, this would result in an optical drift rate
of only Hz/s.

Rotations

Towards Quantum Non-Demolition Measurements of Rotation

One of the unique characteristics of fluid drops, as opposed to solid
dielectric spheres, is the possibility to optically measure and possibly
even control rotations, via the deformation of the rotating drop.
Rotational motion represents a low-energy excitation that is not equivalent
to a harmonic oscillator, and so offers access to quantum phenomena
that are qualitatively distinct from those typically studied in cavity
optomechanics.

The rotational motion of  is qualitatively different
from that of . For the temperatures relevant here (),
 is a pure superfluid and so its rotation is determined
by the presence of vortices, each with quantized circulation. The
angular momentum associated with each vortex is  (where 
is the number of atoms in the drop); thus the drop's angular momentum
can only change in relatively large discrete steps. In practice, this
will ensure that the number of vortices is constant at low temperatures.
Nevertheless, a drop a with a fixed number of vortices will still
possess nontrivial dynamics owing to the vortex lines' motion.

In contrast,  is a normal fluid at these temperatures
and so may undergo rigid-body rotation. Its angular momentum can change
in very small steps of , allowing the drop's total angular
momentum to be a dynamical variable. Although  is highly
viscous at these temperatures, viscosity does not directly damp rigid
body rotation.

For both  and , the drop's rotational
motion is expected to interact with the optical WGMs primarily because
the flow field associated with the rotation will deform the drop shape,
and thereby detune the WGMs. This coupling would allow optical measurements
(i.e., of the WGM) to provide information about the drop's rotational
motion. In order to consider the quantum limits of such a measurement,
we note that the angular momentum  is connected
to the angular frequency  via the drop's moment of inertia
 (here we assume that the drop is nearly spherical).
In principle,  can be inferred from the WGM detuning
caused by the equatorial bulge (which is produced by the centrifugal
acceleration ). The radius at the equator increases
by an amount  . As described above,
the resulting shift of an optical WGM at the equator is .
We thus obtain an ``opto-rotational'' coupling Hamiltonian of the
form 




The form of this Hamiltonian allows for a QND measurement of . 

The Hamiltonian of Eq. () is a simplified
version of the real coupling, as will be explained in the next section.
However, it is sufficient for understanding the basic physics of the
opto-rotational coupling, and to estimate the feasibility of angular
momentum QND measurements.

The frequency shift  in Eq. () is
given by ,
where  is the (classical) mean value of the drop's angular
momentum and  is the bulge produced by . By balancing
pressure, centrifugal force, and surface tension we find: 




Thus, smaller drops deform less for a given angular frequency, due
to the smaller centrifugal force. However, in terms of  this
is overcompensated by the rapidly increasing ratio .
Altogether, the WGM detuning has a strong dependence on the drop radius: 




Nevertheless, it should be stressed that for typical parameters this
constant is exceedingly small. For a  drop with ,
, and ,
we have . Fortunately,
in most situations the detuning can be much larger than that. This
is because the WGM detuning scales with , meaning
that changing  by  results in a detuning 
and so can be substantially enhanced for large values of . 

In order to detect a given deviation in angular momentum ,
a phase shift  has
to be resolved by the number of photons  sent through
the drop's WGM during the time of the measurement. This implies that
the minimum detectable phase must be sufficiently small, .
More formally, the resolution is set by ,
where we have introduced the spectral density  for the angular
momentum imprecision noise. The spectral density is defined in the
usual way , with ,
where  represents the instantaneous fluctuations
of the angular momentum deduced from the observed phase shift. Taking
into account the phase-shift fluctuations produced by the shot-noise
of the laser beam, as estimated above, we find:





We briefly discuss a numerical example to illustrate the possible
experimental measurement precision. A normal 
drop spinning at  Hz (well below the hydrodynamic
instability) will have .
For  ,
this yields an optical frequency shift of 
per  of additional angular momentum. Therefore, we find .
For  of input power and for ,
one would thus have an angular momentum resolution of .
 

These numbers indicate that it will be impossible to resolve a change
of angular momentum by a single quantum . However, one should
be able to measure  (or  or ) with a precision
better than . This is the spread of  and
 in a situation with maximum , according to Heisenberg's
uncertainty relation. Indeed, for the example given above, ,
which, according to the estimated noise power , can be resolved
in . Moreover, in the case of a superfluid
 drop under identical conditions, the sensitivity
 is easily
sufficient to carefully monitor a single vortex line, which would
carry an angular momentum of 

There are three potential noise sources that may interfere with the
QND measurement of angular momentum: fluctuations in the number of
evaporating atoms leading to stochastic changes of the drop radius,
random angular momentum kicks due to evaporating atoms, and angular
momentum transfer by randomly out-scattered photons. We have estimated
all these effects (see Appendix A), and found them to be smaller than
the measurement uncertainty attained in the example given above.

Lastly, we note that in addition to the centrifugal coupling considered
above there is also the Fizeau effect, which produces a WGM detuning
 (with a different sign for clockwise and counter-clockwise
WGM modes). We estimate the single quantum coupling rate for the effect
to be  Hz for . Since
the Fizeau effect does not increase with , we expect the
centrifugal coupling to dominate.

Coupling between Vibrations and Rotations

The coupling in Eq. () is idealized in two
ways. First, it assumes that the drop strictly rotates only around
the -axis and that  are not involved
in the dynamics. Second, we have written down a direct coupling between
rotation and optical frequency. In reality, the rotation will first
lead to a deformation, i.e. a displacement of one of the surface modes,
and this deformation will then couple to the optical WGM. Conversely,
the laser's shot noise will lead to a fluctuating force acting on
the surface modes, which then couple back to the rotation. This represents
the back-action associated with the optical readout. 

In the present QND case, the back-action leads to dephasing between
different eigenstates of the angular momentum projection .
Physically, fluctuations in the circulating photon number couple to
 (via the deformation) which then scramble 
and . 

In summary, a more complete understanding of the optical measurement
of angular momentum will require a description of the coupling between
mechanical vibrations and the drop's rotations. This is also an interesting
dynamical problem in its own right, and it turns the liquid drop into
a novel coupled opto-mechanical-rotational system (Fig. a). 

The interplay between rotations, deformations and vibrations in fluid
spheres has been studied in nuclear physics (for the liquid drop model
of the nucleus ), geophysics (for rotating
planets), and hydrodynamics (for rotating drops ).
For small angular frequencies, the two most important effects are
(i) the slight deformation of the drop due to the centrifugal force
and (ii) a shift in the frequencies of the surface modes. This frequency
shift (sometimes known as Bryan's effect )
is due to the Coriolis force. It leads to a rotation of the surface
vibrations that is neither a simple co-rotation with the rotating
drop nor static in the lab frame. For the  modes of interest
here, the frequencies in the rotating frame are shifted by ,
where  is the mode index ().

Previous studies of the interplay of rotations and vibrations have
typically been limited to a fixed rotation axis or other special cases
. To move beyond
these assumptions, we have derived the full Lagrangian of the system
without any such assumptions of symmetry, for the case where only
 surface modes are excited (extensions to larger  are straightforward).
To accomplish this, we note that the surface deformation pattern 
in the laboratory frame can be decomposed into spherical harmonics.
The five deflection amplitudes  of the  surface modes,
together with the three Euler rotation angles, form the set of variables
in the Lagrangian (Appendix B). 

The Lagrangian can be derived by (i) calculating the flow field inside
the drop enforced by the time-varying deformation pattern of its surface,
(ii) integrating the resulting kinetic energy density over the volume
of the drop, and (iii) adding the potential energy from the surface
tension. This assumes an incompressible fluid whose flow field can
be understood as an irrotational flow pattern in the co-rotating frame,
produced by the surface deformation. The final result involves the
deformation variables , the angular velocity vector ,
and the Euler angles that transform between the co-rotating frame
and the lab frame. We display the slightly involved Lagrangian in
the appendix and we will publish its full derivation elsewhere.

The basic physics can be understood qualitatively by considering the
special case of a rotation around the -axis. In particular, the
kinetic energy in the Lagrangian contains the following term, beyond
the standard terms for the rigid-body rotation of a sphere and the
kinetic energies of the surface modes:




This is the term that couples the bulge mode deflection  to
the rotation around the -axis (with the moment of inertia ).
Physically, it can be read in two ways. First, spinning up the drop
creates a finite deflection proportional to , which
then leads to an optical shift, as discussed previously. Conversely,
a deflection increases the moment of inertia and thereby the rotational
energy for a given angular frequency. 

We note that for a rotating drop there also appears a set of low-frequency
modes, the so-called ``inertial modes'' .
Their frequencies scale with the rotation frequency, and they are
thus well separated from the vibrational modes we have been discussing,
as long as the rotation speed is sufficiently far below the instability
threshold for nonlinear drop deformation and fission. As a result,
we neglect them.
















As for the effective coupling between the angular momentum and the
optical frequency, we have to point out another interesting aspect
that has been omitted in the simplified model of Eq. ().
An optical whispering gallery mode traveling around the equator in
the -plane will be sensitive not only to the bulge equatorial
deformation that is generated by ; its frequency will also
be shifted by a rotation around the x-axis (or y-axis), since this
leads to an expansion of the equator in the - (or -) plane.
According to Eq. (), this frequency
shift is  of that obtained for -rotations, and has the opposite
sign. As a consequence, the operator that is really measured is expected
to be the combination .
The situation is displayed in Fig. b.

In an experiment, angular momentum will be generated by spinning up
the drop (e.g. via the application of a rotating electric field).
Such an approach will not select a single energy eigenstate with a
definite , but rather a coherent superposition of various 
(as well as of various ). The details will depend on the exact
procedure used for spinning up the drop, and in practice there will
be a thermal incoherent mixture because the experiment is conducted
at finite  with a large thermal population of vibrational and
rotational levels. The QND measurements described above would then
be able to resolve the angular momentum to some extent, thereby narrowing
its distribution via the measurement backaction.

In summary, the Lagrangian that we briefly discussed here will form
the general basis for discussions of the intricate coupled nonlinear
dynamics of vibrations and rotations in the fluid drop. Among other
things, this will enable a detailed analysis of the measurement backaction
in optical dispersive measurements of the angular momentum components.
However, exploring the rich nonlinear dynamics of this model is beyond
the scope of the present work and we leave these steps to future research. 

Outlook

The levitated helium drop offers a large number of unusual features
that represent opportunities for unconventional optomechanics and
fundamental studies of superfluid helium physics. Here we will briefly
mention some of those.

Due to the large energy of electronic transitions in helium, the drop
is expected to handle high circulating optical powers. We estimate
the optical spring effect in the drop to be  per
photon, so it should be possible to increase the drop's mechanical
frequencies by several orders of magnitude. It would remain to be
seen how the mechanical  of a given surface mode would evolve
as its frequency is increased past a large number of other mechanical
modes. At the same time, the static deflection can remain small ()
even for  circulating photons. Moreover, it would be rather
easy in this setup to reach the strong-coupling regime of linearized
optomechanics, , for 
Hz and a conservative estimate of  kHz. Thus,
using the tools of linear optomechanics ,
one could e.g. transfer nonclassical optical states into the surface
vibrational modes. Possibly, these could then be further transferred
onto the angular momentum state, generating novel optorotational control.
Alternatively, the dispersive measurement of angular momentum outlined
above can be used to generate interesting post-selected states, including
states of squeezed angular momentum.

Beyond the conventional linear optomechanical coupling, it should
also be possible to realize quadratic coupling in this setup. Indeed,
according to Eq. (), an optical
whispering-gallery mode whose plane is tilted at a particular angle
will have vanishing linear coupling to the equatorial bulge mode (,
), while the optical WGM in the equatorial plane itself has
no linear coupling to the  mechanical modes.

In the present manuscript, we have entirely focussed on the lowest-order
surface vibration modes at . However, one can imagine generating
interesting multimode optomechanics when addressing the higher-order
modes as well. The collective optical spring effect will be able to
generate an effective light-induced interaction between those modes,
which can get so strong as to form completely new normal modes. Moreover,
one can imagine exploiting transitions between optical modes of different
radial and angular momentum quantum numbers. These transitions will
then couple efficiently to higher  mechanical modes, e.g. acoustic
whispering gallery modes, leading to Brillouin-like optomechanical
interactions .

When a drop's surface deformations or rotation rate become sufficiently
large, a variety of nonlinear effects are expected to occur. It is
known that a rotating drop can develop symmetry-broken shapes ,
but many questions remain open. For example, is it possible to obtain
stable drops with non-zero topological genus ?

Finally, the optical control and readout can serve as a completely
novel means to study the physics of superfluid helium in a setting
that is devoid of any complications arising from solid surfaces. For
example, at low temperatures, the damping of surface waves (ripplons)
is due to ripplon-phonon scattering. However, due to the finite size
of the drop, the bulk phonons inside the drop constitute a bath with
a very strongly frequency-dependent force noise spectrum and strongly
non-Markovian properties. These might be studied quantitatively, especially
using the optical spring effect as a tool to vary the ripplons' frequency.

Rotation in the superfluid drop is quantized and vortex lines emerge
as the drop is made to spin above a certain rotation rate .
Below that rate, the drop's angular momentum must be contained either
in surface modes or in the normal fluid (phonons propagating in the
bulk). The presence and the motion of the vortex lines then affects
the surface deformation, and this will be readily measurable optically.
Even a single vortex line is not inert. It can wiggle, and these vibrations
of the string-like vortex (known as Kelvin modes) could also be read
out via their effect on the optical WGM, providing a means for measuring
the mechanical properties of an isolated vortex line .
Moreover, one could investigate the interactions of many vortices
as well as quenches through phase transitions, e.g. observing Kibble-Zurek
type physics upon cooling a spinning drop. In general, optomechanics
in levitated helium drops may become a new tool enabling us to explore
a whole range of physical phenomena that are analogues to effects
in high-energy physics and cosmology .

Acknowledgments

F. M., M.S., and A. A. acknowledge support through an ERC Starting
Grant (``OPTOMECH''), as well as the European FET proactive network
``Hybrid Optomechanical Technologies''.













Appendix A: Noise sources for the QND measurement of angular momentum

There are three noise sources that may potentially interfere with
the QND measurement of the drop's angular momentum. 

The first is due to the fact that the evaporation of atoms is a stochastic
process. When  atoms evaporate on average during a given time
interval, that number actually fluctuates by , leading
to corresponding fluctuations in the drop radius and the optical resonance.
The effect diminishes as the temperature decreases and the evaporation
rate slows. The relevant rates can be extracted from Fig. .
After 1000 s of evaporation, a  drop reaches 
K with  nW of cooling power. This corresponds to 
atoms evaporating per second, with a resulting deterministic drift
of the optical resonance of  MHz/s. In Section III.A we considered
a measurement time of 0.1 , which is sufficiently long
to resolve an angular momentum spread of the order of the Heisenberg
uncertainty, . During this time, the number of evaporated
atoms fluctuates only by about , leading to a negligible
stochastic optical shift of  Hz. 

The second noise source is directly connected to the same physics:
the evaporating atoms will also carry away angular momentum. For ,
a single atom flying off with the mean thermal velocity can extract
 from a droplet of radius  mm. Staying with
the example considered in the previous paragraph, in 
this results in a stochastic contribution to  of ,
much smaller than the  measurement resolution mentioned
above.

Finally, the third noise source is present even in the absence of
evaporation. It consists of changes in the drop's angular momentum
due to the scattering of photons. Each randomly scattered photon can
carry away angular momentum , which amounts to
about 6000 . Assuming an input power of 10 
and that 10 of the photons are scattered stochastically in random
directions (e.g. from the thermal surface fluctuations), this process
would result in a stochastic angular momentum transfer (during a 0.1
 measurement time) of , well
below the measurement uncertainty. 

Appendix B: Lagrangian for the coupling of rotations to the 
vibrations in an incompressible fluid drop

The purpose of this appendix is to display the full Lagrangian describing
the coupling between arbitrary rotations and the vibrational 
surface modes of the drop. To that end, we have to introduce a number
of definitions. The derivation of this Lagrangian will be discussed
in a separate publication (see also the thesis ).

For brevity, it is convenient from now on to measure lengths in units
of the sphere radius (such that ). Appropriate dimensions can
be re-instated later, if needed. The surface deformation pattern in
the laboratory frame is given by




where  resides on the surface ().
The  are based on the  spherical harmonics,
. They have been
extended to cover all of space, which will simplify the notation further
below. More precisely, we have defined ,
, and ;
where the constants are , ,
and . The surface integrals are
normalized, 
for = 1.

To write down the Lagrangian, we need to convert between the lab frame
and the co-rotating frame (described by a set of three Euler angles
which we sometimes combine into a three-vector ).
We assume that the transformation is effected by a suitable 
matrix , with , or explicitly:




Upon rotation of the drop by the angular frequency vector 
(which is expressed in the lab frame), the matrix  changes according
to




or  in matrix
notation. This relation defines the generators  that
describe infinitesimal rotations. The generator  for rotations
around the -axis is the simplest one, with .
Finally, we introduce the notation ,
and . With these definitions, we are
now in a position to write down the full Lagrangian that couples vibrations
and rotation:





Summation over repeated indices is implied. This Lagrangian contains,
in this order: (i) the rotational energy of the unperturbed spherical
drop, (ii) the kinetic energy of the surface vibrations, (iii) the
change in the rotational energy due to the deformation (with the surface
deformation field  evaluated at the angular momentum vector),
(iv) the term describing Bryan's effect (from the Coriolis force),
(v) the potential energy of the surface vibrations (due to the surface
tension). We note that all the deformation-related quantities (,
, and ) have to be expressed via 
for the purpose of deriving the equations of motion. We also note
that the  coefficients obey the constraint 
due to the fact that the surface deformation is real-valued. In deriving
the equations of motion, one can either split 
into real and imaginary parts (for ) or, more efficiently, formally
treat  and  as independent
variables.

 
List of Videos
textcolor     
     
    
    
Topological phase transitions and chiral inelastic transport
 induced by the squeezing of light 
Vittorio Peano
Institute for Theoretical Physics, University of Erlangen-Nurnberg,  Staudtstr. 7, 91058 Erlangen, Germany 
Martin Houde
Department of Physics, McGill University, 3600 rue University, Montreal, Quebec, H3A 2T8, Canada 
Christian Brendel 
Institute for Theoretical Physics, University of Erlangen-Nurnberg,  Staudtstr. 7, 91058 Erlangen, Germany 
Florian Marquardt
Institute for Theoretical Physics, University of Erlangen-Nurnberg,  Staudtstr. 7, 91058 Erlangen, Germany
Max Planck Institute for the Science of Light, Gunther-Scharowsky-Strasse 1/Bau 24, 91058 Erlangen, Germany 
Aashish A. Clerk
Department of Physics, McGill University, 3600 rue University, Montreal, Quebec, H3A 2T8, Canada   
We show how  the squeezing of light can lead to the formation of  topological states.   Such states are characterized by non-trivial
Chern numbers, and exhibit protected edge modes which give rise to chiral elastic and inelastic photon transport.  These  topological bosonic states  are not equivalent to their fermionic (topological superconductor) counterparts and  cannot be mapped by a local transformation onto  topological states found in particle-conserving models.  They thus represent a new  type of topological system.  We study this physics in detail in the case of a Kagome lattice model, and discuss possible realizations using nonlinear photonic crystals or superconducting circuits.  
fill in  
Introduction  
There has been enormous interest in
trying to replicate the physics of topological electronic phases in a variety of 
bosonic systems, including  cold atoms , photonic systems  and more recently phononic systems .  
Photonic analogues include quantum-Hall like states
induced through the introduction of synthetic gauge fields ,
 phases which are analogous to time-reversal invariant topological
insulators , Floquet topological insulators  and even Majorana-like modes .
Experimental studies of such phases have made significant progress
.    
In addition to being of fundamental interest, these topological
photonic and phononic phases could have practical utility, as they
provide disorder-protected edge modes that could be used for chiral
light and sound propagation.  
Despite this intense activity, most works on topological bosonic states amount in the end
to replicating a well-known fermionic single-particle Hamiltonian
with bosons; as the topological properties are a function of the resulting
single-particle eigenstates, particle statistics play no crucial role,
except perhaps in the methods used for probing the system. As we now discuss, this simple
correspondence will fail if the particle number is not conserved.   
Consider the most general quadratic Hamiltonian describing bosons on a lattice which respects the discrete translational invariance of the lattice, but which does not conserve particle number:   
The first term describes a non-interacting band-structure, where  runs over momenta in the first Brillouin zone, and  labels the bands.  The remaining terms correspond to parametric driving or two-mode squeezing terms.  
As we discuss below, they can be controllably realized in a number of different settings, with the  operators describing "real" particles 
(i.e. photons in a cavity lattice), and not quasiparticles defined above some effective condensate.
While superficially similar to pairing terms in a superconductor, these two-mode squeezing terms have a profoundly different effect in a bosonic system, as there is no limit to the occupancy of a particular single-particle state.  They can give rise to highly entangled ground states, and even to instabilities.    
    
Given these differences, it is natural to ask how anomalous "pairing" terms can directly lead to topological bosonic phases.  In this work, we study the topological properties of 2D systems described by Eq. (), in the case where the underlying particle-conserving band structure has no topological structure, and where the parametric driving terms do not make the system unstable.  We show that the introduction of  particle non-conserving terms can break time-reversal symmetry (TRS) in a manner that is distinct from having introduced a synthetic gauge field, and can lead to the formation of bands having a non-trivial pattern of (suitably defined) quantized Chern numbers.  
This in turn leads to the formation of protected chiral edge modes: unlike the particle conserving case, these modes can mediate a protected inelastic scattering mechanism along the edge (i.e. a probe field injected into the edge of the sample will travel along the edge, but emerge at a different frequency).  In general, the topological phases we find here are distinct both from those obtained in the particle-conserving case, and from those found in topological superconductors.   
We also discuss possible realizations of this model using a nonlinear photonic crystal or superconducting microwave circuits. 
Note that recent works have explored topological features of bosonic quasiparticles in condensed phases; interactions with the condensate treated at the mean-field level yield a Hamiltonian having the general form of Eq. (). These include a study of a magnonic crystal , as well as general Bose-Einstein condensates in 1D   and in 2D . Unlike our work, these studies did not explore the general role that tunable squeezing terms play in 
yielding topological states.  Further, in our case Eq. (1) describes the "real" particles of our system, not quasiparticles defined above some background; this makes detection and potential applications much easier.   Most importantly, the topologically-protected inelastic scattering we describe is absent in those different settings.  
Results 
Kagome lattice model 
For concreteness, we start with a system of bosons on a kagome lattice (see Fig.),   
(we set ). Here, we denote by   the photon annihilation operator  associated with lattice site , where the 
vector site index has the form .   labels a particular unit cell of the lattice, while the index  labels the element of the sublattice.   indicates the sum over nearest neighbors,
and  is the (real valued) nearest neighbor hopping rate;  plays the role of an on-site energy.  As there are no phases associated with the hopping terms, this Hamiltonian is time-reversal symmetric and topologically trivial.  We chose the kagome lattice because it is directly realizable both in quantum optomechanics  and in arrays of superconducting cavity arrays ; it is also the simplest model where purely local parametric driving can result in a topological phase.    
We next introduce quadratic squeezing terms to this Hamiltonian that preserve the translational symmetry of the lattice and that are no more non-local than our original, nearest-neighbor hopping Hamiltonian:   
    
Such terms generically arise from having a nonlinear interaction with a driven auxiliary pump mode on each site (which can be treated classically).  As we discuss below, the variation in phases in  from site to site could be achieved by a corresponding variation of the driving phase of the pump.  Note that 
we are working in a rotating frame where this interaction is time-independent, and thus  should be interpreted as the detuning
between the parametric driving and the true on-site (cavity) frequency  (i.e. , where the parametric driving is at a frequency ). The parametric driving can cause the system to become unstable; we will thus require that the on-site energy  is always sufficiently large that each parametric driving term is sufficiently non-resonant to ensure stability.   
For a generic choice of phases in the parametric driving Hamiltonian of Eq. (), it is no longer possible to find a gauge where  is purely real when expressed in terms of real-space annihilation operators:  hence, even though the hopping Hamiltonian  corresponds to strictly zero flux, the parametric driving can itself break TRS.  
In what follows, we will focus for simplicity on situations where time-reversal and particle-conservation are the only symmetries broken by the parametric driving:  they will maintain the inversion and  rotational symmetry of the kagome lattice.  We will also make a global gauge transformation so that  is purely real, while .  In this case, the only possible choices for the  phases have the form  with   
,  is an integer and is the vorticity of the parametric pumps.   
     
*  
Gap opening and non-trivial topology
 is the standard tight-binding kagome Hamiltonian for zero magnetic field, and does not have band gaps:
the upper and middle bands touch at the symmetry point , whereas the middle and lower
bands touch at the symmetry points  and  where they form Dirac cones [see Fig. (a)].   
Turning on the pairing terms, the Hamiltonian  can be diagonalized in the standard manner 
as , where
the  are canonical bosonic annihilation operators determined by a Bogoliubov transformation of the form (see Appendix  for details):   
Here,  are the annihilation operators in quasi-momentum space, and 
  is a band index; we count the bands by increasing energy. 
The photonic single-particle spectral function now shows resonances at both positive and negative frequencies, , corresponding to ``particle''- and ``hole''-type bands, see Fig. (d).
 Because of the TRS breaking induced by the squeezing terms, the band structure described by  now exhibits gaps, see  Fig. (b); further, for a finite sized system, one also finds edge modes in the gap, see Fig. (d).   
The above behaviour suggests that the parametric terms have induced a non-trivial topological structure in the wavefunctions of the band eigenstates.  To quantify this, we first need to properly identify the Berry phase associated with a bosonic 
band eigenstate in the presence of particle non-conserving terms.
For each , the Bloch Hamiltonian  corresponds to the Hamiltonian of a multi-mode parametric amplifier.  Unlike the particle-conserving case, the ground state of such a Hamiltonian is a multi-mode squeezed state with non-zero photon number; it can thus have a non-trivial Berry's phase associated with it when  is varied, see Appendix .  The Berry phase of interest for us will be the difference of this ground state Berry phase and that associated with a single quasiparticle excitation.  One finds that the resulting Berry connection takes the form   
Here,  the -vector of Bogoliubov coefficients  plays the role of a singe-particle wavefunction,  and  acts in the 'particle-hole-space', associating  to the -components and  to the -components,  see Appendix  for details. 
These effective wavefunctions obey the symplectic normalization condition 
k,n   _z    k',n'  
	& =  _s
	 	 u_n,^*[s]  u_n',-
	 	 v_n,^*[s]  v_n',
		  
	& = _,_n,n'
	  
Having identified the appropriate Berry connection for a band eigenstate, 
the Chern number for a band  
is then defined in the usual manner:   
This definition agrees with that presented in Ref.  and (in 1D) Ref. ; standard arguments
 show that the  are integers with
the usual properties.  We note that, as for superconductors, breaking the   (particle-conservation) symmetry remains compatible with a first-quantized picture after doubling  the number of bands. The additional 'hole' bands  are connected to the standard 'particle' bands  by a particle-hole symmetry;  see Appendix .  In bosonic systems, the requirement of stability implies that particle and hole bands can not touch. Thus,
the sum of the Chern numbers over the particle bands (with ) must be zero, and  there cannot be any edge states with energies below the lowest particle bulk band (or in particular, at zero energy); see Appendix .   
In the special case where we only have onsite parametric driving (i.e. ), the Chern numbers can be calculated
analytically (see Appendix ).   They  are uniquely fixed by the pump vorticity.  If , we have TRS and the band structure is gapless, while for , .  This set of  topological phases also occurs in a particle-number conserving model on the kagome lattice with a staggered magnetic field, i.e. the Oghushi-Murakami-Nagaosa (OMN) model of the anomalous quantum Hall effect .  
In the general case, including offsite parametric driving, entirely new phases appear. We have computed the Chern numbers for that case numerically, using the approach of Ref. .  In Fig. (a), we show the topological phase diagram of our system, where  and  
are held fixed, while the parametric drive strengths  are varied.   Different colors correspond to different triplets  of the band Chern numbers, with gray and dark-gray corresponding to the two phases already present in the OMN model.   
Strikingly, a finite  off-diagonal coupling   generates a  
large variety of phases which are not present in the OMN model. The border between different topological
phases represent topological phase transitions, and correspond to parameter values where a pair of bands touch at a particular
symmetry point; we discuss this further below.      
Effective model   
To gain further insight into the structure of the topological phases found above, it is useful to work in a ``dressed-state" basis that eliminates the local parametric driving terms from our Hamiltonian.  We thus
first diagonalize the purely local terms in the Hamiltonian; for each lattice site  we have   
Here , and the annihilation operators  are given by a local Bogoliubov (squeezing) transformation 
, where the squeezing factor  is  
On a physical level, the local parametric driving terms attempt to drive each site into a squeezed vacuum state with squeeze parameter ; the  quasiparticles correspond to excitations above this reference state.  Note that we have included an overall phase factor in the definition of the  which will simplify the final form of the full Hamiltonian. 
In this new basis of local quasiparticles, our full Hamiltonian takes the form   
The transformation has mixed the hopping terms with the non-local parametric terms: The effective counter-clockwise hopping matrix element is 
	J_jl & = 
		J e^i  +  
			&  e^3i / 2 [
			2 J (2 ) ^2r  +
			2r (2+_) ],  
and the magnitude of the effective non-local parametric driving is 
	  = 
		 & 
			e^-i(/2+_)  + 
			  2(/2+_)  ^2 r 
		&+ J 2r(/2) . 
Note that the phase of  can be eliminated by a global gauge transformation, and hence it plays no role; we thus take  to be real in what follows. 
Our model takes on a much simpler form in the new basis:  the onsite parametric driving is gone, and the non-local parametric driving is real.  Most crucially, the effective hoppings now can have spatially-varying phases, which depend both on the vorticity of the parametric driving in   (through ), and  the magnitude of the on-site squeezing (through ).  In this transformed basis, the effective hopping phases are the only route to breaking TRS. If the parametric terms were not present, the complex phases would correspond in the usual manner to a synthetic gauge field 
(i.e. the effective flux  piercing a triangular plaquette would be ).  
Our model has thus been mapped on to the standard OMN model for the anomalous quantum Hall effect, with an additional (purely real) nearest-neighbour two-mode squeezing interaction. However, we note that strictly speaking   can not be interpreted as a flux in the presence of the additional parametric terms: a 'flux' of  can not be anymore eliminated by a gauge transformation because the complex phases  
reappear in the parametric terms. In that case, only a periodicity of  in  is retained, since that corresponds to having trivial hopping phases of .  
Understanding the topological structure of this transformed Hamiltonian is completely sufficient for our purposes:  one can easily show that the Chern number of a band is invariant under any local Bogoliubov transformation, hence the Chern numbers obtained from the transformed Hamiltonian in 
Eq. () will coincide exactly with those obtained from the original Hamiltonian in Eq. ().  We thus see that the topological structure of our system is controlled completely through only three dimensionless parameters:  the 'flux'  associated with the hopping phase, the ratio  and the ratio .    
The topological phase diagram for the effective model is shown in Fig. (b).
Again, one sees that as soon as the effective non-local parametric drive  is non-zero, topological phases distinct from the standard (particle-conserving) OMN model are possible. The sign of the parametric pump vorticity  determines the sign of the effective flux , c.f.  Eq. .  As such, 
the right half of Fig. (b) (corresponding to ) is a deformed version of the phase diagram of the original model for pump vorticity , as plotted in Fig. (a).  Changing the sign of  (and hence ) simply flips the sign of all Chern numbers, see Appendix .    
Our effective model provides a more direct means for understanding the boundaries between different topological phases.  Most of these are associated
with the crossing of bands at one or more high-symmetry points in the Brillouin zone; this allows an analytic calculation of the phase boundary (see Appendix ).  Perhaps most striking in Fig. (b) is the horizontal boundary (labelled ), occurring at a finite value of the effective offsite parametric drive, .
This boundary is set by the closing of a band gap at the  points; as these points are associated with the decoupling of one sublattice from the other two, this boundary is insensitive to the flux .  Similarly, the vertical line labeled  denotes a line where the system has TRS, and all bands cross at 
the symmetry points ,  and .  The case of zero pump vorticity  (not shown) is also interesting.  Here, the effective flux  depends on the strength of the parametric drivings, but is always constrained to be  or .  This implies that the effective Hamiltonian has TRS, even though the original Hamiltonian may not (i.e.  if , the original Hamiltonian does not have TRS).  For ,  the parametric drivings do not open any band gap and the Chern numbers are not well defined.   
Edge states and transport  
Despite their modified definition, the Chern numbers associated with our Bogoliubov bands still guarantee the existence of protected chiral edge modes in a system with boundaries via a standard bulk-boundary correspondence, see Appendix .  These states can be used to transport photons, by exciting them with an auxiliary probe laser beam which is focused on an edge site and at the correct frequency. The lack of particle-number conservation manifests itself directly in the properties of the edge states:  along with the standard  elastic transmission they can also mediate  inelastic scattering processes. In terms of the original lab frame, light injected at a frequency  can emerge on the edge at frequency   where  is the frequency of the laser   parametrically driving the system. This is analogous to  the idler output of a parametric amplifier. Here, both signal and idler  have a topologically protected chirality.  
Shown in Fig.  are the results of a linear response calculation describing such an experiment, applied to a finite system with corners. We incorporate a finite photon decay rate  in the standard input-output formalism, see Appendix  for details.  Narrow-band probe light  inside a topological band gap is applied to a site on the edge, and the resulting inelastic transmission probabilities to each site on the lattice are plotted, see  Fig. (a). One clearly sees that the probe light is transmitted in a uni-directional way along the edge of the sample, and is even able to turn the corner without significant backscatter. The corresponding elastic transmission [not shown] is also chiral and shows the same spatial dependence. In Fig. (b) we show the  elastic and inelastic transmittions  to the sites  indicated in red  (rescaled by the overall transmission,  where  is the reflection probability at the injection site) as a function of the probe frequency . By scanning the laser probe frequency one can separately address particle and hole band gaps. The relative intensity of the inelastic scattering component is highly enhanced  when the probe beam is inside a hole band gap, see also the sketches in Fig. (c-d). 
 When the parametric interaction between the  quasiparticles is negligible, the ratio of elastic and inelastic 
transmissions  depends only on the squeezing factor , [c. f. Eq. ()], see Appendix .      
Physical realization  
Systems of this type could be
implemented in 2D photonic crystal coupled cavity arrays fabricated
from nonlinear optical  materials . The array of optical
modes participating in the transport would be supplemented by pump
modes (resonant with the pump laser at twice the frequency). One type
of pump mode could be engineered to be spatially co-localized with
the transport modes ( processes), while others could
be located in-between (). The required periodic
phase pattern of the pump laser can be implemented using spatial light
modulators or a suitable superposition of several laser beams impinging
on the plane of the crystal. Optomechanical systems offer another
route towards generating optical squeezing terms ,
via the mechanically induced Kerr interaction, and this could be exploited
to create an optomechanical array with a photon Hamiltonian of the
type discussed here. Alternatively, these systems can be driven by
two laser beams to create phononic squeezing terms . A fourth
alternative consists in superconducting microwave circuits of coupled
resonators, where Josephson junctions can be embedded to introduce
 and higher-order nonlinearities, as demonstrated in .  
Conclusions and Outlook  
In this work, we have shown how tunable squeezing interactions in a photonic system are flexible tools that allow the creation of new kinds of 
topological bosonic phases.  We further demonstrated that the protected edge channels supported by such phases allow uni-directional elastic and inelastic coherent photon transport.  Our work opens the door to a number of interesting new directions.  On the more practical side, one could attempt to exploit the unique edge states in our system to facilitate directional, quantum-limited amplification.  On the more fundamental level, one could use insights from the corresponding disorder problem  and attempt to develop a full characterization of particle non-conserving bosonic topological states that are described by quadratic Hamiltonians.  This would then be a counterpart to the classification already developed for fermionic systems .   
VP, CB, and FM acknowledge support by an ERC Starting Grant OPTOMECH, by the DARPA project ORCHID, and by the European Marie-Curie ITN network cQOM. MH and AC acknowledge support from NSERC.    
Details of the calculation of the band structure 
Bogoliubov transformation and first-quantized picture
Here, we show how to find the Bogoliubov transformation Eq. () which diagonalizes the Hamiltonian  defined
in Eqs. (,). It is convenient to switch to a first quantized picture
by casting the second quantized Hamiltonian  in the form   
where 
and  is the Bogoliubov de Gennes Hamiltonian. By plugging the Bogoliubov ansatz Eq. () into the Heisenberg equation of motion for the normal modes ladder operators
,  
one immediately finds the generalized eigenvalue problem   
Here, the matrix  is (minus) the identity for the (hole) particle
sector,   
The bosonic quadratic Hamiltonian  describes the dynamics linearized around a  stable classical solution if it is possible to find
its  normal mode decomposition.  In other words, for all  the eigenvalue problem Eq. () should have a set of
three orthonormal (particle-like) solutions, c. f. Eq. (). A sufficient and necessary criterion for stability is that
 all eigenvalues of  are real, see discussion below. 
Particle-hole symmetry
The symplectic eigenvalue problem ()
has an embedded particle-hole symmetry: for any  particle-like
solution with momentum , energy ,
and wavefunction  there is a
hole-like solution with momentum , 
energy , and wavefunction  
(notice that the hole-like solutions have negative length ).
Here, operator  gives the complex conjugate of the wavefunction
and  exchanges particles and holes,    
In other words, the Bogoliubov de Gennes Hamiltonian has the generalized
symmetry 
where the charge conjugation operator  is anti-unitary
and . Thus, our system represents the Bosonic
analogue of a superconductor in the Class  of the standard topological
classification. 
Numerical calculation of the band structure 
From Eqs. (,) one can immediately derive the explicit
expression of the Bogoliubov de Gennes Hamiltonian   
where  ( is the pump vorticity).
The matrices  and  are single-particle
operators acting on the sub-lattice degrees of freedom. They have
matrix elements: ,    
 where , ,
and  are lattice vectors. All other
matrix elements are zero. Notice that  raises the
quasi-angular momentum by one unit: 
where  and
likewise for the holes. Here,  is the vortex free eigenstate,
 has a vortex, and  an anti-vortex ( is defined modulo
). Thus, a hole with quasimomentum  is converted into a particle
with quasi-angular momentum . In other words, a pair of
down-converted photons have quasi-angular momenta  and ,
respectively. The additional quasimomentum  is provided
by the pump photons. In order to write the off-diagonal parametric interaction compactly in terms of the quasi-angular momentum raising operator   we have introduced the rescaled off-diagonal parametric coupling  for pump vorticity  and  for pump vorticity . 
For the effective model Eq. () the Bogoliubov de
Gennes Hamiltonian reads    
Here, we have introduced the hopping matrix 
in the presence of the synthetic magnetic field flux . It has
the following non zero matrix elements:  
. 
In the most general case, we calculate the band structure and the single-particle wavefunctions  by diagonalizing the  matrix 
numerically. 
Analytical calculation of the band structure close to the symmetry points  
One can gain much insight on the array dynamics, including the
stability requirements and  the array  topology, by calculating analytically the band strucure 
at the symmetry points. This is a particularly easy task at the rotational
symmetry points , , and . There, the hopping matrix
 is diagonal in the basis of the quasi-angular momentum
eigenstates. Thus, in this basis the Hamiltonian becomes block diagonal
with -dimensional blocks. Each block is described by a two-mode
squeezing Hamiltonian, except for the quasi-momentum 
and , when it is a single mode squeezing Hamiltonian   
*
where  is the creation operator
of an excitation with quasimomentum  ()
and quasi-angular momentum . Moreover,  indicates the
corresponding eigenvalue of the hopping matrix : ,
,
 By diagonalizing
the squeezing Hamiltonian we find the general expression for the eigenvalues  
From an analogous calculation we obtain the spectrum of the effective
model at the rotation symmetry points   
where  are the eigenvalues of
: ,
, ,
, .   
Stability analysis  
The system is stable when all eigenvalues of 
are real. If all eigenenergies of the unperturbed Hamiltonian 
have the same sign the parametric interaction is off-resonant and
the system is stable if the parametric couplings are below a finite
threshold. On the contrary, if the unperturbed band touches the zero-energy
axis, the parametric interaction is resonant for the zero energy modes
leading to an instability for any arbitrarily small value of the coupling. Thus,
the parametric instability sets an upper limit to the hopping .
For concreteness, we consider a positive onsite energy 
(corresponding to a red detuned drive). In this case, all eigenenergies
of  are positive if . In this case,
the system is stable for sufficiently small values of the parametric
couplings  and  Nevertheless,
the threshold of an instability is reached as soon as the lowest eigenenergy
of a particle-type band becomes zero for a finite value of the parametric
couplings  and  For the parameters
of Fig.   the lowest band touches the zero energy
axis at the  point. Thus, we can find an analytical expression
for the instability threshold using the solutions at the rotational
symmetry points Eqs. (,).
In Fig. 3(a) the state with zero energy at the border of the unstable
region has zero quasimomentum and an anti-vortex. Thus, the instability threshold is given by setting .
In Fig. 3(b) the state with zero energy has zero quasi-momentum and
quasi-angular momentum. By setting , we
find a simple expression for the instability threshold,   
Details of the definition and properties of the symplectic Chern number 
Berry phase of a Bogoliubov quasi-particle 
For an excitation conserving Hamiltonian, the Chern number of the
-th band can be viewed as a sum of Berry phases accumulated on
a set of closed loops covering the whole Brillouin zone. In this case,
the state which accumulates the relevant Berry phase is the -th
eigenstate of the single-particle Hamiltonian 
(a block with quasimomentum  of the single-particle Hamiltonian
). Below, we show that one can naturally extend this definition
of the Chern number to any bosonic Hamiltonian including anomalous
terms by identifying the relevant Berry phase in a second-quantized
setting. 
For each quasi-momentum , the second-quantized block   
of the full bosonic Hamiltonian  is a six-mode squeezing
Hamiltonian. If we regard the quasi-momentum  as an external
parameter, we can ask ourself what is the additional Berry phase accumulated
by a single Bogoliubov quasi-particle in a specific band  while
the quasi-momentum is varied adiabatically over a closed loop.  In
other words, we calculate the Berry phase accumulated by the many-body
state  where 
is the Bogoliubov vacuum. We find    
*
In the second line we have used that 
(by definition of the vacuum). We note that the Bogoliubov vacuum
 is quasi-momentum dependend and could possibly accumulate
a Berry phase by its own, .
However, the Berry phase of interest is the additional Berry phase
accumulated by the quasi-particle added over the Bogoliubov vacuum. 
Properties of the symplectic Chern numbers 
Taking into account the orthonormality condition Eq. (), one can immediately prove that the Chern numbers have the usual
properties: (i) They are integer numbers; (ii) After a phase transition
where two or more bands touch the individual Chern number of the band
involved in the crossings may change but their sum does not change.
Since the crossing of a particle and hole band lead to an instability
rather than a phase transition, the sum of the Chern numbers over
the particle bands is zero.   
Details of the calculation of the topological phase diagrams   
Symmetry of the topological phase diagram  under synthetic magnetic field inversion
In the topological phase diagram of Fig. (b) all Chern numbers change sign if the direction of the synthetic gauge field
is inverted, . This has a simple explanation: To change the sign of the flux  and of the quasimomentum  corresponds to taking the complex conjugate of the BdG Hamiltonian in momentum space, , c.f. Eq. . It follows that the single-particle eigenfunctions for opposite values of the flux and of the quasi-momentum are also related by complex conjugation, . From the definition of the Chern numbers, c. f. Eq. , it immediately follows that the Chern numbers change sign under inversion of the synthetic gauge field .
Border of the different topological phases 
At a border of a topological phase transition a pair of Chern numbers
can change their values because the corresponding bands touch. Generally
speaking bands tend to repel each other rather than crossing. However,
at a lattice symmetry point this phenomenon does not necessarily occur
because the interaction of a pair of bands can be prevented by a selection
rule. In particular, at the rotational symmetry points , ,
and , a hole with quasi-angular momentum  can only be
converted into a particle with quasi-angular momentum .
We note that due to inversion symmetry the bands must touch simultaneously
at the symmetry points  and . We refer to the set of parameters
where the bands touch at the symmetry points  and  ()
as -lines (-lines). When also time-reversal symmetry
is present there is band crossing at all rotational symmetry points.
We refer to the set of parameters where time-reversal symmetry occurs
as -lines. In addition, a pair of bands can touch at one
of the three  points where one sublattice is decoupled from the
remaining two sublattices (a particle or hole on that sublattice can
not hop on the remaining sublattices). We note that due to rotational
symmetry a pair of bands should touch simultaneously at all three
 points. We refer to the set of parameters where a pair of bands touch
at the  points as -lines.  
In our highly symmetric system, we expect most of the crossings to
occur at a symmetry point. However, we note that accidental crossings
away from any symmetry point are not forbidden. Indeed most (but not
all) borders of the different topological phases in Fig. 2 can be
identified with -lines, -lines, -lines, or
-lines as explained below.  
We first focus on the effective model. The vertical lines 
are -lines (there is time-reversal symmetry because the
hopping amplitude  is real). One can also easily recognize
the -lines because they are horizontal. This must be the case
because the spectrum at a -point where a sublattice decouples
from the remaining sublattices does not depend on the flux .
Indeed, there is such a horizontal line in the phase diagram of Fig.
2(b). We note that it appears for .
Below, we show that this analytical expression holds when the 
quasi-particles are described by an effective particle-conserving
Hamiltonian. We can also find an analytical expression for the -line
and the -lines as explained below. 
We initially focus on the -lines.  We regard the band crossing
condition of a pair of levels with quasi-angular momentum  and
,  as an implicit
equation for the parametric coupling  as a function
of the flux . We take advantage of the analytical expression
for the spectrum at the rotational symmetry points Eq. ()
to solve this equation. For  and , we find exactly one
real positive solution   
*
in the intervals  and .
Keeping in mind that the phase diagram is periodic with period ,
this solution can be thought of as a single -line which goes
(for increasing flux) from  at  back to
 at  (). Indeed, such a line
is visible in the phase diagram of Fig. 2(b). From the implicit equations
, 
one can find similar formulas for the remaining -line and
the -lines. In particular, the other -line corresponds
to the crossings of the levels with angular-momentum  and 
and goes from  at  back to 
at  (), see also Fig. 2(b). There is not
a third -line because the levels with quasi-angular momentum
 and  are degenerate only on the -lines. Likewise,
one can show that the -lines go from  at 
back to  at  and from 
at  back to  at , respectively.
We note that the formulas for the band crossings are exact and valid
for an arbitrary ratio of . However, if
 is above a finite threshold the unstable
region may overlap with the band crossings and not all topological
phases will be present in the phase diagram.  
Above we have identified all lines forming the border of the different
topological phases in Fig. 2(b) except for the lines which appear
above the -lines very close to the -lines and surrounds
the white areas of the topological phase diagram Fig. 2 b. These lines
correspond to accidental crossings which occur away from any symmetry
point. They enclose four different topological phases (which are not
listed in our legend for brevity).  
Next, we discuss the topological phase diagram of the original model.
For a pump circulation  (), the resulting
effective flux  is positive (negative), see Eq. (). Thus,  topological phase
diagram of the original model is a deformed version of the right (left) half of the effective
model phase diagram, see panel (a) of Fig. 2 for the case 
. The case  on the other hand is mapped
onto the -lines of the effective diagram.  
A remarkable feature of our model is that there is only a single topological
phase for any fixed value  of the pump circulation if the
off-diagonal parametric terms are not present (:
 for  and 
for  . This is reminiscent of the anomalous Quantum Hall
effect on a Kagome lattice with nearest neighbor hoppings (OMN model)
where the topological phase is uniquely determined by the sign of
the magnetic flux piercing a triangular plaquette, 
if the flux is positive or negative, respectively. Indeed, for small
squeezing , the parametric interaction
effectively induces a small synthetic gauge field with a positive
flux for . This can be easily seen by switching to the
effective description and neglecting the residual parametric terms.
For concreteness we consider the case . For small squeezing
and  we are somewhere close to ,
 inside the topological phase  at the
bottom right corner of the effective diagram. From the above analysis
of the effective diagram we know that a topological phase transition
can occur only if we cross a  or -line. However,
from the analytical solution of the spectrum at the rotational symmetry
points of the original model Eq. () we see
that such crossings never occur on the  axis.
Thus, there in no topological phase transition even for large squeezing
if .   
Effective excitation-conserving Hamiltonian  
When  is much larger than  and 
one can derive an effective excitation conserving Hamiltonian. In
the regime where  it is not enough to
keep the excitation conserving terms in Eq. () but
one should also include the leading order correction in .
We arrive at the excitation conserving Hamiltonian with next-nearest-neighbor
hoppings,  
Here,  indicates the sum
over next-nearest-neighbor sites and   
*
In this simplified picture it is straightforward to calculate the
band structure at the  points and finding the bad degeneracy condition
 which leads
to the horizontal line in the topological phase diagram of the effective
model.  
Bulk-boundary correspondence  
It is well known that in a system with a boundary, the net number
of edge states (the number of right-movers minus the number of left-movers)
in a bulk band gap is a topological invariant . This statement is based
on the sole assumption that the band structure and the corresponding
eigenvectors change smoothly in the presence of a local perturbation
that does not close a gap. Thus, it clearly applies to any quadratic
Hamiltonian. For the special case of an excitation-conserving insulator
or a superconductor the bulk boundary correspondence expresses such
topological invariant in terms of the Chern numbers: the net number
of edge states in a band gap coincides with the sum of the Chern numbers
of all bands below that band gap. Here, we explicitly show that the
bulk-boundary correspondence is still valid for our model where anomalous
terms are present.  
We start noticing that the wavefunctions of the RWA Hamiltonian Eq.
() depend only on two parameters: the phase 
of  and the dimensionless next-nearest-neighbor coupling
 By calculating the
phase diagram as a function of these parameters [not shown] we
see that it supports all topological phases present in the topological
phase diagram of the effective Hamiltonian for the -quasiparticles
[our full model without approximations]. Thus, we can continously
interpolate between the two Hamiltonians without crossing any topological
phase transition [by sending  while also
tuning  and 
to stay in the same topological phase]. Keeping in mind that the
bulk-boundary correspondence holds for the excitation-conserving Hamiltonian
Eq. () and that the net number of edge states does
not change during the interpolation [unless a gap is closed], we can conclude that such correspondence
is valid for our model even for small  where the
RWA leading to Eq. () is not a good approximation. 
We note that the above reasoning combined with the assumption that
a continuous interpolation between any quadratic bosonic Hamiltonian
and an excitation conserving Hamiltonian is always possible without
closing any band gap, leads to the general validity of the
bulk-edge correspondence.  
Details of the transport calculations  
In our transport calculations we have included photon decay. We adopt
the standard description of the dissipative dynamics of photonic systems
in terms of the Langevin equation of input-output theory , for each site:  
In practice, we consider an array of detuned parametric amplifiers
with intensity decay rate  and add to the standard description
of each parametric amplifier the inter-cell coherent coupling described
in the main text. The last term describes the input field and includes
the vacuum fluctuations as well as the influence of an additional
probe field. The field leaking out of each cavity at site  is
given by the input-output relations .
The above formulas give an accurate description of a photonic system
where the intrinsic losses during injection and inside the system
are negligible. 
 In Fig. (3), we show the probabilities  and
 that a photon injected on site  with frequency
 is transmitted 
to site  elastically (at frequency ) or
inelastically (at frequency ) where it is detected.
From the Kubo formula and the input-output relations we find  
*
They depend on the Green's function in frequency space 
where    
with the elastic and inelastic components 
and ,
respectively. From the Kubo formula and the input-output relations 
we find  
Taking into account that   
where  are the ladder operators of the normal modes
for a finite array of  sites and 
are the corresponding single-particle states, the Green's function
reads    
We note that for a probe field inside the bandwidth of the particle
(hole) sector but far detuned from the hole (particle) sector, only
the first (second) term of the summand in Eq. () and ()
is resonant. Thus, as expected, the inelastic scattering is comparatively
larger when the probe field is in the hole band gap. 
It is easy to estimate quantitatively the relative intensities of
elastically and inelastically transmitted light when the parametric
interaction of the  quasiparticles is small. In this
case, it is straighforward to show that 
independent of the band  and the site . By putting together
Eqs. (,,,) and neglecting
the off-resonant terms we find that for ,  
*
These analytical formulas agree quantitatively with the numerical
results shown in Fig. 4(b) [note that in Fig. 4(b) the transmission
at the output sites is rescaled by the overall transmission, ].  
Note that we have assumed, for simplicity, that there is no intrinsic absorption present. If there is intrinsic photon absorption, that will add another decay channel to the equation for the light field, but the resulting picture for the light field propagation remains unchanged except for the expected reduction in propagation length along the edge state.      
apsrev    
3   
    
List of Videos
textcolor    
    
Quantum Theory of Continuum Optomechanics  
Peter Rakich  
Department of Applied Physics, Yale University, New Haven, Connecticut
06520, USA  
Florian Marquardt  
Max Planck Institute for the Science of Light, Staudtstr. 2, 91058
Erlangen, Germany  
Department of Physics, University of Erlangen-Nuremberg, Staudtstr.
7, 91058 Erlangen, Germany 
We present the basic ingredients of continuum optomechanics, i.e.
the suitable extension of cavity optomechanical concepts to the interaction
of photons and phonons in an extended waveguide. We introduce a real-space
picture and argue which coupling terms may arise in leading order
in the spatial derivatives. This picture allows us to discuss quantum
noise, dissipation, and the correct boundary conditions at the waveguide
entrance. The connections both to optomechanical arrays as well as
to the theory of Brillouin scattering in waveguides are highlighted.
We identify the 'strong coupling regime' of continuum optomechanics
that may be accessible in future experiments.  
Introduction 
Cavity optomechanics  is a very active
research area at the interface of nanophysics and quantum optics.
Its aim is to exploit radiation forces to couple optical and vibrational
modes in a confined geometry, with applications ranging from sensitive
measurements, wavelength conversion, and squeezing all the way to
fundamental questions of quantum physics. The paradigmatic cavity-optomechanical
system is zero-dimensional, i.e. there is no relevant notion of spatial
distance or dimensionality that would affect the dynamics in an essential
way. 
However, even though the vast majority of optomechanical systems rely
on an optical cavity, there are a number of implementations that evade
this paradigm. In particular, optomechanical effects are observed
in waveguide-type structures, where both the optical field and the
vibrations propagate in 1D, with the potential to uncover new classical
and quantum phenomena. For example, these include waveguides fabricated
on a chip  as well
as thin membranes suspended in hollow core fibres .
There have also been hybrid approaches, e.g., where the light propagates
along the waveguide but couples to a localized mechanical mode ,
or with acoustic waves in whispering-gallery microresonators . 
Coupling light and sound inside a waveguide has long been the subject
of studies on Brillouin (and Raman) scattering in fibres .
This connection, between Brillouin physics and optomechanics, has
recently been recognized as potentially fertile, and during the past
year, first theoretical studies emphasizing this connection have emerged.
The cavity-optomechanical coupling in a torus has been derived by
starting from the known description of Brillouin interactions in an
infinitely extended waveguide . Conversely,
the Hamiltonian coupling light and sound in such waveguides has been
derived starting from the microscopic optomechanical interaction ,
including both boundary and photoelastic terms and fully incorporate
geometric and material properties of the system. These works represent
important bridges between the rapidly developing field of optomechanics
and the significantly more advanced field of Brillouin scattering.  
Independently, the role of dimensionality has also been emphasized
for several years now in another area of optomechanics: Discrete optomechanical
arrays, i.e. periodic (1D or 2D) lattices of coupled optical and vibrational
modes. These could be implemented in various settings, including photonic
crystals , coupled optical
disk resonators , or stacks of membranes.
Recent theoretical studies have revealed their interesting properties,
including the generation of photon-phonon bandstructures ,
synchronization and nonlinear dynamics ,
effects of long-range coupling ,
quantum many-body physics , and the creation
of artificial gauge fields and topological transport . 
In the present manuscript, our aim is to establish simplified foundations
for ``continuum optomechanics'', i.e., optomechanics in 1D waveguides
without cavity modes: (i) We introduce a real-space picture and discuss
how one can enumerate the possible coupling terms to leading order
in spatial derivatives. (ii) We show how the continuum limit arises
starting from discrete optomechanical arrays, thereby connecting Brillouin
physics and these lattice structures. (iii) We include dissipation
and quantum noise, deriving the quantum Langevin equations and the
boundary conditions at the input of the waveguide. (iv) We identify
the 'strong coupling regime' that may be accessible in the future.
(v) We provide an overview of experimentally achieved coupling parameters.  
Continuum Optomechanics in a Real-Space Formulation 
The usual cavity-optomechanical interaction Hamiltonian connects the
photon field  of a localized optical mode and the phonon
field  of a localized vibrational mode. It is of the parametric
form   
Our goal is to generalize this in the most straightforward way to
the case of 1D continuum fields. We will do so in in real space, using
phenomenological considerations. For an evaluation of the coupling
constants for particular geometries one would resort to microscopic
approaches, such as those presented recently in .
While these approaches are powerful, and necessary to design an experimental
system, they are involved and rather complex as an entry point into
continuum optomechanics. Therefore, a phenomenological analysis can
be useful in its own right. For many purposes, the level of detail
provided here will be sufficient  similar to cavity optomechanics,
where the microscopic calculation of  is left as a separate
task. Moreover, a real-space picture is particularly useful in spatially
inhomogeneous situations, such as those brought about by disorder,
design, or nonlinear structure formation. 
We introduce photon and phonon fields  and ,
respectively, for the waveguide geometry that we have in mind (Fig. ).
In contrast to prior treatments, we do not assume the fields to be
sharply peaked around a particular wavevector .
This keeps our approach general and simplifies the representation
of the interacting fields, especially for situations with strongly
nonlinear dynamics. For example, this apprach avoids the need to treat
cascaded forward-scattering with an infinite number of photon fields
. The fields are normalized such that the
total photon number in the entire system would be ,
and likewise for the phonons. In addition, the fields obey the usual
bosonic commutation relations for a 1D field, e.g. .
For a nearly monochromatic wave packet of frequency , the
energy density at position  is ,
and the power can be obtained by multiplying this by the group velocity.
The plane-wave normal modes would be ,
with .    
The normalized mechanical displacement field can be written as .
The physical displacement at any given point will be obtained by multiplying
with the mode function. As is well-known from standard cavity optomechanics,
any arbitrariness arising from the mode function normalization is
avoided by formulating everything in terms of  and ,
since their normalization is directly tied to the overall energy in
the system. 
The most obvious continuum optomechanical interaction can be written
down as a direct generalization of the cavity case:  
Here  defines the continuum optomechanical
coupling constant, which replaces the usual single-photon cavity-optomechanical
coupling . We note that  has dimensions of
frequency times the square root of length. Its meaning can be understood
best in the following way: If there is a mechanical deflection ,
corresponding to 1 phonon per length , then the energy of any
photon is shifted by . We will comment
more on the  dependence when we make the connection to
discrete optomechanical arrays. 
While Eq. () is a plausible ansatz,
it turns out to be only a part of the full interaction. Specifically,
in a real-space formulation of the continuum case, derivative terms
may appear, which we will now discuss. 
There are both boundary and bulk terms that contribute to the shift
of optical frequency when a dielectric is deformed, as is well-known
for optomechanics and has also been discussed recently in the present
context . The
boundary terms are proportional to the displacement , and
as such their most natural representation is in the form of the ansatz
given above, if  is chosen to represent the deflection of
the boundary (more on this, see below). The bulk terms (photoelastic
response), however, depend only on the spatial derivatives of the
displacement field. In particular, this also involves derivatives
along the longitudinal (waveguide) direction, and these terms then
naturally lead to an expression  
We have introduced a superscript  for the coupling constant,
indicating the possible presence of a derivative: 
changes sign if we set , so we associate
a negative signature. 
It is important to note that the shape of the Hamiltonian depends
on the physical meaning of the displacement , which is to
some degree a matter of definition. We have to distinguish the full
vector field , which is defined unambiguously,
from the reduced one-dimensional field  that forms the
object of our analysis. As a concrete example, consider longitudinal
waves on a nanobeam. The 1D field  could then be defined
as the longitudinal displacement, evaluated at the beam center (see
Fig. b, white arrow). In that case the density
change, responsible for the photoelastic coupling, is proportional
to . At the same time, a finite Poisson ratio
will lead to a lateral expansion of the beam, i.e. a motion of the
surface. The surface deflection will be proportional to the density
change, and thus also determined by . However,
we could have defined  differently, namely to represent
directly the surface deflection (Fig. b, black
arrows). In that case, the density change would be given by .
Two different, equally valid definitions of  would thus
lead to different expressions in the Hamiltonian. 
Besides the appearance of derivatives , we may
also encounter derivatives of the electric field. It is well-known
that electromagnetic waves inside matter can also have longitudinal
components, which change sign upon inversion of the propagation direction
(in contrast to the transverse fields). Consequently, the electromagnetic
mode functions depend on the direction of the wavevector, i.e. .
Upon going to our reduced 1D real-space description, this dependence
on the sign of  leads to terms that are the derivatives of the
1D field, since for a plane wave  we have
 . Any terms in the full 3D
light-matter coupling that depended on the longitudinal components
(that change sign with ) will give rise to such derivatives of
the 1D fields.  
In summary, the possible combinations of derivatives that can occur
are listed in table .     
   
This is a complete list of the coupling terms that can arise in a
minimalistic model of continuum optomechanics. The simplest choice,
introduced in the beginning, would be identified as .
Even and odd terms cannot be present simultaneously, unless inversion
symmetry is broken. As remarked above, one can choose the definition
of the 1D field  to select either the ``even'' or the
``odd'' representation. Note that the constants have different physical
dimensions (e.g.  is of dimensions ). 
Interaction terms with derivatives would also arise by starting from
the microscopic theory, keeping the dispersion (-dependence) of
the coupling, and translating from -space into real space. In
general, this would yield derivatives of any order. Here, our aim
was to keep the leading terms. These are sufficient to retain a qualitatively
important feature: A model based on Eq. ()
would predict that the forward- and backward-scattering amplitudes
are equal (set by the single coupling constant in such a model). In
reality, that is not the case, and this fact is taken into account
properly by considering the derivatives. 
Is our list complete? To answer this, let us discuss the ``even''
sector only, without loss of generality. In this sector, we went up
to second order in the derivatives, keeping terms such as .
Why did we not consider second derivatives of individual fields, like
? The
answer is that these can indeed be present. However, a simple integration
by parts will transform those terms into a combination of the terms
that we already listed. 
Beyond the interaction, the Hamiltonian contains the unperturbed energy
of the photons, 
and likewise  for the phonons with their dispersion
. In real space, the same term could be written as 
where  applied to  will reproduce
. 
The resulting coupled continuum optomechanical Heisenberg
equations of motion take the form:   
Here, eq. (4) and (5) are expressed with the simple interaction. More
generally, the interaction may be comprised of a linear combination
of terms in Table I. For example, the term 
in Eq. () becomes   
when even couplings are considered. Likewise, term 
of Eq. () becomes   
The real-space formulation developed here, with the complete list
of interactions derived above, will be especially powerful for considering
the effects of nonlinearities and of spatial inhomogeneities (whether
due to disorder or structure formation). No assumptions about the
fields peaking around a certain wavevector have been employed, nor
are we required to introduce a multitude of photon fields for cases
like forward scattering. The classical version of these nonlinear
equations can readily be solved by using split-step Fourier techniques.  
Dissipation and Quantum Noise 
To discuss the dissipation and the associated quantum and thermal
noise, we employ the well-known input-output formalism and adapt it
suitably to the continuum case. If we assume the photon loss rate
to be , then the equation of motion contains additional terms  
where the vacuum noise field  obeys the commutation
relation 
and has the correlators 
and .
These ensure that the commutator of  is preserved, i.e.
the vacuum noise is constantly being replenished to offset the losses. 
The mechanical field can be treated likewise, with a damping rate
 in place of , and with the additional contribution
of thermal noise: 
and .
Here  is the
Bose occupation at temperature . For simplicity, we assume that
this can be evaluated at some fixed frequency , since the
phonon dispersion  is usually nearly flat in the most
important applications.   
Boundary conditions 
We have now collected all the ingredients for continuum optomechanics,
except the driving and the boundary conditions. A laser injecting
light of amplitude  at point  would be described
by an additional term 
in the equations of motion, with 
for a continuous wave excitation. Here  is the
coupling to the field mode that is populated by the laser photons,
and  would
be the power per unit length impinging on the waveguide at position
x. This description is appropriate for illumination from the side,
which is feasible (and analogous to standard cavity optomechanis)
but atypical in experiments.  
More commonly, light is injected at the waveguide entrance. In that
case, we consider a half-infinite system, starting at  and extending
to the right (Fig. d). The boundary at 
must be such that incoming waves (including the quantum vacuum noise)
are perfectly launched into the waveguide as right-going waves, while
left-moving waves exit without reflection. For the simplest case of
a constant photon velocity , we need to prescribe the right-going
amplitude at ,  
where the ingoing quantum noise has the correlator  
while 
vanishes. Eq. () is valid also in the
presence of dissipation. The solution of the free wave equation 
with the boundary condition () is  
where the right-moving field is set by :  
The left-moving field is an independent fluctuating field. The correlator
of the right-movers is  
*
and the same result holds for the left-movers, such that the full
equal-time correlator of the  field is set by .  
Rotating Frame and Linearized Description 
We can switch to a rotating frame, ,
where  is the laser frequency. For brevity,
we drop the superscript 'new', i.e. all  are now understood
to be in the rotating frame. We then have, in the photon equation
of motion, after employing :  
For brevity, we define .
If only modes close to  are present, this may be expanded
using the group velocity :  
The equation for the phonon field remains unaffected by this change. 
We can linearize the equations in the standard way (see Supplementary
Material), setting 
and  for the steady-state
solution, and  and 
for the fluctuations. Then we obtain, for the simplest interaction
term:   
Here we introduced the linearized coupling ,
as well as the shift .
The omitted terms () in Eqs. () and ()
contain the dissipation and fluctuations, in the same form as above
(only with , and the same for the phonons).
The boundary conditions for the fluctuations  do not
contain any laser driving any more; i.e. we would have Eq. ()
for , but without the laser amplitude .  
Continuum limit for optomechanical arrays 
In an optomechanical array, discrete localized optical and vibrational
modes are coupled to each other via the optomechanical interaction
,
see Fig. . In addition, the photon and phonon
modes  and  are coupled by tunneling between
neighboring sites. For the photons, in a 1D array, this is described
by the tight-binding Hamiltonian .
Here  is the tunnel coupling connecting any two sites 
and . The resulting dispersion relation for the optical tight-binding
band is , where we already
introduced the lattice constant . For the phonons, an analogous
Hamiltonian holds, with a coupling constant  and a resulting
phononic band .    
    
The continuum theory will be a faithful approximation if only modes
of sufficiently long wavelengths (many lattice spacings) are excited.
The properly normalized way to identify localized modes with the continuum
fields is  
This ensures the validity of the commutator relations such as .
We then obtain   
Here  is the continuum version
of Eq. (). For this simple local interaction,
none of the 'derivative-terms' appears. The present approximation
holds when the Hamiltonian acts on states where only long-wavelength
modes are excited. We can now relate the coupling constants for the
continuum and the discrete model:  
In taking the proper continuum limit,  has to be kept
fixed, i.e.  as .
This is the expected physical behaviour, since ,
where  is the size of the
mechanical zero-point fluctuations of a discrete mechanical mode.
If this mode represents a piece of length  in a continuous
waveguide, its mass scales as  [with 
the mass density], such that  grows in the manner discussed
above when  is sent to zero. Note that the continuum limit
also means keeping  and  fixed in the relevant
wavelength range. 
One can now also confirm that our treatment of quantum noise and dissipation
corresponds to the input-output formalism applied to the discrete
modes. For such modes, we would have ,
with 
and .
Setting ,
this turns into the continuum expressions given above. 
We turn back to the optomechanical interaction in the array. So far,
we had assumed a local interaction of the type .
However, it is equally possible to have an interaction that creates
phononic excitations during the photon tunneling process: ,
where  describes
the displacement of a mode attached to the link between the sites
 and ; see Fig. b. It turns out that
such a coupling gives rise to 'derivative' terms in the continuum
model, see the Supplementary Material.  
Elementary processes for a single optical branch 
We briefly connect the real-space and -space pictures to review
the elementary scattering processes. Translating the couplings in
table  to -space, we arrive at the substitutions
, 
and , with .
In addition, , ,
and . This yields the following
amplitude (for the example of the ``even'' sector) in front of the
resulting term  in
the Hamiltonian:  
We can now specifically distinguish the amplitudes for forward-scattering
():  
and backward-scattering ():  
Clearly it was important to keep more than the simplest interaction
term  in real-space to allow that these amplitudes are
different. 
If only forward-scattering is considered, the situation is significantly
different from standard cavity optomechanics. The reason is that the
cavity allows us to introduce an asymmetry between Stokes and anti-Stokes
processes. This is absent here in forward-scattering, where phonons
of wavenumber  can be emitted and absorbed equally likely, scattering
laser photons into a comb 
of sidebands  with . Because
of this, basic phenomena in cavity optomechanics, like cooling or
state transfer, do not translate to the forward scattering case with
a single optical branch; these operation require asymmetry between
Stokes and anti-Stokes coupling processes. Dispersive symmetry breaking
is seldom accomplished in this geometry, as typical propagation lengths
are not adequate to resolve the wavevector difference between Stokes
and anti-Stokes phonon modes.  
In backward scattering, the situation is different, since either phonons
of wavenumber  are emitted (Stokes) or those of wavenumber
 are absorbed (anti-Stokes). This can result in cooling
of  phonons and amplification of  phonons. The
latter process amounts to stimulated backward Brillouin scattering,
amplifying any counterpropagating beam.  
Multiple optical branches 
The useful Stokes/anti-Stokes asymmetry can be re-introduced into
forward scattering by considering multiple optical branches. These
might be different transverse optical modes. In that case, the (simplest)
interaction is  
Here  describes the bare coupling for scattering
from branch  to , with ,
and .
Analogous expressions can be written down for the other interactions
of table . 
For the case of two branches, there will be forward-scattering of
photons  between the branches, by either absorbing
a phonon of wavenumber  or emitting one of wavenumber . In
the linearized Hamiltonian, the inter-branch scattering process is
described by  
with , where .
In momentum space, this turns into   
Interband scattering: Weak coupling 
We first treat the weak coupling limit for scattering between different
optical bands, which has been discussed widely in the literature and
is known under various names such as stimulated Brillouin scattering
(SBS) or stimulated Raman-like scattering (see Suppl. Material for
a discussion of naming conventions). It is a widely studied regime
of continuum optomechanical coupling, with a long history in the context
of nonlinear optics .
The phonon fields are assumed to have far shorter decay lengths than
the optical waves, which is frequently satisfied by experimental systems.
In this limit, the nonlinear optical susceptibility induced by optomechanics
can be approximated as local, greatly simplifying the spatio-temporal
dynamics. For clarity, we term this regime the 'Brillouin-limit'.  
To connect our continuum optomechanical framework with
Brillouin or Raman interactions, we start from Eq. (),
for two optical branches. Just as in Eqs. ()
and (), we introduce rotating frames
and linearize the dispersion relations. Then, we obtain:   
Here,  and 
represent the spatial power decay rate of the photon (phonon) fields,
i.e. the inverse decay length. Since the spatial decay rate of sound
() is typically much larger than that of light (),
the phonon field is generated locally: .
This allows to express the mechanical amplitude in terms of the light
field, which yields:   
We can now cast this result in terms of traveling-wave optical powers
 and , with ,
,
and .
Here we assumed the small signal limit, i.e. , ,
and  is large. We see that  is exponentially
amplified according to   
where 
is the Brillouin gain coefficient .
For alternative derivations in the context of nonlinear optics and
Brillouin photonics, see Refs. ;
for discussion of the induced nonlinear optical susceptibility see
Suppl. Material. This relationship between  and 
permits us to leverage established methods for calculation of the
optomechanical coupling in both translationally invariant 
and periodic  nano-optomechanical systems.
In the Brilloin limit, a range of complex spatio-temporal phenomena
have been studied .  
Strong coupling in the 'Coherent-Phonon Limit' 
The case opposite to the 'Brillouin limit', that we just discussed,
is the situation of a large phonon coherence length. This might be
termed the 'coherent phonon limit'. In this much less explored limit,
a large variety of interesting classical and quantum phenomena can
be expected to appear, as the system acquires a much higher degree
of coherence and nonlocality. Quantum states can then be swapped between
the light field and the phonon field, which can lead to applications
like opto-acoustic data storage in a fibre .
We now consider the situation where creation of a photon in the second
branch is accompanied by absorption of a phonon, instead of
the emission that would lead to amplification. This leads to a modified
version of Eqs. () and ():   
That can be recast as a matrix equation  
where the vector  contains the fields, ,
and   
This is a non-Hermitian matrix that can be diagonalized to obtain
the spatial evolution . We find the eigenvalues  
where  is the average spatial
decay rate, and .
A distinct oscillatory regime is reached when , i.e.  
In that case, the eigenvalues attain an imaginary part, and the spatial
evolution becomes oscillatory. Interestingly, this sharp threshold
only depends on the difference of spatial decay rates. In principle,
therefore, in an unconventional system where  and 
are of the same order, this condition is much easier to fulfill than
when having to compare  against the
total decay rate. Nevertheless, in order for the oscillations to be
observed in practice, in addition the decay length should be larger
than the period of oscillations. This will be true when ,
which can be approximated as   
We will term this the ``strong coupling regime'' for continuum
optomechanics. It is in spirit similar to the strong coupling regime
of cavity optomechanics , although the
dependence on the velocities introduces a new element. If this more
demanding condition () is fulfilled, then
the coupling is also automatically larger than the threshold ()
given above.  
To interpret this condition, note that usually  is
dominated by the phonon decay . In that
case, we could also write .
This shows that, at a fixed phonon decay rate , smaller phonon
velocities make the strong coupling regime harder to reach.  
Experimental Overview    
   
     
Coupling between continuous optical and phonon fields has been realized
in the context of nonlinear optics studies of Brillouin interactions.
These experimental systems, depicted in Fig. ,
include step-index and micro-structured optical fibers ,
gas- and superfluid-filled photonic bandgap fibers,
as well as chip-scale integrated optomechanical waveguide systems
.
To date, these studies have overwhelmingly focused on the Brillouin
related nonlinear optical phenomena ,
as well as noise processes .
However, it is also interesting to examine these systems through the
lens of continuum optomechanics. Figure a shows
the estimated continuum-optomechanical coupling strengths, extracted
using the Brillouin gain , as derived in the previous section.
We see that couplings of between 
have been realized using radiation pressure and (or) photo-elastic
coupling. These couplings are mediated by phonons with frequencies
between 10 MHz and 18 GHz depending on the type of interaction (intra-band
or inter-band) and the elastic wave that mediates the coupling.    
The strength of the nonlinear optical susceptibility increases linearly
with phononic Q-factor. This is seen by comparing the effective phononic
Q-factors, plotted in Fig. b with the peak Brillouin
gain of Fig. c. We define the effective Q-factor
as the ratio of the mechanical frequency and the line-width. The effective
Q-factor is always smaller than the intrinsic phonon Q-factor due
to inhomogeneous broadening from variations in waveguide dimension
along the waveguide length . 
A variety of single-band (intra-modal) and multi-band (inter-modal)
interactions have been demonstrated. These single-band processes include
intra-modal forward-SBS processes (also termed stimulated Raman-like
scattering) and backward-SBS processes; each process is denoted with
circular and square markers, respectively, in Fig. .
Multi-band processes, generically termed inter-modal Brillouin processes,
are denoted by triangular markers in Fig. ; their
classification and nomenclature is discussed in the Suppl. Material. 
As discussed in the previous section, the phonon coherence length
has a significant impact on the spatio-temporal dynamics. Thus it
is important to note that, depending on the intrinsic Q-factor and
the type of phonon mode, the coherence length of the phonon can vary
dramatically. For instance, since intra-modal coupling is mediated
by phonons with vanishing group velocities () ,
phonon coherence lengths are often less than 100 nm. Conversely, in
the cases of backward- or inter-modal (inter-band) coupling, the phonon
group velocities can approach the intrinsic sound velocity in the
waveguide material (e.g., ). These higher velocity phonon
modes correspond to 10-50 micron coherence lengths at room temperatures,
but can be extended to milimeter length-scales at cryogenic temperatures. 
Numerous nano-optomechanical devices have been proposed that have
the potential to yield increased coupling strengths .
Fig.  indicates the prospects
for exploring the strong coupling regime discussed before.  
Conclusions 
We have established a connection between the continuum limit of optomechanical
arrays and Brillouin physics. Especially studies of (classical and
quantum) nonlinear dynamics will profit from our approach, where we
categorized the simplest coupling terms and derived the quantum Langevin
equations, including the noise terms and the correct boundary conditions.
Applications such as wavelength conversion, phonon-induced coherent
photon interactions and extensions to two-dimensional situations 
can now be analyzed on the basis of this framework. As an example,
we have identified the strong coupling regime in continuum-optomechanical
systems and prospects for reaching it in the context of state-of-the-art
experimental systems.   
Acknowledgements 
We thank Philip Russell and Andrey Sukhorukov for initial discussions
that helped inspire this project and for useful feedback on the manuscript.
We acknowledge support by an ERC Starting Grant (FM). P.T.R. acknowledges
support from the Packard Fellowship for Science and Engineering.  
Supplementary Material  
Linearized Interaction 
We briefly review the (straightforward) route from the fully nonlinear
interaction to the linearized version, i.e. a quadratic Hamiltonian.
Assume a steady state solution has been found, with 
and . As is known
for standard cavity optomechanics, there might be more than one steady-state
solution, and formally there could be an infinity of solutions for
the continuum case. We have not explored this possibility further. 
The deviations from this solution will now be denoted 
and . These are still fields. In contrast
to the standard single-mode case, we will keep the possibility that
 depends on position.  
On the Hamiltonian level, we now obtain a new 'linearized' (i.e. quadratic)
interaction term:  
as well as a term  
which is a (possibly position-dependent) shift of the optical frequency.
Its counterpart in the cavity optomechanics case is often dropped
by an effective redefinition of the laser detuning. 
In writing down Eq. (), we have defined   
The photon-enhanced continuum coupling strength  is
the direct analogue of the enhanced coupling  in the
standard linearized cavity-optomechanical case. In contrast to ,
 has the dimensions of a frequency. Likewise, 
is the static mechanical displacement, expressed as a resulting optical
frequency shift. 
At this point, we have only started from the simplest kind of interaction,
Eq. (), to obtain Eq. ().
We will comment on the other terms of table 
below.   
Optomechanical Arrays: Derivative Terms in the continuum version
of the interaction 
In an optomechanical array, it is possible to have an interaction
that creates phononic excitations during the photon tunneling process:
,
where  describes
the phonon displacement of a mode attached to the link between the
sites  and . Here we describe how this can give rise to
the canonical derivative terms when switching to a continuum description. 
Switching from the discrete lattice model to the continuum model,
we replace  
where we chose coordinates so as to indicate that the phonon mode
 is located halfway between the photon modes at .
A Taylor expansion of   
yields  
where all fields are taken at position . Two things are worth
noting here: First, all the first-order derivatives have disappeared
(they would have violated inversion symmetry!). Second, we have obtained
second-order derivatives of the photon field. If we want to turn this
into our ``canonical'' choice of coupling terms (table ),
we have to integrate by parts, in which case derivatives may also
act on . This turns 
into:  
Combining this with the other terms resulting from Eq. (),
one arrives at the interaction expressed completely in the canonical
way.  
Nonlinear susceptibility 
We briefly discuss how, starting from the linearized Eq. (),
we can obtain the effective third-order nonlinear photon susceptibility
induced by the interaction with the phonons. We slightly generalize
this equation, by adding a possible detuning between the mechanical
frequency  and the transition frequency  between
the two optical branches:  
Solving for the steady state 
and inserting into the photon equation of motion, Eq. (),
we obtain:   
We can express this as  
with the effective nonlinear susceptibility  
Using  and 
to cast Eq. 47 in the form of Eq. 28, one finds that the frequency
dependent gain is related to the nonlinear susceptibility as .  
Types of Brillouin interactions 
Here, we elucidate some naming conventions used in the Brillouin literature,
and we explain how these names relate to the classifications that
we use in this paper. These include (i) forward intra-band scattering
processes, where incident and scattered light-fields co-propagate
in the same optical mode, (ii) backward intra-band scattering processes,
where the incident and scattered light-fields counter-propagate, as
well as (iii) inter-band scattering processes, which generically describe
processes that involve coupling between guided optical modes with
distinct dispersion curves. Note that within Fig. 
processes (i), (ii), and (iii) are identified by circular, square,
and triangular markers, respectively. 
Backward intra-band scattering processes, which is the most widely
studied of Brillouin interactions, is commonly termed backward stimulated
Brillouin scattering ;
references 
are examples of this process. However, for historical reasons, the
terminology for forward intra-band and forward inter-band scattering
processes is somewhat more diverse. Thermally driven (or spontaneous)
forward intra-band scattering was first observed in optical fibers,
and identified as a noise process, under the name guided acoustic
wave Brillouin scattering (GAWBS) ; references
 are examples of
this spontaneous process. Stimulated forward intra-band scattering
processes have been described using the term (intra-modal) forward
stimulated Brillouin scattering ,
as well as using the more descriptive term stimulated Raman-like scattering
(SRLS) .  
Inter-band processes have also been observed through both spontaneous
and stimulated interactions under different names. Stimulated inter-band
coupling between co-propagating guided optical modes with different
polarization states has been termed stimulated inter-polarization
scattering (SIPS) . In the context of
noise processes, the spontaneous version process has also been described
using the term de-polarized GAWBS or depolarization scattering .
Stimulated scattering between co-propagating guided optical modes
with distinct spatial distribution has also been described using the
term stimulated inter-modal scattering (SIMS) 
and stimulated inter-modal Brillouin scattering . 
naturemag    
    
    
    
    
    
    
    
    
    
    
    
    
   
Generalized nonreciprocity in an optomechanical circuit via synthetic magnetism and reservoir engineering 
Kejie Fang 
Jie Luo
Kavli Nanoscience Institute, California Institute of Technology, Pasadena, California 91125, USA
Institute for Quantum Information and Matter and Thomas J. Watson, Sr., Laboratory of Applied Physics, California Institute of Technology, Pasadena, California 91125, USA
Anja Metelmann
Department of Physics, McGill University, 3600 rue University, Montreal, Quebec H3A 2T8, Canada
Department of Electrical Engineering, Princeton University, Princeton, New Jersey 08544, USA
Matthew H. Matheny
Kavli Nanoscience Institute, California Institute of Technology, Pasadena, California 91125, USA
Department of Physics, California Institute of Technology, Pasadena, California 91125, USA
Florian Marquardt
Max Planck Institute for the Science of Light, Gunther-Scharowsky-Strasse 1/Bau 24, 91058 Erlangen, Germany
Institute for Theoretical Physics, Department of Physics, Universitat Erlangen-Nurnberg, 91058 Erlangen  
Aashish A. Clerk
Department of Physics, McGill University, 3600 rue University, Montreal, Quebec H3A 2T8, Canada
Oskar Painter
Kavli Nanoscience Institute, California Institute of Technology, Pasadena, California 91125, USA
Institute for Quantum Information and Matter and Thomas J. Watson, Sr., Laboratory of Applied Physics, California Institute of Technology, Pasadena, California 91125, USA
opainter@caltech.edu  
  Synthetic magnetism has been used to control charge neutral excitations for applications ranging from classical beam steering to quantum simulation. In optomechanics, radiation-pressure-induced parametric coupling between optical (photon) and mechanical (phonon) excitations may be used to break time-reversal symmetry, providing the prerequisite for synthetic magnetism. Here we design and fabricate a silicon optomechanical circuit with both optical and mechanical connectivity between two optomechanical cavities. Driving the two cavities with phase-correlated laser light results in a synthetic magnetic flux, which in combination with dissipative coupling to the mechanical bath, leads to nonreciprocal transport of photons with  dB of isolation.  Additionally, optical pumping with blue-detuned light manifests as a particle non-conserving interaction between photons and phonons, resulting in directional optical amplification of  dB in the isolator through direction. These results indicate the feasibility of utilizing optomechanical circuits to create a more general class of nonreciprocal optical devices, and further, to enable novel topological phases for both light and sound on a microchip.   
    
Synthetic magnetism involving charge neutral elements such as atoms , polaritons , and photons  is an area of active theoretical and experimental research, driven by the potential to simulate quantum many-body phenomena , reveal new topological wave effects , and create defect-immune devices for information communication .  Optomechanical systems , involving the coupling of light intensity to mechanical motion via radiation pressure, are a particularly promising venue for studying synthetic fields, as they can be used to create the requisite large optical nonlinearities .  By applying external optical driving fields time-reversal symmetry may be explicitly broken in these systems. It was predicted that this could enable optically tunable nonreciprocal propagation in few-port devices , or in the case of a lattice of optomechanical cavities, topological phases of light and sound . Here we demonstrate a generalized form of optical nonreciprocity in a silicon optomechanical crystal circuit  that goes beyond simple directional propagation; this is achieved using a combination of synthetic magnetism, reservoir engineering, and parametric squeezing.    
Distinct from recent demonstrations of optomechanical nonreciprocity in degenerate whispering-gallery resonators with inherent nontrivial topology , we employ a scheme similar to that proposed in Refs.  in which a synthetic magnetic field is generated via optical pumping of the effective lattice formed by coupled optomechanical cavities.  In such a scenario, the resulting synthetic field amplitude is set by the spatial variation of the pump field phase and the field lines thread optomechanical plaquettes between the photon and phonon lattices (see Fig. ).  To achieve nonreciprocal transmission of intensity in the two-port device of this work -- i.e., bonafide phonon or photon transport effects, not just nonreciprocal transmission phase -- one can combine this synthetic field with dissipation to implement the general reservoir engineering strategy outlined in Ref. .  This approach requires one to balance coherent and dissipative couplings between optical cavities.  In our system the combination of the optical drives and mechanical dissipation provide the ``engineered reservoir'' which is needed to mediate the required dissipative coupling.  
To highlight the flexibility of our approach, we use it to implement a novel kind of nonreciprocal device exhibiting gain .  By using an optical pump which is tuned to the upper motional sideband of the optical cavities, we realize a two-mode squeezing interaction which creates and destroys photon and phonon excitations in pairs. These particle non-conserving interactions can be used to break time-reversal symmetry in a manner that is distinct from a standard synthetic gauge field.  In a lattice system, this can enable unusual topological phases and surprising behavior such as protected chiral edge states involving inelastic scattering  and amplification .  Here, we use these interactions along with our reservoir-engineering approach to create a cavity-based optical directional amplifier:  backward propagating signals and noise are extinguished by  dB relative to forward propagating waves which are amplified with an internal gain of  dB ( dB port-to-port).      
    
The optomechanical system considered in this work is shown schematically in Fig. a and consists of two interacting optomechanical cavities, labeled  (left) and  (right), with each cavity supporting one optical mode  and one mechanical mode .  Both the optical and mechanical modes of each cavity are coupled together via a photon-phonon waveguide, resulting in optical and mechanical inter-cavity hopping rates of  and , respectively (here we choose a local definition of the cavity amplitudes so both are real). The radiation pressure interaction between the co-localized optical and mechanical modes of a single cavity can be described by a Hamiltonian , where  is the annihilation operator of the optical (mechanical) mode and  is the vacuum optomechanical coupling rate  (here we have omitted the cavity labeling).  
To enhance the effective photon-phonon interaction strength each cavity is driven by an optical pump field with frequency relatively detuned from the optical cavity resonance by the mechanical frequency (), with a resulting intra-cavity optical field amplitude .   In the good-cavity limit, where  ( being the optical cavity linewidth), spectral filtering by the optical cavity preferentially selects resonant photon-phonon scattering, leading to a linearized Hamiltonian with either a two-mode squeezing form  (blue detuned pumping) or a beamsplitter form  (red detuned pumping).  Here  is the parametrically enhanced optomechanical coupling rate and  contains the small signal sidebands of the pump.  For both cases the phase of the resulting coupling coefficient is nonreciprocal in terms of the generation and annihilation of photon-phonon excitations. As has been pointed out before, such a nonreciprocal phase resembles the Peierls phase that a charged particle accumulates in a magnetic vector potential . Crucially, the relative phase  is gauge independent (i.e. independent of local redefinitions of the  and  cavity amplitudes), implying it should have an observable effect.  In the simple case of ,  is formally equivalent to having a synthetic magnetic flux threading the plaquette formed by the four coupled optomechanical modes (two optical and two mechanical).  For , a non-zero  still results in the breaking of time-reversal symmetry, though the lack of particle number conservation means that it is not simply equivalent to a synthetic gauge field.  Nonetheless, we will refer to it as a flux in what follows for simplicity.     
*  
To detect the presence of the effective flux , consider the transmission of an optical probe signal, on resonance with the optical cavity resonances and coupled in from either the left or the right side via external optical coupling waveguides as depicted in Fig. b. The probe light can propagate via two different paths simultaneously: (i) direct photon hopping between cavities via the connecting optical waveguide, and (ii) photon-phonon conversion in conjunction with intervening phonon hopping via the mechanical waveguide between the cavities.  As in the Aharonov-Bohm effect for electrons , the synthetic magnetic flux set up by the phase-correlated optical pump beams in the two cavities causes a flux-dependent interference between the two paths. 
We define the forward (backward) transmission amplitude as , where  is the amplitude of the outgoing (incoming) electromagnetic signal field in the corresponding coupling waveguide in units of square root of photon flux.
The optical transmission amplitude in the forward direction has the general form     
[;] = [](J -[]e^- i),   
where  and  is the frequency of the probe light.  is the amplitude of the effective mechanically-mediated coupling between the two optical cavities, and is given by 
eq1b
[] = V ( -i()+ 2)( -i()+ 2)+V^2.  
The prefactor  in Eq. () accounts for reflection and loss at the optical cavity couplers, as well as the mechanically-induced back-action on the optical cavities.  This prefactor is independent of the transmission direction, and for the reverse transmission amplitude , only the sign in front of  changes.   
The directional nature of the optical probe transmission may be studied via the frequency-dependent ratio 
eq1
()[; = J-[]e^- i_BJ - []e^+ i_B.  
Although the presence of the synthetic flux breaks time-reversal symmetry, it does not in and of itself result in nonreciprocal photon transmission magnitudes upon swapping input and output ports .  In our system, if one takes the limit of zero intrinsic mechanical damping (i.e. ), the mechanically-mediated coupling amplitude  is real at all frequencies.  This implies , irrespective of the value of .  We thus find that non-zero mechanical dissipation will be crucial in achieving any non-reciprocity in the magnitude of the optical transmission amplitudes. 
The general reservoir-engineering approach to nonreciprocity introduced in Ref.  provides a framework for both understanding and exploiting the above observation.  It demonstrates that nonreciprocity is generically achieved by balancing a direct (Hamiltonian) coupling between two cavities against a dissipative coupling of the cavities; such a dissipative coupling can arise when both cavities couple to the same dissipative reservoir.  The balancing requires both a tuning of the magnitude of the coupling to the bath, as well as a relative phase which plays a role akin to the flux .  In our case, the damped mechanical modes can play the role of the needed reservoir, with the optical drives controlling how the optical cavities couple to this effective reservoir.  One finds that at any given frequency , the mechanical modes induce both an additional coherent coupling between the two cavities (equivalent to an additional coupling term in the Hamiltonian) as well as a dissipative coupling (which is not describable by a Hamiltonian).  As is shown explicitly in App, , in the present setting these correspond directly to the real and imaginary parts of .  Hence, the requirement of having  is equivalent to requiring a non-zero mechanically-mediated dissipative coupling between the cavities. 
Achieving directionality requires working at a frequency where the dissipative coupling has the correct magnitude to balance the coherent coupling , and a tuning of the flux .  For  and  (), one obtains purely uni-directional transport where the right optical cavity is driven by the left optical cavity but not vice versa. One finds from Eq. () that the mechanically-mediated dissipative coupling between the cavities is maximized at frequencies near the mechanical normal mode frequencies ; to achieve the correct magnitude of coupling, the optical pumping needs to realize a many-photon optomechanical coupling  (see App.  for details).  Note that our discussion applies to both the choices of red-detuned and blue-detuned pumping.  While the basic recipe for directionality is the same, in the blue-detuned pump case the effective reservoir seen by the cavity modes can give rise to negative damping, with the result that the forward transmission magnitude can be larger than one.  We explore this more in what follows. 
     
    
* 
In order to realize the optomechanical circuit depicted in Fig.  we employ the device architecture of optomechanical crystals , which allows for the realization of integrated cavity-optomechanical circuits with versatile connectivity and cavity coupling rates . Figure a shows the optomechanical crystal circuit fabricated on a silicon-on-insulator microchip. The main section of the circuit, shown zoomed-in in Fig. b, contains two optomechanical crystal nanobeam cavities, each of which has an optical resonance of wavelength  nm and a mechanical resonance of frequency  GHz.  The two optical cavities can be excited through two separate optical coupling paths, one for coupling to the left cavity and one for the right cavity.  Both the left and right optical coupling paths consist of an adiabatic fiber-to-chip coupler which couples light from an optical fiber to a silicon waveguide, and a near-field waveguide-to-cavity reflective coupler.  This allows separate optical pumping of each cavity and optical transmission measurements to be carried out in either direction.  The two nanobeam cavities are physically connected together via a central silicon beam section which is designed to act as both an optical waveguide and an acoustic waveguide.  The central beam thus mediates both photon hopping and phonon hopping between the two cavities even though the cavities are separated by a distance much larger than the cavity mode size .  The numerically simulated mode profiles for the localized cavities and the connecting waveguide are shown in Fig. c and d, respectively.  The hopping rate for photons and phonons can be engineered by adjusting the number and shape of the holes in the mirror section of the optomechanical crystal cavity along with the free-spectral range of the connecting waveguide section .  Here we aim for a design with  MHz and  MHz so that nonreciprocity can be realized at low optical pump power, yet still with high transmission efficiency. 
As will be presented elsewhere , the optical and mechanical frequencies of the optomechanical cavities are independently trimmed into alignment post-fabrication using an atomic force microscope to oxidize nanoscale regions of the cavity.  After nano-oxidation tuning, the left (right) cavity has optical resonance wavelength   nm, total loaded damping rate   GHz, and intrinsic cavity damping rate   GHz (c.f. Fig. e).  Note that hybridization of the optical cavity resonances is too weak to be observable in the measured left and right cavity spectra due to the fact that the optical cavity linewidths are much larger than the designed cavity coupling .  The thermal mechanical spectra, as measured from the two cavities using a blue-detuned pump laser (see App. ), are shown in Fig. f where one can see hybridized resonances  which are mixtures of the localized mechanical cavity modes  and .  A nearby phonon waveguide mode () is also observable in both left and right cavity spectra.  The optomechanical coupling rate and mechanical dissipation rate of  were measured before nano-oxidation tuning, yielding   MHz and   MHz. 
The experimental apparatus used to drive and probe the optomechanical circuit is shown schematically in Fig. a.  As indicated, an optical pump field for the left and right cavities is generated from a common diode laser.  The phase difference of the pump fields at the input to the cavities, and thus the synthetic magnetic flux, is tuned by a stretchable fiber phase shifter and stabilized by locking the interference intensity of the reflected pump signals from the cavities.  To highlight the unique kinds of nonreciprocal transport possible in our setup, we present results for an experiment performed with   
blue-detuned pump fields with frequency ; as discussed, this will enable non-reciprocal transport with gain.  An input optical probe signal is generated from either of the left or right cavity pump beams by sending them through an electro-optic modulator (EOM).  A vector network analyzer (VNA) is used to drive the EOMs at modulation frequency  and detect the photocurrent generated by the beating of the transmitted probe and reflected pump signals, thus providing amplitude and phase information of the transmitted probe signal.  Owing to the spectral filtering of the cavities, only the generated lower sideband of the blue-detuned pump at  is transmitted through the circuit as a probe signal.     
Figure b shows the ratio of the forward and backward optical power transmission coefficients of the probe light () for several magnetic flux values between  and .  For these measurements the pump powers at the input to the left and right cavity were set to  dBm and  dBm, respectively, corresponding to intra-cavity photon numbers of  and .  So as to remove differences in the forward and reverse transmission paths external to the optomechanical circuit, here the  ratio is normalized to  dB for a modulation frequency  GHz, detuned far from mechanical resonance in a frequency range where reciprocal transmission is expected. Closer to mechanical resonance, strong nonreciprocity in the optically transmitted power is observed, with a peak and a dip in  occurring roughly at the resonance frequencies of the hybridized mechanical modes  and , respectively (c.f. Fig. c).  The maximum contrast ratio between forward and backward probe transmission -- the isolation level -- is measured to be  dB for  near the  resonance.  The forward transmission is also amplified in this configuration (blue-detuned pump, ), with a measured peak probe signal amplification of  dB above the background level set by photon hopping alone ().  The corresponding port-to-port net gain is only  dB due to impedance mismatching () and intrinsic optical cavity losses (see SI for details). 
From a two-parameter fit to the measured optical power transmission ratio spectra using Eq.  (see blue curves in Figs. b and c), we obtain a waveguide-mediated optical and mechanical hopping rate of  MHz and  MHz, respectively,  consistent with our design parameters. Figure d shows the theoretical calculation of  for a full  range of  with the measured and fit optomechanical circuit parameters. The pattern is seen to be odd symmetric with respect to .  Inserting an additional magnetic flux  into the measurements performed in Fig. b yields the spectra shown in Fig. c which displays a switch in the isolation direction as predicted by the model.  The pump power dependence of the peak (in frequency) forward signal amplification and the corresponding backward signal attenuation relative to the background level far from mechanical resonance are shown in Fig. e for a fixed magnetic flux of .  Good correspondence with the theoretical power dependence (solid curves) is observed, with nonreciprocal amplification vanishing at low pump power.   
One can also obtain nonreciprocal optical power transmission utilizing an even simpler system involving a single mechanical cavity.  This is the situation we have for the Fabry-Perot-like mechanical resonances that exist in the central coupling waveguide (see  resonance of Fig. c).  As depicted in Fig. a, the mode configuration in this case consists of two optical cavity modes ( and ) coupled together via the optical waveguide, one mechanical waveguide mode  which is parametrically coupled to each of the optical cavity modes, and the synthetic magnetic flux  due to the relative phases of the optical pump fields threading the triangular mode space. In Fig. b and c we show the measurement of  for a series of different flux values  with blue-detuned pumping () at levels of  and .  In this single mechanical mode case the direction of the signal propagation is determined by the magnitude of the flux;  leads to backward propagation and  to forward propagation.  The lower contrast ratio observed is a result of the weaker coupling between the localized optical cavity modes and the external waveguide mode, which for the modest pump power levels used here ( W) does not allow us to reach the parametric coupling required for strong directional transmission.    
While our focus has been on the propagation of injected coherent signals through the optomechanical circuit, it is also interesting to consider the flow of noise.  As might be expected, the induced directionality of our system also applies to noise photons generated by the upconversion of both thermal and quantum fluctuations of the mechanics; see App.  for detailed calculations.  One finds that for the system of Fig. , the spectrally-resolved photon noise flux shows high directionality, but that the sign of this directionality changes as a function of frequency (analogous to what happens in the transmission amplitudes).  In contrast, in the single-mechanical mode setup of Fig.  the sign of the directionality is constant with frequency, and thus the total (frequency-integrated) noise photon flux is directional depending upon the flux magnitude. The laser pump fields can thus effectively act as a heat pump, creating a temperature difference between the left and right waveguide output fields.  The corresponding directional flow of quantum noise is especially useful for quantum information applications, as it can suppress noise-induced damage of a delicate signal source like a qubit .    
The device studied in this work highlights the potential for optomechanics to realize synthetic gauge fields and novel forms of nonreciprocity enabled by harnessing mechanical dissipation.  Using just a few modes, it was possible to go beyond simply mimicking the physics of an isolator and realize a directional optical amplifier.  By adding modes, an even greater variety of behaviours could be achieved.   For example, the simple addition of a third optical cavity mode, tunnel-coupled to the first two cavities but with no mechanical coupling, would realize a photon circulator similar to the phonon circulators considered in Ref. .  Scaling the synthetic gauge field mechanism realized here to a full lattice of optomechanical cavities would allow the study of topological phenomena in the propgation of both light and sound.  Predicted effects include the formation of back-scattering immune photonic  and phononic  chiral edge states, topologically nontrivial phases of hybrid photon-phonon excitations , dynamical gauge fields , and, in the case of non-particle-conserving interactions enabled by blue-detuned optical pumping, topologically protected inelastic scattering of photons  and even protected amplifying edge states .    
The authors would like to thank Michael Roukes for the use of his atomic force microscope in the nanooxidation tuning of the cavities.  This work was supported by the AFOSR-MURI Quantum Photonic Matter, the ARO-MURI Quantum Opto-Mechanics with Atoms and Nanostructured Diamond (grant N00014-15- 1-2761), the University of Chicago Quantum Engineering Program (AAC,AM), the ERC Starting Grant OPTOMECH (FM), the Institute for Quantum Information and Matter, an NSF Physics Frontiers Center with support of the Gordon and Betty Moore Foundation, and the Kavli Nanoscience Institute at Caltech.   
 
Device Fabrication and Methods  
Device fabrication and atomic force microscope nano-oxidation tuning
The devices were fabricated from a silicon-on-insulator wafer with a silicon device layer thickness of  nm and buried-oxide layer thickness of  m. The device geometry was defined by electron-beam lithography followed by inductively coupled plasma reactive ion etching to transfer the pattern through the  nm silicon device layer. The devices were then undercut using an HF:HO solution to remove the buried oxide layer and cleaned using a piranha etch.  
After device fabrication, we used an atomic force microscope to draw nanoscale oxide patterns on the silicon device surface.  This process modifies the optical and mechanical cavity frequencies in a controllable and independent way with the appropriate choice of oxide pattern. The nano-oxidation process was carried out using an Asylum MFP-3D atomic force microscope and conductive diamond tips (NaDiaProbes) in an environment with relative humidity of . The tip was biased at a voltage of  V, scanned with a velocity of  nm/s, and run in tapping mode with an amplitude of  nm.  The unpassivated silicon device surface was grounded. 
Optical transmission coefficient measurement   
To measure the optical power transmission through the optomechanical circuit we used a vector network analyzer (VNA). The VNA outputs a microwave tone from port 1 with frequency  to an electro-optic modulator which modulates the optical pump to generate an optical sideband corresponding to the optical probe. In the case of a blue-detuned pump from the optical cavity resonance, the probe field corresponds to the lower sideband (selected by the filtering properties of the cavity itself).  Both the optical probe and pump are launched into one optomechanical cavity in the circuit. At the other cavity, the transmitted optical probe combines with a second pump and the beating of the two is detected by a high-speed photodetector (both the first and second pump beams are from the same laser source, and thus phase coherent). The photocurrent signal from the photodetector is sent into port 2 of the VNA to measure the microwave signal transmission coefficient . Fig.  shows  for forward (right-propagating; blue curve) and backward (left-propagating; red curve) directions through the optomechanical circuit as a function of the modulation frequency .  In Fig. a the synthetic flux value is locked to  whereas in Fig. b .  In both flux settings the optical pumping levels were such that the left and right cavity photon numbers were  and , respectively.  This is the raw transmission data corresponding to the normalized transmission ratio shown in Figs. 3b and 3c of the main text. 
While absolute optical transmission is not directly measured, the ratio of the optical transmission coefficients for forward and backward propagation can be obtained from the normalized microwave signal transmission coefficient ,  
/^2=T_R/T_L^2, 
where  is normalized using the value of  away from all mechanical resonances to remove all the external asymmetry in the experimental setup for left and right propagation paths.  These external asymmetries include modulator efficiency, cable/fiber loss, etc. In our analysis the normalization level is the average value of  in the frequency range of - GHz.  To be clear, the reason this calibration is necessary is because we don't actually physically swap the source and detector in our measurements.  Rather, for the left-to-right transmission path we have one modulator on the left side which generates the probe tone and one detector on the right side which measures the transmission through to the right side.  When we measure right-to-left transmission we have a different modulator on the right side to generate the probe tone and a different detector on the left side to detect the transmitted probe.  If the modulator on the left side is different from the modulator on the right side, then for the same microwave drive that excites the modulators we would get different a different optical probe power in the sidebands of the pump.  Similarly if the left and right detectors have different efficiencies then they would produce a different photocurrent for the same transmitted optical probe power.  Since we measure in practice the ratio of the microwave drive to the detected microwave photocurrent, this could cause an inherent asymmetry in the measured transmission for left-to-right and right-to-left transmission even if the optical transmission was perfectly symmetric. 
Device characterization    
To determine the components of optical cavity loss (intrinsic decay rate , external waveguide-to-cavity coupling , total cavity decay rate ) of both the left and right optical cavities we used a pump-probe scheme similar to that used to measure the nonreciprocity of the optomechanical circuit.  The pump beam in this case, however, is set to be very weak so as to not resonantly excite the mechanics as the probe signal is swept across the optical cavity resonance.  The cavity scans are plotted in Fig. a and b for the left and right cavities, respectively. We fit the phase response curves and get   GHz,   GHz, and   GHz. The intrinsic and external optical cavity rates are used to determine the intra-cavity photon number for a given optical pump power (specified at the input to the cavity). 
Thermal mechanical spectra of the two cavities are measured with a weak blue-detuned optical pump so as to avoid back-action; a single pump is used for each of the left and right cavity measurements. The reflected pump light from the cavity contains modulation sidebands from the thermal mechanical motion, which upon detection with a high-speed photodetector creates a photocurrent with the thermal motion of the mechanical cavity modes imprinted on it. Since the mechanical modes can be hybridized between left-cavity, right-cavity, and waveguide modes, a measurement with the left-side pump produces a local measurement of the cavity modes as measured by the localized left optical cavity mode, and similarly for the right-side pump and cavity.  The intrinsic decay rate of the mechanical modes is inferred from the linewidth of the Lorentzian mechanical spectrum. 
Measurements of the mechanical mode spectra were performed both before and after the cavities were nano-oxidized to tune their localized optical and mechanical modes into resonance.  Measurements prior to nano-oxidation allowed us to determine the local (left and right) mechanical and optical cavity mode properties (i.e., the bare, uncoupled mode properties).  Knowing the left and right cavity mode properties from independent measurements allowed us to fit with fewer fitting parameters the measured forward and backward transmission curves of the hybridized cavities presented in the main article text.  Note that after nano-oxidation the left and right optical cavity modes were only very weakly hybridized so as to maintain their left-cavity and right-cavity character.  The mechanical modes were tuned to be strongly hybdridized as evidenced in Fig. 2f of the main text.  Figures c and d show the measured linewidth of the mechanical cavity modes  versus optical pumping power.  In Fig. c the left cavity was pumped with a blue detuning ; in Fig. d the right cavigty was pumped with a blue detuning of .  By fitting the measured data with formula  ( corresponding to the intra-cavity photon number determined from the  measured cavity properties), we obtain    MHz and  MHz for the left (right) localized cavity modes. 
The optical () and mechanical () hopping rates between the two optomechanical cavities via the connecting waveguide are determined from a global fitting using Eq. (1) of the main text for the group of measured transmission coefficient ratio curves in Figs. 3c and 3d with varying .  The intra-cavity cavity photon number, optomechanical coupling rates and intrinsic mechanical decay rates are all taken as fixed and equal to the independently measured values as described above.  
With the fit value of  from forward and reverse transmission measurements versus , and the measured cavity coupling rates (, ) from the left and rigth optical cavity modes prior to nano-oxidation tuning, we fit the measured optical reflection spectra of the two weakly coupled optical cavity modes after nano-oxidation.  This allows us to determine the uncoupled left and right optical cavity mode frequencies.  The measured and fit spectra as measured from the left and right cavities are shown in Fig. e. As noted earlier, the measured spectra after nano-oxidation are still predominantly given by uncoupled left and right cavity modes.  Based on the theoretical fit to the measured optical reflection spectra, we also calculate the transmission of an optical probe signal through the optomechanical circuit in the absence of a pump beam (i.e., no coupling to phonons, just pure optical transmission)
insertion
JJ^2+/4-( 
Fig. f shows the numerical result, and the minimum insertion loss for transmission from one port to the other port is found to be about  dB for a probe signal frequency in between the two cavity resonances.  This is the estimated port-to-port optical transmission effiency in absence of optomechanical amplification.    
Theory of optical nonreciprocity  
Input-output formula
We provide theoretical analysis of optical nonreciprocity in the coupled optomechanical cavity system. We first consider the case with two optical and two mechanical cavity modes. The Hamiltonian of this system can thus be written down as follows, 
H     = & _k=L,R _ck a_k^a_k + J (a_L^a_R + a_L a_R^)
              +_k=L,R _mk b_k^b_k + V (b_L^b_R + b_L b_R^) 
 &
              +_k=L,R  g_0k (b_k^+b_k) a_k^a_k 
              +_k=L,R i_ek_pke^-i_p k t-i _k(a_k-a_k^),    
where  and  are the waveguide mediated optical and mechanical coupling strength (we gauged out the phase of  and  and take both of them to be real), and the last two terms are the optical driving fields (pumps) which have the same frequency and correlated phases.  
    
We consider the situation where the optical cavities are nearly degenerate, i.e.,  and both optomechanical systems are 
driven with a blue-detuned laser (). We perform a displacement transformation , separating the classical
steady state amplitude of the local optical cavity field from its fluctuations.  
With this we can linearize the optomechanical interaction in the Hamiltonian of Eq.  in the usual manner. 
Assuming the good cavity limit (sideband resolved, ), we apply a rotating wave approximation and obtain for the equations of motions () 
 ddt d_L =& ( i _L  - _L2 ) d_L 
                          - _eL  d_L,in   - _iL _L,in  
                          - i J d_R - i  G_L  b_L^   e^i_L,
                          
 ddt d_R =& ( i _R   - _R2) d_R 
                         - _eR d_R,in    - _iR _R,in  
                         - i J  d_L - i  G_R  b_R^   e^i_R,
                          
 ddt b_L =& -(i + 2) b_L   
                         -  b_L,in   
                         - i V b_R 
                         - i  G_L  d_L^      e^ i_L,
                            
 ddt b_R =& -( i + 2 )b_R 
                         -  b_R, in   
                         - i V b_L 
                         - i  G_R  d_R^      e^ i_R,  
with the total damping rates , the detunings  and the many-photon optomechanical couplings .
The latter contains the steady state amplitude of the local optical cavity field , 
which is related to the pump amplitudes through  
_L(R)e^i_L(R) =& (i_R(L)-_R(L)/2)_eL(R)_pL(R)e^-i_L(R)+iJ_eR(L)_pR(L)e^-i_R(L)
                                      (i_L-/2)(i_R-/2)+J^2.   
We find the steady state amplitude is approximately  under the condition , which means each cavity is effectively only driven by its own optical pump.  
Thus, each pump-enhanced optomechanical coupling and its phase can be independently controlled.  
The intrinsic noise operators  and  in the coupled mode equations  describe thermal and vacuum fluctuations impinging on the the cavities and the mechanical modes respectively. The associated noise of a possible input signal is described via .   
Mechanically-mediated coupling
We perform a Fourier transform (; ) of the coupled mode equations Eqs.  and insert the resulting solution for   into the equations of the cavity operators. 
Ignoring the intrinsic noise terms  and  for the moment,
we obtain for the cavity operators in frequency space () 
_L,+^-1[]  d_L[] =& - _eL d_L,in[] 
                                  - i ( J -  _+[] e^+ i    ) d_R[]  ,   
 _R,+^-1[] d_R[] =&  - _eR d_R,in[]
                                  - i  ( J - _+[] e^-i   ) d_L[] ,   
with the modified susceptibility . The 
frequency dependent coupling  and the  self-energy   are defined as   
 _+[] =           V G_R  G_L       [ - i (+ ) + 2 ]  [( - i ( + ) + 2 ] + V^2  , 
  _k,+ [] =&     i G_k   V G_k      [ - i ( + _mk)  +  _ik2 ]   _+[]  ,  
here the coupling  coincides with Eq. (2) of the main text. 
After eliminating the mechanical degrees of freedom, one finds both a "local" modification of each cavity (described by the self energy ) and an induced coupling between the cavities.
The self-energies lead to damping (or anti-damping) of each cavity resonance as well as a frequency shift of the resonance. 
Here the subscript  indicates blue-detuning (). The poles of the self energy read  
 _ = - i4 ( + ) - 12 ( +  ) 
                   V^2 - [ 14 (- )   -   i2 (- )    ]^2    . 
The induced coupling  has a coherent and a dissipative aspect. 
To illustrate this we separate the coupling into real and imaginary parts .  
The real and imaginary parts of this frequency-dependent coupling have completely different physical interpretations.   
We see this, by considering again the coupling terms in Eq. (). We have 
  d_L[]  &    [ -i ( J  - _[] e^+  i     )   -    _[] e^+ i  ]  d_R[]  
                [ -i J^[]  -    _[] e^+ i   ]  d_R[]   ,  
 d_R[]   &     [ -i  (J   - _[]  e^-i      )    -_[] e^-i   ] d_L[]  
                 [-i   J^[]    -   _[] e^-i   ] d_L[]  . 
For the given frequency of interest, we see that the real part of the induced coupling is completely equivalent to having a Hamiltonian, coherent tunneling term between the cavities;
we can absorb it into a redefinition of the coherent hopping strength , i.e., . 
In contrast,  the coupling mediated by the imaginary part  is not equivalent to some effective coherent tunneling interaction between the cavities,
i.e., the   terms in  and   Eqs.() cannot be incorporated into a definition of .
The terms involving  instead represent a dissipative coupling between the two cavities mediated by the mechanics.
Such dissipative interactions (if we ignore their frequency dependence) can be obtained in a master equation formalism via an effective Lindblad dissipator
of the form ,
where  is the standard Lindblad superoperator.    
Directionality by balancing coherent and dissipative interactions 
The dissipative coupling is crucial for directionality: by balancing the dissipative interaction against the coherent interaction we obtain a nonreciprocal system
 (following the general recipe outlined in Ref.).
For example, if we aim for a directional transport from the left to the right cavity, we want to decouple the left cavity from the right cavity (while still having the right cavity influenced 
by the left cavity). This is accomplished by balancing  coherent and dissipative interactions, i.e., 
 J[]    !=  i  _[] e^i   , 
in which case the coupling from the left to right cavity vanishes,  cf. Eq. (), and we obtain a unidirectional coupling where the right cavity is driven
by the left cavity but not vice versa. Crucially, this would not be possible without the dissipative interaction, i.e., we need .
Note, for the situation that , i.e., , but finite , we  still obtain a directional
dependent phase. However, to use this as the basic for nonreciprocal transmission additional interference processes have to implemented. 
The directionality condition Eq. () can be reformulated in terms of the original  and the phase difference  as used in Eq. ().
This translates to the condition  
 J = _+[]  , 
   =     - (_+[] ) , 
where we still aim for unidirectional behavior from left to right.
For the case of a purely real coupling  these conditions could still be satisfied, i.e., for  and . 
However, this means that there is effectively no coupling between the cavities, and thus no forward transport either. 
Note, that a sign change in  would lead to the opposite situation, where the propagation direction would be from right to left. 
In general, the directionality balancing condition obtained here is frequency dependent, for the simple reason that the mechanically-mediated cavity-cavity coupling is frequency-dependent.
If we could somehow fulfill the directionality condition in Eq. () at every frequency,
the cavity output field operators would be given by (using the standard input-output relation ) 
   d_L,out[] =& [1  -  _eL  _L,+[] ]d_L,in[]   ,  
  d_R,out[] =&  [1 -  _eR  _R,+ [] ] d_R,in[] 
                                  - i _eR_eL _R,+ [] _L,+[]_+[]  
                                       ( e^i  2(_+[])      -  1 )  
                                         d_L,in[]   , 
where we neglected the noise  contributions originating from the mechanical modes, i.e., the coupling to  in Eq. (), 
and the intrinsic cavity noise  for simplicity.
Here, we see again that the dissipative interaction is crucial as we need ,  i.e., we need a finite imaginary part of . 
The  experimentally relevant situation is where dissipative and coherent interactions are only balanced at a single frequency 
(by appropriate tuning of phase and ). Achieving this condition close to the normal modes resonance frequencies is favorable given the resonantly-enhanced transmission.
Enforcing directionality at  for equal mechanical resonance frequencies, results in the directionality conditions 
 : 
 = 2 V (+)  , 
 J =      V G_R  G_L   14  V^2    (+ )^2 +   ^2^216     ,  
where the upper (lower) sign in the phase difference  realizes directionality at . 
Directionality here means  that an input signal  injected on the left cavity is transmitted to the right cavity, whereas the 
backward propagation path, i.e., from right to left, is blocked.   
On the other side, if we assume identical bare mechanical damping of the mechanical modes (), but unequal bare mechanical frequencies (), 
then we find that at the frequencies of the hybridized mechanical modes  
the directionality condition is modified to 
 : 
 = 4   V^2+14(   , 
 J =       V G_L G_R   V^2 + ^216 + 14(  .  
where the upper (lower) sign in the phase difference  realizes directionality at . 
The directionality conditions for a perfectly symmetric device, i.e., for equal mechanical resonance frequencies  and decay rates , can simply be read off from
either Eq.  or Eq. .   
Nonreciprocal optical transmission: two blue-detuned pumps
From the equations for the cavity operators in Eqs.  we can calulate the transmission coefficients via input/output theory.
Note, that although Eqs.  are formulated on the basis of noise operators, they as well describe the dynamics of the cavity field amplitudes 
around their steady state solution.
The right transmission coefficient  and left transmission coefficient  are given by 
T_R L [] =& i     [ J - _+[]  e^i ]
                                     _L^-1[]  _R^-1[] +  [ _+[]^2 + J^2 - 2 _+[] J ()]   
                                    A_+[]  [ J - _+[]  e^i ],   
with the modified susceptibilities  as defined after Eq. (). 
The prefactor  is the same for both transmission amplitudes, it accounts for the mechanically-induced back-action on the optical cavities, cf. main text after Eq. (2).  
Note, that the corresponding prefactor for two red-detuned pumps is simply  . 
We now assume a completely symmetric pair of mechanical cavities ( and ) and apply the 
corresponding directionality direction for symmetric parameters, cf. Eq.  or Eq. .
The transmission coefficient for the through direction () under these conditions of perfect nonreciprocity is given by,  
 T_ [-V]     =& _R _L
        1 i 4V      1 i  4V    
          8  i    C_L  C_R    
                
           [    C_L (1 i _i2V  )    -  (1 i 2 V_L)    (2 i _i2V  ) ] 
           [    C_R (1 i _i2V  )    -  (1 i 2 V_R)    (2 i _i2V  ) ], 
introducing the single cavity cooperativity . 
Considering as well symmetric optical cavities (; ) with symmetric optical pumping ()
the transmission coefficient simplifies to 
T_ [- V]  &   V   
                                          8 i C  _e  
                                                [  2  -   C i   2V ( 1 - C  )      ]^2 ,   
with  and under the realistic assumption that the hopping rate  is much lower than the cavity decay rate .
Here we work with blue-detuned pumping of both optical cavities (), which results in parametric amplification of each of the left and right mechanical modes  
and leads to amplification of the optical probe signal.
This becomes apparent for the situation that the mechanical hopping rate is much faster than the intrinsic mechanical decay rate (). 
In this case the gain diverges for  (this is twice as large as for a single cavity instability because the mechanical modes are hybridized and thus the effective optomechanical coupling from the left or right optical cavity is reduced by a factor of , hence the cooperativity by a factor of 2).  Note, for the situation ,
 the directionality conditions at the hybridized mechanical modes  simplifies to  and . 
Nonreciprocal optical transmission: two red-detuned pumps
The analysis for the the case of two red detuned pumps is similar to the blue-detuned case. 
The cavity operators in  Eq.() couple now to the mechanical lowering operators  and vice versa, while
the detuning between the cavity resonances and the external pump tones yields . 
The ratio of transmission coefficients is found to be given by the following expression 
 =& J - _-[]e^-i J - _-[]e^+i = 
J  - V  G_L G_R[ -i (- ) + 2] [ - i(- )+2] + V^2 e^-i 
     J  - V  G_L G_R[ -i (- ) + 2] [ - i(- )+2] + V^2 e^+i  
where we have , thus the ratio  is the same for blue and red detuned pumps evaluated at corresponding frequencies.
The reason for this is that the transmission is either amplified or suppressed simultaneously for both directions and thus their ratio stay unchanged.  
Comparing to the blue detuned case, the perfect nonreciprocity condition remains the same in the red detuned case, while the transmission coefficient for the through direction 
the hybridized mechanical modes   is given by (assuming ,  and )  
 T_ [  V] & _R _L  
  8 i  C_L  C_R   
         
       [    C_L +    2  i 2V ( C_L  +1 )     ]
       [    C_R +    2  i 2V ( C_R  +1 )     ].  
From Eq. , we note in general an attenuated transmission for the red detuned case as . For the case of a fast hopping rate 
 equality is achieved when  and/or . Comparing the latter to Eq.  we see the maximal through transmission efficiency is achieved when the optical cavity loss rate  is matched to the inter-cavity photon hopping rate  for both cavities (impedance matching condition).    
    
    
   
Nonreciprocity associated with a single mechanical waveguide mode
In our optomechanical circuits, we also observed optical nonreciprocity with a single mechanical waveguide mode. In this case, the Hamiltonian describing the interaction between two optical cavity modes and one mechanical waveguide mode is given by, 
H &  =    _k=L,R + J (+ )+
    
 &
             + _k=L,R (+ ^   ) 
              +_k=L,R i_ek_pke^-it-i_k( 
Going through a similar calculation using coupled mode equations, we find that the ratio of right and left optical transmission coefficients is 
 = &   J i   -i() + 2 e^- i(_W )
                           J i   -i() + 2 e^+ i(_W ), 
where the upper (lower) sign corresponds to the blue (red) detuned case and . 
The corresponding conditions for perfect directionality from left to right and at    are 
J =  2   ,  
 = 2 _W.  
This in turn leads to the transmission coefficients 
  T_ [ ] = &       
                                  4 i   C_WL C_WR    
                                       (C_WL 1) (C_WR 1)   . 
In the case of blue detuned tones an input signal is amplified and the corresponding gain increases for . 
Note in Eq.  we included the phase of the product . This addition comes from the fact that we have already chosen definitions for the local cavity mode amplitudes ( and ) such that the phase of the optomechanical couplings of the localized cavity modes --  and  -- are both zero.  With these same definitions for amplitudes  and  we are not then free to set the phases of both  and  to be zero; not at least for the same set of pump phases  and  chosen for the localized cavity mode coupling. A simple example helps to illustrate this.  The mode  can be viewed as a hybridization between the localized left and right cavity modes and a delocalized waveguide mode .  Using perturbation theory, we have for the mechanical mode amplitude of the hybridized mode ,
hybridization
+ - + 
where  is the unperturbed delocalized waveguide mode amplitude and  is the unperturbed frequency of the delocalized waveguide mode.   is the coupling coefficient between the delocalized waveguide mode and the localized cavity mode . The phases of  and  are determined by the field distribution of the hybridized mode  in the left and right cavities, respectively, and cannot be (both) chosen arbitrarily . Using the mode decomposition of Eq. , we have that  as we have already chosen a local cavity mode amplitude basis such that  and  (this assumes of course that the left (right) optical cavity mode only couples to the portion of  which is due to  (), which is a good approximation due to the fact that the optical cavities are in the far field of each other).  Thus, by simultaneously measuring the flux-dependent transmission near the resonance of the localized mechanical cavity modes and the hybridized mechanical waveguide mode we can determine the  in this mode basis (see Fig.  for example). For the  mode in our experiment, we find , which means for this hybridized mode and chosen localized cavity mode basis the mechanical motion in the left cavity as seen by the left cavity optical mode is approximately  degrees out of phase with the motion in the right cavity as seen by the right cavity optical mode.      
Directional flow of quantum and thermal noise 
Besides the nonreciprocal optical signal transmission, the flow of quantum and thermal noise in the optomechanical circuit is directional. 
This is a natural consequence of the system's scattering matrix having a directional form; the scattering matrix determines both the transmission of coherent signals, as well as noise properties. 
To show this, we calculate the symmetrized output noise spectral density via 
 S_k,out[] = 12 d2 d_k, out[], d_k, out ^[] , 
defined in the standard manner . The mechanical and optical noise  operators introduced in Eqs.  have zero mean
and satisfy the canonical correlation relations: 
o_k, in [] o^_k^,in [] 
= o^_k, in  [] o_k^, in [] + _k,k^(+)
= ( n_o_k^th+1 ) _k,k^(+), 
o_k, in = d_k, in,_k, in,b_k, in . 
where  is the thermal occupation of each bath. In what follows, we assume that we have no thermal occupation of the optical field.
This is justified as we work with a very high optical frequency.    
Figure a-d depicts the output spectra for the situation that both pumps are blue detuned from the cavity by . 
Here we assumed equal mechanical frequencies  and  work in a rotating frame where the uncoupled mechanical resonance frequencies are shifted to zero.
The remaining parameters are as used in the experiment, i.e., we take  MHz,  MHz,  GHz,  GHz,  GHz,  GHz,  MHz,  MHz. The multiphoton couplings  used in the calculation are determined from Eq. .  
Figure a shows the result for zero temperature mechanical baths  and a finite phase  (determined from Eq. ). 
As expected, the  and  output spectra are not identical: while each has a double-peaked structure (corresponding to the two normal mode resonances), 
the right output spectra  has the upper-frequency peak larger than the lower-frequency peak, while the situation is reversed for
the left output spectra. This does not lead to any asymmetry in the total output photon number fluxes  (i.e., intergrated over all frequencies). It does however lead to an asymmetry in the energy fluxes 
(i.e., as the higher energy peak is bigger for the right output spectrum, and the low energy peak is bigger for the left spectrum).
Thus, the  "quantum heating" of zero-point fluctuations preferentially cause an energy flow to
the right (rather than to the left) for this choice of phase.    
It is also worth noting that if all dissipative rates are equal for the  and  cavities, then the  output spectrum is just the frequency-mirrored  output spectrum.
The latter is visible in Fig. (c), where we plotted the output spectra for symmetric parameters, i.e., we set  MHz,  GHz,  GHz  and  (determined from Eq.  for the new ).
However, having unequal decay rates, i.e.,  and , leads to a slight asymmetry even if the phase is set to zero, i.e., , as visible in Fig.b.
In Fig. g we plot the asymmetry  for all the four cases corresponding to Fig. a-d.  
For finite temperature, we find that the output spectrum has a roughly linear dependence on the mechanical bath temperature:  
(assuming ). This linear dependence is visible if we compare Fig. c,d and Fig. e,f,
where the latter  show the output noise spectra for  with symmetric cavity parameters.  
Additionally, we also calculate the added noise quanta to the transmitted signal 
n_k,add[] S_k,out[] T_k []^2-12, 
where  is the half quanta noise of the vacuum optical fields injected from the coupler. Fig.h shows the added noise for left-right propagation with  (and asymmetric experimental cavity parameters). The mechanical baths  are varied as denoted in each graph. Even if the cavities and the mechanics are only driven by vacuum noise the standard quantum limit (SQL) of half a quanta is not achieved.  This is due to the limited amount of gain achieved in the experiment, i.e., the transmission coefficient is not high enough to suppress the noise contributions. 
Moreover, even in the large gain limit the added noise would be roughly one quanta due to the finite amount of intrinsic optical cavity loss.     
    
Reciprocal device    
Realizing optical nonreciprocity in the optomechanical circuits studied in this work is not simple or easy as just creating a circuit with optical and mechanical coupling between two optomechanical cavities.  One is limited by the practical realities of device power handling capability, finite optical and mechanical -factors, etc.  As such, not all the circuits that were tested exhibited nonreciprocal transmission and amplification; the effects were too weak to observe in some circuits.  This, however, was a useful test of our set-up as nonreciprocity could be effectively turned on and off by looking at different circuits with only slightly different parameters. 
Eq.  sets the desired circuit parameters in order to achieve significant nonreciprocity, which for the optomechanical coupling, optical and mechanical -factors, and the power handling capabilities of the nanobeam cavities requires optical hopping rate between cavities to be less than  MHz.  Devices with larger coupling rates can simply not be pumped hard enough to satisfy . To confirm this, here we show another optomechanical crystal circuit with bare cavity wavelengths of   nm and inter-cavity photon hopping rate of  GHz (more than ten times larger than the device studied in the main text). The mechanical spectra of this device as measured from both the left and right optical cavities is shown in Fig. a.  Figure b shows the normalized transmission coefficient for forward and reverse optical signal propagation for a blue-detuned pump wavelength of  nm and synthetic flux of .   Even at the largest pump powers ( W; ) this device does not satisfy the condition of Eq.  due to the large , resulting in nearly perfect reciprocity in the optical signal transmitted power.  These measurements were performed on the exact same set-up as the circuit studied in the main text.   
     
    
    
   
    
Anderson Localization of Composite Excitations in Disordered Optomechanical Arrays
Thales Figueiredo Roque
Instituto de Fisica Gleb Wataghin, Universidade Estadual de Campinas, 13083-859 Campinas, Sao Paulo, Brazil 
Vittorio Peano
Institute for Theoretical Physics II, University Erlangen-Nurnberg, D-91058 Erlangen, Germany 
Oleg M. Yevtushenko
Institute for Theoretical Physics II, University Erlangen-Nurnberg, D-91058 Erlangen, Germany 
Florian Marquardt
Institute for Theoretical Physics II, University Erlangen-Nurnberg, D-91058 Erlangen, Germany
Max Planck Institute for the Science of Light, Gunther-Scharowsky-Strasse 1, D-91058 Erlangen, Germany  
      Optomechanical arrays are a promising future platform for studies of transport,
      many-body dynamics, quantum control and topological effects in systems of coupled
      photon and phonon modes. We introduce disordered optomechanical arrays, focusing on
      features of Anderson localization of hybrid photon-phonon excitations. It turns
      out that these represent a unique disordered system, where basic parameters
      can be easily controlled by varying the frequency and the amplitude of an external
      laser field. We show that the two-species setting leads to a non-trivial frequency
      dependence of the localization length for intermediate laser intensities. This could
      serve as a convincing evidence of localization in a non-equilibrium dissipative situation.    
    42.50.Wk, 
    71.55.Jv, 
    42.65.Sf     
Introduction:
Optomechanics is a rapidly evolving research field at the intersection
of condensed matter and quantum optics . By exploiting
radiation forces, light can be coupled to the mechanical motion of vibration modes.
The interplay of light and motion is now being used for a range of applications,
from sensitive measurements to quantum communication, while it also turns out to
be of significant interest for fundamental studies of quantum physics. 
This rapidly developing area has so far mostly exploited the interaction between a
single optical mode and a single mechanical mode. Going beyond this, recent theoretical
research indicates the substantial promise of so-called optomechanical arrays, where
many modes are arranged in a periodic fashion. In such systems, a large variety of new
phenomena and applications is predicted to become accessible in the future. These include
the quantum many-body dynamics of photons and phonons , classical
synchronization and nonlinear pattern formation ,
tunable long-range coupling of phonon modes ,
photon-phonon polariton bandstructures and transport ,
artificial magnetic fields for photons ,  
and topological transport of sound and light . A first experimental
realization of a larger-scale optomechanical array has recently been presented, involving
seven coupled optical microdisks . Even greater potential is expected for
implementations based on optomechanical crystals ,
i.e photonic crystals that can be patterned specifically to generate localized photon and phonon modes. 
Given these promising predictions and the rapid experimental progress towards larger
arrays, the question of disorder effects now becomes of urgent importance. For example,
in the case of optomechanical crystals, experiments indicate fluctuations in the geometry
of about 1, which translate into equally large relative fluctuations of both the
mechanical and optical resonance frequencies. This will invariably have a very significant
impact on the transport properties. However, gaining a better understanding of disorder
effects in the various envisaged applications is only one motivation of the research to
be presented here. Of equal, possibly even greater, importance is the opportunity that
is offered by optomechanics to create a highly tuneable novel platform for deliberately
studying fundamental physical concepts such as Anderson localization . 
Localization of waves in a random potential  
is one of the most remarkable and nontrivial interference effects.
Initially, it has been studied in electronic disordered systems ,  
though this effect applies equally to other types of quantum and even classical waves
. By now, localization and related phenomena have been discovered
and investigated in photonic systems
,
coupled resonator optical waveguides , cold atomic gases
, in propagation of acoustic waves 
and in Josephson junction chains .
Localization can even play a constructive role, namely in
random lasing . In spite of extensive theoretical efforts, the unambiguous interpretation
of experimental manifestations of localization often remains a challenge, even in situations where the ideal version of Anderson localization applies. 
Optomechanical arrays enable controlled optical excitation and readout and at the same
time promise significant flexibility in their design. However, it is the optical
tuneability of the interaction between two different species (photons and phonons) that
makes optomechanical systems a unique platform. As we will show in the present Letter,
this offers an opportunity to study effects in Anderson localization physics which currently
represent a significant challenge even on the theoretical level and will thus open the
door towards exploring novel physics that has not been observed so far.    
The model:
We consider a 1D array of optomechanical cells (OMA), see Fig., driven by
a single bright laser. The cell  contains an optical and a vibrational mode that are coupled via the standard linearized
optomechanical Hamiltonian 
H_j= _ _,j  n_,j  -
                                            g_j ( c_o,j + c^_o,j ) ( c_m,j +  c^_m,j ) ;  
see Refs. for details.
Here , and
 is the bosonic annihilation operator of either optical, ,
or mechanical, , excitations (we set ).  
Due to disorder, the frequencies  fluctuate around mean values 
. We assume that  are independent
Gaussian random variables with variances 
.
Eq. () is defined in a  rotating frame, where
the optical frequencies  are counted off from the laser frequency,  .
Thus,  indicates the average detuning  and can be tuned in situ by
varying the laser frequency. The optomechanical couplings  are proportional to the  mean amplitude of the
light circulating  in the cavity  . Hence, they are also tunable by varying
the laser power.   
The presence of two-mode squeezing interactions in Eq. () can in principle lead to instabilities.
We choose  such that these terms are off-resonant and disorder configurations
with optical  or vibrational instabilities are very rare. We leave their study for a
forthcoming paper.    
    
    
We can describe the full OMA by a Hamiltonian with nearest-neighbor optical, , and
mechanical, , hopping amplitudes:  
  H= _jH_j - H_h , 
  H_h = _j,  J_  c^_,j+1 c_,j + H.c. 
Our model is time-reversal symmetric .    
Clean polariton bands:  
In a clean  
OMA without dissipation (and without squeezing interaction),
the  photon--phonon hybridization leads to a pair of bands with energies 
  _= -2J (k) 
                    [/2 - J  (k)   ]^2 + g^2 , 
where ,  and
likewise for . We refer to  as upper/lower polariton band, respectively.
 denotes the wave-vector of polaritonic Bloch states.
We focus on the regime where the uncoupled bands overlap, .
In this case, the polariton bands are separated by a gap if the coupling becomes large enough,
 , see Fig.. 
Anderson localization of uncoupled excitations:  
It is well known that even weak disorder leads to a crucial effect in a  
1D system: the eigenstates become localized. If ,  
each subsystem (photon/phonon), is individually described by the 1D Anderson model .
The localized states  
decay exponentially away from their center, . Here  are the bare localization
lengths for photons and phonons (for ), measured in units of the lattice constant. Using the theory of 1D localization
, we can approximate the frequency dependence of the localization length:  
 ^(0)_() 2 ( 2 [k_()] / _)^2 ; 
here the dimensionless quantities  and  are
the disorder strength and the bare group velocity, respectively.  
Eq.() is valid for weak (up to moderately strong) disorder . The comparison
of Eq.() with numerical results is shown below in Fig..   
In any experiment, localization
can be detected if photons and phonons explore the localization length before leaking out, at a rate . This holds true if
,  
which allows us to neglect dissipation in a first approximation .
In addition, the sample size  should be larger than the localization length, . For typical  we need , corresponding to .    
    
Localization in Optomechanical Arrays:
At finite photon-phonon coupling, we encounter an Anderson model with two channels. Localization in the symmetric
version of this model (with equal  
parameters of each channel) is well studied and understood   
. However, OMAs do not fall into this universality class since the mechanical
band is generically much narrower than the optical one, . Thus, the hybrid
excitations consist of two components with very different velocities.
Similar composite quasiparticles are not uncommon, another example is given by cavity polaritons
 including polaritons in a disordered potential .
Developing the theory of localization for such non-symmetric systems remains a real challenge,
cf. Ref..   
The hybrid localized states typically have two localization lengths, ,   
see the upper panel of Fig..
For small systems, , the excitations do not feel localization
and propagate ballistically. Their transmission decays as 
in the range  and becomes suppressed as  at . Our numerical analysis
shows that the space region where  dominates quickly shrinks with increasing .
Therefore,  seems more interesting experimentally, and we will focus on this 'large' localization length in the following.   
We start from a numerical analysis for relatively strong disorder. At the
first stage, we neglect disorder-induced fluctuations of   and use its homogeneous
mean value .  
The method:   
The localization length can be obtained, e.g., from  the photon-photon transmission,
 where 
is the frequency-resolved retarded Green's function.  is defined via the optical power
detected on site  at frequency  while a probe laser of the same frequency is impinging
on a different site  . For , we expect 
. Thus, the expression for the averaged (inverse) localization length reads  
  ^-1_2()= -_x  (
                           (T_oo(j,k;) ) _d
                           / 2 x
                                              ). 
We note that the value of  is the same for other transmission
processes (e.g. photon-phonon transmission) .  
Eq.() can be used as a definition even in the presence of dissipation.
In the absence of dissipation and instabilities, there is a simpler alternative, namely extracting the localization
length directly from the spatial profile of eigenstates .   
    
To ensure reliability of results, we have combined both approaches in numerical simulations.    
Analysis of numerical results:
The upper panel of Fig. shows a typical optomechanical eigenstate
in the case of small coupling. The excitation frequency has been selected from the tail of the pure
mechanical band. Two different slopes, which correspond to two different localization lengths
, are clearly visible. When  increases and the other parameters of the upper Fig.
remain unchanged,  
the region where  dominates shrinks  and becomes invisible
very quickly. In the following, we will concentrate on   
and will denote it as  for the sake of brevity. The lower panel of Fig. illustrates
the distribution of optomechanical excitations in space and frequency, including the character of excitations
(photon vs. phonon). 
Here, and in the following, we have displayed numerical results for an illustrative
set of parameters: 
. Localization of the optomechanical excitations becomes pronounced
at . For concreteness, we have chosen
equal relative disorder strength, . In real samples,  ranges 
from 1GHz to 10THz (: from 100kHz to 1GHz) with the optical disorder being of 
order 100GHz to 1THz  (mechanical: from 10MHz to 100MHz). Thus, our choice of 
 falls into the range of experimentally relevant parameters.
The optomechanical coupling in our numerics ranges from weak,
, to strong, . To suppress finite size effects,
we employed large systems, , during exact diagonalization. The Green's
functions method has allowed us to explore even much larger sizes.    
In Fig., we display the frequency-dependence of the localization length of hybrid optomechanical
excitations in a disordered array, one of the central numerical results of this article. For comparison, we also show the
situation for the uncoupled systems, including the (scaled) analytical expression for ,
Eq.()  (green solid line in Fig.a).   
Once the subsystems are coupled, significant changes of  occur in the vicinity of the
unperturbed (narrow) mechanical band where the optomechanical hybridization is most efficient.  
Firstly we note that, if , the coupling between the optical and the mechanical 
systems is perturbatively weak even in the middle of the mechanical band [region I in Fig.(f)].   
    
On the other hand, when the optomechanical coupling becomes large,  
 for our choice of parameters,
a gap opens around the resonant frequency  and remaining excitations inside the gap tend to 
become localized [Fig.(e)].    
    
    
Analytical methods which would allow one to explore localization in strongly disordered systems are not available in general.
Nevertheless, it turns out that our optomechanical array corresponds to a certain two-channel system,  which was studied
analytically in Ref. for the limit of weak disorder and large coupling. Remarkably, the shape of our numerically
extracted  at large  agrees with the predictions of Ref., even though we are here dealing with
strong disorder,  .    
The theory of Ref. is valid if  is large compared with the (bare) mean level
spacing in the localization volume, , which holds true for the parameters 
of our numerical study at   . If ,  
(i.e., if the clean polariton bands are separated by the gap of the width )
we can use the following (leading in ) expression for the localization length :   
   ( ) & & 4 (2 [ k_() ] )^2 /
                                                   ( ^2 [ 1 + ^2() ] )  ;  
   () & = & 2 J_o J_m g / J (- _r) , 
                        _r J_o / J .
    
Here  and
 denotes the inverted dispersion relation  . The quantity
 is called ``rapidity''. It coincides
with the group velocity of the excitations for ,
and according to Eq.() it governs the frequency-dependence of  in the coupled case.
The factor  reflects renormalization of the disorder strength caused by the optomechanical
coupling. Calculation of  is beyond the scope of Ref.
and we have found its approximate value  by fitting the analytically
calculated maximal value of  to the numerical one.
Fig.e shows the comparison of the analytical and numerical results. They differ
noticeably only close to edges of the clean band where the analytical theory
looses its validity because . In addition, the gap is smeared by the relatively strong disorder.   
We have discovered that, at  ,  the crossover between small and large 
values of  is highly non-trivial (and it is outside the scope of the analytical theory): 
when the optomechanical coupling increases from  to 
[region II in Fig.(f)], the single maximum of  [cf. Fig.(a)(b)]
grows sublinearly in  .
This growth  stops and turns into a decrease when . Simultaneously, a new local maximum 
develops at the frequency corresponding to the maximum of the rapidity  [Fig.(b)(c)
and region III in Fig.(f)]. Finally, the new local maximum becomes the global one and a dip 
appears close to  at 
[Fig.(c)(d)]. This non-trivial dependence of the localization length on the
coupling constant, i.e., on the tuneable intensity of the external laser, could help to distinguish localization
and trivial dissipation effects in real experiments.   
    
We have checked that the shape of  is robust with respect to dissipation effects
as long as the mean level spacing in the localization volume of the hybrid excitations is larger
than the optical and mechanical decay rates,  .
Propagation of the excitations is suppressed due to their
finite life time which is reflected by the frequency-independent decrease of . Typical profiles
 are shown in Fig. where the optical dissipation rate increases until
. These profiles are also robust with respect to the spatial inhomogeneity
of  which results from randomness of the cell frequencies . 
Conclusions and discussion: Disordered OMAs belong to a new class of disordered systems
where composite (photon-phonon) excitations are localized and  
the most important parameters can be easily fine-tuned.  
Thus, OMAs provide a unique opportunity to study Anderson localization of composite
particles in real experiments. Moreover, they should allow to reliably distinguish localization from trivial dissipation effects.   
Future studies may address the additional novel physics that will arise when two-mode
squeezing processes become relevant. At strong driving, this could involve the interplay between
instabilities and localization, with interesting connections to random lasing, extending the new research domain of disordered optomechanical arrays into the nonlinear regime.   
We  acknowledge support from the EU Research Council through the grant
EU-ERC OPTOMECH 278320. TFR acknowledges support from
FAPESP. We are grateful to Vladimir Kravtsov and Igor Yurkevich
for useful discussions.    
3    
    
Coupled Spin-Light dynamics in Cavity Optomagnonics  
Silvia Viola Kusminskiy  
Institute for Theoretical Physics, University Erlangen-N�rnberg,
Staudtstra�e 7, 91058 Erlangen, Germany  
Hong X. Tang  
Department of Electrical Engineering, Yale University, New Haven,
Connecticut 06511, USA  
Florian Marquardt  
Institute for Theoretical Physics, University Erlangen-N�rnberg,
Staudtstra�e 7, 91058 Erlangen, Germany  
Max Planck Institute for the Science of Light, G�nther-Scharowsky-Stra�e
1, 91058 Erlangen, Germany 
Experiments during the past two years have shown strong resonant photon-magnon
coupling in microwave cavities, while coupling in the optical regime
was demonstrated very recently for the first time. Unlike with microwaves,
the coupling in optical cavities is parametric, akin to optomechanical
systems. This line of research promises to evolve into a new field
of optomagnonics, aimed at the coherent manipulation of elementary
magnetic excitations by optical means. In this work we derive the
microscopic optomagnonic Hamiltonian. In the linear regime the system
reduces to the well-known optomechanical case, with remarkably large
coupling. Going beyond that, we study the optically induced nonlinear
classical dynamics of a macrospin. In the fast cavity regime we obtain
an effective equation of motion for the spin and show that the light
field induces a dissipative term reminiscent of Gilbert damping. The
induced dissipation coefficient however can change sign on the Bloch
sphere, giving rise to self-sustained oscillations. When the full
dynamics of the system is considered, the system can enter a chaotic
regime by successive period doubling of the oscillations.   
Introduction  
The ability to manipulate magnetism has played historically an important
role in the development of information technologies, using the magnetization
of materials to encode information. Today's research focuses on controlling
individual spins and spin currents, as well as spin ensembles, with
the aim of incorporating these systems as part of quantum information
processing devices. .
In particular the control of elementary excitations of magnetically
ordered systems denominated magnons or spin waves, is
highly desirable 
, especially for insulating materials
like the ferrimagnet yttrium iron garnet (YIG) .
The collective character of the magnetic excitations moreover render
these robust against local perturbations. 
Whereas the good magnetic properties of YIG have been known since
the 60s, it is only recently that coupling and controlling spin waves
with electromagnetic radiation in solid-state systems has started
to be explored. Pump-probe experiments have shown ultrafast magnetization
switching with light ,
and strong photon-magnon coupling has been demonstrated in microwave
cavity experiments 
including the photon-mediated coupling between a superconducting
qubit and a magnon mode . Going beyond microwaves,
this points to the tantalizing possibility of realizing optomagnonics:
the coupled dynamics of magnons and photons in the optical regime,
which can lead to coherent manipulation of magnons with light. The
coupling between magnons and photons in the optical regime differs
from that of the microwave regime, where resonant matching of frequencies
allows for a linear coupling: one magnon can be converted into a photon,
and viceversa . In the
optical case instead, the coupling is a three-particle process. This
accounts for the frequency mismatch and is generally called parametric
coupling. The mechanism behind the optomagnonic coupling is the Faraday
effect, where the angle of polarization of the light changes as it
propagates through a magnetic material. Very recent first experiments
in this regime show that this is a promising route, by demonstrating
coupling between optical modes and magnons, and advances in this field
are expected to develop rapidly .  
    
In this work we derive and analyze the basic optomagnonic Hamiltonian
that allows for the study of solid-state cavity optomagnonics. The
parametric optomagnonic coupling is reminiscent of optomechanical
models. In the magnetic case however, the relevant operator that couples
to the optical field is the spin, instead of the usual bosonic field
representing a mechanical degree of freedom. Whereas at small magnon
numbers the spin can be replaced by a harmonic oscillator and the
ideas of optomechanics  carry over directly,
for general trajectories of the spin this is not possible. This gives
rise to rich non-linear dynamics which is the focus of the present
work. Parametric spin-photon coupling has been studied previously in atomic ensembles . In this work we focus on solid-state systems with magnetic order and derive the corresponding optomagnonic Hamiltonian. After obtaining the general Hamiltonian, we consider
a simple model which consists of one optical mode coupled to a homogeneous
Kittel magnon mode . We study the classical dynamics
of the magnetic degrees of freedom and find magnetization switching,
self-sustained oscillations, and chaos, tunable by the light field
intensity.  
The manuscript is ordered as follows. In Sec. sec:Model we
present the model and the optomagnonic Hamiltonian which is the basis
of our work. In Sec. sec:Relation-to-optomechanics we discuss
briefly the connection of the optomagnonic Hamiltonian derived in
this work and the one used in optomechanic systems. In Sec. sec:Microscopic
we derive the optomagnonic Hamiltonian from microscopics, and give
an expression for the optomagnonic coupling constant in term of material
constants. In Sec. sec:Spin-dynamics we derive the classical
coupled equations of motion of spin and light for a homogeneous magnon
mode, in which the spin degrees of freedom can be treated as a macrospin.
In Sec. sec:Fast-cavity we obtain the effective equation
of motion for the macrospin in the fast-cavity limit, and show the
system presents magnetization switching and self oscillations. We
treat the full (beyond the fast-cavity limit) optically induced nonlinear
dynamics of the macrospin in Sec. sec:Full-nonlinear-dynamics,
and follow the route to chaotic dynamics. In Sec. sec:Discussion
we sketch a qualitative phase diagram of the system as a function
of coupling and light intensity, and discuss the experimental feasibility
of the different regimes. An outlook and conclusions are found in
Sec. sec:Outlook. In the Appendix we give details of some
of the calculations in the main text, present more examples of nonlinear
dynamics as a function of different tuning parameters, and compare
optomagnonic vs. optomechanic attractors.  
Model 
Further below, we derive the optomagnonic Hamiltonian which forms
the basis of our work:   
where  () is the creation (annihilation)
operator for a cavity mode photon. We work in a frame rotating at
the laser frequency , and 
is the detuning with respect to the optical cavity frequency .
Eq. eq:Hamiltonian assumes a magnetically ordered system
with (dimensionless) macrospin  with
magnetization axis along , and a precession frequency
 which can be controlled by an external magnetic field   
. The coupling between the optical field and the spin is given by
the last term in Eq. eq:Hamiltonian, 
 component
of the spin as shown in Fig. SetUp. The coefficient 
denotes the parametric optomagnonic coupling. We will derive it in
terms of the Faraday rotation, which is a material-dependent constant.  
Relation to optomechanics  
Close to the ground state, for deviations such that 
(with ), we can treat the spin in the usual way as
a harmonic oscillator, ,
with . Then the optomagnonic
interaction 
becomes formally equivalent to the well-known optomechanical
interaction , with bare coupling constant .
All the phenomena of optomechanics apply, including the ``optical
spring'' (here: light-induced changes of the magnon precession frequency)
and optomagnonic cooling at a rate , and
the formulas (as reviewed in Ref. ) can be
taken over directly. All these effects depend on the light-enhanced
coupling , where  is
the cavity light amplitude. For example, in the sideband-resolved
regime (, where  is the optical cavity
decay rate) one would have . If
, one enters the strong-coupling regime, where the magnon
mode and the optical mode hybridize and where coherent state transfer
is possible. A Hamiltonian of the form of Eq. ()
is also encountered for light-matter interaction in atomic ensembles
, and its explicit connection to optomechanics
in this case was discussed previously in Ref. .
In contrast to such non-interacting spin ensembles, the confined magnon
mode assumed here can be frequency-separated from other magnon modes.  
Microscopic magneto-optical coupling  
In this section we derive the Hamiltonian presented in Eq. eq:Hamiltonian
starting from the microscopic magneto-optical effect in Faraday-active
materials. The Faraday effect is captured by an effective permittivity
tensor that depends on the magnetization  in the sample.
We restrict our analysis to non-dispersive isotropic media and linear
response in the magnetization, and relegate magnetic linear birefringence
effects which are quadratic in  (denominated the Cotton-Mouton
or Voigt effect) for future work . In
this case, the permittivity tensor acquires an antisymmetric imaginary
component and can be written as ,
where  () is the vacuum (relative)
permittivity,  the Levi-Civita tensor and  a
material-dependent constant  (here and in what follows,
Latin indices indicate spatial components). The Faraday rotation per
unit length   
depends on the frequency , the vacuum speed of light ,
and the saturation magnetization . The magneto-optical coupling
is derived from the time-averaged energy ,
using the complex representation of the electric field, .
Note that  is real since  is hermitean
. The magneto-optical contribution is  
This couples the magnetization to the spin angular momentum density
of the light field. Quantization of this expression leads to the optomagnonic
coupling Hamiltonian. A similar Hamiltonian is obtained in atomic
ensemble systems when considering the electric dipolar interaction
between the light field and multilevel atoms, where the spin degree
of freedom (associated with  in our case)
is represented by the atomic hyperfine structure .
The exact form of the optomagnonic Hamiltonian will depend on the
magnon and optical modes. In photonic crystals, it has been demonstrated
that optical modes can be engineered by nanostructure patterning ,
and magnonic-crystals design is a matter of intense current research
. The electric field is easily quantized, ,
where  indicates the 
eigenmode of the electric field (eigenmodes are indicated with Greek
letters in what follows). The magnetization requires more careful
consideration, since  depends on the local
spin operator which, in general, cannot be written as a linear combination
of bosonic modes. There are however two simple cases: (i) small deviations
of the spins, for which the Holstein-Primakoff representation is linear
in the bosonic magnon operators, and (ii) a homogeneous Kittel mode
 with macrospin .
In the following we treat the homogeneous case, to capture nonlinear
dynamics. From Eq. eq:UMO-1 we then obtain the coupling
Hamiltonian 
with   
where we replaced , with  the extensive
total spin (scaling like the mode volume). One can diagonalize the
hermitean matrices , though generically not simultaneously.
In the present work, we treat the conceptually simplest case of a
strictly diagonal coupling to some optical eigenmodes (
but ). This is precluded only if the optical
modes are both time-reversal invariant ( real-valued)
and non-degenerate. In all the other cases, a basis can be found in
which this is valid. For example, a strong static Faraday effect will
turn optical circular polarization modes into eigenmodes. Alternatively,
degeneracy between linearly polarized modes implies we can choose
a circular basis. 
Consider circular polarization (R/L) in the -plane, such that
 is diagonal while . Then we find  
where we used Eq. eq:thetaF to express the coupling via
the Faraday rotation , and where  is a dimensionless
overlap factor that reduces to  if we are dealing with plane waves
(see App. ). Thus, we obtain the coupling Hamiltonian
.
This reduces to Eq. () if the incoming laser
drives only one of the two circular polarizations. 
The coupling  gives the magnon precession frequency shift
per photon. It decreases for larger magnon mode volume, in
contrast to , which describes the overall optical shift
for saturated spin (). For YIG, with 
and  ,
we obtain  (taking ), which can
easily become comparable to the precession frequency . The
ultimate limit for the magnon mode volume is set by the optical wavelength,
, which yields . Therefore ,
whereas the coupling to a single magnon would be remarkably large:
. This provides a strong incentive
for designing small magnetic structures, by analogy to the scaling
of piezoelectrical resonators . Conversely, for a macroscopic
volume of , with , this reduces to 
and .  
Spin dynamics 
The coupled Heisenberg equations of motion are obtained from the Hamiltonian
in Eq. eq:Hamiltonian by using ,
.
We next focus on the classical limit, where we replace the operators
by their expectation values:   
Here we introduced the laser amplitude  and the
intrinsic spin Gilbert-damping , characterized
by , due to phonons and defects (
for YIG  
). After rescaling the fields (see App.. ),
we see that the classical dynamics is controlled by only five dimensionless
parameters: .
These are independent of  as expected for classical dynamics. 
In the following we study the nonlinear classical dynamics of the
spin, and in particular we treat cases where the spin can take values
on the whole Bloch sphere and therefore differs significantly from
a harmonic oscillator, deviating from the optomechanics paradigm valid
for . The optically induced tilt of the spin can be
estimated from Eq. eq:EOM as ,
where  is an optically
induced effective magnetic field. We would expect therefore unique
optomagnonic behavior (beyond optomechanics) for large enough
light intensities, such that  is of
the order of or larger than the precession frequency . We
will show however that, in the case of blue detuning, even small light
intensity can destabilize the original magnetic equilibrium of the
uncoupled system, provided the intrinsic Gilbert damping is small.     
Fast cavity regime 
As a first step we study a spin which is slow compared to the cavity,
where . In that case we can expand the
field  in powers of  and obtain an effective
equation of motion for the spin by integrating out the light field.
We write , where the subscript indicates
the order in . From the equation for , we find
that  fulfills the instantaneous equilibrium condition   
from which we obtain the correction :   
To derive the effective equation of motion for the spin, we replace
 in Eq. eq:EOM
which leads to   
Here ,
where 
acts as an optically induced magnetic field. The second term is reminiscent
of Gilbert damping, but with spin-velocity component only along .
Both the induced field  and dissipation coefficient
 depend explicitly on the instantaneous value of
:   
This completes the microscopic derivation of the optical Landau-Lifshitz-Gilbert
equation for the spin, an important tool to analyze effective spin
dynamics in different contexts . We consider
the nonlinear adiabatic dynamics of the spin governed by Eq. eq:EOM_eff
below. Two distinct solutions can be found: generation of new stable
fixed points (magnetic switching) and optomagnonic limit cycles (self
oscillations). 
Given our Hamiltonian (Eq. eq:Hamiltonian), the north pole
is stable in the absence of optomagnonic coupling  the
selection of this state is ensured by the intrinsic damping .
By driving the system this can change due to the energy pumped to
(or absorbed from) the spin, and the new equilibrium is determined
by  and , when 
dominates over . Magnetic switching refers to the
rotation of the macroscopic magnetization by , to a new
fixed point near the south pole in our model. This can be obtained
for blue detuning , in which case  is
negative either on the whole Bloch sphere (when ) or on
a certain region, as shown in Fig. AdDyna. Similar results
were obtained in the case of spin optodynamics for cold atoms systems .
The possibility of switching the magnetization direction in a controlled
way is of great interest for information processing with magnetic
memory devices, in which magnetic domains serve as information bits
. Remarkably, we find
that for blue detuning, magnetic switching can be achieved for arbitrary
small light intensities in the case of . This is
due to runaway solutions near the north pole for , as discussed
in detail in App. . In physical systems, the
threshold of light intensity for magnetization switching will be determined
by the extrinsic dissipation channels.  
For higher intensities of the light field, limit cycle attractors
can be found for , where the optically induced dissipation
 can change sign on the Bloch sphere (Fig. AdDynb).
The combination of strong nonlinearity and a dissipative term which
changes sign, leads the system into self sustained oscillations. The
crossover between fixed point solutions and limit cycle attractors
is determined by a balance between the detuning and the light intensity,
as discussed in App. . Limit cycle attractors
require  (note that
from eq:G_ind 
if  ). 
We note that for both examples shown in Fig. AdDyn, for
the chosen parameters we have 
in the case of YIG, and hence taking  is a very
good approximation. More generally, from Eqs. eq:B_ind we
estimate  and therefore
we can safely neglect  for .
The qualitative results (limit cycle, switching) survive up to ,
although quantitatively modified as  is increased:
for example, the size of the limit cycle would change, and there would
be a threshold intensity for switching.  
Full nonlinear dynamics  
The nonlinear system of Eq. eq:EOM presents even richer
behavior when we leave the fast cavity regime. For limit cycles near
the north pole, when , the spin is well approximated
by a harmonic oscillator, and the dynamics is governed by the attractor
diagram established for optomechanics . In contrast,
larger limit cycles will display novel features unique to optomagnonics,
on which we focus here.    
Beyond the fast cavity limit, we can no longer give analytical expressions for the optically induced magnetic field and dissipation. Moreover, we can not define a coefficient  since an expansion in  is not justified. We therefore resort to numerical analysis of the dynamics. Fig. FullDynFig shows a route to chaos by successive period
doubling, upon decreasing the cavity decay . This route can
be followed in detail as a function of any selected parameter by plotting
the respective bifurcation diagram. This is depicted in Fig. Bif.
The plot shows the evolution of the attractors of the system as the
light intensity is increased. The figure shows the creation and expansion
of a limit cycle from a fixed point near the south pole, followed
by successive period doubling events and finally entering into a chaotic
region. At high intensities, a limit cycle can coexist with a chaotic
attractor. For even bigger light intensities, the chaotic attractor
disappears and the system precesses around the 
axis, as a consequence of the strong optically induced magnetic field.
Similar bifurcation diagrams are obtained by varying either 
or the detuning  (see App. ).    
Discussion    
   
We can now construct a qualitative phase diagram for our system. Specifically,
we have explored the qualitative behavior (fixed points, limit cycles,
chaos etc.) as a function of optomagnonic coupling and light intensity.
These parameters can be conveniently rescaled to make them dimensionless.
We chose to consider the ratio of magnon precession frequency to coupling,
in the form . Furthermore, we express the light intensity
via the maximal optically induced magnetic field .
The dimensionless coupling strength, once the material of choice is
fixed, can be tuned via an external magnetic field which controls
the precession frequency . The light intensity can be controlled
by the laser. 
We start by considering blue detuning, this is shown in Fig. Fig:PhaseBlue.
The ``phase diagram'' is drawn for , and we set
 and . We note that some of the
transitions are rather crossovers (``optomechanical limit cycles''
vs. ``optomagnonic limit cycles''). In addition, the other
``phase boundaries'' are only approximate, obtained from direct
inspection of numerical simulations. These are not intended to be
exact, and are qualitatively valid for departures of the set parameters,
if not too drastic -- for example, increasing  will lead
eventually to the disappearance of the chaotic region. 
As the diagram shows, there is a large range of parameters that lead
to magnetic switching, depicted in white. This area is approximately
bounded by the condition ,
which in Fig. Fig:PhaseBlue corresponds to the diagonal since
we took . This condition is approximate since it was
derived in the fast cavity regime, see App. .
As discussed in Sec. , magnetic switching
should be observable in experiments even for small light intensity
in the case of blue detuning, provided that all non-optical dissipation
channels are small. The caveat of low intensity is a slow switching
time. For , the system
can go into self oscillations and even chaos. For optically induced
fields much smaller than the external magnetic field, 
we expect trajectories of the spin in the  plane, precessing
around the external magnetic field along  and therefore
the spin dynamics (after a transient) is effectively two-dimensional.
This is depicted by the blue-shaded area in Fig.Fig:PhaseBlue.
These limit cycles are governed by the optomechanical attractor diagram
presented in Ref. , as we show in App. .
There is large parameter region in which the optomagnonic limit cycles deviate from the optomechanical
attractors. This is marked by orange in Fig.Fig:PhaseBlue.
As the light intensity is increased, for  the limit
cycles remain approximately confined to the  plane but exhibit
deviations from optomechanics. This approximate confinement of the
trajectories to the  plane at large 
( for )
can be understood qualitatively by looking at the expression of the
induced magnetic field  deduced in the fast cavity
limit, Eq. eq:B_ind. Since we consider ,
 implies . In this limit, 
can become very small and the spin precession is around the 
axis. For moderate  and ,
the limit cycles are tilted and precessing around an axis determined
by the effective magnetic field, a combination of the optical induced
field and the external magnetic field. Blue detuning causes these
limit cycles to occur in the southern hemisphere. Period doubling
leads eventually to chaos. The region where pockets of chaos can be
found is represented by red in the phase diagram. For large light
intensity, such that , the optical
field dominates and the effective magnetic field is essentially along
the  axis. The limit cycle is a precession of the
spin around this axis. 
According to our results optomagnonic chaos is attained for values
of the dimensionless coupling  and light intensities
. This implies a number
of circulating photons similar to the number of locked spins in the
material, which scales with the cavity volume. This therefore imposes
a condition on the minimum circulating photon density in the cavity.
For YIG with characteristic frequencies ,
the condition on the coupling is easily fulfilled (remember 
as calculated above). However the condition on the light intensity
implies a circulating photon density of  photons/
which is outside of the current experimental capabilities, limited
by the power a typical microcavity can support (around 
photons/). On the other hand, magnetic switching
and self-sustained oscillations of the optomechanical type (but taking
place in the southern hemisphere) can be attained for low powers,
assuming all external dissipation channels are kept small. While self-sustained
oscillations and switching can be reached in the fast-cavity regime,
more complex nonlinear behavior such as period doubling and chaos
requires approaching sideband resolution. For YIG the examples in
Figs. ,  correspond to a precession frequency
 (App. ),
whereas  can be estimated to be , taking
into account the light absorption factor for YIG ()
. 
For red detuning , the regions in the phase diagram remain
the same, except that instead of magnetic switching, the solutions
in this parameter range are fixed points near the north pole. This
can be seen by the symmetry of the problem: exchanging 
together with  and 
leaves the problem unchanged. The limit cycles and trajectories follow
also this symmetry, and in particular the limit cycles in the 
plane remain invariant.  
Outlook 
The observation of the spin dynamics predicted here will be a sensitive
probe of the basic cavity optomagnonic model, beyond the linear regime.
Our analysis of the optomagnonic nonlinear Gilbert damping could be
generalized to more advanced settings, leading to optomagnonic reservoir
engineering (e.g. two optical modes connected by a magnon transition).
Although the nonlinear dynamics presented here requires light intensities
outside of the current experimental capabilities for YIG, it should
be kept in mind that our model is the simplest case for which highly
non-linear phenomena is present. Increasing the model complexity,
for example by allowing for multiple-mode coupling, could result in
a decreased light intensity requirement. Materials with a higher Faraday
constant would be also beneficial. In this work we focused on the
homogeneous Kittel mode. It will be an interesting challenge to study
the coupling to magnon modes at finite wavevector, responsible for
magnon-induced dissipation and nonlinearities under specific conditions .
The limit cycle oscillations can be seen as ``optomagnonic lasing'',
analogous to the functioning principle of a laser where energy is
pumped and the system settles in a steady state with a characteristic
frequency, and also discussed in the context of mechanics (``cantilaser''
). These oscillations could serve as a novel source
of traveling spin waves in suitable geometries, and the synchronization
of such oscillators might be employed to improve their frequency stability.
We may see the design of optomagnonic crystals and investigation of
optomagnonic polaritons in arrays. In addition, future cavity optomagnonics
experiments will allow to address the completely novel regime of cavity-assisted
coherent optical manipulation of nonlinear magnetic textures, like
domain walls, vortices or skyrmions, or even nonlinear spatiotemporal
light-magnon patterns. In the quantum regime, prime future opportunities
will be the conversion of magnons to photons or phonons, the entanglement
between these subsystems, and their applications to quantum communication
and sensitive measurements. 
We note that different aspects of optomagnonic systems have been investigated
in a related work done simultaneously . Our work was
supported by an ERC-StG OPTOMECH and ITN cQOM. H.T. acknowledges support
by the Defense Advanced Research Projects Agency (DARPA) Microsystems
Technology Office/Mesodynamic Architectures program (N66001-11-1-4114) and an Air Force Office of Scientific Research (AFOSR) Multidisciplinary University Research Initiative grant (FA9550-15-1-0029).    
Optomagnonic coupling  for plane waves 
 In this section we calculate explicitly the optomagnonic
coupling presented in Eq.. eq:GMO for the case of plane waves
mode functions for the electric field. We choose for definiteness
the magnetization axis along the  axis, and consider
the case . The Hamiltonian  is then
diagonal in the the basis of circularly polarized waves, .
The rationale behind choosing the coupling direction perpendicular
to the magnetization axis, is to maximize the coupling to the magnon
mode, that is to the deviations of the magnetization with respect
to the magnetization axis. The relevant spin operator is therefore
, which represents the flipping of a spin. In the case
of plane waves, we quantize the electric field according to 
where  is the volume of the cavity,  the wave
vector of mode  and we have identified the positive and negative
frequency components of the field as ,
. The factor of 
in the denominator ensures the normalization ,
which corresponds to the energy of a photon in state 
above the vacuum . For two degenerate (R/L) modes at frequency
, using Eq. eq:thetaF we see that the frequency
dependence cancels out and we obtain the simple form for the optomagnonic
Hamiltonian 
with . Therefore
the overlap factor  in this case. 
Rescaled fields and linearized dynamics  
To analyze Eq. eq:EOM it is convenient to re-scale the fields
such that ,  and measure
all times and frequencies in . We obtain the rescaled equations
of motion (time-derivatives are now with respect to )   
If we linearize the spin-dynamics (around the north-pole, e.g.), we
should recover the optomechanics behavior. In this section we ignore
the intrinsic Gilbert damping term. We set approximately 
and from Eq. eq:REOM we obtain   
We can now choose to rescale further, via 
and likewise for . We obtain the following spin-linearized
equations of motion:    
This means that the number of dimensionless parameters has been reduced
by one, since the two parameters initially involving G, , and
 have all been combined into   
In other words, for , the dynamics should
only depend on this combination, consistent with the optomechanical
analogy valid in this regime as discussed in the main text (where
we argued based on the Hamiltonian).  
Switching in the fast cavity limit  
From Eq. eq:EOM_eff in the weak dissipation
limit () we obtain 
*
S_x= & S_y 
S_y= & -S_zB_opt-S_x-_optSS_xS_z, 
from where we obtain an equation of motion for . We are interested
in studying the stability of the north pole once the driving is turned
on. Hence we set ,   
and we consider small deviations  of  from
the equilibrium position that satisfies ,
where  is evaluated at . To linear order
we obtain   
We see that the dissipation coefficient for blue detuning ()
is always negative, giving rise to runaway solutions. Therefore the
solutions near the north pole are always unstable under blue detuning,
independent of the light intensity. These trajectories run to a fixed
point near the south pole, which accepts stable solutions for 
(switching) or to a limit cycle. Near the south pole, ,
 and    
Therefore for  there are stable fixed
points, while in the opposite case there are also runaway solutions
that are caught in a limit cycle. For red detuning, 
and the roles of south and north pole are interchanged.    
    
Nonlinear dynamics  
In this section we give more details on the full nonlinear dynamics
described in the main text. In Figs.  and Bif
of the main text we chose a relative coupling , around
which a chaotic attractor is found. With our estimated 
for YIG, this implies a precession frequency .
In Fig. FullDynFig the chaotic regime is reached at 
with , which implies ,
that is, a number of photons circulating in the (unperturbed) cavity
of the order of the number of locked spins and hence scaling with
the cavity volume. Bigger values of the cavity decay rate are allowed
for attaining chaos at the same frequency, at the expense of more
photons in the cavity, as can be deduced from Fig. Bif where
we took . On the other hand we can think of varying
the precession frequency  by an applied external magnetic
field and explore the nonlinearities by tuning  in this
way (note that  is a material constant). This is done in Fig.
Fig:BifSpin. Alternatively, the nonlinear behavior can be
controlled by varying the detuning , as shown in Fig. Fig:BifDelta.  
Relation to the optomechanical attractors  
In this appendix we show that the optomagnonic system includes the
higher order nonlinear attractors found in optomechanics as a subset
in parameter space.   
    
In optomechanics, the high order nonlinear attractors are self sustained
oscillations with amplitudes  such that the optomechanical frequency
shift  is a multiple of the mechanical frequency . Translating
to our case, this means . Since 
we obtain the condition   
for observing these attractors. We can vary 
according to Eq. eq:OptCond. For  we are
in the limit of small  and we expect
limit cycles precessing along  as discussed in Sec.
sec:Discussion. In Fig.  the attractor
diagram obtained by imposing condition eq:OptCond is plotted.
Since the trajectories are in the  plane, we plot the inflection
point of the coordinate . We expect  evaluated
at the inflection point, which gives the amplitude of the limit cycle,
to coincide with the optomechanic attractors for small 
and hence flat lines at the expected amplitudes (as calculated in
Ref. ) as  increases. Relative evenly
spaced limit cycles increasing in number as larger values of 
are considered are observed, in agreement with Ref. .
Remarkable, these limit cycles attractors are found on the whole Bloch
sphere, and not only near the north pole where the harmonic approximation
is strictly valid. These attractors are reached by allowing initial
conditions on the whole Bloch sphere. For , (Fig. ,
top), switching is observed up to  and then perfect
optomechanic behavior. For higher values of , deviations from
the optomechanical behavior are observed for small  (implying
large  according to Eq. eq:OptCond)
and large amplitude limit cycles, as compared to the size of the Bloch
sphere. An example is shown in Fig. , bottom, for
.    
3    
Pseudomagnetic fields for sound at the nanoscale  
Christian Brendel  
Institute for Theoretical Physics, University of Erlangen-N�rnberg,
Staudtstr. 7, 91058 Erlangen, Germany  
Max Planck Institute for the Science of Light, G�nther-Scharowsky-Stra�e
1/Bau 24, 91058 Erlangen, Germany  
Vittorio Peano  
Institute for Theoretical Physics, University of Erlangen-N�rnberg,
Staudtstr. 7, 91058 Erlangen, Germany  
Oskar Painter  
Institute for Quantum Information and Matter and Thomas J. Watson,
Sr., Laboratory of Applied Physics, California Institute of Technology,
Pasadena, USA   
Florian Marquardt  
Institute for Theoretical Physics, University of Erlangen-N�rnberg,
Staudtstr. 7, 91058 Erlangen, Germany  
Max Planck Institute for the Science of Light, G�nther-Scharowsky-Stra�e
1/Bau 24, 91058 Erlangen, Germany 
There is a growing effort in creating chiral transport of sound waves.
However, most approaches so far are confined to the macroscopic scale.
Here, we propose a new approach suitable to the nanoscale which is
based on pseudo-magnetic fields. These fields are the analogue for
sound of the pseudo-magnetic field for electrons in strained graphene.
In our proposal, they are created by simple geometrical modifications
of an existing and experimentally proven phononic crystal design,
the snowflake crystal. This platform is robust, scalable, and well-suited
for a variety of excitation and readout mechanisms, among them optomechanical
approaches.  
A novel trend has emerged recently in the design of mechanical systems,
towards incorporating topological ideas. These ideas promise to pave
the way towards transport along edge-channels that are either purely
uni-directional  or helical 
(i.e. with two ``spins'' moving in opposite directions), as well
as the design of novel zero-frequency boundary modes .
The first few experimental realizations 
and a number of theoretical proposals 
involve macroscopic setups. These include coupled spring systems 
and circulating fluids 
for a review . These designs represent important
proof-of-principle demonstrations of topological acoustics and could
open the door to useful applications at the macroscopic scale. However,
they are not easily transferred to the nanoscale, which would be even
more important for potential applications.  
The first proposal for engineered chiral sound wave transport at the
nanoscale has been put forward in Ref. : an appropriately
patterned slab illuminated by a laser with a suitably engineered wavefront
realizes a Chern insulator for sound. The laser drive in 
breaks the time-reversal symmetry, enabling uni-directional topologically
protected transport. On the other hand, there would be clear practical
advantages of a design that operates without any drive and, at the
same time, in a simple nanoscale geometry. By necessity, this must
result in helical transport, with two counter-propagating species
of excitations.  
There are two important classes in this regard: (i) topological insulators,
and (ii) pseudo-magnetic fields. A first idea for (i) at the nanoscale
was put forward recently in Ref. . By contrast,
in the present paper, we show how to engineer arbitrary spatial pseudo-magnetic
field distributions for sound waves in a purely geometry-based design.
In addition (and again in contrast to ), it turns
out that our design can be implemented in a platform that has already
been realized and reliably operated at the nanoscale, the snowflake
phononic crystal . That platform has the added
benefit of being a well-studied optomechanical system, which, as we
will show, can also provide powerful means of excitation and readout.
The mechanical pseudo-magnetic fields are analogous to the pseudo-magnetic
fields for electrons propagating on the curved surface of carbon nanotubes
 and in strained graphene .
Pseudo-magnetic fields mimic real magnetic fields
but have opposite sign in the two valleys of the graphene band structure
and, thus, do not break time-reversal symmetry. In the past, this
concept has already been successfully transferred to a photonic waveguide
system .  
Besides presenting our nanoscale design, we also put forward a general
approach to pseudo-magnetic fields for Dirac quasiparticles based
on the smooth breaking of the  point group and translational
symmetries. Our scheme is especially well suited to patterned engineered
materials such as phononic and photonic crystals. It ties into the
general efforts of steering sound in acoustic metamaterials at all
scales .     
    
*
Dirac equation and gauge fields  The  Dirac
Hamiltonian in the presence of a gauge field 
reads (we set the Planck constant and the charge equal to one)   
Here,  is the mass,  is the Dirac velocity, and 
are the Pauli matrices. For zero mass and a constant gauge field (
and ), the band structure forms
a Dirac (double) cone, where the top and bottom cones touch at the
momentum .  
In a condensed matter setting, the Dirac Hamiltonian describes the
dynamics of a particle in a honeycomb lattice, or certain other periodic
potentials, within a quasimomentum valley, i.e. within the vicinity
of a lattice high-symmetry point in the Brillouin zone. In this context,
 is the quasi momentum counted off from the relevant
high-symmetry point. Here, we are interested in a scenario where the
Dirac Hamiltonian Eq. () is defined in
two different valleys mapped into each other via the time-reversal
symmetry operator . This scenario is realized in graphene,
where the Dirac equation is defined in the two valleys around the
symmetry points  and . For charged particles,
the gauge field  usually describes a real
magnetic field , where .
In this case, the time-reversal symmetry  is broken. For
 and a constant magnetic field,  the Dirac cones break up in
a series of flat Landau levels ,  
where  and  is the cyclotron frequency. The
presence of a physical edge then leads to topologically protected
gapless edge states in each valley. For a real magnetic field, the
edge states in the two valleys have the same chirality. However, here,
we will be interested in the case of engineered pseudo-magnetic fields,
where the gauge field  does not break the
-symmetry. In this case, 
must have opposite sign in the two different valleys to preserve the
-symmetry. It is clear that as long as one can focus on
a single valley, the nature of the magnetic field (real or pseudo
magnetic field) does not play any role. This holds true also in the
presence of boundaries. For a given valley and gauge potential ,
exactly the same edge excitations will emerge in the presence of a
pseudo- or a real magnetic field. The nature of the magnetic field
only becomes apparent when the eigenstates belonging to inequivalent
valleys are compared. When time-reversal is preserved (pseudo magnetic
field), each edge state in one valley has a time-reversed partner
with opposite velocity in the other valley. Thus, the edge states
induced by a pseudo magnetic field are not chiral but rather helical. 
Dirac phonons in the snowflake phononic crystal 
FEM mechanical simulations of a silicon thin-film snowflake crystal
are presented in Figure .   
 The mechanical band structure is shown in Fig. c.
It features a large number of Dirac cones at the high-symmetry point
. Each cone  has a time-reversed partner at the point
 (not shown). These pairs of Dirac cones are robust
structures: when the radius of the snowflake is varied, they are shifted
in energy (and can possibly cross other bands) but the top and bottom
cones always touch at the corresponding high-symmetry point, see panel
c. In other words, the mass  and the gauge field 
are always zero in the corresponding Dirac Hamiltonian. In order to
generate the desired gauge field, it is necessary to modify the pattern
of holes in a way that breaks the symmetries of the crystal (see discussion
below).  
In preparation of this, we use the snowflake radius as a knob to engineer
a pair of Dirac cones which are spectrally well isolated from other
bands and have a large velocity. The snowflake crystal can be viewed
as being formed by an array of triangular membranes arranged on a
honeycomb lattice and connected through links (see Figure b).
In principle, we could choose a situation where the links are narrow
(large snowflake radius ), such that all the groups of bands are
spectrally well isolated. However, then the Dirac velocities tend
to be small. For wider links (smaller ), the motion of the adjacent
edges of neighboring triangular membranes becomes strongly coupled.
This give rise to normal modes where such adjacent sides oscillate
in phase, resulting in large displacements of the links. We note that
these links are arranged on a Kagome lattice, see Figure a.
This observation explains the emergence (see r=180nm plot of Fig.
1e) of a group of three bands, separated from the remaining bands
by complete band gaps, and supporting large velocity Dirac cones.
 The triplet of isolated bands can be well fitted by a Kagome lattice
tight-binding model with nearest-neighbor and next-nearest neighbor
hopping. The Kagome lattice model would be entirely sufficient to
guide us in the engineering of the desired gauge fields. However,
we prefer to pursue a more fundamental and general approach based
on the symmetries of the underlying snowflake crystal.   
Identifying the Dirac pseudo-spin by the symmetries 
The snowflake thin-film slab crystal has  point group
symmetry. If we restrict our attention to the -symmetric modes,
the remaining point group is  (six-fold rotations
about the snowflake center and mirror symmetries about the vertical
planes containing a lattice basis vector). The degeneracies underpinning
the Kagome Dirac cones as well as the other robust cones in Fig. b
are usually referred to as essential degeneracies. They are preserved
if the point group includes at least the  symmetries
(six-fold rotational symmetry about the snowflake center) or the 
symmetries (three-fold rotations and mirror symmetries about three
vertical planes containing a lattice unit vector). The point group
here contains both groups but, for concreteness, our explanation will
focus on the  symmetry. It is useful to think of the
 symmetry as a combination of a  (three-fold)
symmetry group and a  (two-fold) symmetry group. 
The three-fold rotations  belong to the group of the
high-symmetry points  and  (they leave
each of these point invariant modulo a reciprocal lattice vector).
As a consequence, at these points, the eigenmodes can be chosen to
be eigenvectors of the  rotations with quasi-angular
momentum . The essential degeneracies come about
 because the eigenvectors with non-zero quasi-angular momentum 
come in quadruplets (a degenerate pair in each inequivalent valley),
mapped into each other via the time-reversal symmetry operator 
and the rotation  by  about the snowflake
center (the sole non-trivial element of the  group).
If we denote the members of a quadruplet by ,
where  and  indicates the valley and 
is the vertical coordinate, we have  
Note that both  and  change the sign of the quasimomentum
and, thus, of . However, only  changes the sign
of the quasi-angular momentum. 
The Dirac Hamiltonian () for a given valley
 is obtained by projecting the underlying elasticity equations
onto a two-dimensional Hilbert space spanned by the normal modes   
and by identifying  with the eigenvalues of the 
matrix (see Appendix ). In other words, the quasi-angular
momentum  plays the role of the Dirac pseudospin. A mass term
is forbidden because states with equal quasimomentum and opposite
quasi-angular momentum are mapped into each other by the symmetry
, .
A gauge field  is also forbidden because it would couple
states with different quasi-angular momentum at the symmetry point.  
In our phononic Dirac system, the eigenstates 
are three-dimensional complex vector fields. They yield the displacement
fields,   
where  is the phase of the oscillation. In this classical setting,
 can be interpreted
as the square displacement averaged over one period, .
We note that the field 
is invariant under threefold rotations about three inequivalent rotocenters:
the center of the snowflake and the centers of the downwards and upwards
triangles (see Figure b). Three snapshots of the instantaneous
displacement field for the state with  and  are
shown in Fig. d--f. By definition of a quasi-angular momentum
eigenstate with , when the phase  varies by 
(after one third of a period), the instantaneous displacement field
is simply rotated clockwise by the same angle. When the valley is
known, the quasi-angular momentum (which here play the role of the
pseudospin) can be directly read off from a single snapshot based
on the position of the nodal lines. For  ,
they are located at the center of the downwards (upwards) triangles,
cf. Fig. b,d--f.  (For a detailed explanation see Appendix
). Below, we will take advantage of our insight on the
symmetries of the pseudospin eigenstates to engineer a local force
field which selectively excites uni-directional waves.    
    
Pseudo-magnetic fields and symmetry-breaking 
A crucial step towards the engineering of a pseudo-magnetic field
is the implementation of a spatially constant vector potential 
in a translationally invariant system. Afterwards arbitrary magnetic
field distributions can be generated straightforwardly by breaking
the translational invariance smoothly.  
A perturbation that breaks the  symmetry but preserves
the  symmetry will simply shift the Dirac cones, without
opening a gap (see Figure c). This can be identified with
the appearance of a constant gauge field  in the Dirac
Hamiltonian (). As such, the connection
between changes in the microscopic structure of the phononic metamaterial
and the resulting gauge field can be obtained from FEM simulations
by extracting the quasimomentum shift of the Dirac cones. We emphasize
that, in this context, the vector potential  has the dimension of an inverse
length.  
In the snowflake phononic crystal, we can achieve the desired type
of symmetry breaking (breaking  while preserving )
by designing asymmetric snowflakes formed by arms of different lengths,
   (see Figure a). If only one
of the arms is changed, symmetry requires that the vector potential
 points along that arm as shown in Fig. d.
For the Dirac cones associated with the Kagome lattice, our FEM simulations
show that the cone displacement grows linearly with the length changes,
as long as these remain much smaller than the average arm length .
 In this linear regime, and for a general combination of arm lengths,
  , we have   
The unit vectors  point into the direction of the
corresponding snowflake arms, ,
where . The factor  appears because
the vector potential has opposite sign in the two valleys as we have
not broken time reversal symmetry. We note that in general changes
of the arm lengths also shift the frequency of the Dirac point. When
the arm lengths are chosen to be position dependent, as is required
for implementing arbitrary magnetic fields, this energy shift will
enter the Dirac equation as a scalar potential , which
may be unwanted. However, our numerical simulations show that we can
keep  approximately constant, by retaining a constant
average arm length .     
   
Phononic Landau levels and Edge States in a Strip 
We can test these concepts by implementing a constant phononic pseudo-magnetic
field in an infinite snowflake crystal strip, where we can directly
test our simplified description against full microscopic simulations.
The strip is of finite width  in the -direction (where ).
We can realize the corresponding vector potential in the Landau gauge,
, by varying the length 
along the -axis, while keeping the remaining arm lengths equal,
. For concreteness we choose  for . 
The treatment of the boundaries merits special consideration. It turns
out that sharp boundaries are unfavorable, as they give rise to an
extra undesired edge mode that is not related to the quantum Hall
effect physics that we seek to implement.    
A Dirac mass term appears upon breaking the  symmetry,
which we here choose to do by transversally displacing one of the
snowflake arms, as shown inFig. b, with the displacement
varying smoothly in the interval .  
By changing the snowflake arm lengths we can displace the Dirac cones
only over a finite range of quasimomenta. In our simulations ,
as shown in Fig. d. Using Eq. () and
the definition of the magnetic length , we see
that there is a trade-off between the cyclotron frequency 
and, thus, the achievable magnetic band gaps and the system size in
the appropriate magnetic units: 
where  For our FEM simulations we have chosen
.  
In Fig. , we display the phonon band structure and the
phonon wave functions (mechanical displacement fields) extracted from
finite-element numerical simulations as a function of the quasimomentum
 along the translationally invariant (infinite) direction.
We display only positive  because, due to time-reversal symmetry,
both the frequencies and the displacement fields are even functions
of . In the bulk, we expect to reproduce the well-known physics
of Dirac materials in a constant (pseudo)-magnetic field .
Indeed, the numerically extracted band structure consists of a series
of flat Landau Levels at energies of precisely the predicted form
 [ is defined in Eq. ()];
see panel (a) and the zoom-in (b) of Fig. . The Landau
plateaus extend over a quasi momentum interval of width .
Furthermore, in the bulk, we expect the mechanical eigenstates to
be localized states of size  (in the -direction).
Their quasi momentum  should be related to the position via
. This behavior is clearly visible
in Fig. c, where we show the displacement field of the
central Landau level. A zoom-in of this field (panel d) reveals that,
at the lattice scale, it displays the same intensity pattern as the
bulk pseudospin eigenstate  shown previously in Fig. f.
This behavior is also predicted by the effective Dirac description
where the central Landau level is indeed a pseudo-spin eigenstate
with  when the magnetic field  is positive .
Note that the pseudo-magnetic field engineered here also gives rise
to a Lorentz force that will curve the trajectory of phonon wavepackets
traveling in the bulk of the sample. The sign of the force is determined
by the valley index .  
Having demonstrated that we can implement a constant phononic pseudo-magnetic
field, we now argue that our approach with smooth boundaries gives
additional flexibility in the engineering of helical phononic waveguides.
Each Landau level gives rise to an edge state in the region of the
smooth boundaries. The typical behavior of the wavefunction is shown
(for ) in Figure c. For decreasing quasimomenta
, an edge state localized on the lower edge smoothly evolves
into a bulk state, and eventually into an edge state localized on
the upper edge. As is clear from Fig. a and b,
these pairs of edge states span the same energy interval. This behavior
clearly leads to the same number of edge states (for a fixed energy)
on both edges. This is crucial in view of engineering smooth helical
transport on a closed loop. We emphasize that the number of states
on the two edges need not necessarily (by symmetry) be equal. Indeed,
graphene in a constant pseudo-magnetic field supports a different
number of edge states on two opposite (sharp) edges .
In our approach, we can tune the number of edge states on each edge
via the mass term. In particular, the behavior of the edge states
originating from the  Landau level is sensitive to the sign
of the mass. A negative mass (as in our simulations) drags this Landau
level into the band gap below. Vice versa, a positive mass will drag
it into the band gap above. This behavior is related to the peculiarity
of the Landau level being a pseudospin eigenstate (with )
and, thus, an eigenstate of the mass term (with eigenvalue ),
cf. Eq. ().    
    
Transport in a Finite Geometry and Disorder  Any
pseudo-magnetic field that is realized without explicit time-reversal
symmetry breaking necessarily gives rise to helical transport, where
the chirality depends on some artificial spin degree of freedom, i.e.
the valley. A central question in this regard is the robustness against
short-range disorder. In order to assess this, we have studied numerically
transport in a finite geometry. As presented in Fig. 4, we consider
a sample of hexagonal shape with smooth boundaries in the presence
of a constant pseudo-magnetic field (we choose the symmetric gauge
for the vector potential ). In this illustrative example,
a local probe drive excites vibrations near the boundaries, as indicated
in Fig. a. Its frequency is chosen to lie inside the bulk
band gap separating the  and  Landau levels. In this
band gap, the system supports a pair of counter-propagating helical
edge states belonging to opposite valleys. One can select a propagation
direction by engineering the driving force. In a simple setting, one
could apply a time-dependent force that is engineered to excite only
the pseudo-spin eigenstate  in the valley . This
can be achieved by exerting forces at the three corners of a Wigner-Seitz
cell, where the eigenstate displays a large vertical displacement,
see Figure b-d. There is a phase delay of  between
any two corners while a similar pattern of phase delays but with opposite
signs occur in the other valley. Thus, a force which is modulated
with the right phase delays will selectively drive the valley 
and excite only excitations with a particular chirality.  
It turns out to be most efficient (and entirely sufficient) to implement
the numerical simulations for these rather large finite-size geometries
with the help of a tight-binding model on a Kagome lattice (see Appendix
). The parameters of that model can be matched to full
FEM simulations that have been performed for the translationally invariant
case.  This allows us to systematically study the effects of disorder.
In the presence of moderate levels of smooth disorder, which does
not couple the two valleys, the nature of the underlying magnetic
field (pseudo vs. real) will not manifest itself and the transport
will largely be immune to backscattering. Here, we focus instead on lattice-scale
disorder which can lead to scattering with large momentum transfer
that couples the two valleys and thereby leads to backscattering.  
 To
quantify the effect of lattice scale disorder, we consider a setup
with two drains, one to the clockwise and one to the counter-clockwise
direction, as shown in Fig. b. In the absence of disorder,
the vibrations travel clockwise (in this example) and are absorbed
in the right drain; only very weak residual backscattering occurs
at the sharp hexagon corners. In the presence of lattice-scale disorder,
a portion of the excitations will be backscattered and subsequently
reach the left drain. In c, we plot the portion  of
excitations absorbed in the left drain, averaged over a large number
of disorder implementations, as a function of the disorder strength.
In the regime of quasi-ballistic transport (for weak enough disorder),
 is proportional to the backscattering rate. Thus, it scales as
the square of the disorder amplitude and can be used to extract the
scattering length : , where  is the distance
between source and drain. In current nanoscale snowflake crystal experiments
, the fabrication-induced geometric disorder
is on the order of  of the absolute mechanical frequency 
which corresponds to  of the average hopping rate in the tight-binding
model. In that case, our simulations indicate the resulting scattering
lengths  to be very large (of the order of more than 
snowflake unit cells). 
Implementation  Since our design is scale invariant,
a variety of different implementations can be easily envisioned. At
the nanoscale, the fabrication of thin-film silicon snowflake crystals
and resonant cavities have already been demonstrated with optical
read-out and actuation . At the macro scale,
the desired geometry could be realized using 3D-laser printing and
similar techniques. A remaining significant challenge relates to the
selective excitation of helical sound waves and the subsequent read
out. In an optomechanical setting, the helical sound waves can be
launched by carefully crafting the applied radiation pressure force.
For the typical dimensions of existing snowflake optomechanical devices
operating in the telecom wavelength band (lattice spacing nm),
the required force could be engineered using tightly-focused intensity-modulated
laser beams impinging from above on three different snowflake triangles.
The read-out could occur by measuring motionally-induced sidebands
on the the reflection of a laser beam. Although the direct radiation
pressure of the beam will induce rather weak vibrations, they could
still be resolved using optical heterodyning techniques. Alternatively,
in a structure scaled up  times, selected triangles could host
defect mode optical nanocavities. This would boost the radiation pressure
force and the read-out precision by the cavity finesse (see ).
Helical sound waves can then be launched by either directly modulating
the light intensity or a photon-phonon conversion scheme, using a
strong red-detuned drive, with signal photons injected at resonance.
In the micron regime one can benefit from electro-mechanical interactions.
A thin film of conducting material deposited on top of the silicon
slab in combination with a thin conducting needle pointing towards
the desired triangles forms a capacitor. In this setting, an AC voltage
would induce the required driving force. The vibrations could be read
out in the same setup as they are imprinted in the currents through
the needles. In a different electromechanical approach, the phononic
crystal could be made out of a piezoelectric material and excitation
and read out occur via piezoelectric transducers .  
Conclusions  We have shown how to engineer pseudo-magnetic
fields for sound at the nanoscale purely by geometrical means in a
well established platform. Our approach is based on the smooth breaking
of the  and the discrete translational symmetry in
a patterned material; it is, thus, of a very general nature and directly
applies to photonic crystals as well. Indeed, the same geometrical
modifications that have led to the pseudomagnetic fields for sound
investigated in our work will also create pseudomagnetic fields for
 light  in the same setup.  Our approach
offers a new paradigm to design helical photonic and phononic waveguides
based on pseudo-magnetic fields.  
Acknowledgements V.P., C.B., and F.M. acknowledge
support by the ERC Starting Grant OPTOMECH and by the European Marie-Curie
ITN network cQOM; O.P. acknowledges support by the AFOSR-MURI Quantum
Photonic Matter, the ARO-MURI Quantum Opto-Mechanics with Atoms and
Nanostructured Diamond (grant N00014-15- 1-2761), and the Institute
for Quantum Information and Matter, an NSF Physics Frontiers Center
(grant PHY-1125565) with support of the Gordon and Betty Moore Foundation
(grant GBMF-2644).  
Kagome-Dirac modes from Another Point of View 
In the main text, we have plotted the normal modes in a Wigner-Seitz
cell around the center of the snowflake. An alternative choice that
highlights better the motion of the links forming the Kagome lattice
is to center the Wigner-size cell around the center of a triangle,
see Figure a. In Figure b-d,
we show the same normal mode plotted in Figure 1d-f of the main text
for the different Wigner-Seitz cell. Note that the picture is rotated
anti-clockwise by a /3 angle after one third of a period corresponding
to the quasi-angular momentum about the center of the unit cell 
, cf. Eq. () with  and  .    
*  
Explanation of the essential degeneracies and symmetries of the pseudospin
eigenstates 
Here, we discuss the symmetries of the normal modes 
of the snowflake crystal at the high-symmetry points. Thereby we also
explain the appearance of the essential degeneracies underpinning
the robust Dirac cones, and explain how to identify a pseudospin eigenstate
from the FEM simulation of a strip. 
We consider a generic mode  with
quasimomentum ,   
 where  is a translation by a lattice vector
. As usual we can use the Bloch ansatz   
where  is periodic under discrete
translations, .
We choose the center of the snowflake as the origin of the coordinates,
see Figure a. By applying a rotation by a angle
 about the -axis, we find   
where    
We note that 
has a quasimomentum  rotated by
. For a triangular lattice, the high-symmetry points ,
, and  have the peculiarity to
be invariant under  rotations. For example, 
where  is a basis vector of the reciprocal lattice.
Thus, applying the rotation  to a state with
quasimomentum , see Eq. (),
we find another state with the same quasimomentum,   
where   
is invariant under  discrete translations, .
In other words,  (and more in general any 
rotation) commutes with the projector  onto
the states with quasimomentum . The same holds for ,
and . Thus, for each high-symmetry point 
and , it is possible to find a basis of eigenstates
of the  rotations spanning the sub-Hilbert space of
states with that particular quasimomentum. If the crystal has the
 discrete translational invariance and the  symmetry,
such a basis can be chosen to be eigenstates of the Hamiltonian.  
In the following, we denote a common eigenstate of the 
rotations and the translations by 
where  indicates the valley ( for 
and  for  ) and  the quasi-angular
momentum,   
From Eq. (), we see that in terms of the corresponding
translational invariant field 
we have  
e^ib_1xR(2/3)_z_m_s,(R(-2/3)x,z) 
=e^-im_s2/3_m_s,(x,z)  
Next, we show that the eigenstates with non-zero quasi-angular momentum
 at the valleys  can be organized in quadruplets
which are degenerate if the Hamiltonian has time-reversal symmetry
 and the full  symmetry. We denote the members
of the quadruplet . Starting
from an arbitrary state with  or , the remaining
three members of the quadruplet are (by definition) obtained by applying
the time-reversal symmetry  and  (a
rotation by  about the -axis),  
*
where 
It is straightforward to explicitly check that the states ,
, and 
as obtained via the above definitions from 
are indeed eigenstates of the  rotations and the discrete
translations with the appropriate eigenvalues. For the 
rotation we have to show that if Eq. () is assumed
to hold for a specific choice of  and , it will hold
also for the remaining combinations of  and .  
Next we discuss the behavior of the states 
under  rotations about the center of the downwards
and upwards triangles, cf. Figure a,  
respectively. We note that these points lie at the corners of the
Wigner-Seitz cell around the  rotocenter (in this case
the snowflake center). Thus, as in any  symmetric triangular
lattice, they are threefold rotocenters. The states 
are also eigenstates of the  rotations about 
and  (or about any other point belonging to the corresponding
Bravais lattices) with quasi-angular momentum  
respectively. Here, we use the definition of the function 
where . It is easy to verify the above statement
by applying the rotation  about
the point  to the normal modes ,
*
R(2/3)_c_i,z_m_s,(x,z) 
=T(c_i)R(2/3)_,zT(-c_i)_m_s,(x,z) 
=e^-i(m_s+b_1c_i)2/3_m_s,(x,z). 
Taking into account that 
and  we arrive to Eq.
(). Since 
are simultaneous eigenvectors of the  rotations about
all three inequivalent threefold rotocenters of the crystal (the origin,
 and ), the time-averaged squared
displacement field 
is invariant under all these symmetry transformations, cf. Figure
1b of the main text. We note that for  (),
the quasi-angular momentum about the center of the downward (upwards)
triangles  ( ) is finite, 
(), corresponding to a vortex configuration. Thus, the
wavefunction has nodes at these points, cf. Figure 1b of the main
text.  
We note that a generic pseudospin eigenstate, e. g. the zero Landau
level, is the product of a smooth function and the normal mode .
Thus, it will show the same displacement pattern at the lattice scale,
cf. Fig 3d of the main text. Consequently, the pseudo-spin can be
immediately read off from a FEM simulation of a strip (where the valley
is known) just by observing the location of the nodes of 
.   
Derivation of the Dirac equation in the presence of the 
symmetry 
Here, we derive the Dirac Hamiltonian for the case where the 
symmetry is preserved [Equation (1) of the main text with 
and ]. In each valley (), we project
the Hamiltonian onto the states 
and ,
where the quasimomentum  counted off from the symmetry
point is assumed to be small. For each  we define the
Pauli matrices according to   
From this definition (assuming the usual commutation relations for
the Pauli matrices) we also have  
From the band structure calculated by the FEM simulations (without
the pseudomagnetic fields) we see that the eigenenergies are linear
in  close to the relevant symmetry point (they form
a cone). Thus, the Hamiltonian should be, to first approximation,
linear in . Taking into account that 
and that  is a symmetry, a mass term (proportional
to  ) is forbidden and the most general
Hamiltonian which is linear in  has the form   
where  is the degenerate energy of the normal modes .
Under the rotation  we have
*
R(2/3)_zHR(-2/3)_z 
=_pvpR(2/3)_z_+,pR(-2/3)_z+h.c. 
=_pvpe^-i2/3_+,R(2/3)p+h.c. 
=_p(R(2/3)v)pe^-i2/3_+,p+h.c. 
Since the Hamiltonian is invariant under  rotations
we must have  
From Eq. (), we find  where 
is the slope of the cones. By plugging into Eq. ()
and projecting onto a single quasimomentum we obtain the Dirac equation
(1) of the main text [for  and ].   
Details of the numerical calculations of the pseudomagnetic fields 
In this section we provide additional details about the numerical
calculations performed with the COMSOL finite-element solver, thereby
guiding through the computation of the movements of the Dirac cones
in reciprocal space and the construction of the resulting pseudo magnetic
field for phonons in a strip configuration. In all calculations the
material is assumed to be silicon (Si) with Young's modulus of ,
mass density  and Poisson's ratio . 
Breaking the 3-fold rotational symmetry (-symmetry)
of the snowflake geometry but maintaining its inversion symmetry (-symmetry),
displaces the Dirac cones from the high symmetry points 
and , but does not gap the system (cf. Figure 2c of the
main text). This effect is depicted in Figure ,
which shows the motion of the Dirac cones, as an effect of the broken
-symmetry. Thereby the radius of the horizontally
orientated snowflake arm is varied by  (),
which displaces the Dirac cones in the -direction. Generally
this would also shift the Dirac cone's energy. In order to avoid that,
the remaining two snowflake arms are varied equivalently by 
in such a way that the average radius is kept fixed at 
(i.e ).    
   
To engineer a constant pseudo magnetic field in a strip configuration,
that is infinitely extended in the x-direction, the snowflakes need
to be designed properly: The B-field is given by ,
whereas the vector potential for a given valley is directly related
to the shift of the Dirac cones . As the strip is
periodically extended in the x-direction the vector field is not allowed
to vary along this direction (i.e.),
while  must depend linearly on the vertical position 
(i.e. ), in order to have a constant
magnetic field (cf. Figure a). Using the relation
between the shift of the Dirac cones and the variation of the radii
(quadratic fit in Figure a),
the radii of the snowflakes can be calculated in dependence of their
position in the strip (cf. Figure b). In addition
to that, we want to engineer smooth boundaries by opening a mass gap,
which is done by breaking two-fold rotational symmetry at the edges
of the sample. This can be achieved by displacing one of the snowflake
arms by  (cf. Figure 2a of the main text), with 
in the bulk region while it smoothly increases in the vicinity of
the sample's edge (cf. Figure c).     
    
Edge States at the Physical Boundary 
In the Figure , we investigate the intrinsic
edge states that appear at the physical edge of the strip and that
will be present even in the absence of pseudo-magnetic fields. The
relevant bands are highlighted as colored lines in the band structure
of the strip, see panel a. The corresponding displacement fields are
shown in panel b. Note that the edge states are defined only on a
finite portion of the Brillouin zone (where the bands are plotted
as dashed lines) and smoothly transform into bulk modes in the remaining
quasimomentum range.    
*  
Tight Binding Model on the Kagome lattice    
    
For the transport calculations, we have modeled the hexagonal snowflake
crystal by a tight-binding Hamiltonian on a Kagome lattice, which
is the lattice that describes the links between neighboring triangles,
whose motion represents the relevant sound waves for the particular
triple of bands that we choose to consider. The Kagome lattice Hamiltonian
reads,   
Here,  is a multi-index, 
where  label the unit cell, and  the sublattice,
see Figure a. As usual, 
indicates the sum over the nearest neighbors. The hopping matrix 
is symmetric and its matrix elements are chosen to reproduce the same
Dirac equation that would effectively describe our patterned snowflake
crystal. The energy  is the eigenenergy of the states 
for the rotationally symmetric crystal (see main text) while 
cancel out a renormalization of the energy by the hopping terms.  
In the main text and in the Appendix , we have shown
how the FEM simulations can be mapped onto the effective Dirac Hamiltonian
Equation (1) of the main text. Here, we show how the tight-binding
model Eq. () can be mapped onto the same effective
Hamiltonian. We first consider the simple case where the invariance
under discrete translations and the  symmetry are not
broken corresponding to  and . In this case,
all (nearest-neighbor) hopping rates must be equal 
One can easily calculate the equivalent first-quantized Hamiltonian   
where  
and . By expanding around 
or  and projecting onto the states 
and 
( is the quasimomentum about the center of the downwards triangles)
we find the Dirac Hamiltonian (1) of the main text with  
and . The energy at the tip of the cones is 
if . 
Next, we break the  symmetry but preserve the translational
symmetry such that the mass  and the gauge  fields
are constants. In this case, there are six different hopping rates.
Three of them describe the hopping within the same (to a different)
unit cell 
()
where  and  ().
The resulting first-quantized Hamiltonian reads   
where 
Since we are interested in the case where the  symmetry
is broken only weakly, we assume .
Up to leading order in  this correspond
to the the Dirac Hamiltonian (1) of the main text with   
 where the vectors  are defined in the main text.  
With the help of the relations (,,)
we can simulate the Dirac Hamiltonian (1) of the main text with the
desired constant pseudo-magnetic field (in the symmetric gauge )
and mass profile. To simulate the disorder we add and additional random
energy shift  equally distributed on the interval
 A finite decay
rate of the phonons (necessary to reach a steady state), is described
within the standard input/output formalism . In
the simulations with the drains, the decay rate is increase smoothly
in the regions of the drains (in order to avoid introducing any additional
backscattering).  
Possible Implementations 
Here, we provide a few more comments regarding the optomechanical
excitation and read out of helical waves. In the simplest approach
without a cavity, one could illuminate the structure from above by
tightly focussed laser beams, exerting radiation pressure directly.
A rough estimate of the force, for a laser power of ,
indicates that (out-of-plane) vibrational amplitudes of the order
of fm might be achieved. In this estimate, we have adopted the
simplest possible approach, treating the triangle as an oscillator
with a frequency of order  and a decay rate
() set by the scale of the bandwidth of the Kagome bands.
A more detailed analysis would be needed to extract the excitation
efficiency for the particular vibrational modes of interest, which
formed the basis of our discussion in the main text. 
However, a much more efficient approach is available, involving optical
cavities. A structure scaled up by a factor of  (resulting
in frequencies lower by ) can host defect-mode nano cavities embedded
in the triangles itself, cf. Figure . For any such
optical cavity, a circulating light with a modulated intensity will
give rise (via radiation pressure and photoelastic forces) to periodic
cycles of expansion and contraction of the structure. This type of
motion (when the right frequency is selected) clearly overlaps with
the vibrational modes that are relevant for our proposal, cf. Fig.
1df of the main text. We note that the light intensity
is enhanced by the cavity's finesse (usually at least ),
thereby increasing the amplitude of the vibrations. As the thermal
motion decreases with the factor , it is easily possible
to overcome the thermal motion at room temperature. In addition, during
the measurements one can average out the noise and provide a clear
signal of the excited sound waves traveling through the structure,
regardless of thermal fluctuations.    

#1#1  
Snowflake Topological Insulator for Sound Waves  
Christian Brendel  
Max Planck Institute for the Science of Light, Staudtstra�e 2,
91058 Erlangen, Germany  
Vittorio Peano  
Department of Physics, University of Malta, Msida MSD 2080, Malta  
Oskar Painter  
Institute for Quantum Information and Matter and Thomas J. Watson,
Sr., Laboratory of Applied Physics, California Institute of Technology,
Pasadena, USA   
Florian Marquardt  
Max Planck Institute for the Science of Light, Staudtstra�e 2,
91058 Erlangen, Germany  
Institute for Theoretical Physics, University of Erlangen-N�rnberg,
Staudtstr. 7, 91058 Erlangen, Germany 
We show how the snowflake phononic crystal structure, which has been
realized experimentally recently, can be turned into a topological
insulator for sound waves. This idea, based purely on simple geometrical
modifications, could be readily implemented on the nanoscale.  
Introduction.  First examples of topologically
protected sound wave transport have just emerged during the past three
years. So far, experimental implementations exist on the centimeter-scale,
both for the case of time-reversal symmetry broken by external driving
, such as in coupled gyroscopes, as well
as for the case without driving ,
such as in coupled pendula. Moreover, a multitude of different implementations
have been envisioned theoretically .
However, it is highly desirable to come up with alternative design
ideas that may be realized on the nanoscale, eventually pushing towards
applications in integrated phononics. The first theoretical proposal
in this direction  suggested to exploit
the optomechanical interaction to imprint the optical vorticity of
a suitably shaped laser beam to generate chiral sound wave transport
in a phononic-photonic crystal. On the other hand, if one wants to
avoid the strong driving by an external field, purely geometrical
designs are called for. One remarkable idea of Mousavi et al. 
posited creating a sound wave topological insulator by designing a
phononic crystal structure made from a material that would be carefully
engineered by a pattern of small holes to achieve degeneracy between
vibrations that are symmetric and antisymmetric to the plane of the
sample. The appearance of a fine-grained length-scale much smaller
than the wavelength, however, makes it impossible to use this idea
all the way down to wavelengths comparable to the smallest feature
sizes allowed by nanofabrication. In the present manuscript, we propose
a very simple modification to an already existing structure, the so-called
snowflake phononic crystal. The snowflake crystal has already proven
to be a reliable platform for nanoscale optomechanics ,
and could also support pseudomagnetic fields for sound waves .
With the proposed modification, which is inspired by an idea first
analyzed by Wu and Hu for photonic systems 
(see also ),
one will be able to create a topological insulator for sound waves
based on a proven nanoscale platform.  
The envisaged system consists of snowflake-shaped holes of alternating
sizes, in a periodic arrangement on a triangular lattice. This snowflake
topological insulator can be viewed as a metamaterial that supports
topologically protected sound waves whose typical wavelength is larger
than the underlying lattice scale. Such elastic waves propagate along
arbitrarily shaped domain walls engineered by appropriately varying
the snowflake size. We will show that the topological protection is
guaranteed if locally (at the lattice scale) the point group symmetry
of the snowflake design is mantained.  
Platform.  We assume a planar quasi-two-dimensional
phononic crystal slab exhibiting a six-fold rotational symmetry ()
as well as a discrete translational symmetry () on a triangular
lattice, with a lattice constant . The most straightforward implementation
consists in the snowflake phononic crystal. This crystal has been
explored before in the context of optomechanics ,
since it is both a photonic and a phononic crystal, although we will
only make use of its phononic properties. Its structure is shown in
Fig. a. 
Symmetries and folding.  Due to the -symmetry,
the acoustic band structure is forced to have Dirac cones at the two
high-symmetry points,  and .
Now consider a single snowflake-shaped hole surrounded by six other
such holes. Our aim will be to break the original translational symmetry
by changing the central snowflake in this configuration, thereby enlarging
the real-space unit cell by a factor of  (Fig. a).
Conversely, this will reduce the size of the first Brillouin zone
(BZ) by the same factor. To anticipate this reduction, we imagine
what happens when the original band structure, obtained for the as-yet
unperturbed structure, gets folded back into the new BZ (see Fig. a-b).
This will map the Dirac cones from  and  of the
old BZ to the -point of the new BZ, forming a degenerate
pair of double Dirac cones at  (Fig. c-d).
Only in the next step we actually do break , by carrying out
the afore-mentioned change of the central snowflake, increasing the
lattice constant  and establishing
the new symmetry , all the while preserving
 around the unit-cell centers. This opens a complete
gap at the -point (Fig. e), which can be topological
in nature, as will be explained below. 
The easiest way to implement this modification of the geometry is
to change the radius of the central snowflake in each (enlarged) unit
cell by , with  referring to the original
snowflake crystal (Fig. a).    
     
The band structures shown in Fig.  have been obtained
from full finite-element simulations of the equations of linear elasticity,
solving the eigenvalue problem   
with  being the complex three-dimensional wave
function related to the mechanical displacement field 
of the crystal,  the elasticity tensor, and  the
mass density. Here  is a short-hand for the tensor product, .
For concreteness, we envisioned a phononic crystal slab of thickness
, but much smaller slabs have been fabricated already,
down to unit cells of only a few hundred nanometers lateral extension
(acoustic frequencies would scale inversely with the linear dimensions,
as usual). 
Effective Hamiltonian.  We now derive
an effective Hamiltonian valid for the vicinity of the -point.
We are taking a route that clarifies the connection to the original
valley degree of freedom. The results can alternatively be understood
in the framework of the symmetry arguments first advocated for -symmetric
structures in the photonic context in . We start
with the eigenstates of the two double Dirac cones of the regular
() snowflake array. They are labeled by ,
with 1 being the quasi-angular momentum with respect
to the 3-fold rotation  
and  denoting the valley degree of freedom ( for
 vs.  for  ). Under time reversal  (complex
conjugation) and inversion  they obey   
The exact mode shapes of  for the particular
case of the original snowflake crystal are explained in detail in
. In order to derive the Hamiltonian,
we use two sets of Pauli matrices to span the 4-dimensional Hilbert
space. We define one set for the valley degree of freedom 
and another one for the quasi angular degree of freedom ,
such that 
and ,
and the usual set of Pauli matrices holds in this basis. 
We now write down the Hamiltonian as a Taylor series up to linear
order in  by using the above matrices. We keep only terms
that are invariant under  and , which
are the symmetries of our snowflake crystal (even for ).
This leaves us with only the following terms:   
Up to a unitary transformation this Hamiltonian is equivalent to the
large-wavelength limit of the Bernevig-Hughes-Zhang model for a topological
insulator . The first term in Eq. ()
is induced by the breaking of the  symmetry and is responsible
for gapping the degenerate Dirac cones. In other words,  can be
interpreted as a mass, which can change sign. The unitary symmetry
that allows to cast Eq. () in a block-diagonal form  is
the spin degree of freedom 
. Combined with the time-reversal operator, it gives rise to a pseudo
time-reversal symmetry , which has the peculiarity
that it squares to minus the identity, directly leading to Kramer's
degeneracy. At the -point, the common eigenstates of 
and  are the states  and 
which obey , , ,
and .  One can show that these
states are actually of - and -type with respect to their behavior
under 60-degree rotations:   
Note that away from the  point only states of the same helicity
() will get mixed to form the finite eigenstates.The
Hamiltonian terms which are linear in the quasimomentum 
will induce transitions only between states whose -degree quasi-angular
momenta differ by one quantum:  to  and  to
. Only further away from the -point, higher-order
terms (e.g. ) can eventually couple the  and 
states, i.e. mix different helicities. An indirect signature of this
coupling is the lifting of the degeneracy     
   
In a topological insulator, the helical edge states are confined along
domain walls that separate regions of opposite mass . Here, we
can simply tune the mass  by changing the radius of the central
snowflake, see Fig. . As discussed above when all snowflakes
have the same radius (corresponding to ) the  and
 bands are degenerate at the  point (). For a
decreased (increased) radius  of the central snowflakes, the
 orbitals have larger (smaller) energy, corresponding to a positive
(negative) mass , cf. Fig. . In order to understand
this behavior, it is useful to observe that the - orbitals have
extra nodes at the external links leading out of the (enlarged) unit
cell, enforced by a phase-difference of  across those links.
When all snowflakes have equal radius, the additional energy cost
associated with the larger phase gradient (compared to a -orbital)
across these external links exactly offsets the benefit of a reduced
phase gradient on a path encircling the central snowflake. Obviously,
stronger (weaker) internal links [corresponding to a decreased (increased)
central snowflake radius ] favor energetically the -
(-) states, eventually leading to the behavior displayed in Fig.
.   
Strip in the continuum model.  To ascertain
the appearance of edge states at an interface with a band inversion,
we first consider a strip configuration with a mass term  varying
along the transverse (finite) -direction from  to .
We employ the continuum limit based on Eq. (), using
the envelope function approximation. Following this standard procedure
,
we obtain a right (left) moving state, with a linear dispersion 
() for  (), that decays exponentially away
from the domain wall, with a penetration depth . This
behaviour, obtained in the continuum limit, is confirmed in direct
finite-element simulations of the microscopic equations of elasticity
for a strip geometry.    
    
Helical edge channels in finite-element simulations.
 We will now verify the above statements for the snowflake
crystal, using the full microscopic acoustic equations. For that purpose,
we consider a strip with a finite extent along . Before we investigate
the effects of domain walls, we first briefly discuss the strip with
a spatially homogeneous mass term, i.e. composed of the hexagonal
building blocks comprising three snowflakes (Fig. a, red
shaded area), with the central snowflake's radius deviating by .
Figure  shows the band structures of strip configurations
with  (b) and 
(c), obtained by the COMSOL finite element solver. The Dirac cones
are replaced by a complete bulk band gap. There are states that appear
in addition to the bulk-derived bands and that are localized at the
boundaries (Figure e), arising due to the symmetry-breaking
at these sharp sample boundaries. These edge states are not protected
by any symmetry and are highly sensitive to the exact geometry of
the edge. Moreover, they are two-fold degenerate; one state is localized
at the upper and the other at the lower boundary. 
Next, we attach both structures to each other (Fig. a)
and obtain a strip geometry with a domain wall where the sign of the
mass term  flips. The corresponding band structure
is shown in figure d, which is basically a superposition
of the band structures of the bare strips with .
However, in addition to the bulk bands and the afore-mentioned states
at the sample boundaries, two states appear that traverse the gap
entirely, with a linear dispersion of opposite slope (group velocity).
Moreover, there is no discernible avoided crossing between these two
states, underlining the absence of back-scattering expected for topological
insulators due to the symmetry-protection. Figure e shows
the quasi-momentum resolved wave function of the right-moving state
(red energy dispersion in panel d). For small quasi-momenta it is
highly confined around the domain wall, with a typical penetration
depth inversely proportional to the size of the bulk band gap (as
expected from  derived in the continuum model).    
   
Effects of disorder.  The engineered symmetry
 will not protect against competely arbitrary (generic)
disorder. This behaviour is in fact common to all bosonic topological
insulators . However,  is valid
near the -point. Therefore, generically speaking, one may
expect that this protection is preserved near smooth defects, interfaces,
and sample boundaries, which admix only wavevectors close to .
On top of this, even for sharp domain boundaries, we find in the full
finite-element simulations that there is no discernible back-scattering
for the parameters we have explored. Such a scattering would show
up in the form of a minigap, i.e. an avoided crossing between the
counterpropagating edge states. This unexpected robustness in the
presence of sharp interfaces has been observed as well in works analyzing
photonic structures based on  symmetry .
Moreover, one can show that even short-range defects of a certain
kind, that are compatible with the symmetry , do not induce
scattering between counterpropagating edge states. For example, both
of the following perturbations have zero matrix element between sectors
of opposite helicity: changing the masses of all 6 triangles in a
given unit cell by the same amount, or leaving out a single snowflake
hole. 
Arbitrary boundaries.  We now consider a finite
system with an arbitrarily shaped boundary to observe unidirectional
transport of mechanical excitations and the effects of disorder. To
keep the computational effort manageable, we approximate the snowflake
crystal by a tight-binding model, where the sites of this model directly
correspond to the physical triangles that are arranged in a honeycomb
lattice. Note that in order to obtain most of the insights we are
aiming for here, it would be more generally sufficient to use any
tight-binding model that exhibits the same symmetries that underly
the topological protection in our system. We use a hexagonal unit
cell comprising six sites with equal eigenfrequencies. To mimic the
mass term, hopping rates within a unit cell, , deviate
from hopping rates between different unit cells, . Again there
is a direct interpretation: By changing the radius of the central
snowflake in the real microscopic structure, the links connecting
the triangles also change, consequently leading to different coupling
between two triangles. 
As shown above, the unidirectional edge states are superpositions
of the states with the same helicity  (e.g.  and ).
Figure  shows the energy distribution for a mechanical
wave that is propagating at the domain wall between two domains with
different mass terms. We excite a whole unit cell (indicated by the
yellow arrow) with a -type mode shape, thereby launching
a sound wave that just propagates to the right. By calculating the
linear response of each lattice site to this particular excitation,
we obtain the propagation probability (modulus squared of the Green's
function) of the mechanical excitation. As mentioned in the general
discussion near Eq. (), the symmetry  is obeyed
to a very good approximation within a rather large fraction of the
Brillouin zone. As a consequence, any remaining admixture of the opposite
helicity is quickly suppressed when a sharp domain wall (with a sudden
jump in hopping amplitudes) is replaced by even only a slightly smoothened
wall. This is confirmed by the numerical simulations displayed in
Fig. f.  
Conclusions.  The snowflake topological insulator
for sound waves proposed here is straightforward to fabricate at any
scale, down to the nanoscale. It can be excited and read-out using
a variety of different approaches, including electrical, mechanical,
and optomechanical (adapting the ideas presented in ).
The simplicity of the nanoscale design (and the small dimensions of
the unit cell) will turn such a modified snowflake crystal into a
versatile platform for generating arbitrary phononic circuits and
networks 
on the chip, which may couple to hybrid quantum systems of various
kinds and could also contain optically tuneable non-reciprocal elements
. 
Acknowledgments.  We acknowledge funding by ERC
StG OPTOMECH and the EU HOT network, as well as the Max Planck Society.
O.P. acknowledges support by the AFOSR-MURI Quantum Photonic Matter,
the ARO-MURI Quantum Opto-Mechanics with Atoms and Nanostructured
Diamond (grant N00014-15- 1-2761), and the Institute for Quantum Information
and Matter, an NSF Physics Frontiers Center (grant PHY-1125565) with
support of the Gordon and Betty Moore Foundation (grant GBMF-2644).  
apsrev4-1    
3   
List of Videos
textcolor    
    
Many-particle dephasing after a quench  
Thomas Kiendl  
Florian Marquardt  
Dahlem Center for Complex Quantum Systems and Institut f�r
Theoretische Physik, Freie Universit�t Berlin, 14195, Berlin, Germany  
Institute for Theoretical Physics, Universit�t Erlangen-N�rnberg,
Staudtstr. 7, 91058 Erlangen, Germany  
Max Planck Institute for the Science of Light, G�nther-Scharowsky-Stra�e
1/Bau 24, D-91058 Erlangen, Germany 
After a quench in a quantum many-body system, expectation values tend
to relax towards long-time averages. However, in any finite-size system,
temporal fluctuations remain. It is crucial to study the suppression
of these fluctuations with system size. The particularly important
case of non-integrable models has been addressed so far only by numerics
and conjectures based on analytical bounds. In this work, we are able
to derive analytical predictions for the temporal fluctuations in
a non-integrable model (the transverse Ising chain with extra terms).
Our results are based on identifying a dynamical regime of 'many-particle
dephasing', where quasiparticles do not yet relax but fluctuations
are nonetheless suppressed exponentially by weak integrability breaking.   
Introduction  The relaxation dynamics of quantum
many-body systems has come under renewed scrutiny in the past years,
due to its relevance for the foundations of thermodynamics and the
availability of isolated systems, like cold atoms. The simplest case
considers the evolution after a sudden quench of parameters .
Typically, one then analyzes local physical observables (like particle
density, magnetization, currents), and asks about the time-evolution
of expectation values. The most basic question concerns the long-time
averages after the quench: are they correctly described by
a thermal state at some effective temperature related to the initial
energy after the quench? .
On the next, more refined level of analysis we can study the time-dependent
fluctuations of expectation values around their temporal average.
For any finite system, these persist even at infinite time. In principle,
these represent a kind of long-term memory, since they are reproducible
(the same for each repetition of the quench) and depend both on the
exact time of the quench and on details of the initial state.  
A crucial question for the foundations of statistical physics is:
are these fluctuations suppressed in the thermodynamic limit ,
and if yes, how fast? This is also relevant for experiments in equilibration,
like analog quantum simulations carried out in finite ('mesoscopic')
lattices. 
These fluctuations around the time-average are commonly characterized
by 
.
The overbar denotes a time-average and .
Note that this is different from the quantum fluctuations ,
which are usually much larger and would be present even in a perfect
thermal equilibrium state (where  vanishes). 
The finite-size scaling of persistent temporal fluctuations after
a quench has been approached so far from several angles: (i) in the
context of the Eigenstate Thermalization Hypothesis, justifying the
neglect of off-diagonal contributions to expectation values ,
(ii) based on the former, general mathematical bounds supplemented
by physical arguments for generic interacting, non-integrable systems
;
(iii) calculations for simple integrable systems (which have, however,
special properties that strongly differ from the generic case) ;
(iv) numerics .  
Here, we will provide exact analytical results for the suppression
of fluctuations in a non-integrable system, confirming the
hypothesized exponential decay with system size. Our analysis rests
on identifying a general dynamical regime which we term 'many-particle
dephasing', relevant for weak integrability breaking. The advantage
over having purely numerical results will be that we can provide a
complete description of how the result depends on the quench, the
initial state, and parameters. The advantage vs. analytical bounds
is that the bounds are not guaranteed to be close to the true results.  
Integrable transverse Ising Model  We start from
the well-known integrable quantum Ising chain. We review briefly its
properties and its quench dynamics, as they will be important for
our analytical solution of the non-integrable evolution later on.
The quantum (transverse) Ising chain is an exactly solvable model
for quantum phase transitions :  
Here  and  are spin-1/2
operators acting on site . We will assume periodic boundary conditions,
with . For ,
the model is paramagnetic (where ),
while at  there is a quantum phase transition into a
ferromagnetic phase, with spins aligning either in the  or 
direction. The model can be solved exactly by mapping to free fermions,
via .
This results in a quadratic fermionic Hamiltonian that does not conserve
particle number and can be solved by Bogoliubov transformation in
-space:  
For definiteness we will assume  even. The quantization of wavenumbers
is slightly changed from the textbook case (due to an extra sign that
enters when coupling site  to site ), with ,
where  is an integer and  ranges over the Brillouin zone .
The Hamiltonian decomposes into independent sectors .  
For this as well as other integrable models it has been found that
the temporal variance of many single-particle observables scales like
 . However,
there are important exceptions where there is no such suppression
with  . 
In a quench of the coupling strength  out of the pre-quench ground
state, during the evolution we will have  either occupied
by two particles or unoccupied. This can be viewed as an artificial
spin 1/2 system. We take  to correspond to 
and  representing ,
with .
In that notation, the Hamiltonian () becomes
a set of decoupled effective spin-1/2 systems:  
We introduced the two-particle excitation frequencies ,
and the field direction .
The ground and excited state, , have
energies , and .
In this picture, a quench corresponds to a sudden change of 
and , such that for each  the Bloch vector starts
to precess around the new field direction: .  
An example for an observable is the projector for the spin pointing
along  at some site : .
Because of translational invariance, 
is independent of . One finds ,resulting
in an expression of the form .
 At sufficiently long times, all the oscillatory terms dephase, producing
seemingly random time-dependent fluctuations. This process can be
termed ``single-particle dephasing'', since it results from
the superposition of different oscillation frequencies whose number
scales linearly with system size. 
Thus, the temporal variance ends up being .
In the limit of large , this becomes   
i.e. , confirming the result of . 
Quench in the non-integrable model  The general
physical expectation for non-integrable systems is that the long-time
steady state after a quench has fluctuations that are exponentially
suppressed in particle number (system size) , in contrast to the
power-law suppression in the integrable case displayed above. This
was made explicit first in . There,
an upper bound was derived, .
Here,  and  are the maximum and minimum
eigenvalues of . 
denotes the inverse participation ratio, which decreases if the initial
state  spreads over more energy eigenstates
. It was then argued on general physical
grounds that the  usually decreases exponentially with
system size. However, an argument of this kind does not reveal how
fast the decay is for any concrete system or quench scenario, or whether
the upper bound displays the correct parameter dependence at all,
since it will not be tight in general. More recently, it was reported
that numerical simulations for a variety of models and quench scenarios
indeed reveal an exponential suppression with system size, for the
finite-size systems that could be addressed .     
Our goal here is to go beyond bounds and numerics, and to find an
analytical expression for a non-integrable case. We break the integrability
of the quantum Ising model by adding next-nearest-neighbor (NNN) coupling
.
In the fermion representation, this gives rise to two-particle interactions.
Other choices for integrability breaking are possible, which we will
address later. A direct numerical simulation (Fig. ())
indeed reveals a stronger suppression of fluctuations, that seems
to be consistent with an exponential decay in . 
We now come to an important question: What is the physical origin
of this strong suppression? Initially, one might suspect 'true thermalization',
in the sense of inelastic scattering of quasiparticles leading to
a redistribution of quasiparticle populations. This process could
then be described using a kinetic equation, and the final state would
be thermal. However, the simulation shows that this is not the case,
the quasiparticle distribution remains practically unchanged. There
is further numerical evidence that we are not witnessing thermalization:
The fluctuations decay to their steady-state long-time limit during
a time-scale  that scales linearly in the inverse perturbation:
. This is in contrast
to the behaviour expected from a kinetic equation, where the relaxation
rate would be set by . 
Many-particle dephasing  Instead, we have identified
a mechanism that could be termed 'many-particle dephasing'. First,
we note that, for weak interactions, the many-body energy eigenstates
still coincide to a very good approximation with those of the integrable
model. This explains the absence of thermalization in the occupations
of quasiparticles. At the same time, however, the energies are changed.
This lifts the exponentially large degeneracies of the integrable
model and gives rise to dephasing. The number of frequencies involved
is now exponentially large in , which is the reason we term the
resulting dynamics ``many-particle dephasing''. The generic situation,
including the different timescales, is shown schematically in Fig. .
We note that interacting systems mappable to noninteracting ones (the
present case) and purely non-interacting systems have to be distinguished.
Only in the former the complete one-particle density matrix relaxes
.     
It can be shown easily (e.g. ) that
fluctuations in the long-time limit obey .
Here  denotes a transition between two energy eigenstates
 and  where  is the transition
energy, and  combines the
transition matrix element of the observable with the amplitudes 
of the initial state with respect to the post-quench energy eigenbasis
.  
We now consider an arbitrary transition  that is
induced by . Suppose the observable just affects a single
quasiparticle at a time, or (in our case) it affects only a single
 pair of states. All other quasiparticles (or -pairs)
are merely spectators. Such a structure is typical for single-particle
observables. It is at this point that the weak integrability-breaking
interactions impose a crucial difference. For the integrable (effectively
non-interacting) case, there is an exponentially large number of other
transitions that have the same transition energy. These are obtained
by picking all possible configurations of the remaining 'spectator'
degrees of freedom (which are identical in the initial and final state).
In contrast, for the non-integrable (weakly interacting) case, there
is a correction to the transition energies which lifts this massive
degeneracy. For the present model, the transition energy correction
 turns out to be a sum over
contributions that depend on pairs of occupation numbers, 
and  (see Suppl. Material). Given a change in one of the
occupation numbers, the correction thus depends on the configuration
of all the 'spectator' degrees of freedom. Therefore, barring any
(rare) accidental degeneracies, the initial degeneracy is completely
lifted. That statement is confirmed by direct numerical inspection
of .  
Assuming that all the transition energies  have
become non-degenerate, we find .
In general, it would still be an impossible task to evaluate this
expression analytically. At this stage, however, the important observation
is that the  do not enter any more, even though
their modification by the weak interaction was crucial to lift the
degeneracies. Our strategy will be to evaluate this expression for
the matrix elements calculated with respect to the unperturbed integrable
many-particle eigenfunctions. In this way, we will arrive at analytical
insights into the suppression of fluctuations for the non-integrable
model! The requirement for this to work is that the perturbation 
is still weak, such that the eigenfunctions have not been changed
appreciably. Later we will check the results against numerics. 
Each energy eigenstate of the integrable transverse Ising model can
be written as a product state: .
Each configuration  is described by  bits ,
where  denotes the ground state 
and  the excited state  in the 
sector.  The observable we focused on in the numerical example was
, which, in fermionic language,
is equal to .
For this observable, we find:  
where 
enforces the initial and final configurations of 'spectators' 
to match. 
In evaluating the general formula for , we have to
sum over all possible many-particle transitions .
However, the Kronecker delta in Eq. ()
enforces the configurations  and 
to be equal except at . We still have to sum over exponentially
many configurations, though that can be handled by regrouping terms
and a bit of combinatorics (see Suppl. Material). In doing this, we
exploit the fact that the initial state can be written as a product
state over the different -sectors (since it is an eigenstate of
the pre-quench Hamiltonian). 
Analytical results  The final analytical result
for the long-term, steady-state fluctuations in the weakly non-integrable
model (small ) is:  
Here the exponential is equal to the inverse participation ratio .
We find explicitly ,
where 
is the IPR for the initial state  in
sector . In the limit of large ,  becomes -independent:
.
Thus, we obtain analytical access to the exponential suppression of
fluctuations.  
The prefactor in  contains a further  suppression,
and a constant , which can be given explicitly as well:  
where  
and . 
Writing the Ising Hamiltonian in the form of Eq. (),
we can give explicit expressions in terms of the ``magnetic field''
directions before () and after () the
quench:  
We find a very good agreement between the analytical expressions derived
here and the numerical results for finite system sizes (Fig. ).We
can now employ these expressions to discuss how  and 
depend on the quench parameters (Fig. ).
We note especially the non-analytic dependence on the post-quench
parameter at the quantum critical point. 
Other variants  For other observables, similar
calculations can be done. For example, for ,
the result is the same up to the change 
in Eq. (). The model discussed here thus affords
an example where the conjectured (and numerically observed) suppression
of fluctuations, exponential in system size, can be studied analytically
in detail.  
    
Other integrability-breaking interactions can be analyzed along the
same lines. For example, consider a weak longitudinal field .
Due to the  symmetry of
the unperturbed system, the first order energy corrections vanish
in the paramagnetic phase. Higher order contributions can still lead
to integrability breaking. In the paramagnetic phase, this yields
a good agreement with our analytical prediction ().
In the ferromagnetic phase,  breaks the inversion symmetry.
Thus the change in the eigenstates is large and the deviations become
significant (Fig. ). Still, if we
decrease the perturbation to sufficiently small values (orange crosses)
we once again get a good agreement with the analytical prediction
(see also Suppl. Mat.).    
   
Conclusions  We have identified a new regime for
quench dynamics of finite-size (``mesoscopic'') weakly non-integrable
many-particle systems, where the fluctuations are suppressed exponentially
in system-size, in contrast to the integrable case. We have presented
a strategy to obtain analytical results for the steady-state long-time
limit. 
We expect that the basic mechanism discussed here should apply whenever
one starts from an effectively non-interacting model (where the many-particle
energy can be written as a sum over independent contributions) and
introduces a perturbation that lifts the resulting massive degeneracies.
For finite systems, the perturbation can be weak enough that its effect
on the energies is the main effect, while the many-particle energy
eigenstates are still those of the unperturbed system: even an infinitesimal
interaction is sufficient to lift the degeneracies and will thus lead
to a completely different behaviour of the fluctuations in the long-time
limit (although the time-scale for reaching this limit will of course
diverge as the interaction tends to zero!). 
Acknowledgments  We thank Marcos Rigol, Lea Santos
and Aditi Mitra for discussions. T.K. acknowledges financial support
from the Helmholtz Virtual Institute New states
of matter and their excitations''. 
apsrev4-1  
Appendix  
Energy correction 
Starting from the fermionic representation of the transverse Ising
Hamiltonian, one can write down the transition energy corrections
to linear order in the coupling:  
The sum over  corresponds to the different terms present
in the fermionic representation of  and for
each  there is a correction that depends on the respective occupation
numbers. This is very similar to Hartree-Fock corrections for the
interacting Fermi gas. For our purposes, the precise form of 
and  is not important, although it can be written down explicitly.
The resulting splitting of a single degenerate transition energy is
plotted in figure .   
    
Derivation of the analytical many-particle dephasing prediction  
In this section we will derive the many-particle dephasing formula
 for the
temporal fluctuations of the observable .
First consider the general equation  
which was mentioned in the main text. We start by simplifying the
magnitude of the overlap  for two different
configurations   
*  
In order to understand this, recall that  causes all initial
and final spectators to match expect for the wave number . Hence 
can be nonzero only if either the wave numbers are the same or if
 and . The latter drops out because only different
configuration contribute to the temporal fluctuations. 
Inserting into equation 
and resolving the Kronecker deltas in , we obtain  
*
As in the main text,  corresponds to the ground state
and  to the excited state in the  subspace
after the quench. The second sum is over the set of all possible initial
configurations . Because
of the Kronecker deltas the final configurations differ only in the
single -sector from the first sum, resulting in .  
Next comes the crucial part, exchanging the sum of all configurations
with the product of all positive wave numbers. The result is the product
of all wave numbers , with each factor containing the sum of
the configurations in the -section. Taking special care
of the -sector, we obtain   
Using the definitions in the main text, we finally arrive at   
This corresponds to equation ()
in the main text.  
Symmetry breaking due to a longitudinal magnetic field 
In the main text, we show results for a longitudinal magnetic field
as a weak perturbation. We found good agreement in the paramagnetic
phase, but deviations in the ferromagnetic phase. These deviations
occur because the longitudinal field breaks the inversion symmetry.
Here we discuss why we still find a good agreement for sufficiently
weak perturbations. 
Starting in the ferromagnetic phase and the thermodynamic limit, there
are two degenerate ground states . One with
all spins pointing along , and one with all spins along .
Once the system size  becomes finite, both states can be connected
by  spin flips. The transverse field  thus
leads to an exponentially small energy gap that scales as .
This gap separates the two new lowest-lying eigenstates, which are
the symmetric and antisymmetric superposition of the two polarized
states. These correspond to the even and odd total particle number
states in the fermionic picture. 
In our analytics we assumed the system to be in the even subspace.
A longitudinal magnetic field, stronger than the energy gap caused
by the transverse field, mixes the symmetric and anti-symmetric subspaces.
Thus the eigenstates differ significantly from the unperturbed case.
This leads to deviation that could be corrected in principle, by using
the correct eigenstates in the analytics. However, if the perturbation
is sufficiently small the even and odd subspaces will stay well separated
and the analytical results derived in the main text stay valid.    
naturemag   
	
	
	
	
	
Supplementary material: Quantum nondemolition measurement of mechanical motion quanta 
Luca Dellantonio
The Niels Bohr Institute, University of Copenhagen, Blegdamsvej 17, DK-2100 Copenhagen , Denmark
Center for Hybrid Quantum Networks (Hy-Q), Niels Bohr Institute, University of Copenhagen, Blegdamsvej 17, DK-2100 Copenhagen , Denmark
Oleksandr Kyriienko
The Niels Bohr Institute, University of Copenhagen, Blegdamsvej 17, DK-2100 Copenhagen , Denmark
NORDITA, KTH Royal Institute of Technology and Stockholm University, Roslagstullsbacken 23, SE-106 91 Stockholm, Sweden
Florian Marquardt
Institute for Theoretical Physics, University Erlangen-Nurnberg, Staudstrasse 7, 91058 Erlangen, Germany
Max Planck Institute for the Science of Light, Gunther-Scharowsky-Strasse 1, 91058 Erlangen, Germany
Anders S. Sorensen
The Niels Bohr Institute, University of Copenhagen, Blegdamsvej 17, DK-2100 Copenhagen , Denmark
Center for Hybrid Quantum Networks (Hy-Q), Niels Bohr Institute, University of Copenhagen, Blegdamsvej 17, DK-2100 Copenhagen , Denmark   
Here we provide supplemental material for the article ``Quantum nondemolition measurement of mechanical motion quanta'', which is structured as follows. In the first section () we carefully derive the results presented in the main text for the  circuit. In subsection  we describe how the QND interaction allows for reading out the mechanical state, while in subsection  we study the dynamics induced by the linear coupling. The second section () generalizes the results by deriving the figure of merit  for the circuit in Fig. 1(c) of the main text. Considering the symmetric case, analytical results are derived in subsections  and , while the most general case of the antisymmetric system is treated in subsection . In the third section () we look at a possible measurement scheme, both analytically and numerically. Finally, in section  we present an investigation of the required experimental parameters for a concrete realization of our setup. Throughout the supplemental material we present several numerical simulations to support our analytical results (subsections ,  and section ). 
RLC circuit 
In the following we consider an  circuit where the capacitor contains an oscillating element. Following the standard procedure for quantizing an electrical circuit , we can write the Hamiltonian of the setup presented in Fig.  as   
where the conjugate position  and momentum  are the electrical charge and flux, respectively.  is the zero--point motion amplitude for a membrane of mass , and  () denotes the mechanical annihilation (creation) operator.  and  are the mechanical and electrical resonance frequencies. ,  and  are derived from the expansion of the inverse capacitance,   
where the coupling required for the QND interaction comes from the rotating wave approximation: . Finally,  is the input field,  is the Johnson--Nyquist noise associated with the resistor , and  is the random force related to the mechanical reservoir that slowly thermalizes the membrane.    
From Eq. Eq:HamFinalSimple we can derive the Heisenberg equations of motion for the electromechanical system operators ,  and . Adding decays and noises to the equations of motion we have  
	
	Q = & L_0,   
	 = & -QC_0-g_1 _sL_0 Q(b+b^)-g_2_sL_0Q(n_b+bb+b^b^2) -(_t+_r)+2(V_in+V_R0),  
	b = & -i _mb-g_1i_sL_0Q^22-g_2i_sL_0Q^22(b+b^ ) - _b2b+i x_0F_b. 
	  
Importantly, these expressions are just the familiar Kirchoff's laws, which provide the form of the electrical decay rates  and . The mechanical decay rate  is an intrinsic property of the membrane, and we have assumed that the mechanical reservoir can be treated using the Markov approximation. Finally, the reflected signal is determined by the input/output relations   
that read the same in the time and frequency domains. 
QND measurement of the phonon number 
As explained in the main text, there are three mechanisms with which the mechanical system influences the electrical one. These are the two terms  and , which generate sidebands at frequencies  and , and a phonon--dependent frequency shift proportional to  [see Eq. Eq:EOMphiS]. When we perform homodyne measurement at the resonant frequency of the electrical circuit , the sidebands contribution to the measurement outcome averages out, and we are left with the phonon--dependent frequency shift. The main detrimental effect of  will be to cause heating. We consider this in subsection , and in the following discussion of the readout we thus assume that the phonon number is conserved, . Under these assumptions, the electrical readout is independent of the mechanical dynamics, and can be described by 
	
	Q = & L_0,   
	 = & -QC_0-g_2_sL_0Qn_b -(_t+_r)+2(V_in+V_R0). 
	  
As it is instructive to look at these equations in the frequency domain, we introduce the Fourier series of any operator  by   
with  () being the allowed frequencies, and  is the time period used to define the Fourier series. For now we will let  be equal to the measurement time , but later we shall consider a larger value to describe heating on longer time scales. The Fourier coefficients  are then defined by   
It is possible to rewrite equations Eq:qndEOMsimple in the frequency domain:  
	
	-i_k[_k] & = -Q[_k]C_0 - g_2_sL_0Q[_k] n_b-(_r+_t)[_k]+2 (V_in[_k]+V_R0[_k]),   
	-i_kQ[_k] & = [_k]L_0. 
	  
From these two relations we derive , which can then be used in Eq. Eq:In/Out for determining :  
	
	V_out[_k] & = [1-(_k,n_b)]V_in[_k] - (_k,n_b)V_R0[_k],   
	(_k,n_b) & = 2 _t _k -i(_k^2-_s^2-g_2_sn_b)+_k (_r+_t). 
	  
These expressions describe the principle of the QND measurement: the quadratic interaction shifts the resonance frequency of the circuit by an amount proportional to  (denominator of Eq. Eq:VoutSimpleCoeff). By sending a signal resonant with the electrical circuit, it is possible to detect this frequency change as a phase shift of the reflected signal. 
From the quantized form of  and  , we have the Fourier components  
	
	V_in[_k] & = _k Z_out2 a_in,k,   
	V_R0[_k] & = _k R_02a_R0,k, 
	  
where  and  are the annihilation operators for the input field and the electrical reservoir, and satisfy the standard commutation relations. The measurement outcome  is obtained by homodyne detection, meaning that we have access to   
where  is an arbitrary phase that allows choosing the quadrature of the reflected signal to be measured.  
Having now all the operator equations describing the system in the Heisenberg formalism, we need to define the input state . Assuming that the semi--infinite transmission line of impedance  and the resistor  are connected to reservoirs at the same temperature , and that we drive the circuit with a coherent field at the resonant frequency , we have:   
Here,  is the partition function,  is the displacement operator,  is the photon flux,  is the reservoir Hamiltonian, and  with  being the Boltzmann constant. Using  it is possible to calculate the average measured signal  and the variance  for an incident field at the resonance frequency :  
	
	V_M (n_b) & = -_s Z_out2Im(_s,n_b),   
	(V_M )^2 & = _s Z_out2[ 1+2 n_e(_s,T_e) ], 
	  
where  is the number of photons sent into the circuit during the measurement. The imaginary part is denoted with , and  is the average number of photons at frequency  in the electrical reservoir.
Note that we have taken  in Eq. Eq:VmSimple, and  to be purely real. With this choice, we measure the phase quadrature, which optimizes the signal for small  (see Fig. ).   
It is now possible to derive the parameter  introduced in the main text. We defined  to be the difference between two outcomes with one and zero phonons respectively,   
Considering that  is the variance , we find   
This last equation reduces to the form given in the main text by setting  and noticing that typically .  
Membrane heating 
In this subsection we study the time evolution of the average phonon number , and determine the parameter  that characterizes the probability for the mechanical state to jump during the measurement time . It is convenient to introduce creation  and annihilation  operators for the electrical charge  and flux  operators,  
	
	Q & = C_0 _s2(a+a^),  
	 & = i2 C_0_s (a^-a).
	  
Using these we can rewrite the Hamiltonian in Eq. Eq:HamFinalSimple as   
where we have used the rotating wave approximation to neglect terms which are off--resonant with the electrical frequency . Given that the coupling coefficients  and  are small compared to all other parameters, we linearize  and  such that only deviations from their steady states are considered: , where  
If the experiment is performed in a pulsed fashion with incoming pulses varying on a timescale comparable to the circuit's lifetime , Eq. Eq:AvgASimple should be replaced by a suitable expression that takes into account the transient dynamics . Here we restrict ourselves to the cases in which either fields are applied continuously, or pulses are slowly varying on the timescale identified by . In the latter case, the simple replacement  in Eq. Eq:AvgASimple is sufficient. 
Considering that , we can neglect the quadratic coupling in the Hamiltonian Eq. Eq:HamLinearSimple for calculating the heating. The Hamiltonian can then be rewritten in the form  
where we have switched to the rotating frame using the unitary transformation . Notice that we linearized the operator , with its average given by the coherent field  at the frequency , and neglected a term , that can be removed by changing the rest position of the mechanical oscillator.  
The equations of motion for the operators  and  are then given by  
	
	a & =  g_1_t+_r_tT(b+b^) - _t+_r2a+i 2 C_0 _s (V_in+V_R_0),  
	b & =  -i _m b - g_1_t+_r_tT(a - a^)  - _b2b+ix_0F_b, 
	 
where we have linearised in the operators  and .
A formal solution in the time domain for these two differential operator equations then reads  
	
	
	a(t) = & a(0)e^-_t+_r2t+  g_1_t+_r_tT_0^te^-_t+_r2(t-) [ b()+b^()] d
 &+ i2 C_0 _s _0^te^-_t+_r2(t-) [V_in()+V_R_0()] d,  
	 
	
	b(t)  = & b(0)e^-( i _m + _b2 )t - g_1_t+_r_tT_0^te^-( i _m + _b2 )(t-) [ a() - a^()] d
& + ix_0_0^te^-( i _m + _b2 )(t-)F_b()d.
	 
	  
Since we are interested in the average phonon number , we can substitute Eq. Eq:SolASimple into Eq. Eq:SolbSimple, to derive the time evolution of the operator  as a function of the noises ,  and :   
Importantly, because we choose to probe the system at the electrical resonance frequency , the oscillating terms proportional to  and  in Eq. Eq:SolASimple cancel each other, such that the result simplifies to Eq. Eq:SolbLinFinSimple. The above expression is an integral operator equation, the solution of which fully describes the mechanical annihilation operator . An analogous relation can be obtained for the creation operator , by taking the adjoint of Eq. Eq:SolbLinFinSimple. In general, this integral is difficult to evaluate. However, assuming the Markov approximation, we can compute the second moments of all the noise operators involved. Thus, even if we cannot solve Eq. Eq:SolbLinFinSimple for  or , we can use Eq:SolbLinFinSimple for determining . In particular, we use:  
	
	V_in^(_1)V_in(_2) & = _t2 C_0 _s n_e(_s,T_e) (_2-_1),  
	V_in(_1)V_in^(_2) & = _t2 C_0 _s [n_e(_s,T_e) + 1] (_2-_1),  
	V_R0^(_1)V_R0(_2) & = _r2 C_0 _s n_e(_s,T_e) (_2-_1),  
	V_R0(_1)V_R0^(_2) & = _r2 C_0 _s [n_e(_s,T_e) + 1] (_2-_1),  
	F_b^(_1)F_b(_2) & = 2m _m n_m(_m,T_m) (_2-_1),  
	F_b(_1)F_b^(_2) & = 2m _m [n_m(_m,T_m) + 1] (_2-_1),   
	  
where  and  are the average thermal occupation numbers of the electrical and mechanical reservoirs at temperatures  and , respectively. In the following, we omit their argument, assuming that they refer to the frequencies  (electrical) and  (mechanical), and temperatures  (electrical) and  (mechanical) of the respective systems. The requirements on the reservoirs necessary to write the second moments of the noises as in Eqs. Eq:SecMomSimple are the following. First, the mechanical force  needs to vary on a timescale much faster than the membrane's decay time, which is fulfilled for . Second, we have neglected the difference between the electrical excitation number  at the central frequency and the mechanical sidebands. This means that the electrical resonance frequency has to be much bigger than the mechanical one (). Both these requirements are satisfied for the considered experimental parameters. 
Knowing the second moments of all noise operators, and neglecting the term proportional to , using Eq. Eq:SolbLinFinSimple we can find  to be   
where the first two terms  describe the usual time evolution of a free membrane influenced by its own thermal bath, and everything else is the dynamics induced from the electrical system.  
Eq. Eq:PhononNumbEvComplSimple represents an exact result in the limit in which the photonic () and phononic () reservoirs are Markovian. However, it can be better understood if we assume the mechanical damping  to be much smaller than the electrical one, . In particular, if we are probing the system on a time scale that is much longer than the electrical lifetime, i.e. , we can rewrite Eq. Eq:PhononNumbEvComplSimple as   
where we have defined the induced heating  to be  
Equation Eq:PhononNumbEvAppSimple has been compared with numerical simulations of the master equation of the Hamiltonian in Eq. Eq:HamLinFinalSimple, taking into account the electrical and mechanical reservoirs. Examples are given in Fig. .   
From the above expressions, we can determine the parameter  by finding the first order expansion of the function  in Eq. Eq:PhononNumbEvAppSimple with ,   
The form of  given in the main text assumes . Having determined both  and , it is possible to derive the general form of the parameter , including the contribution from the mechanical reservoir.  
``Double arm'' circuit 
In the following we derive the parameter  for the ``double arm'' circuit, introduced to take into account the coupling to the antisymmetric mode associated with the redistribution of charge on the membrane. This is depicted in Fig. . We include possible asymmetries in the fabrication process, the effect of which can be described by a residual linear coupling . The contribution to  from other kinds of asymmetries -- different parasitic resistances and inductances -- will only be investigated numerically, since the analytical results are too long and complicated in this case.   
Using the currents  and  and their associated charges  and , we can determine the Hamiltonian of the circuit in Fig.  to be    
where the magnetic fluxes  and  are defined below. In principle, there are other terms proportional to  and  in the Hamiltonian. These are responsible for sidebands at frequencies , that we have already encountered in section . For the same reasons explained there, these terms do not contribute neither to the electrical readout (homodyne measurement at frequency ) nor to the heating (), and we shall therefore ignore them in the following. A quantitative reason for neglecting these two--phonon processes, is the following. With Fermi Golden rule, we can determine the rate at which these processes happen to be  
that is orders of magnitude lower than  (the one--phonon processes induced by the linear coupling), as can be estimated later in section , where parameters for a proposed implementation are given. Notice that the rate in Eq. Eq:RateTwoPhon describes the two phonon processes relative to the term  in the Hamiltonian in Eq. Eq:HamQuantCompleteBal. The other two phonon process, , is even more suppressed, as the asymmetric field is not directly driven by the input . 
From Eq. Eq:HamQuantCompleteBal, it is possible to derive the equations of motion for the fields , , ,  and . The electrical decays are included using Kirchoff laws, resulting in:  
	
	_a  = & -2Q_aC_0-g_1C_0 _sQ_s(b+b^)-2 g_2C_0 _sQ_an_b-_l_a+2( V_R2-V_R1 ),  
	Q_a  = & _a2L,    
	_s  = & -Q_s2C_0-g_1C_0 _sQ_a(b+b^)-g_22C_0 _sQ_sn_b -(_t+_r)_s+2V_in+2V_R0 + V_R1+V_R2,    
	Q_s  = & 2_sL+2L_0,     
	b  = & -i _m b -ig_1 C_0 _sQ_aQ_s-ig_2 C_0 _s( Q_a^2+Q_s^24 )b -_b2 b+x_0F_b. 
	  
To enable a direct comparison with the  circuit presented in section  we have here used the same notation. This requires small differences in the definitions, to take into account the parasitic resistances and inductances:   
	
	_s^2 & = 1C_0(L+2L_0), 
	_a^2 & = 1C_0L, 
	_t & = 2Z_outL+2L_0, 
	_r & = R+2R_0L+2L_0, 
	_l & = RL.
	  
Moreover, the linear and quadratic couplings  and  come from the expansions of each one of the two capacitors  in the mechanical position , as suggested by the inset in Fig. . Following the same procedure used for the  circuit, we first study the measurement of , and later identify the conditions under which the measurement is effectively QND. 
Notice that, depending on the specific experimental setup, other circuit scheme may be better suited for describing the system. For instance, in the experiment of Ref.  the mechanical oscillator is not directly connected to the circuit, and different equivalent circuit would be required. Here, we restrict ourselves to the setup in Fig.  and defer other setup for later investigation .  
QND measurement of the phonon number, and comparison with the ``membrane in the middle'' setup  
Assuming that the mechanical state is unchanged during the whole measurement time , we can neglect all sources of heating in the system of equations Eq:EOMQBComp, and take  to be constant in time. Importantly, for the setup in Fig.  there are two mechanisms that shift the resonant frequency  and thus allow for the QND measurement. The first one we encountered before for the  circuit, and relates to the quadratic electromechanical coupling: . The second is more involved, and is the same one considered in the optomechanical setup of Ref. . It relies on an effective quadratic coupling proportional to , that arises once we substitute Eqs. Eq:EOMQBPhiAComplete and Eq:EOMQBQAComplete into Eqs. Eq:EOMQBPhisComplete and Eq:EOMQBQsComplete. To better understand this process, it is instructive to look at the final equation for  in the frequency domain:   
where we neglected off--resonant terms and assumed . As indicated explicitly in Eq. Eq:PhiCompleteEx, it is possible to see the frequency shifts induced by the linear  and quadratic  couplings. Whether the QND interaction is dominated by the quadratic coupling  or the effective quadratic interaction , depends on the resonance condition of the symmetric  and antisymmetric  modes in Fig. . To have a sizeable effect of the  term, we need to be near resonance with the antisymmetric mode . At the same time, for the QND detection we probe the system at the resonance frequency . Hence, the  term is dominant when we allow for a strong hybridization of the two electrical modes: . In such situation, by determining the heating rate for the electromechanical setup (see Sec. ), we can derive the condition for a feasible QND detection:  
This condition is similar to the one found in Ref.  for the experiment in Ref. , where strong heating was proven to forbid the QND detection. Compared to that work, however, we gain the factor , that comes from the asymmetry between the damping of the two electrical modes. Hence, our setup does have some gain compared to the  circuit, if the damping of the antisymmetric mode is small: . However, in this case the QND measurement still faces the challenge of a strong heating of the mechanical motion due to the large coupling between the electrical modes, and requires . 
In the following, we will investigate the opposite limit, where the antisymmetric mode  is far--off resonant from the symmetric one . In this case, the quadratic coupling  is dominant , and the heating induced to the mechanical mode will be strongly suppressed. If we neglect the effective quadratic coupling , we only need to consider Eqs. Eq:EOMQBPhisComplete and Eq:EOMQBQsComplete for determining the measurement signal. In the absence of heating, these are uncoupled from both the mechanics and the other electrical modes. We can then derive relations for  and  similar to Eqs. Eq:EOMSimpleQuad:  
	
	-i_k_s[_k] & = -Q_s[_k]2 C_0 - g_2_sL_02Q_s[_k] n_b-(_r+_t)_s[_k]+2 (V_in[_k]+V_R0[_k])+V_R1[_k]+V_R2[_k],   
	-i_kQ_s[_k] & = 2_s[_k]L+2L_0. 
	  
The reflected field  is   
where we have used the input/output relation . The coefficient  is the same as in Eq. Eq:VoutSimpleCoeff, except for a factor  coming from the fact that, here, we are considering the two halves of our capacitor. With the outcome of the homodyne detection being described by the same operator  defined in Eq. Eq:VmSimple, we can find the parameter  for the setup in Fig.  to be   
Notice that for deriving Eq. Eq:ParDsqCompl from Eq. Eq:VoutCompleteForm we assumed that the electrical reservoirs are in a thermal state with average photon number , and that the drive is a coherent state   at the frequency . Consistent with previous sections,  is chosen to be real and the phase of the homodyne measurement is fixed such that  in Eq. Eq:VmSimple.  
Membrane heating 
Given that , we set the quadratic coupling to zero in this subsection. We can then rewrite the Hamiltonian in Eq. Eq:HamQuantCompleteBal in the form    
Moreover, by looking at Eqs. Eq:EOMQBComp, it is possible to see that  and  are the only driven fields in the system (with ,  and  being in a thermal state). Therefore, we can neglect perturbations induced by the mechanical motion, and substitute them with their average values  and . This assumption will be verified in subsection , where we simulate the dynamics of the electromechanical system in the general case in which the parasitic elements may differ from each other. From the Hamiltonian Eq. Eq:HamQuantCompleteBalLinWithS we can determine the equations of motion for  and :  
	
	_s(t) = & -Q_s(t)2C_0 -(_t+_r)_s(t)+ 2V_in(t),    
	Q_s(t)= & 2_s(t)L+2L_0,  
	  
where . Similar to above, we are mainly interested in the case of constant incident fields or long pulses, such that we ignore transient behaviours. The steady state solution for the charge  is then given by   
Assuming that the strongly driven symmetric fields  and  are not perturbed by the mechanical dynamics, we can substitute Eq. Eq:AvgQsCompl into the Hamiltonian of Eq. Eq:HamQuantCompleteBalLinWithS, and obtain   
Differential equations for , , and the mechanical annihilation operator  can finally be derived:  
	
	_a = & -2Q_aC_0 + 2 i g_1_t+_r_t T C_0 _s( e^-i_st-e^i_st )(b+b^) -_l_a+2( V_R2-V_R1 ),  
	Q_a = & _a2L,    
	b  = & -i _m b - 2 g_1_t+_r_tT C_0 _s( e^-i_st-e^i_st )Q_a-_b2 b+ix_0F_b. 
	  
These equations describe the coupling of the mechanical mode to the antisymmetric electrical one. This coupling is enhanced by driving the symmetric mode with the coherent state , and is responsible for heating up the membrane, similarly to Ref. . Therefore, we need to assess to which degree this is deleterious for the QND measurement of . Equations Eq:EOMQBCompLin are nontrivial, and exact solutions are not accessible. However, under reasonable assumptions, we are able to find an approximate analytical solution that will be subsequently confirmed by our numerical approach. 
Our first step for dealing with the system Eq:EOMQBCompLin is to switch to the Fourier domain:  
	
	
	-i_k_a[_k]  = & -2Q_a[_k]C_0 + 2 i g_1_t+_r_t T C_0 _s(b[_k-_s]+b^[_k-_s] 
 & - b[_k+_s]-b^[_k+_s]) -_l_a[_k]+2( V_R2[_k]-V_R1[_k] ),
	  
	-i_kQ_a[_k]  = & _a[_k]2L,    
	
	-i_kb[_k]  = & -i _m b[_k] - 2 g_1_t+_r_tT C_0 _s( Q_a[_k-_s] -Q_a[_k+_s] )
 &-_b2 b[_k]+ix_0F_b[_k].
	
	  
We can employ equations Eq:EOMQBPhiACompLinFou and Eq:EOMQBQACompLinFou in order to obtain an expression for  that depends on the noises only   
where we have defined the effective decay  and frequency shift , resulting from the electrical influence on the mechanical motion:  
	
	
	_b(_k) &= Re-4i _tT _s(g_1_a _r+_t)^2( 1-_a^2+(_k-_s)(i _l+_k-_s)+1-_a^2+(_k+_s)(i _l+_k+_s) ) ,
	 
	
	_b(_k) &= Im-2i _tT _s(g_1_a _r+_t)^2( 1-_a^2+(_k-_s)(i _l+_k-_s)+1-_a^2+(_k+_s)(i _l+_k+_s) ) .	
	  
Note that, for deriving Eq. Eq:EOMQBMechLinFou, we neglected the off resonant terms , , and  (we verify this approximation numerically below in Fig. ). Moreover, the Fourier components of the noises are written in their most general form, meaning that  is now allowed to be negative, with the additional constraints , and .  
In order to have an analytical expression for , we assume that the damping  of the mechanical motion is much smaller than its own natural frequency . If , the set of frequencies contributing to  and  will be located around  and  respectively. This, in turn, implies that we can substitute the effective damping  and shift  with the values taken at the relevant frequencies . Defining the constant effective decay  and frequency shift , we can rewrite Eq. Eq:EOMQBMechLinFou in the following way :   
from which we can see that  affects the dynamics as an effective decay and  serves as a frequency shift. 
We can now take the Fourier series of Eq. Eq:EOMQBMechLinFouPar, in order to go back to the time domain, and solve formally for . 
Defining the noise operator  to be  
	
	
	N(t) & = _k=-^N[_k]e^-i_ktT,
	 
	
	N[_k] & = ( V_R2[_k-_s]-V_R1[_k-_s]-_a^2+( _k-_s )( i_l + _k-_s ) - V_R2[_k+_s]-V_R1[_k+_s]-_a^2+( _k+_s )( i_l + _k+_s ) ),
	
	  
we obtain   
From Eq. Eq:DotBCompl it is now possible to obtain the exact solution for  as a function of the quantum noises  and :   
where  is the annihilation operator at the initial time . From here one can verify that the mechanical creation and annihilation operators satisfy the standard commutation relation, .  
With the above results, we can finally determine  to be   
At this stage, the whole problem is reduced to computing the variances of the mechanical noise  and the electric fields . As a consequence of our assumption , we can neglect off--resonant contributions in  and write it as   
The determination of the other variance, , is more involved. In general, taking the definition of  in Eqs. Eq:NoiseCompl and substituting it into expression for the correlator, one encounters a number of products of the form   
where , and ,  are generic Fourier variables. The denominators  can be determined from Eq. Eq:CoeffNoiseOpCompl. Considering that  
	
	V_Ri[ _h ]V_Rj[ _m ] = & 0,  ij,  
	
	V_Ri[ _h ]V_Ri[ _m ] = & _h R2n_e(_h,T_e)(_h+_m)(-_h) 
 & +_h R2[n_e(_h,T_e)+1](_h+_m)(_h),
	
	  
with  being the occupation number of the electrical reservoir at the considered frequency  and temperature , we get   
We have here assumed both resistances  to be at the same temperature , and neglected fast--oscillating contributions to .  In Eq. Eq:VarianceElNoiseSame, we also denoted the Heaviside step function with the letter . 
With this last result, we are finally able to determine the time evolution for the average phonon number operator . In fact, using equations Eq:VarMechNoiseCompl and Eq:VarianceNoisesComp, it is possible to calculate the integrals in Eq. Eq:NbTimeEvCompl and therefore obtain a clear analytical expression for . In its most general form, the expression is rather involved. For simplicity, we restrict ourselves to a reasonable approximation that allows us to better understand the final result. Considering the limit , from Eqs. Eq:GammaB and Eq:OmegaShift with , we can rewrite the effective decay  and the frequency shift  to be  
	
	_b & = 8 g_1^2 ^2 _l_t_mT(_t+_r)^2_s_a^2,  
	_b & = -4 g_1^2^2_tT(_t+_r)^2_s.	
	  
From now on, referring to  and , we implicitly consider the form given in these last two equations. Note, however, that Eq. Eq:GammaB describes the damping due to the difference in sideband strengths for a mode at frequency  driven at frequency . In the limit where  is large, this induced damping is very small. The shift of Eq. Eq:OmegaShift may be sizeable, but merely leads to a new mechanical resonance frequency, which is not important for the present discussion. Furthermore, as a consequence of , we assume that  and  are approximatively equal in Eq. Eq:VarianceNoisesComp, such that   
Putting all these results together we can finally derive  to be   
As a conclusive part of this discussion, let us determine . Recalling that  is the change in the phonon number for the membrane initially cooled in its ground state, we get   
where we truncated the expansion at first order in . This is the parameter used as denominator in , presented in the main text neglecting the contribution from the mechanical reservoir. 
The parameter  derived above takes into account only the heating induced by the redistribution of charges on the capacitor. Asymmetries are well described analytically by considering a linear coupling  and capacitance  such that . These are the only asymmetries directly affecting the electromechanical coupling; other ones only enter as higher order perturbation, as we will see later in subsection . In this case we can find an overall residual linear coupling  of the membrane equal to   
Under the assumption that the parasitic elements  and  of the circuit are smaller than the non-parasitic ones  and , we can neglect the coupling to the antisymmetric mode to lowest order (this mode is far off resonant, while the symmetric one is resonant). The heating is then dominated by the residual linear coupling , similarly to the situation encountered above in subsection . We can thus use the result in Eq. Eq:PhononNumbEvAppSimple obtained for the  circuit to identify the contribution to the heating:   
Here,  has been defined from  in Eq. Eq:GammaBSimple by substituting  with :    
From Eq. Eq:HeatAsyCon we can determine ,   
being the denominator of the parameter  presented in the main text for . 
Putting together Eqs. Eq:NbTimeComplete and Eq:HeatAsyCon, we can find the time evolution of the average phonon number , taking into account all sources of heating:   
This result will be supported by our simulations, presented in subsection .  
Heating simulation  
In this subsection we present two methods for simulating the membrane heating, described by . For the ``double arm'' circuit in Fig.  we cannot employ the wave function Monte--Carlo approach  that was used for Fig. . Quantum jump simulations apply to Markovian reservoirs, and thereby assume that there is the same number of thermal photons for all frequencies. In our case, there is a big difference in the resonance frequencies of the symmetric  and antisymmetric  electrical modes. Therefore, we need to address the frequency dependence of the reservoir occupation. At a given temperature  of the electrical reservoirs, the antisymmetric mode will come to equilibrium with  photons at frequency . On the other hand, the coupling between the mechanical oscillator and the antisymmetric field is mediated by the driving, which is resonant with the symmetric mode. Hence, the membrane couples to a reservoir containing  photons, as indicated in Eq. Eq:NbTimeComplete. Therefore, more advanced methods are required for simulating the present situation.  
We will investigate the approximations taken for deriving Eq. Eq:PhononEvCompl on two different levels. First, we consider Eqs. Eq:EOMQBCompLinFou and solve them in the Fourier domain, keeping the off-resonant terms that have been ignored in the derivation of Eq. Eq:NbTimeComplete above. Second, we allow for any possible deviation from the balanced circuit in Fig. , by introducing unbalanced parasitic resistances  and , inductances  and , rest capacitances  and , and linear couplings  and . In the following, since we are interested in the time evolution of the mechanical subsystem for times longer than , we will explicitly consider a time variable  in the Fourier expansion of Eq. Eq:FourierDef 
Let us start our analysis by rewriting Eqs. Eq:EOMQBCompLinFou with the creation  and annihilation  operators for the electrical charge  and flux :  
	
	
	a[_k]( -i _k - i _a + _l2 ) =&  _l2a^[_k] -i g_1 _r+_t_t _aT _s( b[_k-_s] + b^[_k-_s] -b[_k+_s]- b^[_k+_s] ) 
 & +i C_0 _a( V_R2[_k]-V_R1[_k] ) + a(t=0) -  a(t=),
	 
	
	b[_k]( -i _k - i _m + _b2 ) = & -ig_1 _r+_t_t _aT _s( a[_k-_s] + a^[_k-_s] -a[_k+_s] - a^[_k+_s] ) 
 & +i x_0F_b[_k]	+ b(t=0) -  b(t=),
		
	  
where  and . Note that in Eqs. Eq:FourierComponentsSim we have ignored  contributions (), and added boundary terms, that are required to describe non--periodic dynamics in the Fourier series. Without those, we would obtain the steady state evolution, that cannot capture the thermalisation from the ground or any other state than the equilibrium. The additional terms can be adjusted to represent the desired initial state. 
In subsection  we truncated the Fourier series by keeping only the terms resonant with the mechanical frequency . Instead, we will now include additional terms at frequencies centred around ,   
where  can be any operator  or , and ,  are integers corresponding to the expansion. In Eq. Eq:TruncatedFourier, the parameter  indicates how many sidebands we consider, while  is related with the convergence of the Fourier series. By setting , we are assuming that the mechanical and electrical subsystems are completely decoupled, while  is the case studied above analytically. Corrections are given for . An example of the considered frequencies is illustrated in Fig.  for  and .    
The Fourier components  and  are then derived from the set of coupled linear equations Eq:FourierComponentsSim, that can be solved efficiently using the matrix notation. A comparison between the result of Eq. Eq:NbTimeComplete and the so--derived simulations is presented in Fig. . In the left plot we present  for different values of the linear coupling . Here,  is the time for which the average mechanical occupation is half the one of the steady state . In the right plot, it is possible to see the --dependence of the mechanical steady state population. As it is possible to see, the simulations converge to the analytical curve of Eq. Eq:NbTimeComplete independently from the parameter . This means that off-resonant terms do not play a major role, and that the approximations taken for deriving Eq. Eq:NbTimeComplete are appropriate. The small discrepancy between analytical and simulated results is dominated by a poor convergence of the Fourier series. By taking bigger , this discrepancy would be eventually removed.   
In the second part of this subsection we simulate the electromechanical system presented in Fig. , allowing all the parasitic elements to differ between the two arms. In particular, we introduce deviations for resistances , inductances , bare capacitances , and the linear couplings  in the left and right arms. Once we have done this, following the standard approach presented above we can derive the equations of motion of our electromechanical setup to be:  
	
	
	Q_a = & _a2 L+L^2 _a-2L L _s2L( L^2+2L L_0-L^2 ),
	 
	
	_a = & -2Q_aC_0-g_1C_0_sQ_s( b + b^ ) - 2 g_2C_0_sQ_a b^ b -_l_a + 2 ( V_R2-V_R1 ) - 2 C^2 Q_a C_0 ( C_0^2-C^2 ) + C Q_s  C_0^2-C^2 
 & - 2 g_1C_0 _sQ_a( b + b^ ) + L ( -R L + L R )L( L^2+2L L_0 - L^2 ) _a + 2R L -2 L RL^2 + 2L L_0 - L^2 _s,
		  
		
	Q_s = & 2_sL + 2 L_0 - L _a ( L^2+2L L_0-2L^2 ) + 2 L^2 _s (L + 2 L_0)( L^2+2L L_0-2L^2 ),
	 
	
	_s = & -Q_s2 C_0-g_1C_0_sQ_a( b + b^ ) - 2 g_2C_0_sQ_s b^ b -(_r+_t) _s +2 ( V_in + V_R0 ) + V_R1 + V_R2 
 & + C Q_a C_0^2-C^2 - C^2 Q_s 2C_0( C_0^2-C^2 ) -  g_12 C_0 _sQ_s( b + b^ ) + R L +2(R_0+Z_out) L -(L+2L_0)R 2( L^2+2L L_0 - L^2 ) _a 
& + L [ R (L+2L_0) -( R+2(R_0+Z_out)  ) L ]( L+2L_0 )( L^2 + 2L L_0 - L^2) _s,
		  
	
	b = & -i _m b-ig_1 C_0 _sQ_aQ_s - i g_2 C_0 _s( b + b^ )( Q_a^2 + Q_s^24 ) -_b2 b + i x_0 F_b + i g_1 C_0 _s ( Q_a^2 + Q_s^24 ).
		
	  
For simulating this set of equations we follow a similar approach to the one presented in subsection , neglecting off--resonant terms that do not contribute substantially to the mechanical heating, and the quadratic coupling (since ). In order to get a solution, we have linearised the symmetric and antisymmetric electrical fields, and the mechanical operators. As opposed to the previous investigations, now our simulations start at a specific time. We thus consider transient dynamics for the average mechanical operators, that we can set to have any initial value (generally zero, as for the ground state). Our simulations are thus performed with the mechanical average values being time dependent . As it is possible to see from Fig. , the agreement between the analytical results and the simulations is excellent, as far as the asymmetries ,  and  are small enough. The system is more susceptible to relative increase of  as compared to  and . This is because  and  are asymmetries of parasitic elements of the circuit, while  affects the main (and only) capacitor. A non--vanishing value of  directly affects the residual linear coupling  [see Eq. Eq:GeffPar] and thus has a larger influence, that is included in our analytical prediction of Eq. Eq:PhononEvCompl. Roughly speaking, whenever ,  and  are smaller than , the agreement between Eq. Eq:PhononEvCompl and the simulations is very good.   
In summary, we have tested the assumptions made in the derivation of our analytical results. We have proven with the Fourier analysis that off--resonant terms do not contribute significantly to the mechanical heating, while simulations of Eqs. Eq:EOMunbalanced ensured that asymmetries play a secondary role in the electromechanical dynamics.   
As a final comment, we note that the derivation of the parameter  including asymmetries can be done analytically with the procedure introduced in subsections  and . We do not report the result here since including ,  and  makes the expressions long and complicated. In principle, however, the parameter  for the most general antisymmetric setup can be derived analytically, with the simple expressions for  and  (given in the main text) being valid for small asymmetries.  
Measurement 
The parameter  specifies how suitable a specific experimental setup is for carrying out the QND detection. The outcome of an experimental run will, however, depend on the procedure used in the experiment. In this subsection, we consider the protocol presented in the main text and illustrated in Fig. . We assume that the mechanical oscillator is prepared and continuously cooled to some average phonon number  during the entire measurement sequence. We determine the best experimental parameter  to be used to maximize the visibility  for a given value of . Finally, we compare the analytical model with numerical simulations.   
First, we develop a model for the protocol presented in Fig. , where we only allow for a single jump during the measurement time . After the state preparation, the membrane is in a mixture of the Fock states , where  is the probability to be in the --th state. When we start probing the system, the measurement outcome  follows a probability distribution that depends on three parameters: , , and .  determines the initial thermal state of the membrane, and fixes the probabilities .  determines the rate at which the membrane jumps out the ground state, and can be used to calculate the probability, for each Fock state in , to jump up or down. In particular, the ground state  has a probability  to jump up, while any other Fock state  has probabilities  and  to jump up or down, respectively. Finally,  sets the distance between measurement outcomes with different phonon occupations. Therefore, whenever the membrane remains in the same state during the whole duration , the outcome  is a Gaussian distributed random number with average  and variance . If, on the other side, the mechanical state changes during the measurement, then  is again a Gaussian distributed random number with variance , but with an average value given by . Here,  is the (uniformly distributed) random time at which the jump happens, and  and  are the phonon numbers before and after the jump. Therefore, knowing ,  and , the probability distribution function  of the outcomes  can be determined:  
where, we recall, , and  is a scaling factor. In this last equation,  is the probability for the mechanical state to remain in  for the whole measurement, while  is the likelihood that either  jumps up or  jumps down. The parameter  is the size of the Hilbert space of the mechanical subsystem. Since we are interested in the peaks relative to  and , we can assume  and thus rewrite Eq:PDFvM in the following form:    
where  denotes the error function. From Eq. Eq:PDFvMa, we can derive an analytical expression for the visibility that depends on the mentioned parameters: . Importantly,  is a dummy parameter, since . It follows that, for given  and , we can maximise  by tuning . Using this model, we obtain the analytical  expression for the optimal  in the limit of , presented in Eq. (5) of the main text. Note that tuning  can be done by adjusting the probe power and choosing an appropriate measurement time .  
To investigate the validity of the single jump approximation used above, we simulate the probability distribution function for the outcome  in a Monte--Carlo simulation. The results are presented in Fig. . In the simulation, we allow multiple jumps to happen by dividing the measurement time  into smaller segments, during which the mechanics is allowed to change. Similar to above, the outcome of the measurement can then be sampled from a Gaussian distribution of variance  and a mean determined by the average phonon number during the measurement. The hardly visible deviation between the analytical prediction and numerics in Fig.  comes from the single jump restriction, and can be eliminated by including the two--jumps events in the model. Note that, since the optimal  decreases for higher values of , the single jump approximation becomes more and more accurate with increasing .    
Secondly, for given  and , we can compare the analytical with the numerical maximum visibility . The latter is determined using repeated Monte--Carlo simulations with different values for , as shown in Fig. . Each point in such plot corresponds to a single simulation with given parameters ,  and . The error bars are derived assuming Poissonian statistics in each bin of the histogram collecting the outcomes . A polynomial fit is then used for determining the maximum visibility , that is compared with the analytical prediction in Fig. 3 of the main text (2D plot; analytical corresponds to the red dotted line, numerical results are represented by blue circles).    
As a final remark, it is important to say that the results of this section can easily be adapted to other experimental schemes . For instance, it is possible to first cool down the mechanical motion to the ground state, and then let it thermalize while measuring several times. An advantage of this approach is that it reduces the probability of jumping down from the excited Fock states, since the cooling is absent. On the other hand, operating the experiment in a pulsed regime may add an extra degree of complexity, e.g., transient effects associated with the change in equilibrium position of the membrane when the fields are turned on.    
Realistic experimental parameters 
Here we study in more detail a possible experimental setup for our proposal, and the potential challenges that may arise pursuing the QND measurement of the phonon number. First, we present a simple derivation for determining the linear and quadratic electromechanical couplings  and  . Then, we discuss the presence of a stray capacitance , the main effect of which is to reduce these couplings. Finally, we analyse the feasibility of an experiment, considering aspects such as the intracavity photon number, the mechanical quality factor, the measurement time, and probe power. The parameters employed are the same as introduced in the main text:  GHz,  MHz,  kHz, , ,  and . The membrane is assumed to be  m long and  m wide, with a quality factor  . We discuss the average occupation  of the mechanical bath in the following. 
The mechanical membrane is fixed along all its boundaries, such as in Fig. 1(a) of the main text. A basis of modes describing its motion is thus , where  
Here,  and  are the length and width of the membrane, respectively. The mode of interest has indices  and , and the constant  fixes an effective gauge for the mass. By setting , we choose the gauge in which the so--called effective mass is the physical mass, and . Recalling that 
	
	g_1 = & x_0_sC_0 C_x=0, 
	g_2 = & x_0^2_s2C_0 ^2 C^2_x=0	,
	 
the couplings can be determined once the derivatives are found. As discussed in Ref. ,  describes the amplitude of the considered mode, and can be viewed as a canonical position. An approximate value of the derivatives in Eq. Eq:Couplings is then   
where  is the distance separating the two capacitor's plates, and the integral is taken over half the membrane, for the reasons discussed in section . Using Eqs. Eq:Couplings and Eq:CouplingDerivative, we can finally determine the values of  and  to be 
	
	g_1 = & 8^2 x_0_sd , 
	g_2 = & x_0^2_sd^2 .
	 
For the parameters introduced in the main text, we find  kHz and  Hz. Considering that we assumed an electrical damping  kHz, it could seem that we reach the strong coupling regime . However, we have so far ignored stray capacitances, that are the main reason for which the strong coupling regime (and thus the phonon QND measurement) has never been accomplished in electromechanics. 
For such small geometries, the stray capacitance  always exceed the intrinsic capacitance  by up to several orders of magnitude , and severely limits the attainable values of the linear and quadratic couplings [see Fig. (b)]. Looking at Eqs. Eq:Couplings, and considering that the stray capacitance does not affect the derivatives , we replace the coupling constants by 
	
	g_1 & C_0C_0+C_s g_1 , 
	g_2 & C_0C_0+C_s g_2	.
	 
For , we find  kHz and  Hz. This value of  is optimistic for geometries similar to the ones in Ref. , where graphene sheets are laid on a substrate in such a way that the contact area between the two interfaces is very large. However, for a setup like the one described in Ref. , membranes of similar dimensions as the ones conjectured here are assembled onto small localized gates, dramatically reducing the stray capacitance. With this fabrication technique, a stray capacitance of  F is obtained, for a membrane that is about two and a half times the size of the one conjectured here. In our case, this value for the stray capacitance would correspond to  times , where  F. Due to the smaller size of our membrane, we assume a reduction in the stray capacitance, such that we consider .  
In our settings, reaching the strong coupling would require . In this regime, phonon QND detection could also be performed with the strategy proposed in . With a large stray capacitance, however, we cannot accomplish such requirement, and investigate different approaches to QND detection. With the experimental parameter described above, we find  and , regardless of the value of . The highest quoted value  is found assuming  and . 
In the remainder of this section, we study the conditions under which the QND detection could be implemented, focusing on the incident power and the measurement time. First, we recall that the membrane's heating has several contributions. Two of them, denoted   and , are the ones identified in Eqs. Eq:DeltaNbCompl (rhs, second term) and Eq:HeatingPar, respectively. They describe the feedback of the electrical system on the mechanical motion, and are the denominators of the parameters  and  defined in the main text. The third contribution comes from the mechanical reservoir. Indicated with , this is given in Eq. Eq:DeltaNbCompl (rhs, first term), and is independent of the strength of the probing field. For determining the parameter , we have so far ignored , assuming that the measurement is fast enough. This is an excellent approximation, as far as . Below, we discuss the case in which there is a seizable contribution from the mechanical bath, and describe its effect on the QND detection of the phonon number.    
Above we have seen that, for the considered experimental parameters, , for which we find the optimal . For , the total number of photons that we need to send within the measurement is  [see Eqs. Eq:DeltaNbCompl and Eq:HeatingPar]. By sending these photons within a sufficiently short time, we can neglect the influence of the mechanical reservoir. To derive precise conditions for this, we define the effective temperature  of the electrically induced reservoir:  
This last equation is derived from Eq. Eq:PhononEvCompl, by sending the time  to infinity, and recalling the definitions of  and .  is the average phonon number at which the membrane stabilizes in the absence of the mechanical reservoir. The condition , under which the mechanical bath can be neglected, can be rewritten as . The measurement time  is thus a knob that allows us to adjust the relative weights of the mechanical reservoir and the electrical feedback on the membrane. For short measurement times,  is increased, and this condition is easier to satisfy. As an example, if we choose  ms and , we get , implying that the average occupation of the membrane's reservoir needs to be less than unity to neglect the mechanical reservoir. For our setup, this requires the temperature of the cryostat to be lower than  mK, a challenging task for current technology. On the other side, choosing  ms fixes , and the temperature for which  becomes negligible is  mK, that has been already achieved in experiments involving graphene resonators . 
Once the measurement time is chosen, and assuming the photon flux  to be constant, one can determine the probing power  and the average intracavity photon number . As an example, with  ms,  becomes  nW and . These parameters are highly dependent on the mechanical quality factor , and the stray capacitance, as investigated below in Fig.(a).  
Finally, we discuss the case in which the electrical heating is in equilibrium with the heating and damping of the mechanical reservoir. In that case, we need to renormalize  by the total heating:  
where  contains both the terms  and .  
Importantly, we can always make  by increasing the driving strength and reducing the measurement time (thus decreasing ). The parameter  substitutes  in the description of the system. The mechanical bath thus reduces the quality of the phonon QND measurement, but the analysis above still applies, with  instead of . As an example, assume that the temperature is  mK . Then, the average occupation of the membrane's reservoir is . We choose  such that the electrical heating is equal to the mechanical: . Then  with the previous parameters. This value is well in the regime of good visibility , and for this , the optimal value of the total heating is . Depending on the value of the mechanical quality factor  and stray capacitance , we can then determine the required incident power and the intracavity photon number, as shown in Fig. . Since we assume , the measurement time is . For the parameters in the figure and a quality factor  varying between  and , we find  s.
                
From Kardar-Parisi-Zhang scaling to explosive desynchronization in
arrays of limit-cycle oscillators  
Roland Lauter  
Institut f�r Theoretische Physik II, Friedrich-Alexander-Universit�t
Erlangen-N�rnberg, Staudtstr. 7, 91058 Erlangen, Germany  
Max Planck Institute for the Science of Light, G�nther-Scharowsky-Stra�e
1/Bau 24, 91058 Erlangen, Germany  
Aditi Mitra  
Department of Physics, New York University, 4 Washington Place, New
York, NY 10003, USA  
Florian Marquardt  
Institut f�r Theoretische Physik II, Friedrich-Alexander-Universit�t
Erlangen-N�rnberg, Staudtstr. 7, 91058 Erlangen, Germany  
Max Planck Institute for the Science of Light, G�nther-Scharowsky-Stra�e
1/Bau 24, 91058 Erlangen, Germany 
We study the synchronization physics of 1D and 2D oscillator lattices
subject to noise and predict a dynamical transition that leads to
a sudden drastic increase of phase diffusion. Our analysis is based
on the widely applicable Kuramoto-Sakaguchi model, with local couplings
between oscillators. For smooth phase fields, the time evolution can
initially be described by a surface growth model, the Kardar-Parisi-Zhang
(KPZ) theory. We delineate the regime in which one can indeed observe
the universal KPZ scaling in 1D lattices. For larger couplings, both
in 1D and 2D, we observe a stochastic dynamical instability that is
linked to an apparent finite-time singularity in a related KPZ lattice
model. This has direct consequences for the frequency stability of
coupled oscillator lattices, and it precludes the observation of non-Gaussian
KPZ-scaling in 2D lattices.  
Networks and lattices of coupled limit-cycle oscillators do not only
represent a paradigmatic system in nonlinear dynamics, but are also
highly relevant for potential applications. This significance derives
from the fact that the coupling can serve to counteract the effects
of the noise that is unavoidable in real physical systems. Synchronization
between oscillators can drastically suppress the diffusion of the
oscillation phases, improving the overall frequency stability. Experimental
implementations of coupled oscillators include laser arrays 
and coupled electromagnetic circuits, e.g. ,
as well as the modern recent example of coupled electromechanical
and optomechanical oscillators .
In this work, we will be dealing with the experimentally most relevant
case of locally coupled 1D and 2D lattices. 
Naive arguments indicate that the diffusion rate of the collective
phase in a coupled lattice of  synchronized oscillators is suppressed
as , which leads to the improvement of frequency stability mentioned
above. However, it is far from guaranteed that this ideal limit is
reached in practice .
The nonequilibrium nonlinear stochastic dynamics of the underlying
lattice field theory is sufficiently complex that a more detailed
analysis is called for. In this context, it has been conjectured earlier
that there is a fruitful connection 
between the synchronization dynamics of a noisy oscillator lattice
and the Kardar-Parisi-Zhang (KPZ) theory of stochastic surface growth
.  
We have been able to confirm that this is indeed true in a limited
regime, particularly for 1D lattices. However, the most important
prediction of our analysis consists in the observation that a certain
dynamical instability can take the lattice system out of this regime
in the course of the time evolution. As we will show, this instability
is related to an apparent finite-time singularity in the evolution
of the related KPZ lattice model. It has a significant impact on the
phase dynamics, increasing the phase spread by several orders of magnitude.
As such, this phenomenon represents an important general feature of
the dynamics of coupled oscillator lattices. 
Before we turn to a definition of the model, it is helpful to briefly
outline the wider context of this study. We will be dealing with phase-only
models, which can often be used to describe systems of coupled limit-cycle
oscillators effectively (see also Fig. ),
whenever the amplitude degree of freedom is irrelevant. The most prominent
examples are the Kuramoto model and extensions thereof .
These deterministic models are studied intensely for their synchronization
properties , mainly for globally
coupled systems with disorder, as well as for pattern formation (for
locally coupled systems) . In
the latter case, interesting effects show up even in the absence of
disorder .     
Adding noise to these models can significantly influence the synchronization
properties ; see 
for an example in globally coupled systems. In locally coupled systems,
the delicate interplay between the nonlinear coupling, the noise,
and the spatial patterns can lead to even more complex dynamics. In
contrast to the related XY model ,
which is used to describe systems in thermodynamic equilibrium, driven
nonlinear oscillator lattices are usually far from equilibrium. This
is reflected in an additional, ``non-variational'' coupling term
.
As long as the phase field is smooth, one can employ a continuum description
of the oscillator lattice .
This is important to make the connection to the theory of surface
growth. The continuum description also links our research to recent
developments in the study of (non-equilibrium) driven dissipative
condensates ,
where the connection to the physics of surface growth was employed
.
In contrast to our work, these works focus on continuum systems, where
the essential new dynamical phenomenon identified would be absent. 
We start our analysis by briefly motivating the model that we will
use. Consider a large number of self-sustained nonlinear oscillators
moving on their respective limit cycles. When they are coupled, they
influence each other's amplitude and phase dynamics. Provided that
the amplitudes do not deviate much from the limit cycle, effective
models can be derived, which describe the phase dynamics only ,
see also Fig. a. The transition from the microscopic
model to the phase model depends on the physical system, with recent
examples including electromechanical 
and optomechanical 
oscillators. In real physical systems, there will be noise acting
on the oscillators. This can be modeled by a Langevin noise term in
the right hand side of the effective phase equation.  
We will be interested in understanding the competition between noise
and coupling in the context of synchronization dynamics. To bring
out fully this competition, we focus on the ideal case of a non-disordered
lattice, with uniform natural frequencies. In that case, the derivation
of an effective model leads to the noisy Kuramoto-Sakaguchi model
 for
the oscillator phases :  
_j= & S_k,j(_k-_j)+C_k,j(_k-_j)+_j, 
where  is a Gaussian white noise term with correlator
,
and  and  are the coupling parameters. The sums run over nearest
neighbors. We will often call this model the ``phase model'', for
brevity. In this article, we focus on the time evolution of the phase
field from a homogeneous initial state. Hence, we set 
on all sites. As an illustrative example, we show the (smoothed) snapshots
of the phase field from a simulation of Eq. ()
in Fig. b. In this figure, the color (and
the mesh geometry) encode the phase value at lattice site 
for three different points in time. 
At this point it should be noted that a lattice of coupled self-sustained
oscillators actually gives rise to an additional term in the effective
phase equation. This term couples the phases of three adjacent sites.
This was derived in ,
and the resulting dynamics of that extended model (without noise)
has been explored by us in a previous work .
However, the additional term is irrelevant for long-wavelength dynamics
and moreover can be tuned experimentally. Therefore, in the present
article we focus entirely on the important limiting case of the Kuramoto-Sakaguchi
model, Eq. (). 
How does the interplay of noise and coupling affect the frequency
stability of the oscillators? This is a central question for synchronization
and metrology. It can be discussed in terms of the average
frequencies, defined as .
Here the  are the phases accumulated during
the full time evolution (see also ).
As the definition of  shows, they have an important physical
meaning in the present setting, essentially indicating the number
of cycles that have elapsed. This is in contrast to other physical
scenarios that also involve phase models like the one shown here.
For example, in studies of superfluids, the phase is defined only
up to multiples of . Then, the total number of phase windings
during the time evolution does not have any direct physical significance.
This distinction is important when trying to make the connections
we are going to point out below. 
Important insights can be obtained from studying the evolving spread
of the average frequencies. This turns out to be directly related
to the spread of the phase field, , 
w_^2(t)= & 1N_j=1^N[_j(t)-(t)]^2 
= & t^21N_j=1^N[_j(t)-(t)]^2, 
where  is the
mean (spatially averaged) phase and 
is the mean average frequency of a lattice with  sites. The angular
brackets denote an ensemble average over different realizations of
the noise. 
For the simple case of uncoupled identical oscillators subject to
noise, the phase spread grows diffusively, .
Hence, the spread of time-averaged frequencies decreases as .
This reflects the fact that the averaged frequencies are identical
in the long-time limit because there is no disorder. In this sense,
the oscillators are always synchronized. However, if coupling is included,
we will find different exponents in the time-dependency of the phase
field spread. For example, a smaller exponent means that the tendency
towards synchronization is stronger. Hence, we will see that the coupling
between the oscillators can either enhance or hinder the synchronization
process, depending on the parameter regime. We expect that this translates
to systems with small disorder in the natural frequencies. 
Much of our discussion of the initial stages of evolution will hinge
on the approximations that become possible when the phases on neighboring
sites are close. Then the phase model, Eq. (),
is well approximated by a second-order expansion in the phase differences
. This expansion can be recast
in dimensionless form using a  parameter .
In a one-dimensional array, for example, the resulting model reads 
h_j= & (h_j+1+h_j-1-2h_j) 
 & +14[(h_j+1-h_j)^2+(h_j-1-h_j)^2]+g_1d_j, 
where we have rescaled both the time, , and the phase field,
. The noise correlator is .
The generalization to two dimensions is straightforward.  
Eq. () can be readily identified as a lattice version
of the Kardar-Parisi-Zhang (KPZ) model ,
a universal model for surface growth and other phenomena. This nonlinear
stochastic continuum field theory describes the evolution of a height
field ,  
h= & h+2(h)^2+, 
with white noise , where .
The diffusive term tries to smooth the surface, while both the noise
and the nonlinear gradient term tend to induce a roughening. 
The relation of the KPZ model to coupled oscillator lattices has been
pointed out before . However,
up to now it has remained unclear how far this formal connection is
really able to predict universal features of the synchronization dynamics.
In the present article, we will indeed observe transient behavior
where universal KPZ dynamics is applicable, but we will also find
that this is invariably followed by phenomena that lead into completely
different dynamical regimes. All the numerical results discussed in
this article will refer either to the full phase model, Eq. (),
or to its approximate version, the ``lattice KPZ model'' Eq. ().
From the comparison of these models, we will be able to extract valuable
predictions for the synchronization dynamics. 
It is straightforward to make the connection between Eq. ()
and a one-dimensional lattice version of the KPZ model more precise.
Starting from Eq. (), and given a lattice constant
, we have to rescale time, , and height, ,
and choose a particular discretization of the derivatives. Note that
in the continuum model in one dimension, it would even be possible
to get rid of all parameters by rescaling time, height and space.
In contrast, for the lattice model, we are left with the one dimensionless
parameter  .
This coupling constant will become important in the following. 
We had derived our lattice model, Eq. (), as an approximation
to the phase model, Eq. (), with
its trigonometric coupling terms that are periodic in the phase variables.
Hence, for the evaluation of the equation of motion, the configuration
space of each phase variable may be restricted to the compact interval
. In view of the foregoing discussion, one may then see
the phase (Kuramoto-Sakaguchi) model as a ``compact KPZ model''.
This designation has indeed been proposed in a recent article 
(see also ). 
The rescaling of time and phase introduced above, for the approximate
lattice model of Eq. (), can also be employed in the
full phase model, Eq. (). Crucially,
this leads to one more dimensionless parameter, . For example,
the sine term will be converted to .
This establishes that for given differences  the approximation,
Eq. (), becomes better for smaller . For this
reason, we will focus on small values , where substantial
findings can be expected from the connection of the phase model to
KPZ dynamics.    
   
First insights can be gained by direct numerical simulations of the
phase model. For one-dimensional arrays, the outcome of a single simulation
is displayed in Fig. a. The typical
time evolution of the phase spread  is shown in Fig. b.
We can distinguish two parameter regimes from the long time evolution.
In one regime, we see that after initial transients, the phase spread
evolves according to  (see magenta curves).
Hence, the synchronization is enhanced as compared to the case of
uncoupled oscillators (where  as discussed
above).  
The power-law growth of the phase field spread with exponent 
can be identified as universal KPZ behavior, as we will explain in
the following. Luckily, in the context of KPZ dynamics, the best-studied
quantity is the mean surface width , which directly relates to
the phase spread  introduced above: 
w^2(L,t)= & 1L^dd^dr(h(r,t)-h(t))^2, 
with the average surface height 
in a system of linear size . The surface width has been found
to obey a scaling law  .
In particular, for  (in appropriately rescaled units),
we have  with .  
In one dimension, the scaling exponent can be calculated analytically
and is  . This means that the surface
will become rougher with time, but less rapidly than for independent
diffusive growth at individual sites. It is this exponent that is
also observed in the evolution of the phase model, Fig. .
Hence, we conclude that 1D arrays of limit-cycle oscillators, as described
by the noisy Kuramoto-Sakaguchi phase model, indeed show KPZ scaling
in certain parameter regimes. 
Far more surprising is the other dynamical regime (red and green curves).
In that regime, one observes diffusive growth, 
for long times, which may seem unremarkable except for clearly deviating
from any KPZ predictions. However, at this point, it is worthwile
to emphasize that we are displaying curves averaged over many simulations.
If instead we look at single simulation trajectories, we see an explosive
growth of  at some random intermediate time (gray
lines). At these random times, the phase field suddenly grows its
variance by several orders of magnitude. This corresponds to an explosive
desynchronization of the oscillators. 
To understand this important dynamical feature better, we now briefly
turn away from the full phase model and study the evolution of the
lattice KPZ model, Eq. (). This serves as an approximate
description at small phase differences, so we can expect to learn
something about the onset of the growth, but not about the long-time
regime which involves large phase differences. As an example, we show
the result of a simulation of Eq. () in Fig. a,
where we plot the field  for several points in time.
Clearly, even this simpler model already displays some kind of instability,
which now leads to an apparent (numerical) finite-time singularity.
It is worthwile to note that such divergences had been identified
before in numerical attempts to solve the KPZ dynamics by discretizing
it on a lattice 
(see also ).
In those simulations, this behavior was considered to be a numerical
artifact depending on the details of the discretization. In contrast,
in view of our phase model, the onset of the instabilities is a physical
phenomenon which merits closer inspection. 
The points in time, for which the snapshots are shown in Fig. a,
approach the time of the singularity logarithmically. In addition
to the normal roughening process, which we expect from the continuum
theory, we see the rapid growth of single peaks. Those can send out
shocks of large height differences, which then propagate through the
system, as can be seen in the center of Fig. a.
The collision of such shocks can produce larger peaks. We commonly
observe that eventually very large shocks grow during propagation,
which leads to the singularity in the numerical evolution (marked
with a red star in the figure). In the inset, we show how the maximum
phase difference between nearest neighbors, ,
increases drastically just before the divergence. We also indicate
the points in time for which we plotted the height field. The details
of the instability development depend on the lattice size and the
coupling parameter.     
   
The occurrence of an instability is a random event. In Fig. b,
we plot the probability of observing an instability during the evolution
up to a time , as a function of the coupling .
In principle, instabilities can occur at all coupling strengths, but
we find that for the lattice size employed here (1000 sites) they
become much less likely (happen much later) for .
To extrapolate to larger lattices, we may adopt the assumption that
the stochastic seeds for these instabilities are planted independently
in different parts of the system. In that case, the probability to
encounter a divergence within a small time interval will just scale
linearly in system size, and the present results for  are
therefore sufficient to predict the behavior at any .  
As mentioned above, the instabilities in lattice KPZ models are considered
unphysical in the surface growth context, because they do not show
up in the continuum model, at least in one dimension .
On the contrary, our phase model, describing synchronization in discrete
oscillator lattices, is a genuine lattice model from the start. Hence,
the onset of instabilities has to be taken seriously. In the full
phase model, Eq. (), the incipient
divergences are eventually cured by the periodicity of the coupling
functions. Instead of resulting in a finite-time singularity, they
will lead the system away from KPZ-like behavior and make it enter
a new dynamical regime.  
To find out for which parameters this happens, we have determined
numerically the probability of encountering large growth of nearest-neighbor
phase differences. We find that we can distinguish between a ``stable''
regime, where no large phase differences () show up in most
simulations, and an ``unstable'' regime, where large differences
occur with a high probability. For small , we indeed
get quantitative agreement with the results discussed above for the
lattice KPZ model, Fig. b.  
In a single simulation in the unstable regime of the phase model,
we typically observe a time evolution such as the one depicted in
Fig. . Initially, the phase
field develops as in the corresponding KPZ lattice model. Then, a
KPZ-like instability induces large phase differences. As mentioned
above, this does not lead to a divergence. Instead, we find that huge
triangular structures develop rapidly. Afterwards, these structures
get diffused on a much longer time scale. The time evolution is reflected
in the phase spread, as shown previously in Fig. b
(gray lines): The development of triangular structures leads to an
explosive growth, whereas the subsequent diffusion leads to the asymptotic
scaling .  
The peculiar time evolution after the onset of the instability can
be explained by considering the deterministic phase model. For the
parameter value  employed here, this model is (at least for
some time) turbulent for initial states with large phase differences.
In the simulations of the full model, the stochastic dynamics induces
an instability initially, which brings the phase field from a KPZ-like
state to a turbulent state locally. After this, the dynamics can be
understood deterministically. Because of the large phase differences
in the turbulent region, this part of the lattice will have a very
different phase velocity from the KPZ-like region (on average). At
the same time, the turbulent region, which is the shaded region in
the plots of Fig. , grows in
space. These two processes lead to a triangular phase field shape
covering the whole lattice. Additionally, the turbulent dynamics produces
very large phase differences, including wrap-arounds by . This
induces a diffusive growth of the phase field width 
with a large diffusion coefficient. This can be seen in the red curve
of Fig. b. The behavior of this curve
after the rapid increase can be fitted well with 
(blue dotted line). We checked that the diffusion coefficient 
from this fit can also be found in simulations of the deterministic
model with random initial conditions. The numerical value of 
is much larger than the noise strength . 
Hence, we conclude that in the unstable regime of the one-dimensional
phase model, the onset of KPZ-like instabilities induces an explosive
desynchronization of the oscillators. This is followed by diffusive
growth of . Note that there remains the large phase
field spread resulting from the desynchronization, and the large long-time
diffusion coefficient , which stems from the deterministic turbulent
dynamics. All of this is relevant for small values of the parameter
.    
The physics of surface growth depends crucially on the dimensionality.
Correspondingly, we ask how the synchronization dynamics in oscillator
lattices changes when we proceed to 2D lattices, which can be implemented
in experiments and which are expected to be favorable towards synchronization.  
By using the same rescaling as above, the lattice KPZ model can be
written in dimensionless units with a single parameter .
Interestingly, an appropriately rescaled form of the continuum
KPZ model in 2D also contains this single parameter. That is in contrast
to the 1D case, where the rescaled continuum model did not depend
on any parameter. As a consequence, there are now different time regimes
in the growth of the surface width . In
particular, KPZ power-law scaling  sets in beyond
a time scale  that becomes exponentially large at small couplings,
. This has to be taken into
account in numerical attempts to observe the scaling regime, as in
. In finite
systems, the surface width saturates eventually, for times .  
The lattice version of the 2D KPZ model, as obtained by extending
Eq. () to two dimensions, also develops instabilities.
Like in 1D, we study the probability of encountering such instabilities,
see Fig. c. We find qualitatively
the same behavior as in 1D: The likelihood of an instability during
a time  increases rapidly with larger . 
There is, however, a crucial difference with respect to the 1D situation:
we find that the instabilities occur much earlier than the (exponentially
late) onset of KPZ power-law scaling. This is illustrated in the inset
of Fig. c, where the hatched
region is the KPZ scaling regime expected from the continuum theory
for infinite systems. In addition, at smaller couplings, the surface
width would saturate long before the projected onset of KPZ scaling
for any reasonable lattice sizes. As an example, the dotted line in
the inset of Fig. c shows
the saturation time for a lattice of size . Overall, we
predict that in 2D the power-law KPZ scaling regime will be irrelevant
for the synchronization dynamics of oscillator lattices. 
These predictions are borne out in simulations of the full phase model,
Eq. (), in 2D (Fig. a
and b). Like in one dimension, we focus on small parameter values
of . As long as the phase differences remain small, which is
the case for small , the
behavior is analogous to the lattice KPZ model, see Fig. a.
As explained above, the exponentially large times of the KPZ power-law
regime cannot be reached before instabilities set in. Instead, the
evolution shows the behavior of the linearized KPZ equation, the so-called
Edwards-Wilkinson model . This produces
a slow logarithmic growth of the surface width .
In this linear model, we can also straightforwardly take into account
the effects of the lattice discretization and the finite size of the
lattice. The resulting analytical prediction is shown as the dashed
line in Fig. a, with a good
initial fit and some deviations only at later times (see also the
appendix). 
In simulations of the phase model with a larger parameter ,
we see initially the same behavior, but followed by a rapid increase
of the phase field spread with time (see Fig. b,
red curve). This can be explained by the explosive growth in single
simulations (gray lines), similar to the behavior in one dimension.
For different parameters, where the instabilities occur earlier, we
see that the phase spread approaches a diffusive square-root growth
for long times (not shown here). 
Overall, we see that there is a parameter regime where lattice KPZ-like
instabilities are not relevant in 2D arrays. Then, the phase field
spreads very slowly (logarithmically) with time. According to Eq. (),
this means that the oscillators tend to synchronize quickly. However,
if instabilities show up, which is the case for larger ,
we find the same explosive desynchronization as in 1D.    
   
In conclusion, we have studied the phase dynamics of one- and two-dimensional
arrays of identical limit-cycle oscillators, described by the noisy
Kuramoto-Sakaguchi model with local coupling. We have shown that,
depending on parameters, the coupling can either enhance or hinder
the synchronization when starting from homogeneous initial conditions.
In 1D, for sufficiently small noise and at short times, one can observe
roughening of the phase field as in the Kardar-Parisi-Zhang model
of surface growth, with the corresponding universal power-law scaling.
At larger noise, or for larger times, explosive desynchronization
sets in, triggering a transition into a different dynamical regime.
We have traced back this behavior to an apparent finite-time singularity
of the approximate (KPZ-like) lattice model. This is especially relevant
for two dimensions, where it will occur before the long-term KPZ scaling
can be observed, although the initial slow logarithmic growth still
makes 2D arrays more favorable for synchronization. 
With these results, we have also made more precise the connection
between phase-only models of limit-cycle oscillators and the KPZ model,
which was only established formally before .
In particular, we have shown that the lattice nature of the phase
model, Eq. (), is important, especially
for large values of the coupling parameter .
The reason is that for small phase differences, we are led to a particular
lattice KPZ model, Eq. (), which, however, contains
instabilities. These will destroy any resemblance between the phase
dynamics and surface growth physics.  
Our predictions will be relevant for all studies of synchronization
in locally coupled oscillator lattices, when the phase-only description
is applicable. This can be the case in optomechanical arrays (e.g. in
extensions of the work presented in ).
They may also become important for the study of driven-dissipative
condensates, described by the stochastic complex Ginzburg-Landau equation
or Gross-Pitaevskii-type equations, where a connection to the KPZ
model has been explored recently 
for the continuum case. Once these studies are extended to lattice
implementations of such models (e.g. in optical lattices), one may
encounter the physics predicted here.  
RL and FM acknowledge support from an ERC Starting Grant and the ITN
cQOM. AM acknowledges support from National Science Foundation Grant
NSF-DMR 1303177.  
Appendix: Methods 
The numerical time integration of the coupled Langevin equations on
the lattice was performed with the algorithm presented in .
In the following, we provide further details on the parameters employed
for the simulations whose results are shown in the figures. 
For the simulations of the full phase model in one dimension in Fig. ,
we employed the following parameters. Fig. a:
,
(resulting in ). We only show a part of the phase
field. Fig. b: Parameters for the
upper magenta curve: .
Lower magenta curve: .
For both magenta curves, the average was taken over 300 simulations.
For the red curve: .
For the green curve: .
The average was taken over 120 simulations. 
We now turn to the simulations of the KPZ model. In general, direct
numerical simulations of this model where the scaling properties are
extracted are always performed for stable evolution. Hence, they are
done in the small-coupling regime, also for slightly different lattice
realizations with quantitatively different stability properties, see
. There, it is also found that
the parameter  has an influence on the transient
dynamics in one dimension (see also )
which explains the transients that we observed in the phase model,
in Fig. b (magenta curves). 
In Fig. b, we plot the probability
of encountering instabilities in the 1D KPZ lattice model as given
by Eq. (), for a wide range of the coupling parameter
. The data is extracted from 300 simulations for
each value of , running up to time ,
with a time step . The probability of instability
is just the ratio of unstable simulations. We checked that the results
for this quantity do not change at  if we go
to a smaller time step of . A simulation was
considered unstable when the nearest-neighbor height difference at
one lattice site exceeded a large value, which was chosen to be .
We used a lattice size of . The probability of an instability
generally increases for larger lattices. An exception are very small
lattices, where boundary effects can become important.  
Fig. c shows the results for
the probability to find an unstable simulation in the 2D KPZ lattice
model. The data for the plot is from 300 simulations for each value
of , on a lattice of size 
with time step . A simulation was considered unstable
when one of the nearest neighbor height difference at one lattice
site exceeded a large value, which was chosen to be . As
in 1D, the probability of instability depends on the lattice size.  
Regarding the results for the two-dimensional phase model, shown in
Fig. a, we commented in the
main text on the analytical predictions from a finite-size lattice
version of the linear Edwards-Wilkinson model (dashed curve in the
figure). It can be seen that there are deviations between this curve
and the simulation of the phase model (red curve) at later times.
Further investigation shows that the two-dimensional lattice version
of the KPZ model (in analogy to Eq. ()) shows the
same deviations. We checked that another lattice version of KPZ (as
in ) does indeed agree with
the result from the linear equation. The reason for the discrepancy
in different lattice models might be more subtle influences of the
nonlinearity, as also reported in .   

Topological quantum fluctuations and travelling wave amplifiers  
Vittorio Peano  
Institute for Theoretical Physics, University of Erlangen-N�rnberg,
Staudtstr. 7, 91058 Erlangen, Germany  
Martin Houde  
Department of Physics, McGill University, 3600 rue University, Montreal,
Quebec, H3A 2T8, Canada  
Florian Marquardt  
Institute for Theoretical Physics, University of Erlangen-N�rnberg,
Staudtstr. 7, 91058 Erlangen, Germany  
Max Planck Institute for the Science of Light, G�nther-Scharowsky-Stra�e
1/Bau 24, 91058 Erlangen, Germany  
Aashish A. Clerk  
Department of Physics, McGill University, 3600 rue University, Montreal,
Quebec, H3A 2T8, Canada  
It is now well-established that photonic systems can exhibit topological
energy bands; similar to their electronic counterparts, this leads
to the formation of chiral edge modes which can be used to transmit
light in a manner that is protected against back-scattering. While
it is understood how classical signals can propagate under these conditions,
it is an outstanding important question how the quantum vacuum fluctuations
of the electromagnetic field get modified in the presence of a topological
band structure. We address this challenge by exploring a setting where
a non-zero topological invariant guarantees the presence of a parametrically-unstable
chiral edge mode in a system with boundaries, even though there are
no bulk-mode instabilities. We show that one can exploit this to realize
a topologically protected, quantum-limited travelling-wave parametric
amplifier. The device is naturally protected both against internal
losses and back-scattering; the latter feature is in stark contrast
to standard travelling wave amplifiers. This adds a new example to
the list of potential quantum devices that profit from topological
transport.  
The quantization of the electromagnetic field introduces a fundamentally
new phenomenon into physics: vacuum fluctuations that permeate all
of space. These fluctuations were initially seen as a basic unalterable
feature of space-time, before it was realized that they could be engineered
to great effect. Simply modifying geometric boundary conditions changes
the size of the fluctuations as a function of position and frequency,
leading to phenomena such as the Purcell enhancement of spontaneous
emission. The introduction of nonlinear optical materials gives rise
to an even greater level of control, leading to the possibility of
squeezed vacuum states , with important applications
to sensing beyond the limits usually set by quantum mechanics .  
In recent years, new approaches for altering the dynamics of wave
fields have gained prominence, based on engineering periodic materials
to elicit topological properties. Topologically protected unidirectional
wave propagation was originally discovered in the study of 2D electrons
in strong magnetic fields, and underlies the robust quantization of
the Hall conductance .  The engineering of topological
photonic materials has been the focus of intense theoretical investigation
, and various experimental platforms have already been
developed .
Phononic topological states have also attracted recent attention 
and the first experimental steps at the macroscopic scale have been
taken .  
Despite this considerable work in topological photonics and phononics,
using topology to address the engineering of vacuum fluctuations has
not been addressed. Most photonic and phononic topological systems
are based on a single particle Hamiltonian which conserves particle
number. These topological states mimic well known electronic topological
phases such as the Quantum Hall phase ,
or the spin Hall phase 
and have a trivial vacuum. In order to modify the properties of the
vacuum one has to introduce particle non-conserving terms to the Hamiltonian
which can coherently add and remove pairs of particles from the system;
these terms have a formal similarity to pairing terms in the mean-field
description of a fermionic superconductor. If the amplitude of these
terms is sufficiently weak, the system remains stable; even in this
regime, the bosonic nature of the particles makes the topological
properties of such Hamiltonians very different from their fermionic
(topological superconductor) counterparts .
An even starker difference occurs when the parametric terms lead to
dynamical instabilities . These instabilities
have no fermionic analogue, and are akin to the parametric instability
in an oscillator whose spring constant is modulated in time. 
Here, we consider a situation where parametric driving is introduced
to a system where photons hop on a lattice in the presence of a synthetic
gauge field (see Fig. 1a). We show how to realize an exotic situation
where all bulk modes are stable, but where the topologically-protected
chiral edge modes that exist in a system with a boundary are unstable.
This leads to an unusual spatially-depedent modification of vacuum
fluctuations: when the system is stabilized by dissipation, quantum
fluctuations in the bulk are only weakly perturbed, whereas those
along the system edge are strongly distorted. The result is not just
an unusual driven-dissipative quantum state, but also a unique kind
of photonic device: as we show in detail, the system serves both as
a topologically-protected, non-reciprocal, quantum-limited amplifier,
as well as a source of chiral squeezed light. It thus represents a
potentially powerful new kind of application of topological materials.    
   
*   
Identifying unstable modes 
Before delving into the details of our proposal, it is useful to discuss
the underlying theoretical ideas in a general setting. Our main goal
is to exploit topological features of a dynamically unstable Hamiltonian,
adding dissipation to realize a non-thermal steady state. In the absence
of topological considerations, this is a situation that is ubiquitous
in quantum optics. The simplest bosonic Hamiltonian exhibiting instability
is the single-mode squeezing Hamiltonian:  
where  is a bosonic annihilation operator. Heuristically,
 describes photons in a single cavity mode (effective
energy ) which are subject to coherent two-particle driving
(with amplitude ). Without dissipation,  becomes
unstable and cannot be diagonalized when the driving amplitude exceeds
the energy cost for creating a pair of photons, i.e. when .
In this regime, the dynamics corresponds to an ever-growing, exponential
accumulation of entangled pairs of bosonic particles: there is no
stationary state.  
If we now add dissipation, stability can be restored by offsetting
the effective two-particle driving described by  against
the decay rate  of the mode; one requires .
The result is a non-thermal stationary state having a steady flux
of excitations flowing from the driven mode to the dissipative bath
(which could be a waveguide serving as an input-output port). This
is precisely the situation realized in a standard parametric amplifier:
the linear-response properties of this driven-dissipative steady-state
allow for quantum-limited amplification of an additional signal drive.
The required two-photon driving in Eq.() is generically
realized by using a nonlinearity and parametric down-conversion of
a driven pump mode.  
With these preliminaries, we now consider a very general quadratic
Hamiltonian describing bosons on a lattice subject to parametric driving:  
Here the ladder operator  annihilates a boson
with quasimomentum  in the state , where 
label polarization and/or sublattice degrees of freedom. The first
set of terms describes the hopping of photons on the lattice, and
explicitly conserves both particle number and quasimomentum. It could
be diagonalized to yield a standard band structure: for each quasimomentum
, we would have  band eigenstates. The second set
of parametric driving terms break particle number conservation, and
in general also break the conservation of quasimomentum: the two-photon
driving injects pairs with a net quasimomentum ,
implying that quasimomentum is only conserved modulo .
For a realization based on a driven  medium, the two-photon
driving terms correspond to the down-conversion of pump photons with
quasimomentum  into a pair of photons with
quasimomenta  and ,
respectively. Having a non-zero quasimomentum for injected pairs will
be a crucial resource when we attempt to control parametric instabilities.  
Analogous to the simple Hamiltonian in Eq.(), the
lattice Hamiltonian in Eq. () exhibits
instabilities when the amplitude for creating a pair of photons exceeds
the energy of the pair. Formally, one can introduce a generalized
normal mode decomposition of this generic Hamiltonian which explicitly
separates out stable modes and unstable modes. One obtains [see
Appendix ]:  
For each quasimomentum  in the first Brillouin zone,
we will now have both a set of stable modes (indexed by ),
and a set of unstable modes (. The first -sum
in Eq.() describes the stable modes:
they are described by canonical bosonic anihiliation operators ,
and enter the Hamiltonian in the standard manner, as a real energy
times a number operator .
The unstable modes can also be described by canonical bosonic anihiliation
operators . They however enter the Hamiltonian
via unstable two-mode squeezing (parametric amplifier) Hamiltonians:  
where  and 
are both real. This effective Hamiltonian for the unstable modes has
a simple interpretation: pairs of quasiparticles with opposite energies
 are created with an amplitude .
We stress that for any non-zero , 
is unstable (as the total energy for creating the relevant pair of
excitations is always zero). The quasiparticle operators 
in Eqs.(,)
are a complete set of Bogoliubov ladder operators.    
    
Parametrically driven Hofstadter model 
Having established the necessary theoretical framework, we will now
show how to engineer a Hamiltonian whose only unstable Bogoliubov
modes  are chiral states co-propagating
along the physical boundary of a topological system. We consider photons
hopping on a 2D square lattice in the presence of a synthetic magnetic
field flux, which are also subject to parametric two-photon driving
on each site (see Fig. (c)). Writing the Hamiltonian
in the position basis, we have  
where  is the photon annihilation operator
on site , and  are
the corresponding onsite energies. As usual, the synthetic gauge field
is encoded in the pattern of phases  of the nearest-neighbor
hopping rates, . We take
the synthetic flux per plaquette to be . Working in the
Landau gauge, we then have  for vertical hopping
and  for rightwards hopping. The
parametric driving amplitude on a given site  is written
; we take the phase to vary as ,
implying the injection of pairs with a quasimomentum .
For a realization based on a driven nonlinear medium, 
where  is the power of the pump laser, and 
would be the quasimomentum of the pump laser photons. Note that a
gauge transformation 
would modify both pattern of phases  and .  
When the laser is switched off, , and there is no disorder,
, we have the well known Hofstadter
model . The band structure of a semi-infinite
strip (extending to the lower-half -plane) is shown in Fig. a.
The continuous bulk band structure consists of four bands (one for
each site in the magnetic unit cell). The top and bottom bands are
flat Landau levels separated from the two central bands by topological
band gaps. Because of the boundary, one finds inside each topological
band gap an edge state (dark line). The net number of these edge states
(the number weighted by the sign of their slope) is a topologically
protected quantity which does not depend on the shape of the edge
and can be calculated from the bulk Hamiltonian . 
We now turn on the parametric driving such that the resulting Hamiltonian
can exhibit instability. Our goal is twofold: we want the system to
be unstable only if we have a boundary, and in this case, the
dominant unstable Bogoliubov modes should be chiral excitations localized
at the system's boundary. We do this by choosing the parametric drive
parameters so that the only pairs of photons that can be created in
an energy and quasimomentum conserving fashion correspond to edge
state excitations of the original () model. For concreteness,
we will focus on exciting the edge mode in the lower topological band
gap (dispersion ). In the lab frame, we will
thus tune the pump photon frequency  and quasimomentum
 so that a single pump photon can be converted into two edge
excitations with frequency  and quasimomentum .
In the rotating frame we use to write our Hamiltonians, this requirement
reduces to . If this resonance condition
is met, an arbitrarily weak parametric drive  will cause instability
of the edge mode. The required tuning is shown in Fig. a.  
Because of the approximately linear dispersion relation of the edge
mode, the above tuning guarantees that the parametric driving can
resonantly create a pair of edge mode photons having momenta ,
see the hollow circles in Figure (b). Thus,
even for a weak parametric drive amplitude, the edge state will exhibit
instability over a range of quasimomenta near  (corresponding
to a finite bandwidth around  in the lab frame), see
Figure (c). 
Conversely, the energies of two bulk excitations always add up to
a finite value, see Appendix . In other words,
all bulk parametric transitions have a finite detuning. This guarantees
the bulk stability (even in the presence of disorder) for a driving
amplitude  below the minimal value of the bulk detuning.     
    
   
Topological non-reciprocal amplifier 
Having shown how to realize an unstable topological edge mode, we
now want to understand how one can use it. More precisely, we show
that a finite size array of nanocavities coupled to simple waveguides
can be used as a new kind of topologically-protected, phase-sensitive,
quantum-limited amplifier. The role of the waveguides is two-fold:
they serve as amplifier input-output ports and they stabilize the
dynamics.  
We consider a realization of our system using a  array
of nanocavities, and additionally include three coupling waveguides.
Each waveguide is coupled to a site at the edge of the sample, as
shown in Fig. a-b. This coupling is described
using standard input/output theory, and is entirely characterized
by the three rates ,  and
, see Appendix .
In addition, we take each cavity to have an internal-loss decay rate
.  
When the small decay rate  is neglected, and without parametric
driving, the array can be operated as an ideal circulator where a
signal from any waveguide is entirely transmitted into the next waveguide,
see Figure c. Indeed, it is always possible
to match the impedances at each port to cancel the back-reflection
by tuning the corresponding coupling rate (, 
or ). Once inside the array a wave in a topological
band gap has no alternative but to chirally propagate along the edge.
In addition, the impedance matching ensures that a wave impinging
on a waveguide from the edge channel will be entirely transmitted.  
We harness the robust non-reciprocity of this topological circulator
to design an amplifier. We use the waveguide on the upper right (left)
as input (output) port of the amplifier. We choose parametric driving
parameters similar as in Fig. . In the finite
geometry, the quasimomentum matching will be approximately realized
only on the upper edge. Thus, the amplification occurs mainly in the
region between the input and the output port.  
The linear response of the amplifier is investigated numerically in
Fig. . A signal injected into the array
from the input port propagates chirally until it leaves the array
through the output port, see Fig. a. Depending
on its phase, it can be amplified or de-amplified along the way. Treating
the amplifier as a phase-sensitive amplifier, we find that the power
gain for the amplified signal quadrature is flat over a large bandwidth,
corresponding to the frequency range over which the edge state dispersion
is purely linear (see panel d). At the same time, any signals incident
upon the output port will be almost entirely dumped into the sink
port, and not reach the input port, see b.
The residual reverse gain and input reflection are much smaller than
unity, see panel e, ensuring the protection of a potentially fragile
signal source (e.g. a qubit). Crucially, this strongly non-reciprocal
amplifying behavior is of topological origin and is thus robust against
disorder. We demonstrate this resilience by including moderate levels
of disorder in our simulations (see Fig. ). 
Our numerical results are in qualitative agreement with analytical
results for a model in which a 1D chiral edge state is coupled to
three waveguides, see Appendix . In this
context, we find simple expressions for the impedence matching condition
and the maximum power gain   
respectively. Here,  is the transverse edge state wavefunction,
 is the edge state velocity and  is the number of sites separating
the input and the output ports. Thus, we see that the gain is the
exponential of the rate  of creation of down-converted pairs
times the time of flight  from the input to the output port.
While we have focused on operation as a phase-sensitive amplifier,
for frequencies different from , one could also use
the device as a quantum-limited phase preserving (i.e. non-degenerate)
amplifier.   
Quantum-limited amplification  
The noise floor of the amplifier is the frequency-resolved noise of
the amplified output quadrature, see Appendix .
It is plotted in dark (light) red for a clean (disordered) sample
in Fig. a. The quantum limit on
a phase-sensitive amplifier is to have zero added noise, implying
that the noise floor is simply set by the amplification of the vacuum
fluctuations entering the input port. The added noise (expressed as
an equivalent number of input quanta) is plotted in Fig. b;
despite disorder and noise associated with internal loss, the amplifier
is nearly quantum limited over the entire amplification bandwidth.     
    
Topological stationary state  
Next, we investigate the quantum fluctuations in the stationary state
that arise from the steady flow of photons from the parametric pump
to the amplifier ports in the form of down-converted radiation. Physically,
such a flow arises because vacuum fluctuations entering the input
port (within the amplification bandwidth) are amplified inside the
array before exiting through the output port. The resulting stationary
state of each cavity is Gaussian, and can be represented by a Wigner
function; these are visualized as a set of noise ellipses in Fig.
c. Each noise ellipse completely
characterizes the steady state of the corresponding site once all
remaining sites and the waveguides have been traced out. The areas
of the ellipses are constrained from below by the Heisenberg uncertainty
principle and assume the minimal possible value for pure states. The
bulk sites are all in the trivial quantum groundstate, which is characterized
by circular ellipses with the minimal area and zero photons. On the
other hand, the eccentricity, the area and the average on-site photon
number (color code) grow while moving from the input to the output
port along the upper edge (the major axis corresponds to the amplified
quadrature). We emphasize that in a thermal equilibrium setting, the
area of the ellipses would be equal on all sites and directly reflect
the environment temperature. Here, the excess noise of the sites on
the upper edge has a quantum origin. This phenomenom has been termed
quantum heating .  
Due to quantum heating, the stationary state of each cavity along
the edge corresponds to a thermal squeezed state, implying that the
squeezed quadrature has a larger variance than required by the uncertainty
principle. Nonetheless, the frequency-resolved output noise is strongly
squeezed below the vacuum level (for frequencies within the amplification
bandwidth). Remarkably, the quality of the output squeezing is not
deteriorated in the presence of disorder. For the parameters considered
here, more than  of output squeezing are predicted both
in the case of a clean and a disordered sample, see the blue curves
in Fig. a.   
Implementation  
Photonic gauge fields have been already realized in several experimental
platforms . The only additional
ingredient of our proposal is the parametric pumping with a finite
quasimomentum. In the setup of Ref. , one could
fabricate the microrings from a nonlinear optical  material
and drive them with a single laser impinging at a finite angle. The
implementation of parametric pumping  and synthetic
gauge fields 
is in principle possible in any cavity array platform where a nonlinear
resource is available. These include photonic crystals microcavities
 fabricated from nonlinear optical 
materials  or piezoelectric
materials, optomechanical arrays based on optomechanical crystals
, or lattices of superconducting resonators
with embedded Josephson nonlinearities . We also
note that very recently, a proposal for realizing topological insulator
physics in a classical optical network with nonlinearities was put
forward ; such a setup could also be adapted to implement
our scheme, as it contains all the necessary ingredients.  
Conclusions and outlook 
In this work, we have introduced a means to tie the squeezing and
amplification of vacuum fluctuations to topological properties of
a band structure. Our work represents a new design principle for a
non-reciprocal quantum-limited amplifier which has topological protection.
Non-reciprocal amplifiers have the potential to revolutionize experiments
with superconducting qubits, as they could eliminate the need for
ferrite-based circulators and the accompanying insertion losses which
limit current experiments. A variety of (non-topological) designs
based on multiple parametric interactions have been proposed recently
 and even realized experimentally
, including a travelling wave parametric
amplifier (TWPA) built using an array of over 2000 Josephson junctions
. In such a conventional TWPA, the reverse transmission
is at best unity, and even small amounts of disorder can lead to large
amounts of unwanted reflection gain. In contrast, the topological
underpinnings of our design ensure reverse transmission and input
reflection coefficients that are well below unity even in the presence
of disorder.  
More generally, our topological amplifier differs markedly from other
proposed topological devices such as isolators or non-amplifying circulators
, in that it has some protection against internal losses:
in the large gain limit, only the loss (and corresponding noise) in
the immediate vicinity of the input port hinder quantum limited operations,
as it is only this noise which is amplified to any significant degree
(see Appendix  for a quantitative discussion of
this point).   
In conclusion, our work shows how utilizing the topological properties
of an unstable bosonic Hamiltonian provides a new route for both engineering
electromagnetic vacuum fluctuations, and correspondingly, constructing
a new kind of topologically-protected, non-reciprocal quantum amplifier.
It opens the door to future studies, both pursuing other kinds of
novel applications, as well as more fundamental issues (e.g. the effects
of additional photon-photon interactions in such systems).  
Acknowledgements 
V.P., C.B., and F.M. acknowledge support by an ERC Starting Grant
OPTOMECH, by the DARPA project ORCHID, and by the European Marie-Curie
ITN network cQOM. M.H. and A.A.C. acknowledge support from NSERC.
We thank Ignacio Cirac, Sebastian Huber, and Andr� Xuereb for discussion.  
Generalized normal mode decomposition  
We consider the generic Hamiltonian Eq. ().
We group all ladder operators with quasimomentum  in
a vector of ladder operators, .
 The Heisenberg equation of motion for 
reads  
where    
and  is the Bogoliubov de Gennes Hamiltonian    
In the following, we explicitly construct a complete set of Bogoliubov
operators , leading to the generalized
normal mode decomposition Eq. (), from
the solutions of the eigenvalue problem  
We note that we need to find only  annihilation operators while
the eigenvalue problem has dimension . However, the equations
for quasimomentum  are not independent from the
equations for quasimomentum . The ones can be obtained
from the others by taking the adjoint. This doubling of the degrees
of freedom accompanied by an embedded particle-hole symmetry occurs
because we are effectively applying a single-particle formalism to
a problem where the number of excitations is not conserved.  
From Eq. () it is easy to prove that eigenvalues
which are not related by complex conjugation 
have -orthogonal eigenvectors, .
Moreover, the eigenvectors with real eigenvalues have a non-zero symplectic
norm, 
(which can also be negative). We assign the label  to the positive
norm eigenvectors. We construct a set of orthonormal Bogoliubov creation
operators from these positive norm solutions with the definition,  
We note that the scalar product between a standard vector and a vector
of operators is an operator. Moreover, we have to normalize the positive
vectors  according to 
such that 
By taking the time derivative of Eq. () and
plugging Eq. () and the adjoint of Eq. ()
we immediately find  
Thus,  is the annihilation operator of
a harmonic oscillator with energy .
In the same way, one could construct a set of creation operators 
from the negative norm eigenvectors . However,
it is possible to focus only on the positive norm solutions because
of the particle-hole symmetry: the information encoded in the negative
norm solutions  is also encoded in the
positive norm solutions .  
The remaining eigenvectors have zero norm, .
They appear whenever the Hamiltonian is unstable. In this case, the
matrix  has pairs of complex conjugated
eigenvalues 
For concreteness, we indicate with the label  the eigenvalues
with positive imaginary part. The pair of eigenvectors 
are not ortoghonal to each other, .
In this case, we define a pair of commuting ladder operators as,  
The bosonic commutation relations are recovered by requiring the normalization 
By taking the time derivative of Eq. () and
using Eq. (), the transpose of Eq. (),
and Eq. () we find  
Likewise, we find  
The corresponding Hamiltonian is the two-mode squeezing Hamiltonian
(Eq.()) with energies 
and amplification amplitude   
When the matrix  is diagonalizable, the set of Bogoliubov
annihilation operators defined in Eqs. ()
and () is complete. The pathological case where
the matrix  is not diagonalizable occurs only exactly
at the threshold of an instability.  
Details of the calculation of the band structure  
Stability of the bulk Hamiltonian 
In the main text, we have explained that a bosonic Hamiltonian with
anomalous pairing terms is unstable when it allows the creation of
a pair of Bogoliubov excitations without any net energy change. In
other words, the sum of two quasiparticle energies should be zero.
We have also claimed that for the parameters of Figure 2 the bulk
Hamiltonian is stable because no combination of bulk states whose
energies add up to zero exists. This is not immediately obvious from
the plot of the standard band structure. In order to visually illustrated
the absence of such combination of bulk states one has rather to plot
the corresponding Bogolibov de Gennes band structure, see Fig. .
For each value of , the latter is formed by both the quasiparticle
energies  (blue bands) as well as the energies 
(grey bands). In analogy to the descriptions of quasiparticles in
fermionic superconductors, one refers to the former (latter) as the
particle (the hole) bands of the system. The absence of crossings
between particle and hole bands for the chosen pump laser frequency
implies that there is no combination of a pair of bulk quasiparticles
whose energies add up to zero while at the same time the corresponding
quasimomenta add up to . In the limit of vanishing parametric
driving (), the minimal distance between particle and hole
bands is the minimal detuning of a parametric transition involving
two bulk states. 
In the presence of weak disorder, there is no selection rule for the
quasimomenta of the pair of quasiparticles created in a parametric
transition. Nevertheless, all possible parametric transitions are
still detuned because the band gap separating particle and hole bands
is not merely locally defined (for a fixed ) but rather extends
to the whole Brillouin zone. Thus, the stability of the bulk Hamiltonian
is a robust feature. 
As explained in Appendix , the Bogoliubov
de Gennes band structure can be calculated by diagonalizing the matrix
 where  is the first-quantized Bogoliubov
de Gennes Hamiltonian equivalent to the second quantized Hamiltonian
Eq. (5) of the main text in the presence of periodic boundary conditions
both in the - and - directions.    
*  
Band structure of a strip 
Figure 2 of the main text represents the band structure and the amplification
amplitudes of a semi-infinite strip. Those have been derived from
the the Bogoliubov de Gennes band structure and the amplification
rates of a strip with two physical edges as explained below. 
We have simulated a finite strip of width  magnetic unit cells.
For each value of the quasimomentum , the set of energies
 and  forming the BdG band structure
and the corresponding amplification rates  are
calculated by diagonalizing the relevant  matrix .
While strictly speaking the energy spectrum is discrete, the spacing
between subsequent bulk states is not visible on the figure scale.
The resulting band structure [panels (b-c)] and the corresponding
amplification rates [panel (d)] are shown in Fig. .
By inspecting the corresponding wavefunctions one can easily distiguish
between particle and hole bands (plotted in blue and grey, respectively),
edge and bulk states (plotted by the thick dark and thin light lines,
respectively) and upper- and lower-edge states (solid and dashed lines,
respectively). 
Since the hole bands are not independent from the particle bands and
refer to the same set of normal modes, we have not displayed the hole
energies in the plots in the main text. Moreover, we have shown only
the edge states localized on the upper edge. Removing the edge states
localized on the lower edge effectively corresponds to plotting the
band structure of a semi-infinite strip extending to the lower half
plane. 
We note that the particle (hole) edge states cross the hole (particle)
band. Thus, a pair formed by an edge and a bulk excitation can in
principle also be resonantly excited. However, the corresponding matrix
element is very small and the resulting amplification rate is not
visible on the scale of the figure.  
Analytical derivation of Edge state dispersion and amplification
rate 
Here, we outline a direct derivation of the edge state dispersion
for a semi-infinite strip. 
We first, consider the case where the parametric driving is switched
off (). The Hamiltonian in terms of the annihilation operators
 of a plane wave with quasimomentum 
on the -th row reads  
 Since, the strip extends to the lower-half plane the -th
sum runs over the negative integers. By definition of the normal modes
 and eigenenergies  we have
,
or equivalently .
By plugging the ansatz ,
we arrive to the first-quantized time-independent Schr�dinger equation
which we set in the matrix form,  
 & (  
)=M_j_y(_n[k_x])(  
) 
 & =(  
)(  
). 
Here, we have defined .
In principle, the above equation holds only for  but
not for  because there is no row corresponding to .
One can circumvent this problem by formally adding the row 
together with the boundary condition . Thus, one
immediately finds  
(  
) & =_j'_y<j_yM_j'_y(_n[k_x])(  
). 
Next, we focus on the edge state solutions. In the following, we drop
the subscript  because there is only one edge state in each band
gap, see below. For the edge states we have to enforce the boundary
condition   
Equivalently, one can require    
 where  is the transfer matrix by a full magnetic
unit cell (four sites),   
(5) is fullfilled if and only if the vector  is an eigenvector
of the -site transfer matrix  whose eigenvalue
has modolous smaller than unity. In other words, the edge state dispersion
is determined by the conditions,   
 Equation (6) is a third order polynomial in the dimensionless energy
. Thus, it has three roots for each value of .
Each root corresponds to a solution inside one of the three band gaps
(lower, middle, or upper). By plugging the analytical expression of
each root of Equation (6) into Equation (7) we find the range of 
where the corresponding edge state is defined: the interval 
for the upper edge state,  for the lower edge state,
and the two intervals  and  for
the edge state in the local band gap between the two central bands.
In order to enforce the bosonic commutation relations ,
we have to appropriately normalize the single-particle wavefunctions
. This condition fixes the
modolous of the wavefunction on the initial site .
The complex phase of  is arbitrary. For concreteness,
we choose  to be real. 
Next, we show how the edge state is modified by the parametric pump.
The pump drive written in terms of the annihilation operators 
reads,   
Before pursuing an exact numerical solution we adopt a semi-analytical
treatment. We focus on the lower band gap edge state which is resonantly
driven for the parameters of Fig. 2 of the main text. As in the main
text, we consider the case where the frequency and quasimomentum of
the pump laser are chosen to resonantly excite pair of edge photons
with quasimomentum ,   
In this case, it is convenient to introduce the quasimomentum 
counted off from . By rewriting the full Hamiltonian (including
the pump) in terms of the edge states ladder operators 
and keeping only the terms that acts on the lower edge state (we neglect
an off-resonant parametric coupling to the bulk modes and the other
edge states), we find    
 Here, we have grouped all excitation conserving terms into two contributions
whose amplitudes  and 
are an odd an even function of , repectively,   
Note that  is the quasimomentum dependent detuning
of the parametric transition creating pairs of photons with quasimomentum
. The corresponding parametric coupling is given
by   
It is easy to show that it can be expanded in terms of even powers
of  and that the leading order is    
The edge state is unstable over the finite quasimomentum interval
where . Following the general procedure
presented in Appendix , we find
the eigenenergies and amplification amplitude of the Bogoliubov edge
state normal modes   
and   
in the unstable and stable quasimomentum ranges, respectively. 
We can recover the edge state dispersion and lineshape of the amplification
amplitude obtained numerically and shown in Fig 2 of the main text
by keeping the leading order contributions in Eqs. (,,),    
Input-output formalism 
We include the effects of dissipation using the standard input-output
formalism . Each site is described by the Langevin
equation   
Here,   is the decay rate on site .
On the sites coupled to waveguides, the decay rates ,
, and  are induced by the
coupling to the waveguides and are chosen to achieve impedance matching.
In this case, the input fields 
describe the field impinging on site  from the corresponding
waveguide including the field vacuum fluctuations. The field 
leaking out of the waveguide is given by the input-output relations  
On the remaining sites (i.e. those not coupled to iwaveguides), we
assume a small uniform decay rate  
corresponding to internal loss; 
describes the corresponding incident vacuum fluctuations associated
with this loss port.  
The linear response and the noise properties of the array are simple
functions of the retarded Green's functions   
We calculate the above Green's functions numerically for a finite
array.  
Response Ellipses 
In Fig. a (Fig. b)
we show the linear response of the pair of quadratures  
to a classical field of frequency  injected at the
input (output) port as a function of the field phase ,  
 indicates the site attached to the relevant injection
waveguide ( for Fig. a,
 for Fig. b).
The response on each site is represented by the ellipse   
where   
are the major and minor semiaxes of the ellipse, and   
is the angle parametrizing the orientation of the major semiaxis.
In the figure, the reference angle 
is rotated by  compared to the page vertical. The maximum
(minimum) response  ()
at site  to an input field at the port 
is obtained for the driving phase 
( ),    
Gain, Reverse Gain, and Input Reflection  
As we analyze our amplifier in the phase-sensitive mode of operation,
it is useful to consider its scattering properties in a quadrature
representation, using an optimal quadrature basis fields in the input
and output waveguides. The relevant scattering between these waveguides
is described by  
*
where we have omitted writing terms describing contributions from
vacuum noise incident from the internal loss ports, as well as terms
describing the reflection of noise incident from the output waveguide
(due to slightly imperfect impedance matching). We define the quadratures
of the output waveguide as   
*
while the quadratures of the input-waveguide are defined as  
*
We will define both the quadrature basis in each coupling waveguide
so that  is maximal. This implies
that the largest amplification of a narrow-band signal centered at
zero frequency ( in the lab frame) occurs when the
incident signal is in the  quadrature
of the input waveguide, with the amplified output being contained
in the output field  quadrature of the
output waveguide. It also follows naturally that for vacuum noise
inputs,  will be the optimally squeezed
quadrature. An explicit calculation of the scattering matrix in terms
of the Green's functions introduced above shows that the angles defining
these preferred input and output quadratures are given by   
see Eqs. (,). The fact that in general
 is a simple reflection
of the fact that our system can both perform phase-sensitive amplification
of incident signals, as well as simply rotate incident signals in
phase space.  
The frequency dependent power gain is then by definition given by
the transmission probability:   
*
The reverse gain is obtained similarily by exchanging the two indices
of the Green's functions in the above formula and in Eq. ().
Finally, the input reflection probability describes the reflection
of signals incident in the (amplified)  quadrature of the
input port    
*  
Added noise and squeezing 
The symmetrized frequency-resolved noise in the amplified and de-amplified
output-waveguide output field quadratures shown in Figure (a)
are defined as   
*
respectively. The number of added noise quanta shown in Figure (b)
is defined by,   
Noise Ellipses 
In Figure (c), the stationary state
of each site  is represented as a noise ellipse. The
noise ellipse on a particular site  is obtained by diagonalizing
the corresponding covariance matrix     
*
and identifying the square root of its eigenvalues 
and  as the ellipse semi-axes and the
angle  as the ellipse rotation angle
(the reference angle  is rotated by
 compared to the page vertical).   
Effective model for the edge state coupled to waveguides 
In this supplementary note we want to derive an effective quantum
field theory for the edge state coupled to a waveguide. We want to
model a finite system which will then support a single edge state
with a ring geometry (i.e. periodic boundary conditions). We adopt
the simplest possible approach valid when the input signal has a bandwidth
well within the amplifier bandwidth. In this case, we can approximate
the edge state velocity and amplification rates to be constant, ,
, and , respectively. Moreover,
we can neglect the quasimomentum dependence of the edge state transverse
wavefunction. We thus arrive at the edge state ladder operator   
where  is the number of sites along the edge, and the indexes
 and  () label the position
in the directions parallel and longitudinal to the edges (for the
edge state along the upper edge described above 
and ). Moreover,  is the transverse
edge state wavefunction, 
see Eqs. (,). The periodic
boundary conditions 
are enforced by the quasimomentum quantization . 
We consider a waveguide attached to a single site along the edge in
the logitudinal position . The
coupling to the waveguide as described by standard input-output theory
is entirely characterized by the decay rate . Since, the
edge state is the only state within the amplifier bandwidth the coupling
of the waveguide to a single site is equivalent to a direct coupling
to the edge state at the same longitudinal position 
with the renormalized decay rate .
The resulting Langevin equation reads  
c(j_)=i[H^(edge),c(j_)]-2_j_,j_exc(j_)+j_,j_exa^(in), 
with the input-output relations    
Next we take the continoum limit by defining the chiral edge field  
where  is the edge length and the periodic boundary conditions
 follow from the quasimomentum quantization
. From Eq. () with ,
, and , and Eq. ()
we find the field equations   
We note that due to the point-interaction with the waveguide the field
 is not continous at the position  where
the waveguide is attached, 
( and  are infinitesimal positive and negative numbers,
respectively). Keeping this in mind, the input output relation in
the continous limit reads    
Before investigating the interaction with the waveguide, we first
discuss the propagation inside the ring. For concreteness we consider
 such that  ()
is the field immediately after (before) the interaction with the waveguide.
A signal travels an almost complete round trip from 
to  in the time .
During this time no interaction with the waveguide takes place. From
Eq. (), one readily finds  
*
Here, we have introduced the amplified and de-amplified quadratures,
 and 
We can conclude that a signal with the right phase during a complete
round trip inside the ring experience a power gain   
Next, we discuss the interaction with the waveguide. An input signal
from the waveguide will be partly reflected and partly transmitted
into the ring at . Then, it will propagate inside the ring
until it has completed a round trip. A signal with the right phase
will be amplified along the way. Before starting a new round trip,
part of the amplified signal returns into the waveguide. If the signal
remaining in the ring at the beginning of the second round trip is
smaller compared to the signal in the ring at the beginning of the
first round trip, the signal will decay after few round trips. In
this regime, the waveguide stabilizes the edge state. By integrating
the Heisenberg equations () close to  
we find    
where  and  are the reflection and transmission probability
amplitudes,   
To prevent instability, we require that the transmission  be large
enough that the field in the edge-mode ring does not grow with each
round trip. The simplest case is where we tune the decay rate 
so that all of the incident wave in the edge mode ends up in the coupling
waveguide, i.e. , . This requires , or in terms
of the decay rate , the edge state velocity , and the
edge state transversal wavefunction at the edge ,
we find   
If this impedance matching condition is met, signals incident from
the waveguide in the  quadrature will be reflected back
with a power gain  independent of frequency. The
impedance matching ensures that multiple traversals of the ring are
impossible, which both precludes instability, but also prevents the
formation of standing wave resonances and a strongly frequency-dependent
gain. 
We note that the effective model described above can be straightforwardly
extended to describe a chiral edge state coupled to several waveguides.
In particular, we consider a set up with two impedance matched waveguides
at position  and  (),
respectively. A signal from the first waveguide entering the edge
state at position  is entirely transmitted into the
second waveguide at position . For the appropriate
phase of the input signal, we have   
where  is the input quadrature. We denote
, the corresponding amplified quadrature
at ,   
From Eq. () one finds   
where the gain  is given by Eq. ().  
Comparison between finite size simulations and effective model 
In the regime where our effective theory applies (for signals well
within the amplifier bandwidth), it can reproduce well the simulations
of finite arrays. There are some quantitative differences due to well
understood finite size effects. For instance, the edge state velocity
is not constant in the finite size array but rather decreases close
to the edges where the edge state propagation changes direction. For
this reason the gain does not depend only on the number of sites separating
the input and the output port but also on the precise position of
the ports. We have placed the input and output port close to the edges
to enhance the gain. Indeed, the gain in the finite size simulations
is slightly larger than predicted by Eq. (). Due to
the position dependent edge state velocity also the value of the decay
rate required to obtain impedance matching depends on the position
where the waveguide is attached (and is lower at the edges). 
We note that the analytic continuum model can be extended to capture
the frequency dependence of the gain and noise of our travelling wave
amplifier; one needs however to incorporate into the model the leading-order
quasimomentum dependence of the edge state velocity (which creates
an effective pump detuning for the relevant parametric process). This
is will be presented in a future work.  
Quantitative analysis of the resilience of the topological amplifier
to losses 
Here, we show that our quantum amplifier design offer some degree
of resilience to intrinsic losses and the corresponding noise. We
want to calculate noise which is added to a signal propagating from
the input to the output port when intrinsic losses are present. In
addition to the impedance matched outcoupling towards the waveguides
at the input and output ports, we consider a loss channel on each
site and denote the corresponding decay rate as . 
In the continous limit, and with the same approximations as above,
we find the quantum field equations valid in the region between the
input and output port  
 where  is the vacuum noise: 
and   
We fourier transform into frequency space and find the solution   
 Putting together Eq. () for 
with Eqs. (,) we can relate
the output signal  to the input signal
 of the amplifier   
 The added noise  in noise quanta is by definition,  
where  is the symmetrized noise at the output
port,   
and  is the gain. We note that in our simple approach
,  and  are frequency independent.
From Eqs. (,) we find   
and   
From this expression we see that for 
the noise added at position  is cut off exponentially
as a function of the distance  from the input. In particular,
in the large gain limit and assuming that 
is smooth close to , we can approximate   
Note crucially that as one increases the length  of the amplifying
channel, the gain increases exponentially, while the added noise remains
constant. We thus see explicitly that the amplifying channel is immune
to the majority the internal loss noise in the system. 
  
      
    
         
      
Quantum nondemolition measurement of mechanical squeezed state beyond the 3 dB limit 
C. U. Lei, A. J. Weinstein, J. Suh, E. E. Wollman, A. Kronwald, F. Marquardt, A. A. Clerk, K. C. Schwab
schwab@caltech.edu
Applied Physics, California Institute of Technology, Pasadena, CA 91125, USA
Korea Research Institute of Standards and Science, Daejeon 305-340, Republic of Korea
Friedrich-Alexander-Universitat Erlangen-Nurnberg, Staudtstr. 7, D-91058 Erlangen, Germany
Max Planck Institute for the Science of Light Gunther-Scharowsky-Strasse 1/Bau 24, D-91058 Erlangen, Germany
Department of Physics, McGill University, Montreal, Quebec, H3A 2T8 Canada  
We use a reservoir engineering technique based on two-tone driving to generate and stabilize a quantum squeezed state of a micron-scale mechanical oscillator in a microwave optomechanical system. Using an independent backaction evading measurement to directly quantify the squeezing, we observe  dB of squeezing below the zero-point level, surpassing the 3 dB limit of standard parametric squeezing techniques. Our measurements also reveal evidence for an additional mechanical parametric effect.  The interplay between this effect and the optomechanical interaction enhances the amount of squeezing obtained in the experiment.  
Generating nonclassical states of a massive object has been a subject of considerable interest. It offers a route toward fundamental tests of quantum mechanics in an unexplored regime . One of the most important and elementary quantum states of an oscillator is a squeezed state :  a minimum uncertainty state has a quadrature which is smaller than the zero-point level. Such states have long been discussed in the context of gravitational waves detection to improve the measurement sensitivity . It is well known that a coherent parametric drive can be used to squeeze mechanical fluctuations , which is essentially equivalent to the technique first used to squeeze ground-state optical fields . However, the maximum steady-state squeezing achieved by this method is limited to 3 dB due to the onset of parametric instability. Therefore, it is in principle impossible to have a steady state where the mechanical motion is squeezed below one half of the zero-point level using only parametric driving. These limitations may be overcome by combining continuous quantum measurement and  feedback , but it would substantially increase the experimental complexity.  
Another method to generate robust quantum state is quantum reservoir engineering , which has been used to generate quantum squeezed states and entanglement with trapped ions  and superconducting qubits . It can also applied to optomechanical system to generate strong steady-state squeezing without quantum-limited measurement and feedback . By modulating the optomechanical coupling with two imbalanced classical drive tones, the driven cavity acts effectively as a squeezed reservoir. When the engineered dissipation from the cavity dominates the dissipation from the environment, the mechanical resonator relaxes to a steady squeezed state. This technique has been applied recently to generate quantum squeezed states of macroscopic mechanical resonators . 
In addition to being a tool for state preparation, optomechanics also provides a means to probe the quantum behavior of macroscopic objects . In particular, a backaction evading (BAE) measurement  of a single motional quadrature can be implemented in an optomechanical system. If the drive tones that modulate the coupling are balanced, a continuous quantum nondemolition (QND) measurement of the mechanical quadrature can be made. This technique can be used to fully reconstruct the quantum state of the mechanical motion. 
In this work, we combine reservoir engineering and backaction evading measurement with a microwave optomechanical system to perform continuous QND measurement of a quantum squeezed state. Among the previous three squeezing experiments , only  demonstrated direct detection, performed using a two-cavity optomechanical system; here we implement both reservoir engineering and BAE measurement simultaneously within a simple single-cavity setup. In addition to the optomechanical interaction, a mechanical parametric effect is observed. Contrary to previous works, where the mechanical parametric effect produced parametric instability that limited the precision of the BAE measurement , the interplay between the parametric drive and the engineered dissipation enhances the mechanical squeezing. By directly measuring the mechanical quadrature variances with the BAE measurement, we demonstrate motional quantum squeezing with squeezed quadrature variance ,  dB below the zero-point level. This exceeds what is possible using only parametric driving, even if one starts in the quantum ground state. This is the first experiment to demonstrate more than 3 dB quantum squeezing in a macroscopic mechanical system.  
The mechanical oscillator in this work is a 100 nm thick,  aluminum membrane, with fundamental resonance frequency  MHz and mechanical linewidth  Hz at 10 mK. It is capacitively coupled to a lumped-element superconducting microwave resonator with resonance frequency  GHz and damping rate  kHz (Fig. a). The mechanical motion couples to the resonance frequency of the microwave resonator through the modulation of the capacitance, with an optomechanical coupling rate  Hz, where  fm is the amplitude of the zero-point fluctuation of the mechanical oscillator with mass  pg. The system is described by the Hamiltonian  
H = & _ca^a+_mb^b-g_0a^a(b+b^) 
 &+i_in(^*(t)a-(t)a^)+H_diss,  
where  is the annihilation (creation) operator of the intra-cavity field,  is the mechanical phonon annihilation (creation) operator,  is the coupling rate of the input coupler, and  is the external driving field. The term  accounts for dissipation. 
To squeeze the mechanical motion, we drive the cavity with a pair of pump tones at  with intracavity field   
which is represented by the red and blue arrows in Fig. b. Linearizing the cavity dynamics in the standard way, the pumps couple the microwave resonator to the Bogoliubov mode of the mechanical motion with the Hamiltonian  
where  is the fluctuating part of the cavity field , and  is the Bogoliubov-mode annihilation operator whose ground state is a squeezed state with squeezing parameter .  is the coupling rate between the Bogoliubov mode and the cavity.  are the enhanced optomechanical coupling rates, and  are the intracavity pump photon numbers corresponding to the squeezing pumps. 
The beam-splitter Hamiltonian in Eq. () enables us to cool the Bogoliubov-mode into its ground state, producing a stationary mechanical squeezed state with quadrature variances  
where  is the effective mechanical linewidth and  parameterizes the phase-dependent driving of the mechanics by cavity fluctuations. The quadrature variances depend on the intracavity pump photon numbers , as well as the cavity occupation  and the phonon bath occupation , which can be extracted from the output spectra (Fig. f,g). Together with Eq. (), the corresponding quadrature variances can be calculated . 
Fig. c shows the quadrature variances with various intracavity pump photon ratio . We start by squeezing the mechanical motion with total intracavity pump photon number  and pump photon ratio . This pump configuration generates a mechanical squeezed state with the squeezed quadrature variance  and the anti-squeezed quadrature variance , indicated by the solid red circle and square in Fig. c. The corresponding normalized output spectra and the fits from the two-tone optomechanical model  are shown in Fig. f. To further squeeze the mechanical motion, we can increase the total pump photon number. The blue circles (squares) in Fig. c are the squeezed (anti-squeezed) quadrature variances at total intracavity pump photon number . The solid (dashed) blue curves are the predictions from Eq. () with constant cavity and mechanical occupations extracted from the output spectrum at ; they agree with the data at low pump photon ratio. At large pump photon ratio, the cavity bath starts to heat up (Fig. d), which increases the mechanical quadrature variances. The orange curves in Fig. c are the predictions from Eq. () including the cavity heating effect extracted from the experiment (orange line in Fig. d). With the heating effect, the minimum quadrature variance is achieved at  with  (the solid blue circle in Fig. d),  dB below the zero-point level. The corresponding normalized output spectra and fits are shown in Fig. g. 
While inferring the level of squeezing from the cavity output spectrum is convenient, it would be preferable to have a more direct method that does not rely on assumptions about the mechanical dynamics.  This can be achieved in our system without needing to introduce an additional cavity resonance:  we continue to use the cavity density of states near resonances to generate mechanical squeezing, but now use the density of states away from resonances to make an independent, backaction-evading measurement of a single mechanical quadrature. In this way, our single cavity effectively plays the role of two:  it both generates squeezing, and permits an independent detection of the squeezing. 
To directly measure a single mechanical quadrature, in addition to the squeezing pumps, we introduce another pair of weak backaction evading (BAE) probes (the purple arrows in Fig. b) at  with intracavity field   
where  is the relative phase between the BAE probes and the squeezing pumps. For a sideband-resolved system (), the modulation of the BAE probes exclusively couples the mechanical quadrature  to the microwave resonance with the interaction  
where  is the enhanced optomechanical coupling rate and  is the intracavity pump photon number corresponding to the BAE probes. Since  is a constant of motion of the system, the interaction () enables a continuous QND measurement of the the mechanical quadrature. By sweeping the probe phase , we can perform tomography of the mechanical quantum state (Fig.  a). In order to ensure no interference between the sidebands of the squeezing pumps and the BAE probes, we detune the BAE sidebands from the cavity resonance by . The power of the BAE probes are set about 10 dB weaker than the power of the squeezing pumps to avoid extra heating. In the experiment, the motional sideband spectrum of the BAE probes is measured, from which we can extract the mechanical quadrature variance and linewidth. In the following, we will perform a BAE measurement to directly characterize the weakly squeezed state corresponding to the spectrum Fig.  f and the strong squeezed state corresponding to the spectrum Fig. g. 
Fig. b shows the mechanical quadrature variances from the BAE measurement as a function of the probe phase . The red circles are the quadrature variances of the weakly squeezed state measured with the BAE technique. The red curve is the inferred quadrature variances from the corresponding output spectrum (Fig. f). In this case, the results from the BAE measurement are in good agreement with the results inferred from the output spectrum. Similarly, the blue circles are the quadrature variances of the strong squeezed state measured with the BAE technique. The blue curve is the inferred quadrature variance from the corresponding output spectrum (Fig.  g). The minimum quadrature variance is achieved at  with ,  dB below the zero-point level. This is lower than the quadrature variance inferred from the output spectrum, implying that there is additional dynamics at play (beyond the ideal optomechanical interaction). 
The enhanced squeezing observed in the BAE measurement suggests an additional squeezing mechanism beyond the dissipative mechanism discussed above; an obvious candidate is direct parametric driving of the mechanics.  The presence of such driving is further corroborated by our observation of a phase dependence of the quadrature linewidth in the BAE measurement (Fig. c). Similar induced mechanical parametric driving has been observed in other BAE measurements; they can arise via a number of mechanisms, including thermal effects as well as higher nonlinearities . To understand the effects of this mechanical parametric driving, we phenomenologically add the mechanical parametric interaction to our otherwise ideal optomechanical model :  
where  is the amplitude of the parametric interaction and  is the relative phase between the parametric drive and the squeezing pumps. 
We fit the observed phase-dependent quadrature linewidth to our model, thus extracting the amplitude and phase of the parametric drive. . By assuming the phase of the parametric drive  follows the phase of the BAE probe (i.e. , where  is a constant phase shift), the model captures the observed phase dependence behavior of the quadrature linewidth, as shown by the dashed curves in Fig. c. Surprisingly, if one instead assumes that the parametric driving is a result of the main squeezing tones (i.e. take  a constant independent of ), one cannot capture the observed phase dependence of the quadrature linewidth . These results suggest that the parametric drive is induced by the BAE probes. 
The predicted squeezed quadrature variance for the strong-pumps configuration is , as shown by the blue star in Fig. b. We stress that our treatment of the spurious mechanical parametric drive is phenomenological; we do not know the precise microscopic mechanism which causes this driving.  Nonetheless, it allows us to explain both surprising features of the BAE measurements (the observed phase-dependent mechanical quadrature linewidth, and the enhanced squeezing). 
In conclusion, we combine reservoir engineering and backaction evading measurement in a microwave optomechanical system to demonstrate a continuous QND measurement of a mechanical quantum squeezed state. From the BAE measurement,  dB of squeezing below the zero point level has been observed, surpassing the 3 dB limit of the standard parametric squeezing technique. In addition, a phase dependence of the quadrature linewidth is observed and explained by including a mechanical parametric interaction to the ideal optomechanical model. The interplay between the optomechanical interaction and the mechanical parametric interaction enhances the mechanical squeezing and provides a qualitative explanation to the BAE measurement results. The present scheme can be applied to generate and characterize more complicated quantum states by carefully engineering the nonlinear interaction . The ability to generate and measure a strong quantum squeezed state of a macroscopic mechanical object would be useful for ultra-sensitive detection , quantum information processing , as well as fundamental study of quantum decoherence .  
This work is supported by funding provided by the Institute for Quantum Information and Matter, an NSF Physics Frontiers Center with support of the Gordon and Betty Moore Foundation (NSF-IQIM 1125565), by the Defense Advanced Research Projects Agency (DARPA-QUANTUM HR0011-10-1-0066), by the NSF (NSF-DMR 1052647 and NSF-EEC 0832819), and by the Semiconductor Research Corporation (SRC) and Defense Advanced Research Project Agency (DARPA) through STARnet Center for Function Accelerated nanoMaterial Engineering (FAME). A.C., F.M., and A.K. acknowledge support from the DARPA ORCHID program through a grant from AFOSR, F.M. and A.K. from ITN cQOM and the ERC OPTOMECH, and A.C. from NSERC.    
*   
* 
apsrev4-1   
Supplementary Information for ``Quantum nondemolition measurement of mechanical squeezed state beyond the 3 dB limit"  
C. U. Lei, A. J. Weinstein, J. Suh, E. E. Wollman, A. Kronwald, F. Marquardt, A. A. Clerk, K. C. Schwab  
Applied Physics, California Institute of Technology, Pasadena, CA 91125, USA  
Korea Research Institute of Standards and Science, Daejeon 305-340, Republic of Korea  
Friedrich-Alexander-Universitat Erlangen-Nurnberg, Staudtstr. 7, D-91058 Erlangen, Germany  
Max Planck Institute for the Science of Light Gunther-Scharowsky-Strasse 1/Bau 24, D-91058 Erlangen, Germany  
Department of Physics, McGill University, Montreal, Quebec, H3A 2T8 Canada  
0
0
0
1   
Theory 
Ideal two tones optomechanical Hamiltonian
The Hamiltonian of a generic optomechanical system reads  
where  is the annihilation (creation) operator of the intra-cavity field, 
is the mechanical phonon annihilation (creation) operator, and  is the bare optomechanical coupling between the cavity and the mechanical oscillator.  describes the external driving. 
The device studied in this work is a two ports optomechanical system. Microwave tones are applied from the left port, which we designate . In this section, we consider a system driven by two microwave tones.  The drive Hamiltonian reads  
where  and  are the blue and red pump amplitudes at the input port. In the following, we apply the standard linearization -- i.e., we separate the cavity and the mechanical operators,  and , into a classical part,  or , plus quantum fluctuations,  or . E.g., . In the interaction picture with respect to  , we find the linearized optomechanical Hamiltonian  
Here,  
describes the resonant part of the linearized optomechanical interaction whereas  
describes off-resonant optomechanical interactions. Note that  describes the driven-enhanced optomechanical coupling. Here,  is the intracavity microwave amplitude due to the red and blue pumps, and we have assumed  for simplicity and without loss of generality. In the following analysis, we consider the good cavity limit . At this limit, the off-resonant part of the Hamiltonian can be neglected by the rotating wave approximation (RWA). 
Mechanical parametric modulation
In addition to the ideal optomechanical interaction, mechanical parametric modulation is observed in the experiment. This spurious mechanical parametric effect can be induced by thermal effects or nonlinearities . To take this effect into account, we phenomenologically include the mechanical parametric interaction  
where  is the amplitude of the parametric interaction,  is the relative phase between the parametric drive and the squeezing pump. 
Quantum Langevin equations
The linearized quantum Langevin equations read 
d&=-(2-i)d+i(G_-b+G_+b^)+d_in,  
b&=-(_m2-i)b-i2e^-ib^+i(G_-d+G_+d^)+_mb_in .  
Here, 
is the total input noise of the cavity, where  describes the input fluctuations to the cavity from channel  with damping rate .  and  correspond to the left and right microwave cavity ports, while  corresponds to internal losses. The noise operator  describes
quantum and thermal noise of the mechanical oscillator with intrinsic damping rate . The input field operators satisfy the following commutation relations:   
where  is the photon occupation in port
, and 
is the thermal occupation of the mechanical oscillator. The total
occupation of the cavity is the weighted sum of the contributions from
different channels: . 
Optomechanical output spectrum and mechanical spectrum
In this section, we derive the optomechanical output spectrum and the mechanical quadrature spectrum. For this, we solve the quantum Langevin equations (Eqs. , ) in Fourier space. It is convenient to define the vectors ,
and
. We then find the following solution to the quantum Langevin equations in frequency space:  
where    
In the experiment, we measure the output microwave spectrum through the undriven (right) cavity port. One finds the output field  using the input-output relation . This yields 
d_R,out()= d_R,in()-_R([])_11d_in-_R([])_12d_in^
 & -_R_m([])_13b_in-_R_m([])_14b_in^. 
The transmission spectrum (driven response) is  
The symmetric noise spectral density is  
where  
The mechanical quadrature spectrum is  
where .  The quadrature variance is given by the integral   
In some pump configurations, we can simplify the results. For , the expressions can be simplified to   
where . For both  and , the mechanical quadrature spectra and the quadrature variances are   
in the regime , Eq. () reduced to Eq. (4) in the main text. 
Measurement circuit 
The schematic of the measurement circuit is shown in Fig.  We cool the device with a dilution refrigerator to 10 mK. In the experiment, up to four microwave drive tones are applied to the device. Since the excess phase noise from the microwave sources at the cavity resonance can excite the cavity and degrade the squeezing. In order to avoid extra heating from the phase noise of the sources, a tunable notch filter cavity is used to provide more than 50 dB noise rejection at the cavity resonance frequency . The input microwave pumps are then attenuated by about 40 dB at different temperature stages in the cryostat to dissipate the Johnson noise from higher temperature, keeping the input microwave noise at the shot noise level. The output signal passes through two cryocirculators at 50mK, then amplified by a cryogenic high electron-mobility transistor amplifier (HEMT) at 4.2 K and a low noise amplifier at room temperature for analysis. During the measurement of the noise spectrum, we continuously monitor the phase difference between the squeezing pumps and the BAE probes. The beat tones of the pumps and the probes are acquired by microwave detection diodes, then fed into the sub-harmonic circuits to halve the frequencies. The relative phase between the resulting beat tones are compared and measured by the lock-in. A computer is used to generate the error signal and feedback to the sources to keep the phase drift within half degrees.   
Calibrations 
Calibration of the squeezing output spectrum   
In the experiment, we spend an equal time interleaving measurement
to measure the pumped noise spectrum 
and the unpumped noise spectrum  at
the output of the measurement chain. The unpumped noise spectrum 
is the noise floor of the system which is dominated by the noise figure
of the cryogenic HEMT amplifier. The difference of the pumped and unpumped noise
spectra is related to the output noise spectrum of the optomechanical
system by  
where  is the gain of the measurement
chain around the reonance of the cavity and  is the coupling
rate to the output port of the device. In order
to fit the measured spectrum 
to extract the detuning  and , the linewidths  and , occupation factors and ,
we need an independent measurement to extract the enhanced optomechanical
coupling rate  and the gain factor . 
Besides the noise spectrum, we also measure the transmitted power of the drive tones at the output of the measurement chain , which is related to the intracavity pump photon number by  
where  are the correction factors due to the parasitic channel . The square of the enhanced optomechanical couplings are related linearly to the transmitted pump powers by  
where the calibration factors . Therefore, we can convert the measured transmitted powers of the drive tones to the enhanced optomechanical couplings with the calibration factors . In the following, we will describe the procedures to extract the calibration factors. 
We start with the calibration of the enhanced optomechanical coupling  induced by the red detuned tone. To do that, a single red detuned tone is applied at  with transmitted power  (Fig. a). Then, a network analyzer is used to generate a weak probe and sweep it through the center of the cavity resonance to measure the transmission spectrum of the mechanical sideband. The enhanced optomechanical coupling rate  can be extracted by fitting the transmission spectrum with the optomechanical model (). By measuring the transmission spectrum with various transmitted power  and fitting with the linear relation () (the red line in Fig. c), we obtain the calibration . 
A similar method can be used to calibrate the enhanced optomechanical coupling  induced by the blue detuned tone. In this case, a blue detuned tone is placed at  with transmitted power , where . Since the blue detuned tone would amplify the mechanical motion and narrow the mechanical linewidth, the mechanical resonator becomes unstable when the cooperativity  approaches to unity. In order to keep the mechanics stable, a constant red detuned tone is applied at  to damp the mechanical motion (Fig. b).
Similar to the calibration of , we use a network analyzer to measure the transmission spectrum of the mechanical sidebands. Then we can extract the enhanced optomechanical coupling rate  by fitting the transmission spectrum with the optomechanical model (). By measuring the transmission spectrum with various transmitted power  and fitting with the linear relation () (the blue line in Fig. c), we obtain the calibration . 
After calibrating the enhanced optomechanical coupling rates, in order to fit the measured noise spectrum with the optomechanical model, the last thing we need is the gain factor . Which can be obtained by the thermal calibration of the motional sideband noise power. To do that, a single red detuned tone is placed at  with sufficiently small pump power  such that the optomechanical damping effect is negligible . We then measure the noise power of the up-converted motional sideband , over a range of calibrated cryostat temperature  (Fig. d). Due to the weak temperature dependence of the cavity linewidth , we monitor the cavity linewidth at each measurement temperature. The resulting normalized sideband power is given by  
where  is the detuning of the pump, which is equal to zero in this case,  is the average value of the cavity linewidth over the respective temperatures and  is the thermal calibration. The linear fit in Fig. d gives , which enable us to convert the normalized noise power into quanta. The gain factor is given by the ratio of the thermal calibration  and the calibration of the enhanced optomechanical coupling  (i.e. ). With the calibrations discussed above, we can relate the measured noise spectrum and transmitted powers to the optomechanical model  
which enable us to extract , , , ,  and  from the measured output noise spectrum. 
Calibration of the backaction evasion spectrum   
In our experiment, we perform an additional BAE measurement away from the cavity resonance to directly and independently measure the mechanical quadratures. Since the detuning of the BAE sideband from the cavity resonance  is comparable to the cavity linewidth, in order to precisely balance the BAE tones and correctly interpret the BAE noise spectrum, an independent calibrations of the enhanced optomechanical coupling rate  and the normalized sideband power are necessary. 
We follow the same procedures in the last section to calibrate the BAE measurement, the only difference is the frequency of the drive tones. Fig. a(b) is the pump configuration in calibration of the enhanced optomechanical coupling rate (). The results of the calibrations are shown in Fig. c. From the linear fits, we get  and . Fig. d is the calibration of the normalized motional sideband power corresponds to a single red detuned tone at . The linear fit in Fig. 3d gives .   
Similar to the measurement of the squeezing output spectrum, we spend an equal time interleaving measurement to measure the pumped and unpumped noise spectrum in the BAE measurement. After subtracting the unpumped noise spectrum to remove the noise floor, the noise spectrum of the BAE sideband is given by  
the first term  is the noise spectrum of the microwave resonator due to the non-zero cavity occupations and the second term  is the noise spectrum of the BAE sideband, which is given by  
where  is the mechanical quadrature spectrum. Because the BAE sideband is detuned from the cavity resonance with detuning comparable to the cavity linewidth, over the bandwidth of the BAE measurement, the cavity noise appears as a frequency dependent noise background. An example of the spectrum is given by Fig. , a quadratic polynomial is employed to fit the cavity noise background, as shown by the red curve in Fig. . The BAE sideband spectrum  is given by  subtracting the noise spectrum from the fitted cavity noise background and the BAE sideband noise power is given by integrating Eq. ()  
With the thermal calibtration factor , we can convert the normalized BAE sideband power to the quadrature variance  
Analysis of the mechanical parametric effect 
In this section, we will describe the procedures to extract the mechanical parametric interaction from the measured quadrature linewidth data. As shown in the theory section, for given pump configurations , thermal occupations  and mechanical parametric interaction , the mechanical quadrature spectrum  can be calculated by Eq. (). The mechanical quadrature linewidth is given by fitting the predicted mechanical quadrature spectrum with a Lorentzian curve, as shown in Fig. . 
Using the pump configurations and thermal occupations extracted from the corresponding output spectra (Fig. 1f,g in the main text), the quadrature linewidth can be written as a function of the probe phase , the amplitude  and the phase  of the parametric drive (i.e. ). Then we can extract the mechanical parametric interaction  by fitting the measured mechanical quadrature linewidth in the BAE measurement with the function . 
As discussed in the main text, we assume the phase of the parametric drive  follows the phase of the BAE probe  (i.e. , where  is a constant phase shift). The amplitude  and the constant phase shift  can be extracted by fitting the quadrature linewidth data with the function , the fit results are shown by the dashed curves in Fig. a. From the fit, we extract Hz,  for the weakly squeezed state (red dashed curve) and kHz,  for the strong squeezed state (blue dashed curve). Under this assumption, the model captures the observed phase dependence behavior of the quadrature linewidth in the BAE measurement. With the extracted mechanical parametric drive, the corresponding quadrature variances can be calculated by Eq. (), as shown by the dashed curves in Fig. b. On the other hand, if we assume the mechanical parametric drive is induced by the squeezing pump (i.e. ), the function  doesn't capture the observed phase dependence behavior of the mechanical quadrature linewidth, as shown by the solid curves in Fig. a. These results imply that the observed mechanical parametric interaction is induced by the BAE probes instead of the squeezing pumps..    
   
colorlinks=true, linkcolor=blue, citecolor=blue, urlcolor=blue    
   
Quantum-coherent phase oscillations in synchronization 
Talitha Weiss
Stefan Walter
Florian Marquardt 
Friedrich-Alexander University Erlangen-Nurnberg (FAU), Department of Physics, Staudtstrasse 7, 91058 Erlangen, Germany  
and Max Planck Institute for the Science of Light, Staudtstrasse 2, 91058 Erlangen, Germany  
05.45.Xt, 03.65.-w, 42.50.-p  
Recently, several studies have investigated synchronization in quantum-mechanical limit-cycle oscillators. However, the quantum nature of these systems remained partially hidden, since the dynamics of the oscillator's phase was overdamped and therefore incoherent. We show that there exist regimes of underdamped and even quantum-coherent phase motion, opening up new possibilities to study quantum synchronization dynamics. To this end, we investigate the Van der Pol oscillator (a paradigm for a self-oscillating system) synchronized to an external drive. We derive an effective quantum model which fully describes the regime of underdamped phase motion and additionally allows us to identify the quality of quantum coherence. Finally, we identify quantum limit cycles of the phase itself.   
Introduction.--  
Synchronization is commonly studied in so-called limit cycle (LC) oscillators that arise from an interplay of linear and nonlinear effects . For instance, linear amplification causes an instability, whereas nonlinear damping limits the oscillator's dynamics to a finite amplitude. Notably, the phase remains free, which allows synchronization of the oscillator to an external periodic drive or other LC oscillators. A transition from the intrinsic LC motion towards synchronized oscillations occurs depending on the coupling strength to (and frequency mismatch of) the external reference.  
Quantum synchronization, i.e., the study of quantum systems whose classical counterparts synchronize, has recently attracted increasing theoretical attention. So far, studies of quantum synchronization have only explored overdamped phase motion. This implies that the dynamics, although taking place in quantum systems, remains always incoherent and classical-like, ruling out the observation of interesting effects like quantum tunnelling or superposition states of different synchronization phases. In the present article, we discover quantum-coherent phase dynamics.  
Theoretical studies of quantum synchronization have been performed for different platforms, including optomechanics , atoms and ions  , Van der Pol (VdP) oscillators , and superconducting devices . Measures of synchronization in the presence of quantum noise have been proposed in Refs. .  
On the experimental side, only classical synchronization has been studied so far for a wide range of systems , including more recently  optomechanical systems . In the well-developed field of classical synchronization, overdamped phase motion is the standard ingredient both of phenomenological equations and microscopically derived models. For example, locking to an external force is described by the so-called Adler equation, a first-order differential equation for the phase. Similarly, synchronized optomechanical systems are described by the first-order phase equation of the Hopf-Kuramoto model . However, it has been noticed that classical synchronization also allows for underdamped phase dynamics. For instance, the classical VdP oscillator features underdamped phase motion and even (synchronized) phase self-oscillations . Both regimes have recently been observed experimentally using a nanoelectromechanical system . Classical phase self-oscillations, also called phase trapping, have also been observed with coupled laser modes . Furthermore, synchronized Josephson junction arrays can be mapped to the Kuramoto model including inertia .  
Here we will show that a regime of quantum-coherent dynamics exists and that underdamped phase dynamics is a necessary but not sufficient condition to observe this regime. Rather, it is the dynamically generated non-equilibrium dephasing rate that has to become smaller than the oscillation frequency. Additionally, we identify phase self-oscillations in the quantum regime.  
We obtain these insights for a paradigmatic model, the quantum version of the VdP oscillator subject to an external drive. The synchronization of the VdP oscillator to this external drive is an excellent test case to investigate universal synchronization behaviour. We derive an effective quantum model that captures the regime of underdamped phase dynamics. This allows us to identify a quality factor for the quantum coherence. We illustrate the potentially long coherence times by showing that initial negativities of a Wigner density vanish slowly. Finally, we briefly discuss possible experimental realizations.  
Quantum model.--    
The quantum VdP oscillator subject to an external drive is described by the master equation ()  
	 = -i[-b^b+iF(b-b^), ] + _1 D[b^] + _2 D[b^2]  ,  
with . Here,  is the detuning of the oscillator's natural frequency  from the frequency of the external drive  and  is the driving force. The two dissipative terms in Eq. () describe gain and loss of one and two quanta at rates  and , respectively. 
In Fig.  we show the steady-state Wigner function along with the corresponding phase probability distribution   by numerically solving Eq. () for its steady state . In the absence of an external force (), the two competing dissipation rates  and  lead to LC motion of the VdP oscillator, Fig. (a). For a finite applied force () and sufficiently small detuning , the VdP oscillator synchronizes to the external force and a fixed phase relation between the VdP oscillator and the force is present. In the rotating frame, this corresponds to a localized Wigner density and a phase distribution  with a distinct peak. With increasing detuning, the VdP oscillator is less synchronized to the external force [related to the height and width of ] and the synchronization phase [peak position of ] is shifted, Fig. (b). 
These steady-state properties do not provide any information on the underlying synchronization dynamics, especially if we are trying to discover possible underdamped and quantum-coherent phase dynamics. To test for these regimes, we now derive an effective quantum model.  
Effective quantum model.--    
In the synchronized regime, the classical equation of motion for ,  
	=i+_122^2 ,  
has a stable fixed point . We linearize Eq. () around  by defining , where  describes fluctuations around .
Neglecting terms of order  and higher, we obtain  
	_eff = -i [ H_eff, _eff ] + _1D[b^]_eff + 4_2_ss^2D[b]_eff  ,  
with the effective Hamiltonian  
	H_eff=-b^b-i_22(_ss^2b^b^-_ss^*2bb)  .  
This effective model captures the major features of the full quantum model and thus allows at least qualitative predictions about the behaviour of the system, while quantitative agreement varies with parameters. A comparison of the outcomes of Eqs. () and () can be found in the Supplemental Material . The effective model is a squeezing Hamiltonian where the amount of squeezing depends on the classical steady-state solution .     
    
* 
Diagonalizing Eq. () leads to   
	H_diag=-_effc^c+const.  .   
Here, , , , and   is the effective frequency. The corresponding master equation reads  
	_diag = -i [ H_diag, _diag ] + _D[c^]_diag + _D[c]_diag  ,   
with , , and neglecting fast rotating terms, such as . The diagonalized, effective model is a damped harmonic oscillator with frequency  and damping . This unambiguously allows us to identify an underdamped phase dynamics regime following the standard procedure for a harmonic oscillator, i.e., we require , which leads to a real-valued effective frequency . This is consistent with the corresponding classical dynamics derived from Eq. (), leading to a second-order differential equation of the phase,  
	 +  + ^2 = 0  .   
Here,  describes phase deviations from the steady-state phase  and  is the bare frequency which is related to the effective frequency ; cf. .  
Before we discuss results from our effective quantum model, we briefly review the relevant features of the corresponding classical ``phase diagram'' of synchronization, Fig. (a). 
This phase diagram and its quantum analogue will help us to identify the parameter regime of underdamped phase motion, where we then can check for quantum coherence.
We obtain the boundaries between the regimes of the classical phase dynamics from a linear stability analysis of Eq. (); cf. . Notably, we distinguish two qualitatively different transitions from synchronization to no synchronization: 
At small forces, a saddle-node bifurcation characterizes the transition from synchronized (overdamped) dynamics directly to the LC regime. At larger forces, a regime of underdamped phase motion opens up before a Hopf bifurcation marks the onset of a LC which does not necessarily encircle the origin.   
Since we are actually interested in a quantum regime, it is worthwhile to see that these two qualitatively different transitions have also important consequences for the quantum dynamics.  In particular, we find a qualitative change of behaviour in the squeezing properties of the steady state. 
Since  is quadratic in  the system is fully characterized by its covariance matrix  with the quadratures  and . The eigenvalues  of the covariance matrix determine the shape of the squeezing ellipse . 
Their ratio (the asymmetry of the ellipses) is shown in Fig. (b). Notably, at small forces, it increases with larger detuning. In contrast, at larger forces where we predict underdamped phase dynamics, the ellipses become more circular while increasing the detuning . 
Thus, the squeezing behaviour can be used as an indicator for the existence of a quantum regime of underdamped phase motion. 
The effective model becomes unstable if , which corresponds to the classical fixed point losing its stability. Additional details on squeezing can be found in the Supplemental Material .  
Quantum coherence.-- 
Studying the effective model, we have identified the quantum regime of underdamped phase motion. Now we demonstrate that within this regime, it is possible to preserve quantum coherence for a significant time. To this end, we choose an initial state which possesses negativities in its Wigner function, Fig. (a), and show that these negativities persist for a long time compared to the characteristic timescale of the dynamics . The dynamics due to Eq. () leads to a rotation of the state around the classical steady state , Fig. (b). Notably, this dynamical evolution has little influence on the coherence and the negativities of the Wigner density survive many oscillations of the system, Fig. (c). After the loss of coherence, the state remains in a classical mixture of two displaced states and settles into the steady state only on an even longer timescale; see Ref.  for a complete overview. All Wigner densities in Figs. (a)-(c) are obtained by numerically solving the full master equation (). 
This behaviour is successfully predicted by our effective model, which allows us to quantify quantum coherence within the underdamped regime and eventually identify a quantum-coherent regime. The time scale on which the quantum system approaches the steady state is approximately given by the damping . Thus, a necessary condition to observe quantum-coherent motion is . Approaching the classical Hopf bifurcation,
the damping  becomes arbitrarily small. However, a small damping does not imply a small dephasing rate . The dephasing rate ultimately determines the lifetime of negativities, i.e., quantum coherence. With  and , the dephasing rate  depends on both the damping  and the effective occupation of the VdP oscillator . This effective occupation comes about due to the driven-dissipative character of the quantum oscillator even at zero environmental temperature, also called quantum heating . It increases towards the boundaries of the underdamped regime, Fig. (d), counteracting the decreasing damping.  
Additional insight is obtained by identifying a quality factor for quantum coherence, , which determines the lifetime of negativities in the Wigner density. Close to the instability and, more importantly, at large forcing and detuning,  increases and can become significantly larger than , Fig. (e). This is the quantum-coherent regime where negativities of the Wigner density can survive many oscillations of the system, Fig. (c). 
Regarding Fig. (e), the only remaining dimensionless parameter (apart from the normalized force and detuning) is the ratio of the damping rates . It influences the region of stability of the effective model. For instance, increasing  shifts the instability () to larger detuning. This allows to achieve a comparable quality factor  at smaller forcing but similar detuning - mainly because  increases with . 
In Figs. (f) and (g) we show all relevant rates in the underdamped regime at small and large forcings, respectively. In both cases  increases, while  and  decrease with larger detuning. At small force, Fig. (f), the dephasing rate remains the largest rate in the entire underdamped regime. Notably, for large , Fig. (g), we find that  can become significantly larger than both  and , thus entering the quantum-coherent regime. This is the key element to observing long-lived quantum coherence.  
Spectrum.-- 
To shed more light on the possibility to experimentally observe the transition from overdamped to underdamped synchronization dynamics, we investigate the spectrum . We obtain  from the steady state of Eq. () by applying the quantum regression theorem or analytically from the effective model; see Supplemental Material . The spectrum carries information on the frequencies of the driven VdP oscillator. 
Figure (a) shows  for a fixed external force and various detunings, corresponding to the overdamped (upper black spectrum) and underdamped (middle blue, lower red spectra) regime. In the overdamped regime the spectrum shows a single peak close to , indicating synchronization to the external force. With increasing detuning, the spectrum develops from a single peak to two peaks which now sit at approximately . A small remainder of the central peak at  becomes visible for a larger splitting of the main peaks. The emerging double peaks clearly indicate the transition from overdamped to underdamped phase dynamics, Fig. (b). The increasing asymmetry of  results from the coupling of amplitude and phase dynamics.    
For even larger detuning, synchronization is lost which ultimately leads to a single peak in the spectrum at . 
A recent experiment synchronized two nanomechanical oscillators by coupling to a common cavity mode . Curiously, the cavity output spectrum showed sidebands next to the common frequency of the locked oscillators. These sidebands were suggested to arise from (classical) underdamped phase motion of the oscillators, which is also consistent with the classical limit of our theory. 
Interestingly, we find that the phase can even undergo self-oscillations. In the quantum regime, these phase self-oscillations appear (in analogy to the classical scenario) at the boundary of underdamped phase motion just before the loss of synchronization occurs. A circular LC opens up around the former stable fixed point. In the quantum regime this is smeared by quantum fluctuations and becomes visible only once the LC is large enough. If that LC expands even further, it will eventually come to resemble the original unsynchronized state: The LC encircles the origin of phase space and the corresponding phase distribution is flat, Fig. (a). However, in Fig. (c), this is not yet the case, i.e., the LC does not encircle the origin. The oscillator has still a tendency to be locked to the phase of the external force. This is also reflected in the corresponding phase distribution  which becomes asymmetric and shows the onset of a double peak structure.  
Notably, phase self-oscillations are accompanied by the appearance of a series of peaks in the spectrum, Fig. (d), representing higher harmonics of the main phase-oscillation frequency.   
Experimental realization.-- 
The regime of underdamped quantum phase motion and even quantum phase self-oscillations could be experimentally studied in a variety of systems. 
For instance, trapped ions are promising candidate systems for studying synchronization in the quantum regime . The possibility to prepare nonclassical states experimentally  allows for probing the quantum-coherent nature of the underdamped phase dynamics. Based on parameters for trapped  ions , we estimate that it should be possible to observe significant quantum coherence. 
In this scenario, the negative and nonlinear damping are both of the order of  kHz, with . To observe quantum-coherent underdamepd phase dynamics the detuning  and the external force  should be a few hundred kHz each. This is realistic, with frequencies of the motional state in the MHz regime.   
Furthermore, mechanical self-oscillations in cavity optomechanics have been discussed theoretically  and observed experimentally . Thus, they are well-suited to study synchronization, and classical synchronization phenomena have already been demonstrated experimentally . 
Yet another possible platform to observe quantum-coherent phase motion are superconducting 
microwave circuits. These are exceptional and highly tuneable platforms for experimentally investigating quantum systems. In principle, arbitrary quantum states can be realized . Even, the faithful engineering of two-photon losses in such systems has been demonstrated . This makes them very interesting for studying quantum-coherent phase motion and phase self-oscillations of a quantum VdP oscillator.  
Conclusion.-- 
We have shown that the phase of a synchronized quantum Van der Pol oscillator exhibits intriguing underdamped and even quantum-coherent phase
dynamics around the synchronized steady state. In order to explore this interesting regime, we have developed an effective quantum model and identified where the dephasing rate becomes sufficiently small to observe quantum-coherent phase motion. As a direct consequence, we have shown that this preserves a nonclassical quantum state for many phase oscillations. We estimate that this could readily be observed in state-of-the-art experiments. 
While we have analyzed the simplest synchronization phenomenon, to an external drive, the regime identified here will also show up in the quantum phase dynamics of two coupled oscillators or even lattices . In the latter case, phenomena such as quantum motion of phase vortices may potentially become observable.  
Acknowledgements: We acknowledge financial support by the Marie Curie ITN cQOM and the ERC OPTOMECH.  
apsrev4-1 
0  
        Supplemental Material for ``Quantum-coherent phase oscillations in synchronization''  
        Talitha Weiss, Stefan Walter, and Florian Marquardt  
        Friedrich-Alexander University Erlangen-Nurnberg (FAU), Department of Physics, Staudtstrasse 7, 91058 Erlangen, Germany 
        and Max Planck Institute for the Science of Light,
Staudtstrasse 2, 91058 Erlangen, Germany   
Details on the classical synchronization phase diagram    
   
Here, we discuss some additional details of the classical phase diagram of a Van der Pol (VdP) oscillator synchronizing to an external force, cf. Fig. 2(a) of the main text.
The boundaries for the regimes of overdamped, underdamped, and limit-cycle motion are obtained from a linear stability analysis of Eq. (2) of the main text (see for instance also Ref.  for more details). Using  and keeping only first order terms of , the linearized equation of motion is   
	2_ss^2^*+_122_ss^2.  
The eigenvalues  of the corresponding Jacobi matrix are related to damping and effective frequency of the VdP oscillator and contain information about the properties of the corresponding fixed point . 
In Fig. , we show the real and imaginary part of the eigenvalues . Note that, depending on parameters, Eq. () features either one or three fixed points. However, if there are three fixed points, see Fig. (a), only one of them is stable. We show the real and imaginary parts of the eigenvalues of a stable fixed point as solid lines and the eigenvalues corresponding to unstable fixed points as dashed lines. Note that in the synchronized regimes (both overdamped and underdamped) synchronization towards the stable fixed point occurs.  
The phase diagram, cf. Fig. 2(a) of the main text, shows that the regime of limit-cycle motion can be entered via two different types of bifurcations which we show here in detail:
In Fig. (a) the regime of limit-cycle motion is entered via a saddle-node bifurcation, while in Fig. (b) a Hopf bifurcation marks the onset of limit-cycle oscillations. In both cases a single, unstable fixed point exists in the limit-cycle regime, i.e., the corresponding real parts of the eigenvalues, associated to damping, are positive. This indicates amplification and the stabilizing, nonlinear effects that lead to a limit cycle are not included in the linear stability analysis. 
At smaller detuning, before the limit-cycle regime, synchronization towards a stable fixed point occurs. 
The important difference between the two possible transitions is determined by the imaginary part of the eigenvalues of this stable fixed point. The imaginary part is related to the oscillation frequency and approaching the saddle-node bifurcation, the imaginary parts remain zero. This implies that, for detunings below the bifurcation, no characteristic oscillation frequency exists. The non-zero imaginary parts visible in Fig. (a) belong to unstable fixed points, which are not of importance in the context of synchronization.
In contrast, at larger force, Fig. (b), a Belyakov-Devaney transition  occurs even before the Hopf bifurcation. There the real parts of the eigenvalues become equal but remain negative (i.e. there exists a stable fixed point), yet the imaginary parts become nonzero. This implies that in this case the steady state is approached in an oscillatory fashion and determines the regime of underdamped phase motion. Only at even larger detuning a Hopf bifurcation occurs where the real parts become positive as well and a limit cycle is created.  
The boundaries between the different regimes of classical synchronization phase dynamics are determined by the following explicit expressions:
 a saddle-node bifurcation given by ,
 a transition from a stable node to a stable focus (Belyakov-Devaney transition) which is defined by 
with ,
and  a Hopf bifurcation described by 
with .
Note that this linear analysis does not allow us to distinguish between stable self-oscillations of the phase (limit cycles not evolving around the origin) and ordinary limit cycles where the phase is monotonously increasing.    
Classical dynamics of the effective quantum model  
The effective quantum model, Eq. (3) of the main text, allows us to discuss the corresponding classical dynamics which is given by
. This is equivalent to the linearized equation () confirming that we have indeed derived the correct linearized quantum model.
It is instructive to consider to first split the complex amplitude  into amplitude  and phase  such that , and then obtain the corresponding equations for the amplitude and phase deviations  and . These deviations are simply defined as the difference between the actual amplitude  (phase ) from the steady-state amplitude  (steady-state phase ), i.e. 
and .
Since  and  are small,  is approximately the change in direction of  and  is
approximately the change perpendicular to this. For  we then obtain 
and  and with this  
		&=  R-(_2R_ss^2-_12)  ,  
	R	&= -(3_2R_ss^2-_12) R -  ,   
which can be combined to a second-order differential equation for the phase,   
	 +  + ^2 = 0  .  
Here we have defined 
and . 
Notably Eq. () is describes a common harmonic oscillator which allows for overdamped as well as underdamped motion. The transition from overdamped to underdamped solutions is characterized
by , i.e. where the effective oscillation frequency of the system  becomes real-valued. 
The solution to Eq. () becomes unstable if , revealing the onset of limit-cycle motion. The limit-cycle motion itself depends on nonlinear effects to stabilize and thus cannot be described with the linearized equations. 
The parameters  and  obtained from this classical analysis are equal to the damping and effective frequency appearing in the effective quantum model.  
Comparison of the full and the effective quantum model    
Here we compare results from the full quantum model, Eq. (1) of the main text, to results from the e�ffective model, Eq. (3) of the main text, and the outcome of the classical equations () and (). In Fig. (a) and (b) we show the steady-state Wigner density obtained from the full quantum model and the effective model respectively. The result of the effective model needs to be displaced to the classical steady state , indicated by the white cross. The Wigner densities obtained from the full and the effective quantum model match reasonably well. The parameters were chosen such that first deviations become visible: (i) The Wigner density of the full model is no longer centered exactly around the classical solution , while the effective model does so by construction. (ii) The effective quantum model is described by a squeezing Hamiltonian, cf. main text. Thus the corresponding Wigner densities are ellipses, while the full model can lead to additional curvature in the Wigner density (more banana-shaped). 
Within the effective model synchronization attracts the system's dynamics towards the stable fixed point . We can capture the dynamics using small deviations around . A natural choice are deviations in radial direction, , and in phase direction, , similar to the classical treatment. We can define corresponding operators  in radial direction and perpendicular to it, .
With this, deviations of the phase can be approximated via  such that the full phase is given by .
We show the phase as a function of time in Fig. (c). The system shows underdamped phase motion, i.e. a few damped oscillations can be observed in the full and effective quantum model, as well as in the classical simulation. It is consistent with the corresponding Wigner densities, that the trajectories of the full and effective quantum model are damped towards a different steady state. Only the steady state of the effective quantum model and the classical equations are equal by construction. Note that the relation of  to the phase deviations  is only accurate if the deviations are small. In Fig. (d) we show the variance  as a function of detuning. For small  synchronization works best, i.e. the Wigner density is more confined in phase space and thus the resulting variance is small. Deviations between the full and effective quantum model appear with increasing detuning. Then, synchronization becomes weaker and the full model can develop a less ellipse-like Wigner density. Approaching the Hopf bifurcation the variance within the effective model blows up, signalling the break-down of the model. The full model shows an increasing variance, which is consistent with the synchronization becoming weaker and the Wigner density becoming more smeared out.   
Details on the squeezing    
In the main text we derived the squeezing Hamiltonian of our effective model, Eq. (4) of the main text, and discussed the asymmetry of the squeezing ellipses in Fig. 2(b) of the main text. Due to the quadratic Hamiltonian, the state is fully characterized by its covariance matrix  with the quadratures  and  (same definition as in the main text). 
The equation of motion for the covariance matrix can be expressed in the following form,  
with the matrices  
	M&= i(r-r^*)+_1/2-2_2_ss^2 & r+r^*-
 r+r^*+& -i(r-r^*)+_1/2-2_2 _ss^2 
	D&= _1/2+2_2_ss^2&  
 & _1/2+2_2_ss^2 . 
Here we used  for brevity. The steady-state solution to this equation of motion, , can be analytically obtained, resulting in a  matrix  that depends only on system parameters and the classical steady-state amplitude . Then, the eigenvalues of the covariance matrix  can be calculated and analyzed.
The ratio of these eigenvalues determines the asymmetry of the squeezing ellipses discussed in the main text. However, also the absolute amount of squeezing can be analyzed by comparing to the size of the vacuum state. If any direction of the squeezing ellipse becomes smaller than the width of the vacuum state this is referred to as squeezing below shot noise. To this end, we calculate the shot-noise covariance matrix , which is diagonal and has  as doubly degenerate eigenvalue. We compare this to the smallest eigenvalue  of the covariance matrix of the synchronized VdP oscillator. Squeezing below shot noise occurs for values . 
Interestingly, the synchronized VdP oscillator does feature squeezing below shot noise at small detuning and sufficiently large forcing.  As shown in Fig. , for a fixed detuning, squeezing becomes stronger if the external force  is increased, eventually dropping below the shot noise value. In combination with Fig. 2(b) of the main text we conclude that approximately the radial direction is squeezed. Since squeezing below the shot noise level occurs mainly at small detuning, it occurs mostly within the regime of overdamped phase motion, but can reach into the underdamped regime as well. However, approaching the classical Hopf bifurcation, i.e., the instability of the effective model, by increasing the detuning , the squeezing necessarily decreases since the Wigner density smoothly transforms back into a (circular) limit cycle. 
This parameter dependence of the absolute squeezing can also be directly explained from the squeezing Hamiltonian, Eq. (4) of the main text. At first sight squeezing depends on the steady state of the system, i.e., , and thus has an intricate dependence on all parameters. However, we generally observe that large forcing  leads to large values of . Notably, the squeezing Hamiltonian does not depend on this absolute value, but on the complex value  instead. Investigating the steady state Wigner density of the synchronized VdP oscillator, we observed in Fig. 1(b) of the main text a crucial dependence on the detuning: Although the value  does slightly decrease with , the more important effect is a rotation in phase space, corresponding to a change of the synchronization phase. Thereby  transforms from an almost real quantity to an almost purely imaginary quantity, thus significantly decreasing the real part of  even if its modulus would be conserved completely. 
Therefore, we can conclude that large squeezing appears if the force is sufficiently large compared to the detuning such that the synchronization phase (the peak position of the phase distribution) is close to the ideal value of  or .  
Long time evolution of coherent synchronization dynamics  
In the section 'Quantum coherence' in the main text we discuss that the synchronization dynamics can preserve quantum coherence for a significant number of oscillations of the system. 
Here, in Fig. , we want to show how an initially prepared superposition state loses coherence and finally relaxes to the synchronized steady state. We numerically simulate the full quantum model to stress that this behaviour, expected due to a sufficiently small dephasing rate obtained from our effective quantum model, can indeed be observed (although quantitative deviations occur). The beginning of this time evolution is also shown and described in Fig. 3(a)-(c) of the main text, but will be repeated here for completeness.  
Starting with a superposition state, Fig. (a), the Wigner density shows interference fringes with negativities. The synchronization dynamics described by the full master equation (1) of the main text, leads to rotations around the classical steady state (yellow cross), Fig. (b). The frequency of these oscillations is, approximately, given by  determined from the effective model. Due to dephasing, the interference fringes start to fade out, Fig. (c), (f) and (g), and disappear after many oscillations of the system. Fig. (c) shows a snapshot after almost  oscillations, where the clear interference fringes have disappeared and only a small area of  slightly negative Wigner density values remains. However, the system is still far from its steady state, because the timescale set by the dephasing can be vastly different from the timescale set by the damping rate. In the example shown here, the state becomes a classical mixture of two displaced states first. Those displaced states merge at much later times,  Fig. (d), and finally form the synchronized steady state of the system,  Fig. (e).  Fig. (f) and (g) show cuts along the momentum axis of the Wigner densities as a function of time. The damping, i.e. the relaxing towards the steady state, can be viewed best in  the long time evolution Fig. (f). To clearly see the dephasing, i.e. the loss of coherence in form of vanishing negativities in the Wigner density,  Fig. (g) zooms into the first part of the long time evolution.    
    
Analytical spectrum  
In the over- and underdamped regime we can also obtain the spectrum 
from the analytical solution to our effective model. We start from Eq. (4) of the main text, the squeezing Hamiltonian, and write down the quantum Langevine equations,  
	b&= ib-2b-_22_ss^2b^+ ,  
	b^&= -ib^2b^_22_ss^*2b+^.  
Here the noise operators  and  represent white noise, fulfilling  and  and  is obtained from the dissipation rates of Eq. (3) in the main text, i.e. we identified  and . Eqs. () and () are easily solved in Fourier space where the problem simplifies to finding the inverse of a -matrix. Choosing the convention  and  we find  
*
	b()&=[-i(^2-(+i/2)^2-_2^2_ss^4()--_2_ss^2^2-(+i/2)^2-_2^2_ss^4^(-)  ,  
	b^()&=--_2_ss^*2^2-(+i/2)^2-_2^2_ss^4()+[-i(+)+/2]^2-(+i/2)^2-_2^2_ss^4^(-). 
Within the effective model the fluctuation spectrum  can be obtained from this solution by evaluating the relevant noise correlators. We find  
	S_eff()=_2^2_ss^4+n[(/2)^2+_2^2_ss^4+(+)^2][(^2-^2_ss^4)^2+(/2)^2][(+^2-^2_ss^4)^2+(/2)^2]. 
This spectrum features peaks close to .    
apsrev4-1 
99  
J. Kurths, A. Pikovsky, and M. Rosenblum,
Synchronization: A Universal Concept in Nonlinear Sciences (Cambridge University Press, 2001).  
H. W. Broer, B. Hasselblatt, and F. Takens,
Handbook of Dynamical Systems - Volume 3 (North Holland, 2010).    
colorlinks=true, linkcolor=blue, citecolor=blue   
     
Classical Dynamical Gauge Fields in Optomechanics 
Stefan Walter 
Florian Marquardt  
 Institute for Theoretical Physics, University Erlangen-Nurnberg, Staudtstrasse 7, 91058 Erlangen, Germany  
 Max Planck Institute for the Science of Light, Staudtstrasse 2, 91058 Erlangen, Germany  
42.50.Wk, 05.50.+q, 11.15.Kc   
Artificial gauge fields for neutral particles such as photons, recently attracted a lot of attention in various fields ranging from
photonic crystals to ultracold atoms in optical lattices to optomechanical arrays. Here we point out that, among all implementations
of gauge fields, the optomechanical setting allows for the most natural extension where the gauge field becomes dynamical.
The mechanical oscillation phases determine the effective artificial magnetic field for the photons, and once these phases
are allowed to evolve, they respond to the flow of photons in the structure. We discuss a simple three-site model where we
identify four different regimes of the gauge-field dynamics. Furthermore, we extend the discussion to a two-dimensional
lattice. Our proposed scheme could for instance be implemented using optomechanical crystals.   
Introduction 
Optomechanics describes the interaction of light and mechanical motion . The prototypical
optomechanical setting consists in a Fabry-Perot cavity where one of the mirrors is free to oscillate. Due to the
radiation pressure force the light inside the cavity interacts with the mirror's motion. 
Tremendous experimental progress has been made during the last years to exploit this very elementary light-matter
interaction, with achievements such as cooling a nanomechanical oscillator to its motional ground state 
and position measurements below the standard quantum limit , to name only a few examples.
Mechanically and/or optically coupling several optomechanical systems leads to interesting new physics. For
instance, setups consisting of only a few optical and mechanical modes allow for nonreciprocal devices for
photons . Furthermore, one- or two-dimensional arrays of
coupled optomechanical systems are promising candidate systems for studying many-body physics of photons
or phonons . 
Most interestingly, optomechanical arrays are also a platform to create artificial gauge fields for photons 
and phonons . The optomechanical implementation complements other proposals for generating artificial
gauge fields for photons 
and ultracold atoms in optical lattices . 
In this article, we study the most basic phonon-assisted photon tunneling process which is due to the optomechanical
interaction. We show that an elementary optomechanical setting naturally gives rise to dynamical gauge
fields. The key ingredient is a self-oscillating mechanical mode which connects two optical modes. Most importantly
this brings an additional degree of freedom into play, viz. the mechanical oscillation phase. This mechanical
oscillation phase is connected to an effective magnetic field seen by the photons and possesses its own dynamics. 
During the last years, several proposal have been put forward dealing with the deliberate generation of dynamical
gauge fields. Platforms based on ultracold atoms in optical lattices 
or superconducting circuits  are discussed as promising systems which could serve as
quantum simulators for dynamical gauge theories such as quantum electrodynamics and quantum chromodynamics . 
In most cases these proposals require a great deal of engineering, meaning carefully choosing a setting which yields
the desired interactions between for instance superconducting qubits. Instead we concentrate on the intriguing optomechanical
setting which gives rise to dynamical gauge fields in a very natural way. Particularly, in our scenario only basic phonon-assisted
photon tunneling processes generated via the basic optomechanical interaction are needed.
Besides the purpose of quantum simulation for dynamical gauge theories, the optomechanical setting opens up new
directions dealing with nonlinear pattern formation of dynamical gauge fields in driven and dissipative systems .  
In the following, we investigate the evolution of the mechanical oscillation phases (the dynamical gauge field) in response
to the light field dynamics, which is a unique feature of the optomechanical case.
We consider a photonic lattice (representing the matter fields) and artificial gauge fields (phonons) which can be
attributed to directed links between two sites of the photonic lattice. Such a system could for instance be implemented in
optomechanical crystal structures 
or disk resonator arrays .  
Generic Model for Dynamical Gauge Fields with Optomechanics 
The crucial ingredient in our model is the phonon-assisted photon tunneling that can be generated by the optomechanical
interaction: A photon  hopping from site to site is accompanied by the coherent emission or absorption of a phonon .
This can be described by the Hamiltonian ()  
	H =	_j _j^ a_j^ a_j^ + _l _l^ b_l^ b_l^ + _l J_l^ b_l^ a_l_2^ a_l_1^ +  .  
Here,  denotes a lattice site, and  is the index for a directed link from  to .
A photon hopping in the direction of the link absorbs a phonon. Photons (phonons) have frequencies 
(), and  are the phonon-assisted photon tunneling amplitudes. We introduce the notation
 and note that we use  and  interchangeably. In Eq. ()
we made use of the rotating wave approximation which is valid for , where  is the photon decay rate.  
Non-reciprocity in photon transport can be engineered by coherent inelastic transitions induced by mechanical
vibrations . However, in contrast to Ref. Schmidt2015b we will treat the vibrations as
dynamical degrees of freedom. In order to make the inelastic processes resonant, the nearest neighbor on-site
photon frequencies have to differ by the corresponding link phonon frequency ()
with the link direction from site  to . This leads to directed links. Generally speaking, a photon tunneling
from a site with a low (high) on-site frequency to a site with a high (low) on-site frequency absorbs (emits) a phonon.
We include photon losses at a rate  and account for driving by adding the term
 to Eq. (),
see .   
    
Our effective model, Fig.  a), can be realized in an optomechanical setting by building on the
``modulated link'' scheme that had been proposed to generate static artificial magnetic fields .
In this scheme, the link between two optical modes  and  is realized with an intermediate optical mode  which
couples optomechanically to a mechanical mode , forming a single optomechanical cell, cf. Fig.  b).
In Ref. Schmidt2015b the mechanical mode is externally driven into a large amplitude state 
which leads to a modulation of the frequency of the intermediate optical mode .
 is the single-photon optomechanical coupling strength. We note that other microscopic implementations are possible.
For example, one might have a mechanical mode that directly couples to the hopping between optical modes, as has been
worked out in detail for optomechanical crystals . This would be connected to the ``wavelength conversion
scheme'' discussed in Ref. Schmidt2015b. 
In contrast to these two scenarios, we will assume that the mechanical oscillator undergoes self-sustained optomechanical
oscillations  instead of being externally driven. Thus it behaves as a limit-cycle oscillator with a
fixed amplitude  and a free phase . We will later show that the phase of the mechanical limit-cycle oscillator
posses its own dynamics and that it will respond to the flow of photons in the system. This phase will then be directly
linked to a dynamical gauge field. We want to stress that such mechanical self-sustained oscillations are a very generic
feature of optomechnical systems. Therefore an optomechanical implementation of a dynamical gauge field requires
less engineering than other proposals .  
Gauge Field Dynamics 
Here we will focus on the classical dynamics of the model, i.e., the limit of large coherent photon and phonon amplitudes.
This is the most relevant regime for most of the current optomechanical setups (due to the small single-photon coupling
strength ) . Thus, we decompose the expectation values of the photon and phonon operators
into a classical amplitude and a phase,  and . From the full quantum
Heisenberg equations of motion for the effective Hamiltonian, the equations for the mechanical phases  become  
	_ij	&= -_ij - J_ij B_ij A_i A_j (_ij+_ij)  ,  
while the optical amplitudes  obey  
	A_i =  -_j i J_ij  B_ij (_ij + _ij) A_j  ,  
and the optical phases  evolve according to  
	_i	= - _i - _j i J_ij  B_ij A_jA_i (_ij + _ij)  .  
We introduced  and used .
Here and in the following we assume that the amplitudes of the limit-cycle oscillations are a constant of motion,
i.e., . This regime can be reached by working with self-induced optomechanical oscillators sufficiently
above threshold . The initial phase of the self-oscillators would be random
without extra precautions, but it can be set via an externally imposed mechanical drive, realized through an intensity-modulated
light field. 
In principle, the quantum regime of the present model could also be discussed, if the optomechanical coupling would be strong.
The most straightforward extension to a quantum version can be realized considering that the mechanical oscillators on the
links feature limit-cycles with quantum coherent phase dynamics.
Another more demanding way towards dynamical gauge fields in the quantum regime with optomechanics would be in the
spirit of Refs. Osterloh2005,Ruseckas2005,Zohar2011,Hauke2012,Banerjee2012,Zohar2013,Edmonds2013,Marcos2013,Marcos2014.
There, the link variable can be considered as a spin that flips each time an excitation hops between the corresponding sites.
In the optomechanical case, this would require highly nonlinear mechanical oscillators that can be brought into the quantum
regime such that they effectively act as a two-level system. 
An important point we want to make at this stage is the invariance of the equations of motion under the following
local  gauge transformation  
	_ij^	&= _ij + ( _j - _i )   ,  
	_i^	&= _i + _i    ,  
meaning that the observed evolution of the light intensity will not change, independent of the choice of .
We assumed a static gauge choice ; otherwise Eqs. () and () would have to be supplemented by a change in
frequencies:  and .  
Under which conditions does the gauge field display nontrivial dynamics? In Eqs. (),  (),
and () we can rescale time by , where we assume link independent tunneling and mechanical amplitudes.
Doing this, we observe that the entire dynamics only depends on the dimensionless ratio of . Here,  is proportional to
the laser drive amplitude and corresponds to the optical amplitude at an arbitrary reference site in the lattice (globally lowering
the optical amplitudes will also lower the optical amplitude at the reference site). For the limit , we expect that the
oscillation phases will not be affected by the hopping photons, rather only defining a static magnetic field pattern. This can
be seen from Eq. (): for  the second term, which provides the coupling to the hopping photons, can
be neglected. However, if  is large, we expect back-action of the hopping photons on the phonons leading to
intriguing coupled dynamics of the gauge field.  
Three-Site Model  
First, we study the case of three sites. The resulting effective model for photons  on sites  and
phonons  on links  is depicted in Fig.  a), where we define .
For definiteness, we will assume . For three sites, the gauge freedom implies that only the gauge
invariant flux  
	= _13 + _21 + _32  ,  
i.e., the sum of phases around the triangular plaquette, affects the dynamics of the photons. We want to mention that in
the regime where the phonons are not influenced by the photons () the Hamiltonian for the three-site
model can be diagonalized and the setup can act (for ) as a photon circulator , see also .    
    
In the intriguing case where the photons interact with the phonons we discuss the driven and dissipative setting and
furthermore choose equal tunneling amplitudes  and mechanical amplitudes .
As an example we consider a resonant drive on site .
Without drive and dissipation the dynamics only depends on the ratio . As a consequence,
for the driven case, the four parameters involved , can be combined into just two dimensionless parameters,
 and . The resulting ``phase diagram'' for the flux dynamics as a function of these two parameters
is displayed in Fig.  a). It has been obtained from direct numerical simulations and reveals four distinct regimes.
In regimes I and II the flux  (after some transient behavior) approaches a stationary value of either 
or different from it, respectively. In regimes III and IV, the flux  is not stationary but even in the long-time limit
shows a dynamical behavior. Most interestingly, the flux dynamics  in these regimes can either show periodic
or chaotic behavior, region III and IV in Fig.  a), respectively. Figures  b) and c) show cuts along
the red dashed lines marked in the phase diagram, indicating a continuous phase transition from phase I to II. In Fig. 
a) and b), we show two examples of the phase space  in regimes III and IV. Already at this level
we can distinguish periodic [Fig.  a)] from chaotic [Fig.  b)] dynamics. A more involved characterization
can be done using a bifurcation diagram. To this end, we show the value of  evaluated at the zero crossings of
, in the long-time limit, as a function the mechanical amplitude  in Fig.  c). This bifurcation
diagram allows us to distinguish the periodic from the chaotic flux dynamics within the whole phase diagram for .
In addition, we also checked whether the Fourier transform of the trajectories shows a clear peak or is flat, indicating
periodic or chaotic behavior, respectively, see .  
In the regime of fast photons dynamics (compared to the phonon dynamics), we are able to apply a Born-Oppenheimer
approximation and adiabatically eliminate the photons. To be more precise, we solve  where 
and use this instantaneous solution to eliminate  from the equations of motion for , see .
In the case of a resonant drive on site , this approximation leads to the following equation of motion for the flux:  
	 = 16 E^2J B^3 (4 + ^2J^2 B^2) () ^2J^2B^2 [12 + ^2J^2 B^2]^2 + [16 ()]^2   .  
From Eq. () we find  which shows very good agreement with the exact numerical
long-time dynamics in regime I. This approach fails in the other regimes since there we are not able to adiabatically
eliminate the photons. We also want to mention that both  and  are fixed points of Eq. ().
It turns out that for a resonant drive on site ,  is an unstable fixed point of Eq. ().
The asymmetry between  and  is due to the breaking of translational invariance, necessarily produced
by the link directions. In contrast, a resonant drive on site  would have  as a stable
fixed point. From Eq. () we also can estimate the rate  at which the flux  settles into
steady state. By linearizing around the fixed point we find 
where .  
Lattices 
We extend the three-site model to two-dimensional lattices and illustrate the dynamical behaviour on a triangular lattice,
cf. Fig.  c). Going from three sites to a lattice, a significant new feature comes into play: the artificial
dynamical magnetic field produced by the phonons can now exert a Lorentz force that bends the path of any light-beam
propagating in the array. Therefore, we end up with a dynamical interplay where the flow of the photons
changes the spatial distribution of the magnetic flux density which then acts back on the dynamics of the light field. 
We choose a scenario with the link directions as depicted in Fig.  c).
We note that this is not the only possible choice. In fact the intricate photon and phonon dynamics depends on the link pattern.
We illustrate the nonlinear structure formation in this model for the case of having only a single site illuminated by a laser.
In Fig.  a) we show the temporal evolution of the light intensity (top row) as well as the magnetic field
(bottom row) on the lattice.
At first the photons experience a static magnetic field which is set by the initial phases of the mechanical oscillations (here
chosen such that the initial flux is ) and start to move along the edge. Due to the back-action of the photons
(which primarily move along the edge) on the phonons, the flux per plaquette changes. This in turn leads to a reconfiguration
of the magnetic field which in this scenario forces the photons to reverse their direction of motion. Here, the system does not
reach a steady state even in the long-time limit.
Even though the photons live only for a short time  before escaping the structure, the system
develops a spatial ``memory'' in the form of the mechanical oscillation phases, where previous photons leave their imprint.   
     
For an intuitive description of the dynamics we assume zero initial flux per plaquette , a large optical damping
 compared to the tunneling , and a drive on one optical site on the top edge of the lattice. For this scenario,
we show in Fig.  b) a schematics of the flux and light field dynamics and focus on the fluxes through
the gray plaquettes for the very first moments of time evolution.
As soon as the optical amplitudes of two neighboring optical sites is nonzero, the mechanical oscillation phase on the
corresponding link will change, cf. Eq. (). More precisely, the phases on the links decrease, indicated by
the black arrows where the number of arrowheads indicate the magnitude of decrease.
However, from the way these phases enter the photon dynamics, one can deduce that each phase contributes to the
flux inside a plaquette with a positive sign only if the respective link is traversed in the positive direction when going
around the plaquette counterclockwise. This leads to the signs shown in the figure.
The light propagation due to the magnetic field is indicated by the green arrows.
It is worth mentioning that even in the long-time limit the mechanical oscillation phases continue drifting because even
an arbitrarily small but finite optical amplitude on neighboring sites is enough to change the phases, albeit very slowly.
With such a scenario one could imagine to engineer a desired magnetic field pattern by means of an optical drive.  
Disorder 
In general, disorder effects in optomechanical arrays have been recognized as an important issue, especially in systems
where the coupling between optical modes cannot be larger than the -scale mechanical frequencies, as is
the case both in the present system as well as, e.g., in our proposal for topologically protected transport in optomechanics .
The transport of photons and phonons in disordered optomechanical arrays in the regime of Anderson localization has recently
been analyzed in some detail by our group . To avoid such effects, the disorder needs to be suppressed
down to a level of the photon tunneling or less in order to obtain localization lengths that are so large that they do not matter
any more (larger than either the system size or the photon decay length). However, recently significant progress has been
made regarding the fabrication of optomechanical crystal arrays, representing the most promising integrated nanoscale
platform for these types of experiments. Specifically, it has been possible to reduce the disorder by a factor of about 
using novel postprocessing techniques, which brings it down to a scale where photon localization lengths become very large.
These techniques have been exploited recently in an experiment on optomechanical non-reciprocity with two coupled modes 
which is quite close in spirit to the setup we would require here.  
Conclusion 
We have shown that dynamical gauge fields in optomechanical arrays arise quite naturally. The evolving mechanical
oscillation phases, which respond to the flow of the photons, represent a dynamical gauge field for the latter. Already the
three-site model shows intriguing dynamics which leads to a rather complex phase diagram for the flux dynamics. With
experiments pushing towards multi-mode optomechanical setups, the three-site model seems feasible to be realized in
the near future and would pave the way for further studies of dynamical gauge fields in optomechanical arrays.
Collective behavior such as synchronization and pattern formation of mechanical limit-cycle oscillators have recently been
studied in optomechanical arrays . In this spirit, further studies on gauge field
dynamics in optomechanics could address questions on synchronization and dynamical pattern formation of the magnetic
field.  
We acknowledge helpful discussions with Roland Lauter, and thank Vittorio Peano and Talitha Weiss for a careful reading
of the manuscript. This work was financially supported by the Marie Curie ITN cQOM and the ERC OPTOMECH.   
The Three-Site Model: Including drive and dissipation  
Since the photons eventually decay, we add photon loss and drive to the system. This is best done starting with the
Hamiltonian () and adding a driving term .
Going into a frame rotating with the driving frequency , we obtain  
	H &=	_j 1,2,3 (_j^ - _d) a_j^ a_j^ + _j 1,2,3 E_j ( a_j + a_j^ ) + _l 12,23,13 _l^ b_l^ b_l^  
		&+J_12  B_12 (  e^-i _12 a_1^ a_2^ + )
		+ J_23  B_23 ( e^-i _23 a_2^ a_3^ + )
		+ J_13  B_13 ( e^i _13 a_3^ a_1^ + )  .   
Including dissipation of the photons at a rate  and neglecting effects due to quantum noise, the equations of motion
for the photons become  with  
	a &= (a_1,a_2,a_3)^T  ,  
	E &= (E_1,E_2,E_3)^T  ,  
	M& = (  
)  .  
The equations of motion for the phases  are unchanged. In Fig.  we show the optical amplitude
 as a function of the flux  and the drive frequency .
Figure  almost resembles the eigenfrequencies  in Fig.  c) which we obtained from
diagonalizing the Hamiltonian.    
The Three-Site Model: Diagonalization  
Here, we give some further details on the three-site model given by Eq. () which in its explicit form reads  
	H &=	_j 1,2,3 _j^ a_j^ a_j^ + _l 12,23,13 _l^ b_l^ b_l^
		+ J_12  ( b_12^ a_2^ a_1^ + )
		+ J_23  ( b_23^ a_3^ a_2^ + )
		+ J_13  ( b_13^ a_1^ a_3^ + )  .  
The equations of motion are obtained straight forwardly by using Heisenberg's equation of motion. The mechanical phases
 evolve according to  
	_12	&= -_12 - J_12 B_12 A_1 A_2 (_12+_12)  ,  
	_23	&= -_23 - J_23 B_23 A_2 A_3 (_23+_23)  , 
	_13	&= -_13 - J_13 B_13 A_1 A_3 (_13+_13)  .  
The optical amplitudes  obey the following equations of motion  
	A_1 =  &-J_12  B_12 (_12 + _12) A_2 - J_13  B_13 (_13 + _13) A_3  ,  
	A_2 =  &+J_12  B_12 (_12 + _12) A_1 - J_23  B_23 (_23 + _23) A_3  ,  
	A_3 =  &+J_13  B_13 (_13 + _13) A_1 + J_23  B_23 (_23 + _23) A_2  ,  
and the optical phases   
	_1	= - _1 &- J_12  B_12 A_2A_1 (_12 + _12) - J_13  B_13 A_3A_1 (_13 + _13)  ,  
	_2	= - _2 &- J_12  B_12 A_1A_2 (_12 + _12) - J_23  B_23 A_3A_2 (_23 + _23)  ,  
	_3	= - _3 &- J_23  B_23 A_2A_3 (_23 + _23) - J_13  B_13 A_1A_3 (_13 + _13)  .  
As mentioned in the main text, for , i.e., in the case of a static flux , and for 
a circulator behavior is expected, cf. Ref. Koch2010. A solution to this system of coupled first order differential equations with
initially one photon on site  and a phase   is shown in Fig.  a) and b), where the circulator
behavior is clearly visible, i.e., the photon is moving counterclockwise around the triangular plaquette.    
The Hamiltonian of the three-site model can be diagonalized best after going into a rotating frame by applying the
transformation  
	U = e^i t _j _j^ a_j^ a_j^ e^i t _l _l^ b_l^ b_l^   ,  
to Eq. () which leads to the Hamiltonian  
	H &=	J_12  B_12 ( e^-i _12 a_1^ a_2^ + ) 
		+ J_23  B_23 ( e^-i _23 a_2^ a_3^ + ) 
		+ J_13  B_13 ( e^i _13 a_3^ a_1^ + )  .  
Since we are here interested in the eigenvalues, we can perform a gauge transform  and make the
following gauge choice  
	- _12 + _2 - _1 &=    ,  
	- _23 + _3 - _2 &=   ,  
	_13 + _1 - _3   &=   ,   
which we can write as . 
The Hamiltonian can then be written as  
	H = _j=1^3 J_j B_j e^i  a_j^ a_j+1^ +  ,  
where we assumed periodic boundary conditions, i.e.,  and for convenience we introduce 
and similarly for . By introducing normal modes  
	a_j^ = 13 _k=0^2 e^-2 i k j / 3 A_k^  ,  
	A_k^ = 13 _j=1^3 e^2 i k j / 3 a_j^  ,  
and furthermore assuming equal tunneling amplitude  and limit-cycle amplitude , the Hamiltonian can be diagonalized  
	H = _k=0^2 _k^ A_k^ A_k^  ,  
where . As already pointed out in Ref. Koch2010, for 
this setup shows the behaviour of a photon circulator.  
Spectrum of a Periodic Trajectory Versus a Chaotic Trajectory   
    
Here, we give additional information on how we made the distinction between the periodic and chaotic behavior of the
dynamical gauge field in the case of the three-site model. In the main text, we chose to present the distinction, periodic
versus chaotic, by plotting the bifurcation diagram shown in Fig.  c). In addition to this, we also investigated the Fourier
transform of the time series , the spectrum. For a periodic time series there is a pronounced peak in the
spectrum at the frequency corresponding to the period of the time series. In the case of a chaotic time series the
spectrum does not show a preferred frequency and is almost flat.
In Fig.  a) and Fig.  b), we show the Fourier transform of the time series corresponding to
the phase space trajectories shown in Fig.  a) and Fig.  b), respectively. In the case of a periodic
trajectory, the spectrum clearly shows a peak, where as for a chaotic trajectory the spectrum is flat.
To summarize, in addition to the bifurcation diagram presented in the main text, we also checked the Fourier transform
of the time series to consistently distinguish periodic from chaotic trajectories.  
The Triangular Lattice: Equations of Motion  
On a two-dimensional triangular lattice we denote dynamical variables on lattice site  with a subscripts  and
dynamical variables on the directed links from site  to site  by a subscript . The equations of motion
for the mechanical phases  on the lattice links are  
	 &_(n,m)(n,m+1) = -_(n,m)(n,m+1) - J_(n,m)(n,m+1)B_(n,m)(n,m+1) A_n,m A_n,m+1 (_(n,m)(n,m+1)+_n,m-_n,m+1)  ,  
	 &_(n,m+1)(n+1,m)	= -_(n,m+1)(n+1,m)- J_(n,m+1)(n+1,m)B_(n,m+1)(n+1,m) A_n,m+1 A_n+1,m (_(n,m+1)(n+1,m)+_n,m+1-_n+1,m)  ,  
	 &_(n,m)(n+1,m)		= -_(n,m)(n+1,m) - J_(n,m)(n+1,m)B_(n,m)(n+1,m) A_n,m A_n+1,m (_(n,m)(n+1,m)+_n,m-_n+1,m)  .   
The optical amplitudes  obey the equations of motion  
	A_n,m = &-J_(n,m)(n,m+1) B_(n,m)(n,m+1) (_(n,m)(n,m+1) + _n,m - _n,m+1) A_n,m+1   
				&- J_(n,m)(n+1,m) B_(n,m)(n+1,m) (_(n,m)(n+1,m) + _n,m - _n+1,m) A_n+1,m  
				&+J_(n,m-1)(n,m) B_(n,m-1)(n,m) (_(n,m-1)(n,m) + _n,m-1 - _n,m) A_n,m-1  
				&- J_(n,m)(n+1,m-1) B_(n,m)(n+1,m-1) (_(n,m)(n+1,m-1) + _n,m - _n+1,m-1) A_n+1,m-1  
				&+J_(n-1,m)(n,m) B_(n-1,m)(n,m) (_(n-1,m)(n,m) + _n-1,m - _n,m) A_n-1,m  
				&+ J_(n-1,m+1)(n,m) B_(n-1,m+1)(n,m) (_(n-1,m+1)(n,m) + _n-1,m+1 - _n,m) A_n-1,m+1  ,   
and the optical phases  on a lattice site evolve according to  
	_n,m = 	&- _n,m   
					&- J_(n,m)(n,m+1) B_(n,m)(n,m+1) A_n,m+1A_n,m (_(n,m)(n,m+1) + _n,m - _n,m+1)   
					&- J_(n,m)(n+1,m) B_(n,m)(n+1,m) A_n+1,mA_n,m (_(n,m)(n+1,m) + _n,m - _n+1,m)  
					& - J_(n,m-1)(n,m) B_(n,m-1)(n,m) A_n,m-1A_n,m (_(n,m-1)(n,m) + _n,m-1 - _n,m)  
					&- J_(n,m)(n+1,m-1) B_(n,m)(n+1,m-1) A_n+1,m-1A_n,m (_(n,m)(n+1,m-1) + _n,m - _n+1,m-1)  
					& - J_(n,m)(n+1,m-1) B_(n,m)(n+1,m-1) A_n-1,mA_n,m (_(n,m)(n+1,m-1) + _n-1,m - _n,m)  
					&- J_(n-1,m+1)(n,m) B_(n-1,m+1)(n,m) A_n-1,m+1A_n,m (_(n-1,m+1)(n,m) + _n-1,m+1 - _n,m)   .  
A driving term on a particular site and dissipation of the photons on each site can be added straightforwardly, as also done
for the three-site model.  
The Triangular Lattice: Distribution of Optical and Mechanical Frequencies  
As mentioned in the main text, the links are directed: A photon tunneling from a site with a low (high) on-site frequency to
a site with a high (low) on-site frequency absorbs (emits) a phonon. These processes have to be resonant which could be
achieved by distributing the photon and phonon frequencies in the right way. For instance, the frequencies can be arranged
as shown in Fig. .    
    
L lines, C points and Chern numbers: understanding band structure topology using polarization fields 
Thomas Fosel1,2, Vittorio Peano1,3 and Florian Marquardt1,2  
	1 Friedrich-Alexander University Erlangen-Nurnberg (FAU), Department of Physics, Staudtstr. 7, 91058 Erlangen, Germany  
	2 Max Planck Institute for the Science of Light, Staudtstr. 2, 91058 Erlangen, Germany  
	3 Department of Physics, University of Malta, Msida MSD 2080, Malta    
	[] March 2017  
	Topology has appeared in different physical contexts. The most prominent application is topologically protected edge transport in condensed matter physics. The Chern number, the topological invariant of gapped Bloch Hamiltonians, is an important quantity in this field. Another example of topology, in polarization physics, are polarization singularities, called L lines and C points. By establishing a connection between these two theories, we develop a novel technique to visualize and potentially measure the Chern number: it can be expressed either as the winding of the polarization azimuth along L lines in reciprocal space, or in terms of the handedness and the index of the C points. For mechanical systems, this is directly connected to the visible motion patterns.   
Keywords: Chern number, polarization singularities    
Introduction  
Ever since the discovery of the transverse wave nature of electromagnetic waves, the study of the polarization properties of such vector waves has attracted a great deal of attention and led to the introduction of novel mathematical concepts. For a generic plane wave, the tip of the electric field vector traces an ellipse that defines the polarization state. In just the same way, we can describe the mechanical motion of a single pendulum that is free to move along two orthogonal directions. 
For an arbitrary (monochromatic) field, its polarization becomes position-dependent, and the resulting polarizaton field can display complex spatial patterns. Again, there is a mechanical analogy, in the form of 2D arrays of coupled mechanical oscillators. Such coupled oscillator arrays have already been used as a platform to implement topologically protected transport of sound waves, using coupled pendula  and coupled gyroscopes . Eventually, they could also be realized on the nanoscale, eg using nanopillar arrays . The time-evolution of such an array under monochromatic driving also exhibits elliptical motion that has the same mathematical description as the electromagnetic polarization fields. 
The study of the complex spatial polarization patterns in random electromagnetic waves has led to interesting topological concepts. The central objects of interest are lines where the polarization gets linear, and points with circular polarization. These ``L lines''  and ``C points''  have been studied thoroughly in random optical fields, but are still not widely known. However, they have been found in many different physical contexts, for example the sunlight in the sky  and speckle fields . 
There is, of course, another branch of physics where topology has become very prominent recently: the analysis of band structures. According both to their phenomenology and their theoretical description, two categories can be identified. On the one hand, there are the Chern insulators associated with the quantum Hall effect  and the anomalous quantum Hall effect ; they exhibit chiral edge transport as a result of a non-trivial topological invariant, the Chern number . On the other hand, topological insulators have been established by the discovery of the quantum spin Hall effect ; their edge channels are helical, and their topological properties are encoded in a binary () topological invariant . The importance of those topological features on transport is by now well-documented . 
In the present work, it is our aim to connect these two strands of topology, in a general way that is particularly useful for mechanical systems. Our approach helps to visualize (and, in principle, measure) the Chern numbers based on the polarization fields of bulk excitations. In fact, we offer two different approaches to extract the Chern numbers of the band structure, one based on L lines and the other based on C points. 
Our method is an alternative to other recently explored techniques to obtain Chern numbers for bosonic systems, both from bulk features , from dynamics at the boundary  and in more general settings . 
Besides the mechanical arrays of pendula and nanopillars mentioned above, we will also explain how our method can be applied in general to arbitrary mechanical structures (eg phononic crystals), and also to the electromagnetic fields in photonic structures. It is, thus, applicable in principle to a large class of the recently proposed or implemented topological devices for sound waves , light waves , ultracold atoms , or magnons . These include Chern insulators, as well as time-reversal preserving topological insulators whose Hamiltonian can be decomposed into a pair of Chern insulator Hamiltonians with opposite Chern numbers.  
Connecting topological bands to polarization fields  
In the following, we will consider a particle or excitation hopping around on a lattice in two dimensions. We will assume that there is some internal degree of freedom associated with the particle, or, equivalently, a certain number of basis states situated at each lattice site. The physical origin may vary: the spin of a particle, the atomic orbital for atoms in a crystal (s, p, d, ), the different oscillation directions of a mechanical resonator in a phononic lattice, the sense of circulation of the whispering gallery modes in a lattice of coupled optical disk resonators, or the polarization of photon-exciton polaritons in micropillars. In addition, one unit cell might consist of multiple sites, depending on the lattice geometry. For all these cases, we will speak of the ``polarization degree of freedom''. 
The total number  of basis states associated with a unit cell of the Bravais lattice determines the number of bands. In the following, we will denote the real-space basis states as  where  labels the unit cell and  refers to the polarization degree of freedom. 
The eigenmodes of every Hamiltonian  which respects the translational invariance are the Bloch states  
where  is the index of the band (with ) and  the position of the unit cell. 
We now consider the Chern number of the band :  
where  is the Berry connection and  is the unit vector in the direction of the -axis. The complex amplitudes  completely characterize the Bloch states in the band . They can already be deduced by inspecting a Bloch state in a single unit cell. Observation of the polarization pattern within one unit cell as a function of  is therefore sufficient to determine the Chern number of the -th band. This may even be of experimental relevance, for platforms like mechanical systems where direct measurement of the motion pattern in a given Bloch state is feasible. 
It turns out that the Chern number can even be calculated just by knowing the projections of the Bloch state  along two linearly independent directions, as long as these projections do not both vanish simultaneously for the same quasimomentum  (for a proof, see sec:connection+proof). Without loss of generality, we choose orthogonal directions in our polarization basis. The two projections define a complex vector field in reciprocal space:   
For particles with spin-1/2 or equivalent systems like mechanical oscillators with two degrees of freedom (oscillation directions),  and  can refer to the two basis states of the internal degree of freedom. If the lattice is a non-Bravais lattice, the projection onto one sublattice is a natural choice. In the mechanical case,  corresponds to the directly visible motion pattern  on the selected site. We note that, in the most general case, the orbit will be an ellipse.  
Geometrical interpretation of the polarization    
    
    
    
    
    
The vector field  defined in eq:definition_polarized_field can be rewritten in the useful parameterization  
In a mechanical setting, the angle  gives the direction of the major axis of the elliptical orbit and is therefore called the polarization azimuth,  represents a measure of its ellipticity and handnedness, and  (the total intensity along the two projections) is the squared diagonal of the axis-aligned bounding box, cf fig:polarization+poincare_sphere (a-b). In addition,  is the oscillation phase which is a gauge of freedom for the eigenstate. 
One can characterize the polarization of the field  by the Stokes parameters 
	
		S0 & = _1^2+_2^2  
		S1 & = _1^2-_2^2 = S0 (2polar_altitude) (2polar_azimuth)  
		S2 & = 2_1_2   = S0 (2polar_altitude) (2polar_azimuth)  
		S3 & = 2_1_2   = S0 (2polar_altitude).
	
	 
The parameters , , and  can be identified with the coordinates on the Poincare sphere, while  is the corresponding radius, cf fig:polarization+poincare_sphere (c).  
L Lines and Chern numbers  
In the previous section, we have shown how to assign to each band  an auxiliary polarization field , see eq:definition_polarized_field. In the remainder of the paper, we will make use of this field and of the geometrical interpretation of the polarization to provide a recipe to visualize the Chern number of the band. 
A typical polarization pattern is shown in fig:l_lines+chern[4](a). There, it can be seen that the polarization gets perfectly linear at the interfaces between the regions with left- and right-handed polarization. These interfaces are therefore called L lines. They are a generic feature of continuous polarized fields. L lines have been studied especially in polarized random fields . They are structurally stable upon small perturbations . Their robustness can be motivated by a topological argument: because the mapping on the Poincare sphere is continuous, any path between two points on different hemispheres, ie opposite handedness, has to inevitably cross the equator where the polarization is linear. 
Below, we explain how to simply read off the Chern numbers by inspecting the L lines of the polarization field. This is possible under a basic assumption: there should be no amplitude vortex in the polarization field. Amplitude vortices are the points where  vanishes. In two dimensions, they are not topologically protected because they require that four parameters vanish simultaneously (the real and imaginary part of  and ). Thus, they do not appear in generic random fields. While they could emerge as a consequence of some lattice point symmetry, they will disappear in the presence of a small perturbation that breaks that symmetry (and does not change the Chern number). Even without modifying the underlying Hamiltonian, one could eliminate such structures by a different choice of the projections used to define the auxiliary polarization field . For the above reasons, the scenario analyzed here where no amplitude vortex is present is not a special case but rather a generic one. 
In view of establishing a connection between the L lines and the Chern numbers, we define the winding number  of the polarization azimuth along one L line. This is defined as follows: We observe how the linear polarization direction changes as we traverse the closed L line in a specified sense. If the polarization turns around the origin counterclockwise (clockwise),  acquires a positive (negative) sign, and its absolute value is determined by the number of full turns. This value can be half-integer, since the linear polarization direction is defined only modulo 180 degrees. For our purposes, we specify that the traversal direction of the L line should always be chosen to match the handedness of the polarization field in the enclosed region (clockwise in the example of fig:l_lines+chern[4]a).    
    
    
    
    
We now state (and later prove) one of the main messages of this paper: The winding number  of the polarization azimuth along this L line is directly connected to the Chern number. In the simplest case with one L line per Brillouin zone, it is directly given by . If there are multiple L lines per Brillouin zone, their contributions simply add up:  
In particular, the Chern number is automatically  if there are no L lines at all.  
C Point classifications and Chern numbers    
    
    
    
Next, we show that the Chern numbers can also be related to the properties of the so-called C points . The C points are the points where the polarization gets perfectly circular. In other words, they correspond to the poles of the Poincare sphere, and they are the nodes of the scalar field   
whose complex phase is directly related to the polarization azimuth . 
It turns out that the C points can be classified according to four different criteria . Below, we show that two of these criteria are relevant in determining the Chern number. The first relevant criterium is based on their handedness, ie whether the polarization is purely left-handed () or right-handed (). The other relevant criterium is based on the so-called  classification: the polarization azimuth  is not well-defined at a C point, and the index  counts its winding around the corresponding singularity (in counter-clockwise direction):  
Its half-integer nature emerges from the fact that a half rotation of  corresponds to a full rotation around the  axis, ie it is already sufficient to restore the original elliptical motion pattern. We note that a C point, by definition, emerges at any crossing of the contours  and . Whenever any random perturbation is introduced, all the crossings with  are splitted into several C points (the sum over all C points of the  indexes is conserved in this process). In contrast, those C points with  are structurally stable, ie they will not split, and they cannot be created or destroyed spontaneously; pairwise creation and annihilation is however possible. 
It turns out that also the sum of the  indexes weighted by the corresponding handedness (the sign of ) is conserved for all these continuous transformations. In other words, such a weighted sum over all C points is a topological invariant. In the present setting where the polarization field is associated to the -th energy band of a translationally invariant system, the topological invariant discussed above can be identified with the Chern number,   
where  () contains all the C points with  () and .  
eq:relation_chern+c_points can be obtained from eq:relation_chern+l_lines by using that the winding of the polarization azimuth equals the sum of the enclosed C point indices. The two last conversions in eq:relation_chern+c_points are possible because the winding number along the boundaries of the Brillouin zone has to vanish (contributions on opposite edges will always cancel), so the unweighted index sum always vanishes: .  
    
Like eq:relation_chern+l_lines, eq:relation_chern+c_points applies only in the absence of amplitude vortices. Again, as we already discussed above in the context of L lines, such amplitude vortices are not topologically stable and do not appear generically. They can typically be eliminated by choosing a different projection. However, if needed, it is easy to extend eq:relation_chern+c_points by their contributions:  
where  consists of the labels for the amplitude vortices. The concrete value of  cannot be deduced from the values of  and  alone, but it can be determined if an additional projection  is known (which must not vanish at the same point ). Alternatively,  can be interpreted as the contributions of the C points into which the amplitude vortex decays under a small perturbation of the Hamiltonian. The treatment of amplitude vortices is illustrated in fig:c_points+ampl_vortices+chern.  
Connection to other Methods and Proof  
We will now present a proof for our recipe in sec:l_lines to obtain the Chern number from the L lines. In addition, we will relate the schemes presented in sec:l_lines and sec:c_points with another, well-known technique to visualize the Chern number, the Skyrmion configuration method, and discuss common features and differences.  
Kohmoto method  
We will prove our main result formula, eq:relation_chern+l_lines, for the Chern number by making a connection to the well-known analytical method for calculating the Chern numbers which is due to Khomoto . In Khomoto's method, one fixes a gauge by requiring that the overlap between the Bloch eigenstates of a particular band with a fixed state, for example , is a real positive number. When this prescription is well defined in the whole Brillouin zone, the Chern number can be interpreted as the flux of a curl piercing a closed surface (the Brillouin zone which is a torus), cf eq:definition_chern_number. In this case, Stokes theorem ensures that the Chern number will be zero. Thus, in all topologically non-trivial cases the prescription will be ill-defined for one or more values of the quasi-momentum . These points are commonly referred to as obstructions. The reason why the gauge prescription is ill-defined at an obstruction is simply that the corresponding overlap matrix element vanishes there. In this situation, it is neccessary to divide the Brillouin zone into several regions where different gauge conditions are applied. Then, the Chern number is encoded in the phase mismatches  at the interface between the different regions,  where  is the wavefunction in the gauge chosen in the regions  and , respectively. If the subdivision into regions is chosen such that there are no trijunctions, ie all the interfaces are closed loops, the Chern number is  
where the sum is taken over interfaces between neighboring regions ,  (where  is enclosed by ), and the integral is along the respective interface line. In practice, an effective route to analytically calculate the Chern number is to choose one gauge , determine the corresponding obstructions, and, for each obstruction , fix a suitable gauge  in a small region around it. This procedure reduces the task of calculating the Chern number to computing the phase mismatch in a few infinitesimally small regions. This often paves the way to an analytical treatment. 
Our scheme discussed in sec:l_lines can be viewed as a variation of Khomoto's method where rather than trying to fix the same gauge in the whole Brillouin zone and inserting patches where this does not work, we focus from the very beginning on two different gauge choices. For this purpose, we define the left- and right-handed components of an eigenstate  (here, we omit the band index ) using the corresponding auxiliary polarization field from eq:definition_polarized_field: 
	psi_L[] &:= 12(_s_1[]-i_s_2[]) &
	psi_R[] &:= 12(_s_1[]+i_s_2[])
	 
Demanding either  or  to be real, we obtain two distinct gauge conditions for the state : 
	psi_L[Phi_L(k)] & ! R+ &
	psi_R[Phi_R(k)] & ! R+
	 
We will fix the gauge using the first condition when the state  is in the northern hemisphere of the Poincare sphere (corresponding to , ie left-handed polarization), and the second one otherwise. This construction is possible because we have assumed that there are no amplitude vortices. We now show that the phase mismatch between these two gauges, defined by 
, is directly related to the polarization azimuth:
. For this purpose, we first apply . 
By inserting eq:definition_psi_lr into the numerator and comparing the result with the definition of  in eq:definition_sigma_field rewritten in terms of  and  using eq:definition_stokes_parameters, we find that . So,  according to the last equality in eq:definition_sigma_field.  
Skyrmion number  
It has been discussed before  that in a two-band model, the Chern number can be related to the skyrmion number: every eigenstate is represented by a Bloch vector  which is analoguous to the vector  here; the skyrmion number  
counts how many times the mapping  wraps the Bloch sphere, and is identical to the Chern number of the corresponding energy band. The skyrmion number has been developed in the context of magnetic skyrmions, quasiparticles which appear in certain magnetic materials. 
In that sense, our method generalizes this ``skyrmion method'' to models with an arbitrary number of bands. In addition, it connects the Chern number to the theory of L lines and C points, and it provides an interpretation of the Chern number in terms of directly visible features.  
Application to Mechanics and Optics    
The illustrative examples in fig:l_lines+chern,fig:c_points+chern,fig:c_points+ampl_vortices+chern have actually been calculated for a specific model which has already been implemented for gyroscopic pendula  and proposed for photon-exciton polaritons. This tight-binding  model features a  polarization degree of freedom on a honeycomb lattice. The on-site polarization degree of freedom represents two in-plane directions of motion of a two-dimensional mechanical (eg gyroscopic) oscillator or two directions of the field distributions in the case of photon-exciton polaritons. Because of the two sublattices in a honeycomb lattice, there are in total four energy/frequency bands in such a tight-binding model. For a pair of sites, the longitudinal (transversal) mode is defined such that it is parallel (perpendicular) to the connecting line. The longitudinal (transversal) modes of nearest neighbor sites are coupled with coupling strength  (). The toy model for this interaction in mechanics are two-dimensional mass-spring networks. In this setting, additional on-site Zeeman splitting -- breaking the time-reversal symmetry -- gives rise to AQHE edge channels. 
Because of its simple conception and the possibility to directly observe the polarization patterns in a mechanical system, such a system is a promising platform to demonstrate the determination and visualization of the Chern number with the technique described in this article. Whereas a macroscopic implementation of this model seems straightforward, a mesoscopic or microscopic one is more challenging due to the difficulties to fabricate springs at these lengthscales. However, there might be some more easily fabricated systems which intrinsically have this kind of interaction, eg arrays of nanopillars . Unpublished experimental data  indicate that the motion of neighboring nanopillars is coupled, and the described coupling type is the only linear interaction model which respects all the present symmetries. 
Conceptually, there are different options to implement Zeeman splitting including charged nanopillars in a homogeneous magnetic field, the conserved angular momentum  of magnetic tips in analogy to the Einstein-de Haas effect, and the Coriolis force  (cmp fig:nanopillars). However, order-of-magnitude estimates indicate that only the latter one can be strong enough to overcome the effect of dissipation and disorder. 
Another possible application, in the context of optics, are dielectric materials with a discrete translational symmetry in two dimensions; chiral edge channels analoguous to the QHE have already gained experimental verification in photonic crystals . In these systems, the (complex) electric field  takes over the role of the electron wave function. If arbitrary quasimomentum states can be excited and the resultant polarization of the electric field  can be measured at one single point  which is fixed previously, mapping these polarization patterns onto the Brillouin zone allows to directly read off the Chern number. Note that although the degree of polarization of the field  is only two, the dimension of the Bloch space is infinite due to the dependency on the two (continuous) coordinates  and . This is one example where the generalization to an arbitrary number of bands, compared to the Skyrmion method (see sec:connection+proof), becomes important.  
Measuring the Chern number  
Due to its outstanding role in the description of topologically protected edge state, the measurement of the Chern number may be a crucial point in an experimental analysis of a Chern insulator. 
One possible approach to obtain the Chern numbers is to measure the quantized Hall conductance in the band gaps. For example, this measurement works with very high precision in the original setup, the quantum Hall effect . However, there might be some situations in which wrong results are obtained due to technical limitations, eg if edge states in one band gap exist in principle, but they have a too large penetration length compared to the system size to be detectable. Or, if there is only a local, but not a global band gap, the Chern number is well-defined, but cannot be measured this way. More importantly, this method is by a fundamental reason restricted to fermionic systems as it relies on the quantized Hall conductance. Since there is no equivalent quantity in a bosonic system, different approaches to measure the Chern number for those had to be developed . 
Our method could serve as an alternative to these techniques as it offers a very direct approach: experimental techniques like Fourier transform spectroscopy or the excitation with quasimomentum modes give full access to the Bloch states; this is sufficient input to identify the L lines and C points, and to determine their relevant properties. Therefore, straightforward application of the schemes in sec:l_lines,sec:c_points can also be used to measure the Chern numbers for any type of Chern insulator. 
Its universality and directness could be a great advantage in comparison to other strategies. We also emphasize that, as opposed to, for example, a numerical calculation using a band structure simulation (there are both analytical  and numerical  methods), our method requires neither precise knowledge of the actual system parameters nor even the understanding of the underlying microscopic mechanisms.  
Conclusion  
The central aspect of this article is the connection between two topological concepts in modern physics: we have related the Chern number, one of the central quantities in the context of the QHE and the AQHE, to L lines and C points, the structurally stable objects known from random fields in polarized optics. What we obtain is a graphical interpretation of the Chern number which makes this abstract quantity more tangible. 
The term polarization is fundamental in the geometric description of oscillating electromagnetic fields. Even more, we can directly see what it means to a mechanical system by looking at the trajectories. This intuition makes these two classes of systems play an exclusive role for the scheme presented here. 
Besides the visualization, we have also discussed the possibility to use this technique as a tool to measure the Chern number in an experiment.  
References    
    


